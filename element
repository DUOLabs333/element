#!/usr/bin/env python3



import types
import sys
import base64
pyparsing_module=types.ModuleType("pyparsing")
#setattr(pyparsing_module,"__file__",__file__)
exec(base64.b64decode(b'bW9kdWxlX2RpY3Q9e30KbW9kdWxlX2RpY3RbInB5cGFyc2luZy9weS50eXBlZCJdPSIiIgoKIiIiCm1vZHVsZV9kaWN0WyJweXBhcnNpbmcvdW5pY29kZS5weSJdPSIiIgojIHVuaWNvZGUucHkKCmltcG9ydCBzeXMKZnJvbSBpdGVydG9vbHMgaW1wb3J0IGZpbHRlcmZhbHNlCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0LCBUdXBsZSwgVW5pb24KCgpjbGFzcyBfbGF6eWNsYXNzcHJvcGVydHk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZm4pOgogICAgICAgIHNlbGYuZm4gPSBmbgogICAgICAgIHNlbGYuX19kb2NfXyA9IGZuLl9fZG9jX18KICAgICAgICBzZWxmLl9fbmFtZV9fID0gZm4uX19uYW1lX18KCiAgICBkZWYgX19nZXRfXyhzZWxmLCBvYmosIGNscyk6CiAgICAgICAgaWYgY2xzIGlzIE5vbmU6CiAgICAgICAgICAgIGNscyA9IHR5cGUob2JqKQogICAgICAgIGlmIG5vdCBoYXNhdHRyKGNscywgXCJfaW50ZXJuXCIpIG9yIGFueSgKICAgICAgICAgICAgY2xzLl9pbnRlcm4gaXMgZ2V0YXR0cihzdXBlcmNsYXNzLCBcIl9pbnRlcm5cIiwgW10pCiAgICAgICAgICAgIGZvciBzdXBlcmNsYXNzIGluIGNscy5fX21yb19fWzE6XQogICAgICAgICk6CiAgICAgICAgICAgIGNscy5faW50ZXJuID0ge30KICAgICAgICBhdHRybmFtZSA9IHNlbGYuZm4uX19uYW1lX18KICAgICAgICBpZiBhdHRybmFtZSBub3QgaW4gY2xzLl9pbnRlcm46CiAgICAgICAgICAgIGNscy5faW50ZXJuW2F0dHJuYW1lXSA9IHNlbGYuZm4oY2xzKQogICAgICAgIHJldHVybiBjbHMuX2ludGVyblthdHRybmFtZV0KCgpVbmljb2RlUmFuZ2VMaXN0ID0gTGlzdFtVbmlvbltUdXBsZVtpbnQsIGludF0sIFR1cGxlW2ludF1dXQoKCmNsYXNzIHVuaWNvZGVfc2V0OgogICAgXCJcIlwiCiAgICBBIHNldCBvZiBVbmljb2RlIGNoYXJhY3RlcnMsIGZvciBsYW5ndWFnZS1zcGVjaWZpYyBzdHJpbmdzIGZvcgogICAgYGBhbHBoYXNgYCwgYGBudW1zYGAsIGBgYWxwaGFudW1zYGAsIGFuZCBgYHByaW50YWJsZXNgYC4KICAgIEEgdW5pY29kZV9zZXQgaXMgZGVmaW5lZCBieSBhIGxpc3Qgb2YgcmFuZ2VzIGluIHRoZSBVbmljb2RlIGNoYXJhY3RlcgogICAgc2V0LCBpbiBhIGNsYXNzIGF0dHJpYnV0ZSBgYF9yYW5nZXNgYC4gUmFuZ2VzIGNhbiBiZSBzcGVjaWZpZWQgdXNpbmcKICAgIDItdHVwbGVzIG9yIGEgMS10dXBsZSwgc3VjaCBhczo6CgogICAgICAgIF9yYW5nZXMgPSBbCiAgICAgICAgICAgICgweDAwMjAsIDB4MDA3ZSksCiAgICAgICAgICAgICgweDAwYTAsIDB4MDBmZiksCiAgICAgICAgICAgICgweDAxMDAsKSwKICAgICAgICAgICAgXQoKICAgIFJhbmdlcyBhcmUgbGVmdC0gYW5kIHJpZ2h0LWluY2x1c2l2ZS4gQSAxLXR1cGxlIG9mICh4LCkgaXMgdHJlYXRlZCBhcyAoeCwgeCkuCgogICAgQSB1bmljb2RlIHNldCBjYW4gYWxzbyBiZSBkZWZpbmVkIHVzaW5nIG11bHRpcGxlIGluaGVyaXRhbmNlIG9mIG90aGVyIHVuaWNvZGUgc2V0czo6CgogICAgICAgIGNsYXNzIENKSyhDaGluZXNlLCBKYXBhbmVzZSwgS29yZWFuKToKICAgICAgICAgICAgcGFzcwogICAgXCJcIlwiCgogICAgX3JhbmdlczogVW5pY29kZVJhbmdlTGlzdCA9IFtdCgogICAgQF9sYXp5Y2xhc3Nwcm9wZXJ0eQogICAgZGVmIF9jaGFyc19mb3JfcmFuZ2VzKGNscyk6CiAgICAgICAgcmV0ID0gW10KICAgICAgICBmb3IgY2MgaW4gY2xzLl9fbXJvX186CiAgICAgICAgICAgIGlmIGNjIGlzIHVuaWNvZGVfc2V0OgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZm9yIHJyIGluIGdldGF0dHIoY2MsIFwiX3Jhbmdlc1wiLCAoKSk6CiAgICAgICAgICAgICAgICByZXQuZXh0ZW5kKHJhbmdlKHJyWzBdLCByclstMV0gKyAxKSkKICAgICAgICByZXR1cm4gW2NocihjKSBmb3IgYyBpbiBzb3J0ZWQoc2V0KHJldCkpXQoKICAgIEBfbGF6eWNsYXNzcHJvcGVydHkKICAgIGRlZiBwcmludGFibGVzKGNscyk6CiAgICAgICAgXCJhbGwgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBpbiB0aGlzIHJhbmdlXCIKICAgICAgICByZXR1cm4gXCJcIi5qb2luKGZpbHRlcmZhbHNlKHN0ci5pc3NwYWNlLCBjbHMuX2NoYXJzX2Zvcl9yYW5nZXMpKQoKICAgIEBfbGF6eWNsYXNzcHJvcGVydHkKICAgIGRlZiBhbHBoYXMoY2xzKToKICAgICAgICBcImFsbCBhbHBoYWJldGljIGNoYXJhY3RlcnMgaW4gdGhpcyByYW5nZVwiCiAgICAgICAgcmV0dXJuIFwiXCIuam9pbihmaWx0ZXIoc3RyLmlzYWxwaGEsIGNscy5fY2hhcnNfZm9yX3JhbmdlcykpCgogICAgQF9sYXp5Y2xhc3Nwcm9wZXJ0eQogICAgZGVmIG51bXMoY2xzKToKICAgICAgICBcImFsbCBudW1lcmljIGRpZ2l0IGNoYXJhY3RlcnMgaW4gdGhpcyByYW5nZVwiCiAgICAgICAgcmV0dXJuIFwiXCIuam9pbihmaWx0ZXIoc3RyLmlzZGlnaXQsIGNscy5fY2hhcnNfZm9yX3JhbmdlcykpCgogICAgQF9sYXp5Y2xhc3Nwcm9wZXJ0eQogICAgZGVmIGFscGhhbnVtcyhjbHMpOgogICAgICAgIFwiYWxsIGFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzIGluIHRoaXMgcmFuZ2VcIgogICAgICAgIHJldHVybiBjbHMuYWxwaGFzICsgY2xzLm51bXMKCiAgICBAX2xhenljbGFzc3Byb3BlcnR5CiAgICBkZWYgaWRlbnRjaGFycyhjbHMpOgogICAgICAgIFwiYWxsIGNoYXJhY3RlcnMgaW4gdGhpcyByYW5nZSB0aGF0IGFyZSB2YWxpZCBpZGVudGlmaWVyIGNoYXJhY3RlcnMsIHBsdXMgdW5kZXJzY29yZSAnXydcIgogICAgICAgIHJldHVybiBcIlwiLmpvaW4oCiAgICAgICAgICAgIHNvcnRlZCgKICAgICAgICAgICAgICAgIHNldCgKICAgICAgICAgICAgICAgICAgICBcIlwiLmpvaW4oZmlsdGVyKHN0ci5pc2lkZW50aWZpZXIsIGNscy5fY2hhcnNfZm9yX3JhbmdlcykpCiAgICAgICAgICAgICAgICAgICAgKyBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXrCqsK1wrpcIgogICAgICAgICAgICAgICAgICAgICsgXCLDgMOBw4LDg8OEw4XDhsOHw4jDicOKw4vDjMONw47Dj8OQw5HDksOTw5TDlcOWw5jDmcOaw5vDnMOdw57Dn8Ogw6HDosOjw6TDpcOmw6fDqMOpw6rDq8Osw63DrsOvw7DDscOyw7PDtMO1w7bDuMO5w7rDu8O8w73DvsO/XCIKICAgICAgICAgICAgICAgICAgICArIFwiX1wiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICApCgogICAgQF9sYXp5Y2xhc3Nwcm9wZXJ0eQogICAgZGVmIGlkZW50Ym9keWNoYXJzKGNscyk6CiAgICAgICAgXCJcIlwiCiAgICAgICAgYWxsIGNoYXJhY3RlcnMgaW4gdGhpcyByYW5nZSB0aGF0IGFyZSB2YWxpZCBpZGVudGlmaWVyIGJvZHkgY2hhcmFjdGVycywKICAgICAgICBwbHVzIHRoZSBkaWdpdHMgMC05CiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIFwiXCIuam9pbigKICAgICAgICAgICAgc29ydGVkKAogICAgICAgICAgICAgICAgc2V0KAogICAgICAgICAgICAgICAgICAgIGNscy5pZGVudGNoYXJzCiAgICAgICAgICAgICAgICAgICAgKyBcIjAxMjM0NTY3ODlcIgogICAgICAgICAgICAgICAgICAgICsgXCJcIi5qb2luKAogICAgICAgICAgICAgICAgICAgICAgICBbYyBmb3IgYyBpbiBjbHMuX2NoYXJzX2Zvcl9yYW5nZXMgaWYgKFwiX1wiICsgYykuaXNpZGVudGlmaWVyKCldCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgKQoKCmNsYXNzIHB5cGFyc2luZ191bmljb2RlKHVuaWNvZGVfc2V0KToKICAgIFwiXCJcIgogICAgQSBuYW1lc3BhY2UgY2xhc3MgZm9yIGRlZmluaW5nIGNvbW1vbiBsYW5ndWFnZSB1bmljb2RlX3NldHMuCiAgICBcIlwiXCIKCiAgICAjIGZtdDogb2ZmCgogICAgIyBkZWZpbmUgcmFuZ2VzIGluIGxhbmd1YWdlIGNoYXJhY3RlciBzZXRzCiAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICgweDAwMjAsIHN5cy5tYXh1bmljb2RlKSwKICAgIF0KCiAgICBjbGFzcyBCYXNpY011bHRpbGluZ3VhbFBsYW5lKHVuaWNvZGVfc2V0KToKICAgICAgICBcIlVuaWNvZGUgc2V0IGZvciB0aGUgQmFzaWMgTXVsdGlsaW5ndWFsIFBsYW5lXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwMDIwLCAweEZGRkYpLAogICAgICAgIF0KCiAgICBjbGFzcyBMYXRpbjEodW5pY29kZV9zZXQpOgogICAgICAgIFwiVW5pY29kZSBzZXQgZm9yIExhdGluLTEgVW5pY29kZSBDaGFyYWN0ZXIgUmFuZ2VcIgogICAgICAgIF9yYW5nZXM6IFVuaWNvZGVSYW5nZUxpc3QgPSBbCiAgICAgICAgICAgICgweDAwMjAsIDB4MDA3RSksCiAgICAgICAgICAgICgweDAwQTAsIDB4MDBGRiksCiAgICAgICAgXQoKICAgIGNsYXNzIExhdGluQSh1bmljb2RlX3NldCk6CiAgICAgICAgXCJVbmljb2RlIHNldCBmb3IgTGF0aW4tQSBVbmljb2RlIENoYXJhY3RlciBSYW5nZVwiCiAgICAgICAgX3JhbmdlczogVW5pY29kZVJhbmdlTGlzdCA9IFsKICAgICAgICAgICAgKDB4MDEwMCwgMHgwMTdGKSwKICAgICAgICBdCgogICAgY2xhc3MgTGF0aW5CKHVuaWNvZGVfc2V0KToKICAgICAgICBcIlVuaWNvZGUgc2V0IGZvciBMYXRpbi1CIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwMTgwLCAweDAyNEYpLAogICAgICAgIF0KCiAgICBjbGFzcyBHcmVlayh1bmljb2RlX3NldCk6CiAgICAgICAgXCJVbmljb2RlIHNldCBmb3IgR3JlZWsgVW5pY29kZSBDaGFyYWN0ZXIgUmFuZ2VzXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwMzQyLCAweDAzNDUpLAogICAgICAgICAgICAoMHgwMzcwLCAweDAzNzcpLAogICAgICAgICAgICAoMHgwMzdBLCAweDAzN0YpLAogICAgICAgICAgICAoMHgwMzg0LCAweDAzOEEpLAogICAgICAgICAgICAoMHgwMzhDLCksCiAgICAgICAgICAgICgweDAzOEUsIDB4MDNBMSksCiAgICAgICAgICAgICgweDAzQTMsIDB4MDNFMSksCiAgICAgICAgICAgICgweDAzRjAsIDB4MDNGRiksCiAgICAgICAgICAgICgweDFEMjYsIDB4MUQyQSksCiAgICAgICAgICAgICgweDFENUUsKSwKICAgICAgICAgICAgKDB4MUQ2MCwpLAogICAgICAgICAgICAoMHgxRDY2LCAweDFENkEpLAogICAgICAgICAgICAoMHgxRjAwLCAweDFGMTUpLAogICAgICAgICAgICAoMHgxRjE4LCAweDFGMUQpLAogICAgICAgICAgICAoMHgxRjIwLCAweDFGNDUpLAogICAgICAgICAgICAoMHgxRjQ4LCAweDFGNEQpLAogICAgICAgICAgICAoMHgxRjUwLCAweDFGNTcpLAogICAgICAgICAgICAoMHgxRjU5LCksCiAgICAgICAgICAgICgweDFGNUIsKSwKICAgICAgICAgICAgKDB4MUY1RCwpLAogICAgICAgICAgICAoMHgxRjVGLCAweDFGN0QpLAogICAgICAgICAgICAoMHgxRjgwLCAweDFGQjQpLAogICAgICAgICAgICAoMHgxRkI2LCAweDFGQzQpLAogICAgICAgICAgICAoMHgxRkM2LCAweDFGRDMpLAogICAgICAgICAgICAoMHgxRkQ2LCAweDFGREIpLAogICAgICAgICAgICAoMHgxRkRELCAweDFGRUYpLAogICAgICAgICAgICAoMHgxRkYyLCAweDFGRjQpLAogICAgICAgICAgICAoMHgxRkY2LCAweDFGRkUpLAogICAgICAgICAgICAoMHgyMTI5LCksCiAgICAgICAgICAgICgweDI3MTksIDB4MjcxQSksCiAgICAgICAgICAgICgweEFCNjUsKSwKICAgICAgICAgICAgKDB4MTAxNDAsIDB4MTAxOEQpLAogICAgICAgICAgICAoMHgxMDFBMCwpLAogICAgICAgICAgICAoMHgxRDIwMCwgMHgxRDI0NSksCiAgICAgICAgICAgICgweDFGN0ExLCAweDFGN0E3KSwKICAgICAgICBdCgogICAgY2xhc3MgQ3lyaWxsaWModW5pY29kZV9zZXQpOgogICAgICAgIFwiVW5pY29kZSBzZXQgZm9yIEN5cmlsbGljIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwNDAwLCAweDA1MkYpLAogICAgICAgICAgICAoMHgxQzgwLCAweDFDODgpLAogICAgICAgICAgICAoMHgxRDJCLCksCiAgICAgICAgICAgICgweDFENzgsKSwKICAgICAgICAgICAgKDB4MkRFMCwgMHgyREZGKSwKICAgICAgICAgICAgKDB4QTY0MCwgMHhBNjcyKSwKICAgICAgICAgICAgKDB4QTY3NCwgMHhBNjlGKSwKICAgICAgICAgICAgKDB4RkUyRSwgMHhGRTJGKSwKICAgICAgICBdCgogICAgY2xhc3MgQ2hpbmVzZSh1bmljb2RlX3NldCk6CiAgICAgICAgXCJVbmljb2RlIHNldCBmb3IgQ2hpbmVzZSBVbmljb2RlIENoYXJhY3RlciBSYW5nZVwiCiAgICAgICAgX3JhbmdlczogVW5pY29kZVJhbmdlTGlzdCA9IFsKICAgICAgICAgICAgKDB4MkU4MCwgMHgyRTk5KSwKICAgICAgICAgICAgKDB4MkU5QiwgMHgyRUYzKSwKICAgICAgICAgICAgKDB4MzFDMCwgMHgzMUUzKSwKICAgICAgICAgICAgKDB4MzQwMCwgMHg0REI1KSwKICAgICAgICAgICAgKDB4NEUwMCwgMHg5RkVGKSwKICAgICAgICAgICAgKDB4QTcwMCwgMHhBNzA3KSwKICAgICAgICAgICAgKDB4RjkwMCwgMHhGQTZEKSwKICAgICAgICAgICAgKDB4RkE3MCwgMHhGQUQ5KSwKICAgICAgICAgICAgKDB4MTZGRTIsIDB4MTZGRTMpLAogICAgICAgICAgICAoMHgxRjIxMCwgMHgxRjIxMiksCiAgICAgICAgICAgICgweDFGMjE0LCAweDFGMjNCKSwKICAgICAgICAgICAgKDB4MUYyNDAsIDB4MUYyNDgpLAogICAgICAgICAgICAoMHgyMDAwMCwgMHgyQTZENiksCiAgICAgICAgICAgICgweDJBNzAwLCAweDJCNzM0KSwKICAgICAgICAgICAgKDB4MkI3NDAsIDB4MkI4MUQpLAogICAgICAgICAgICAoMHgyQjgyMCwgMHgyQ0VBMSksCiAgICAgICAgICAgICgweDJDRUIwLCAweDJFQkUwKSwKICAgICAgICAgICAgKDB4MkY4MDAsIDB4MkZBMUQpLAogICAgICAgIF0KCiAgICBjbGFzcyBKYXBhbmVzZSh1bmljb2RlX3NldCk6CiAgICAgICAgXCJVbmljb2RlIHNldCBmb3IgSmFwYW5lc2UgVW5pY29kZSBDaGFyYWN0ZXIgUmFuZ2UsIGNvbWJpbmluZyBLYW5qaSwgSGlyYWdhbmEsIGFuZCBLYXRha2FuYSByYW5nZXNcIgogICAgICAgIF9yYW5nZXM6IFVuaWNvZGVSYW5nZUxpc3QgPSBbXQoKICAgICAgICBjbGFzcyBLYW5qaSh1bmljb2RlX3NldCk6CiAgICAgICAgICAgIFwiVW5pY29kZSBzZXQgZm9yIEthbmppIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKICAgICAgICAgICAgX3JhbmdlczogVW5pY29kZVJhbmdlTGlzdCA9IFsKICAgICAgICAgICAgICAgICgweDRFMDAsIDB4OUZCRiksCiAgICAgICAgICAgICAgICAoMHgzMDAwLCAweDMwM0YpLAogICAgICAgICAgICBdCgogICAgICAgIGNsYXNzIEhpcmFnYW5hKHVuaWNvZGVfc2V0KToKICAgICAgICAgICAgXCJVbmljb2RlIHNldCBmb3IgSGlyYWdhbmEgVW5pY29kZSBDaGFyYWN0ZXIgUmFuZ2VcIgogICAgICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAgICAgKDB4MzA0MSwgMHgzMDk2KSwKICAgICAgICAgICAgICAgICgweDMwOTksIDB4MzBBMCksCiAgICAgICAgICAgICAgICAoMHgzMEZDLCksCiAgICAgICAgICAgICAgICAoMHhGRjcwLCksCiAgICAgICAgICAgICAgICAoMHgxQjAwMSwpLAogICAgICAgICAgICAgICAgKDB4MUIxNTAsIDB4MUIxNTIpLAogICAgICAgICAgICAgICAgKDB4MUYyMDAsKSwKICAgICAgICAgICAgXQoKICAgICAgICBjbGFzcyBLYXRha2FuYSh1bmljb2RlX3NldCk6CiAgICAgICAgICAgIFwiVW5pY29kZSBzZXQgZm9yIEthdGFrYW5hICBVbmljb2RlIENoYXJhY3RlciBSYW5nZVwiCiAgICAgICAgICAgIF9yYW5nZXM6IFVuaWNvZGVSYW5nZUxpc3QgPSBbCiAgICAgICAgICAgICAgICAoMHgzMDk5LCAweDMwOUMpLAogICAgICAgICAgICAgICAgKDB4MzBBMCwgMHgzMEZGKSwKICAgICAgICAgICAgICAgICgweDMxRjAsIDB4MzFGRiksCiAgICAgICAgICAgICAgICAoMHgzMkQwLCAweDMyRkUpLAogICAgICAgICAgICAgICAgKDB4RkY2NSwgMHhGRjlGKSwKICAgICAgICAgICAgICAgICgweDFCMDAwLCksCiAgICAgICAgICAgICAgICAoMHgxQjE2NCwgMHgxQjE2NyksCiAgICAgICAgICAgICAgICAoMHgxRjIwMSwgMHgxRjIwMiksCiAgICAgICAgICAgICAgICAoMHgxRjIxMywpLAogICAgICAgICAgICBdCgogICAgY2xhc3MgSGFuZ3VsKHVuaWNvZGVfc2V0KToKICAgICAgICBcIlVuaWNvZGUgc2V0IGZvciBIYW5ndWwgKEtvcmVhbikgVW5pY29kZSBDaGFyYWN0ZXIgUmFuZ2VcIgogICAgICAgIF9yYW5nZXM6IFVuaWNvZGVSYW5nZUxpc3QgPSBbCiAgICAgICAgICAgICgweDExMDAsIDB4MTFGRiksCiAgICAgICAgICAgICgweDMwMkUsIDB4MzAyRiksCiAgICAgICAgICAgICgweDMxMzEsIDB4MzE4RSksCiAgICAgICAgICAgICgweDMyMDAsIDB4MzIxQyksCiAgICAgICAgICAgICgweDMyNjAsIDB4MzI3QiksCiAgICAgICAgICAgICgweDMyN0UsKSwKICAgICAgICAgICAgKDB4QTk2MCwgMHhBOTdDKSwKICAgICAgICAgICAgKDB4QUMwMCwgMHhEN0EzKSwKICAgICAgICAgICAgKDB4RDdCMCwgMHhEN0M2KSwKICAgICAgICAgICAgKDB4RDdDQiwgMHhEN0ZCKSwKICAgICAgICAgICAgKDB4RkZBMCwgMHhGRkJFKSwKICAgICAgICAgICAgKDB4RkZDMiwgMHhGRkM3KSwKICAgICAgICAgICAgKDB4RkZDQSwgMHhGRkNGKSwKICAgICAgICAgICAgKDB4RkZEMiwgMHhGRkQ3KSwKICAgICAgICAgICAgKDB4RkZEQSwgMHhGRkRDKSwKICAgICAgICBdCgogICAgS29yZWFuID0gSGFuZ3VsCgogICAgY2xhc3MgQ0pLKENoaW5lc2UsIEphcGFuZXNlLCBIYW5ndWwpOgogICAgICAgIFwiVW5pY29kZSBzZXQgZm9yIGNvbWJpbmVkIENoaW5lc2UsIEphcGFuZXNlLCBhbmQgS29yZWFuIChDSkspIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKCiAgICBjbGFzcyBUaGFpKHVuaWNvZGVfc2V0KToKICAgICAgICBcIlVuaWNvZGUgc2V0IGZvciBUaGFpIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwRTAxLCAweDBFM0EpLAogICAgICAgICAgICAoMHgwRTNGLCAweDBFNUIpCiAgICAgICAgXQoKICAgIGNsYXNzIEFyYWJpYyh1bmljb2RlX3NldCk6CiAgICAgICAgXCJVbmljb2RlIHNldCBmb3IgQXJhYmljIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwNjAwLCAweDA2MUIpLAogICAgICAgICAgICAoMHgwNjFFLCAweDA2RkYpLAogICAgICAgICAgICAoMHgwNzAwLCAweDA3N0YpLAogICAgICAgIF0KCiAgICBjbGFzcyBIZWJyZXcodW5pY29kZV9zZXQpOgogICAgICAgIFwiVW5pY29kZSBzZXQgZm9yIEhlYnJldyBVbmljb2RlIENoYXJhY3RlciBSYW5nZVwiCiAgICAgICAgX3JhbmdlczogVW5pY29kZVJhbmdlTGlzdCA9IFsKICAgICAgICAgICAgKDB4MDU5MSwgMHgwNUM3KSwKICAgICAgICAgICAgKDB4MDVEMCwgMHgwNUVBKSwKICAgICAgICAgICAgKDB4MDVFRiwgMHgwNUY0KSwKICAgICAgICAgICAgKDB4RkIxRCwgMHhGQjM2KSwKICAgICAgICAgICAgKDB4RkIzOCwgMHhGQjNDKSwKICAgICAgICAgICAgKDB4RkIzRSwpLAogICAgICAgICAgICAoMHhGQjQwLCAweEZCNDEpLAogICAgICAgICAgICAoMHhGQjQzLCAweEZCNDQpLAogICAgICAgICAgICAoMHhGQjQ2LCAweEZCNEYpLAogICAgICAgIF0KCiAgICBjbGFzcyBEZXZhbmFnYXJpKHVuaWNvZGVfc2V0KToKICAgICAgICBcIlVuaWNvZGUgc2V0IGZvciBEZXZhbmFnYXJpIFVuaWNvZGUgQ2hhcmFjdGVyIFJhbmdlXCIKICAgICAgICBfcmFuZ2VzOiBVbmljb2RlUmFuZ2VMaXN0ID0gWwogICAgICAgICAgICAoMHgwOTAwLCAweDA5N0YpLAogICAgICAgICAgICAoMHhBOEUwLCAweEE4RkYpCiAgICAgICAgXQoKICAgICMgZm10OiBvbgoKCnB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLl9yYW5nZXMgPSAoCiAgICBweXBhcnNpbmdfdW5pY29kZS5KYXBhbmVzZS5LYW5qaS5fcmFuZ2VzCiAgICArIHB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLkhpcmFnYW5hLl9yYW5nZXMKICAgICsgcHlwYXJzaW5nX3VuaWNvZGUuSmFwYW5lc2UuS2F0YWthbmEuX3JhbmdlcwopCgpweXBhcnNpbmdfdW5pY29kZS5CTVAgPSBweXBhcnNpbmdfdW5pY29kZS5CYXNpY011bHRpbGluZ3VhbFBsYW5lCgojIGFkZCBsYW5ndWFnZSBpZGVudGlmaWVycyB1c2luZyBsYW5ndWFnZSBVbmljb2RlCnB5cGFyc2luZ191bmljb2RlLtin2YTYudix2KjZitipID0gcHlwYXJzaW5nX3VuaWNvZGUuQXJhYmljCnB5cGFyc2luZ191bmljb2RlLuS4reaWhyA9IHB5cGFyc2luZ191bmljb2RlLkNoaW5lc2UKcHlwYXJzaW5nX3VuaWNvZGUu0LrQuNGA0LjQu9C70LjRhtCwID0gcHlwYXJzaW5nX3VuaWNvZGUuQ3lyaWxsaWMKcHlwYXJzaW5nX3VuaWNvZGUuzpXOu867zrfOvc65zrrOrCA9IHB5cGFyc2luZ191bmljb2RlLkdyZWVrCnB5cGFyc2luZ191bmljb2RlLtei1rTXkdeo1rTXmdeqID0gcHlwYXJzaW5nX3VuaWNvZGUuSGVicmV3CnB5cGFyc2luZ191bmljb2RlLuaXpeacrOiqniA9IHB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlCnB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLua8ouWtlyA9IHB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLkthbmppCnB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLuOCq+OCv+OCq+ODiiA9IHB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLkthdGFrYW5hCnB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLuOBsuOCieOBjOOBqiA9IHB5cGFyc2luZ191bmljb2RlLkphcGFuZXNlLkhpcmFnYW5hCnB5cGFyc2luZ191bmljb2RlLu2VnOq1reyWtCA9IHB5cGFyc2luZ191bmljb2RlLktvcmVhbgpweXBhcnNpbmdfdW5pY29kZS7guYTguJfguKIgPSBweXBhcnNpbmdfdW5pY29kZS5UaGFpCnB5cGFyc2luZ191bmljb2RlLuCkpuClh+CkteCkqOCkvuCkl+CksOClgCA9IHB5cGFyc2luZ191bmljb2RlLkRldmFuYWdhcmkKCiIiIgptb2R1bGVfZGljdFsicHlwYXJzaW5nL2NvcmUucHkiXT0iIiIKIwojIGNvcmUucHkKIwppbXBvcnQgb3MKaW1wb3J0IHR5cGluZwpmcm9tIHR5cGluZyBpbXBvcnQgKAogICAgTmFtZWRUdXBsZSwKICAgIFVuaW9uLAogICAgQ2FsbGFibGUsCiAgICBBbnksCiAgICBHZW5lcmF0b3IsCiAgICBUdXBsZSwKICAgIExpc3QsCiAgICBUZXh0SU8sCiAgICBTZXQsCiAgICBTZXF1ZW5jZSwKKQpmcm9tIGFiYyBpbXBvcnQgQUJDLCBhYnN0cmFjdG1ldGhvZApmcm9tIGVudW0gaW1wb3J0IEVudW0KaW1wb3J0IHN0cmluZwppbXBvcnQgY29weQppbXBvcnQgd2FybmluZ3MKaW1wb3J0IHJlCmltcG9ydCBzeXMKZnJvbSBjb2xsZWN0aW9ucy5hYmMgaW1wb3J0IEl0ZXJhYmxlCmltcG9ydCB0cmFjZWJhY2sKaW1wb3J0IHR5cGVzCmZyb20gb3BlcmF0b3IgaW1wb3J0IGl0ZW1nZXR0ZXIKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCmZyb20gdGhyZWFkaW5nIGltcG9ydCBSTG9jawpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKCmZyb20gLnV0aWwgaW1wb3J0ICgKICAgIF9GaWZvQ2FjaGUsCiAgICBfVW5ib3VuZGVkQ2FjaGUsCiAgICBfX2NvbmZpZ19mbGFncywKICAgIF9jb2xsYXBzZV9zdHJpbmdfdG9fcmFuZ2VzLAogICAgX2VzY2FwZV9yZWdleF9yYW5nZV9jaGFycywKICAgIF9ic2xhc2gsCiAgICBfZmxhdHRlbiwKICAgIExSVU1lbW8gYXMgX0xSVU1lbW8sCiAgICBVbmJvdW5kZWRNZW1vIGFzIF9VbmJvdW5kZWRNZW1vLAopCmZyb20gLmV4Y2VwdGlvbnMgaW1wb3J0ICoKZnJvbSAuYWN0aW9ucyBpbXBvcnQgKgpmcm9tIC5yZXN1bHRzIGltcG9ydCBQYXJzZVJlc3VsdHMsIF9QYXJzZVJlc3VsdHNXaXRoT2Zmc2V0CmZyb20gLnVuaWNvZGUgaW1wb3J0IHB5cGFyc2luZ191bmljb2RlCgpfTUFYX0lOVCA9IHN5cy5tYXhzaXplCnN0cl90eXBlOiBUdXBsZVt0eXBlLCAuLi5dID0gKHN0ciwgYnl0ZXMpCgojCiMgQ29weXJpZ2h0IChjKSAyMDAzLTIwMjIgIFBhdWwgVC4gTWNHdWlyZQojCiMgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nCiMgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCiMgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCiMgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAojIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0bwojIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0bwojIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKIwojIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlCiMgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCiMKIyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELAojIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgojIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4KIyBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWQojIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsCiMgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUKIyBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KIwoKCmlmIHN5cy52ZXJzaW9uX2luZm8gPj0gKDMsIDgpOgogICAgZnJvbSBmdW5jdG9vbHMgaW1wb3J0IGNhY2hlZF9wcm9wZXJ0eQplbHNlOgoKICAgIGNsYXNzIGNhY2hlZF9wcm9wZXJ0eToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgZnVuYyk6CiAgICAgICAgICAgIHNlbGYuX2Z1bmMgPSBmdW5jCgogICAgICAgIGRlZiBfX2dldF9fKHNlbGYsIGluc3RhbmNlLCBvd25lcj1Ob25lKToKICAgICAgICAgICAgcmV0ID0gaW5zdGFuY2UuX19kaWN0X19bc2VsZi5fZnVuYy5fX25hbWVfX10gPSBzZWxmLl9mdW5jKGluc3RhbmNlKQogICAgICAgICAgICByZXR1cm4gcmV0CgoKY2xhc3MgX19jb21wYXRfXyhfX2NvbmZpZ19mbGFncyk6CiAgICBcIlwiXCIKICAgIEEgY3Jvc3MtdmVyc2lvbiBjb21wYXRpYmlsaXR5IGNvbmZpZ3VyYXRpb24gZm9yIHB5cGFyc2luZyBmZWF0dXJlcyB0aGF0IHdpbGwgYmUKICAgIHJlbGVhc2VkIGluIGEgZnV0dXJlIHZlcnNpb24uIEJ5IHNldHRpbmcgdmFsdWVzIGluIHRoaXMgY29uZmlndXJhdGlvbiB0byBUcnVlLAogICAgdGhvc2UgZmVhdHVyZXMgY2FuIGJlIGVuYWJsZWQgaW4gcHJpb3IgdmVyc2lvbnMgZm9yIGNvbXBhdGliaWxpdHkgZGV2ZWxvcG1lbnQKICAgIGFuZCB0ZXN0aW5nLgoKICAgIC0gYGBjb2xsZWN0X2FsbF9BbmRfdG9rZW5zYGAgLSBmbGFnIHRvIGVuYWJsZSBmaXggZm9yIElzc3VlICM2MyB0aGF0IGZpeGVzIGVycm9uZW91cyBncm91cGluZwogICAgICBvZiByZXN1bHRzIG5hbWVzIHdoZW4gYW4gOmNsYXNzOmBBbmRgIGV4cHJlc3Npb24gaXMgbmVzdGVkIHdpdGhpbiBhbiA6Y2xhc3M6YE9yYCBvciA6Y2xhc3M6YE1hdGNoRmlyc3RgOwogICAgICBtYWludGFpbmVkIGZvciBjb21wYXRpYmlsaXR5LCBidXQgc2V0dGluZyB0byBgYEZhbHNlYGAgbm8gbG9uZ2VyIHJlc3RvcmVzIHByZS0yLjMuMQogICAgICBiZWhhdmlvcgogICAgXCJcIlwiCgogICAgX3R5cGVfZGVzYyA9IFwiY29tcGF0aWJpbGl0eVwiCgogICAgY29sbGVjdF9hbGxfQW5kX3Rva2VucyA9IFRydWUKCiAgICBfYWxsX25hbWVzID0gW19fIGZvciBfXyBpbiBsb2NhbHMoKSBpZiBub3QgX18uc3RhcnRzd2l0aChcIl9cIildCiAgICBfZml4ZWRfbmFtZXMgPSBcIlwiXCIKICAgICAgICBjb2xsZWN0X2FsbF9BbmRfdG9rZW5zCiAgICAgICAgXCJcIlwiLnNwbGl0KCkKCgpjbGFzcyBfX2RpYWdfXyhfX2NvbmZpZ19mbGFncyk6CiAgICBfdHlwZV9kZXNjID0gXCJkaWFnbm9zdGljXCIKCiAgICB3YXJuX211bHRpcGxlX3Rva2Vuc19pbl9uYW1lZF9hbHRlcm5hdGlvbiA9IEZhbHNlCiAgICB3YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbiA9IEZhbHNlCiAgICB3YXJuX25hbWVfc2V0X29uX2VtcHR5X0ZvcndhcmQgPSBGYWxzZQogICAgd2Fybl9vbl9wYXJzZV91c2luZ19lbXB0eV9Gb3J3YXJkID0gRmFsc2UKICAgIHdhcm5fb25fYXNzaWdubWVudF90b19Gb3J3YXJkID0gRmFsc2UKICAgIHdhcm5fb25fbXVsdGlwbGVfc3RyaW5nX2FyZ3NfdG9fb25lb2YgPSBGYWxzZQogICAgd2Fybl9vbl9tYXRjaF9maXJzdF93aXRoX2xzaGlmdF9vcGVyYXRvciA9IEZhbHNlCiAgICBlbmFibGVfZGVidWdfb25fbmFtZWRfZXhwcmVzc2lvbnMgPSBGYWxzZQoKICAgIF9hbGxfbmFtZXMgPSBbX18gZm9yIF9fIGluIGxvY2FscygpIGlmIG5vdCBfXy5zdGFydHN3aXRoKFwiX1wiKV0KICAgIF93YXJuaW5nX25hbWVzID0gW25hbWUgZm9yIG5hbWUgaW4gX2FsbF9uYW1lcyBpZiBuYW1lLnN0YXJ0c3dpdGgoXCJ3YXJuXCIpXQogICAgX2RlYnVnX25hbWVzID0gW25hbWUgZm9yIG5hbWUgaW4gX2FsbF9uYW1lcyBpZiBuYW1lLnN0YXJ0c3dpdGgoXCJlbmFibGVfZGVidWdcIildCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZW5hYmxlX2FsbF93YXJuaW5ncyhjbHMpIC0+IE5vbmU6CiAgICAgICAgZm9yIG5hbWUgaW4gY2xzLl93YXJuaW5nX25hbWVzOgogICAgICAgICAgICBjbHMuZW5hYmxlKG5hbWUpCgoKY2xhc3MgRGlhZ25vc3RpY3MoRW51bSk6CiAgICBcIlwiXCIKICAgIERpYWdub3N0aWMgY29uZmlndXJhdGlvbiAoYWxsIGRlZmF1bHQgdG8gZGlzYWJsZWQpCiAgICAtIGBgd2Fybl9tdWx0aXBsZV90b2tlbnNfaW5fbmFtZWRfYWx0ZXJuYXRpb25gYCAtIGZsYWcgdG8gZW5hYmxlIHdhcm5pbmdzIHdoZW4gYSByZXN1bHRzCiAgICAgIG5hbWUgaXMgZGVmaW5lZCBvbiBhIDpjbGFzczpgTWF0Y2hGaXJzdGAgb3IgOmNsYXNzOmBPcmAgZXhwcmVzc2lvbiB3aXRoIG9uZSBvciBtb3JlIDpjbGFzczpgQW5kYCBzdWJleHByZXNzaW9ucwogICAgLSBgYHdhcm5fdW5ncm91cGVkX25hbWVkX3Rva2Vuc19pbl9jb2xsZWN0aW9uYGAgLSBmbGFnIHRvIGVuYWJsZSB3YXJuaW5ncyB3aGVuIGEgcmVzdWx0cwogICAgICBuYW1lIGlzIGRlZmluZWQgb24gYSBjb250YWluaW5nIGV4cHJlc3Npb24gd2l0aCB1bmdyb3VwZWQgc3ViZXhwcmVzc2lvbnMgdGhhdCBhbHNvCiAgICAgIGhhdmUgcmVzdWx0cyBuYW1lcwogICAgLSBgYHdhcm5fbmFtZV9zZXRfb25fZW1wdHlfRm9yd2FyZGBgIC0gZmxhZyB0byBlbmFibGUgd2FybmluZ3Mgd2hlbiBhIDpjbGFzczpgRm9yd2FyZGAgaXMgZGVmaW5lZAogICAgICB3aXRoIGEgcmVzdWx0cyBuYW1lLCBidXQgaGFzIG5vIGNvbnRlbnRzIGRlZmluZWQKICAgIC0gYGB3YXJuX29uX3BhcnNlX3VzaW5nX2VtcHR5X0ZvcndhcmRgYCAtIGZsYWcgdG8gZW5hYmxlIHdhcm5pbmdzIHdoZW4gYSA6Y2xhc3M6YEZvcndhcmRgIGlzCiAgICAgIGRlZmluZWQgaW4gYSBncmFtbWFyIGJ1dCBoYXMgbmV2ZXIgaGFkIGFuIGV4cHJlc3Npb24gYXR0YWNoZWQgdG8gaXQKICAgIC0gYGB3YXJuX29uX2Fzc2lnbm1lbnRfdG9fRm9yd2FyZGBgIC0gZmxhZyB0byBlbmFibGUgd2FybmluZ3Mgd2hlbiBhIDpjbGFzczpgRm9yd2FyZGAgaXMgZGVmaW5lZAogICAgICBidXQgaXMgb3ZlcndyaXR0ZW4gYnkgYXNzaWduaW5nIHVzaW5nIGBgJz0nYGAgaW5zdGVhZCBvZiBgYCc8PD0nYGAgb3IgYGAnPDwnYGAKICAgIC0gYGB3YXJuX29uX211bHRpcGxlX3N0cmluZ19hcmdzX3RvX29uZW9mYGAgLSBmbGFnIHRvIGVuYWJsZSB3YXJuaW5ncyB3aGVuIDpjbGFzczpgb25lX29mYCBpcwogICAgICBpbmNvcnJlY3RseSBjYWxsZWQgd2l0aCBtdWx0aXBsZSBzdHIgYXJndW1lbnRzCiAgICAtIGBgZW5hYmxlX2RlYnVnX29uX25hbWVkX2V4cHJlc3Npb25zYGAgLSBmbGFnIHRvIGF1dG8tZW5hYmxlIGRlYnVnIG9uIGFsbCBzdWJzZXF1ZW50CiAgICAgIGNhbGxzIHRvIDpjbGFzczpgUGFyc2VyRWxlbWVudC5zZXRfbmFtZWAKCiAgICBEaWFnbm9zdGljcyBhcmUgZW5hYmxlZC9kaXNhYmxlZCBieSBjYWxsaW5nIDpjbGFzczpgZW5hYmxlX2RpYWdgIGFuZCA6Y2xhc3M6YGRpc2FibGVfZGlhZ2AuCiAgICBBbGwgd2FybmluZ3MgY2FuIGJlIGVuYWJsZWQgYnkgY2FsbGluZyA6Y2xhc3M6YGVuYWJsZV9hbGxfd2FybmluZ3NgLgogICAgXCJcIlwiCgogICAgd2Fybl9tdWx0aXBsZV90b2tlbnNfaW5fbmFtZWRfYWx0ZXJuYXRpb24gPSAwCiAgICB3YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbiA9IDEKICAgIHdhcm5fbmFtZV9zZXRfb25fZW1wdHlfRm9yd2FyZCA9IDIKICAgIHdhcm5fb25fcGFyc2VfdXNpbmdfZW1wdHlfRm9yd2FyZCA9IDMKICAgIHdhcm5fb25fYXNzaWdubWVudF90b19Gb3J3YXJkID0gNAogICAgd2Fybl9vbl9tdWx0aXBsZV9zdHJpbmdfYXJnc190b19vbmVvZiA9IDUKICAgIHdhcm5fb25fbWF0Y2hfZmlyc3Rfd2l0aF9sc2hpZnRfb3BlcmF0b3IgPSA2CiAgICBlbmFibGVfZGVidWdfb25fbmFtZWRfZXhwcmVzc2lvbnMgPSA3CgoKZGVmIGVuYWJsZV9kaWFnKGRpYWdfZW51bTogRGlhZ25vc3RpY3MpIC0+IE5vbmU6CiAgICBcIlwiXCIKICAgIEVuYWJsZSBhIGdsb2JhbCBweXBhcnNpbmcgZGlhZ25vc3RpYyBmbGFnIChzZWUgOmNsYXNzOmBEaWFnbm9zdGljc2ApLgogICAgXCJcIlwiCiAgICBfX2RpYWdfXy5lbmFibGUoZGlhZ19lbnVtLm5hbWUpCgoKZGVmIGRpc2FibGVfZGlhZyhkaWFnX2VudW06IERpYWdub3N0aWNzKSAtPiBOb25lOgogICAgXCJcIlwiCiAgICBEaXNhYmxlIGEgZ2xvYmFsIHB5cGFyc2luZyBkaWFnbm9zdGljIGZsYWcgKHNlZSA6Y2xhc3M6YERpYWdub3N0aWNzYCkuCiAgICBcIlwiXCIKICAgIF9fZGlhZ19fLmRpc2FibGUoZGlhZ19lbnVtLm5hbWUpCgoKZGVmIGVuYWJsZV9hbGxfd2FybmluZ3MoKSAtPiBOb25lOgogICAgXCJcIlwiCiAgICBFbmFibGUgYWxsIGdsb2JhbCBweXBhcnNpbmcgZGlhZ25vc3RpYyB3YXJuaW5ncyAoc2VlIDpjbGFzczpgRGlhZ25vc3RpY3NgKS4KICAgIFwiXCJcIgogICAgX19kaWFnX18uZW5hYmxlX2FsbF93YXJuaW5ncygpCgoKIyBoaWRlIGFic3RyYWN0IGNsYXNzCmRlbCBfX2NvbmZpZ19mbGFncwoKCmRlZiBfc2hvdWxkX2VuYWJsZV93YXJuaW5ncygKICAgIGNtZF9saW5lX3dhcm5fb3B0aW9uczogdHlwaW5nLkl0ZXJhYmxlW3N0cl0sIHdhcm5fZW52X3ZhcjogdHlwaW5nLk9wdGlvbmFsW3N0cl0KKSAtPiBib29sOgogICAgZW5hYmxlID0gYm9vbCh3YXJuX2Vudl92YXIpCiAgICBmb3Igd2Fybl9vcHQgaW4gY21kX2xpbmVfd2Fybl9vcHRpb25zOgogICAgICAgIHdfYWN0aW9uLCB3X21lc3NhZ2UsIHdfY2F0ZWdvcnksIHdfbW9kdWxlLCB3X2xpbmUgPSAod2Fybl9vcHQgKyBcIjo6OjpcIikuc3BsaXQoCiAgICAgICAgICAgIFwiOlwiCiAgICAgICAgKVs6NV0KICAgICAgICBpZiBub3Qgd19hY3Rpb24ubG93ZXIoKS5zdGFydHN3aXRoKFwiaVwiKSBhbmQgKAogICAgICAgICAgICBub3QgKHdfbWVzc2FnZSBvciB3X2NhdGVnb3J5IG9yIHdfbW9kdWxlKSBvciB3X21vZHVsZSA9PSBcInB5cGFyc2luZ1wiCiAgICAgICAgKToKICAgICAgICAgICAgZW5hYmxlID0gVHJ1ZQogICAgICAgIGVsaWYgd19hY3Rpb24ubG93ZXIoKS5zdGFydHN3aXRoKFwiaVwiKSBhbmQgd19tb2R1bGUgaW4gKFwicHlwYXJzaW5nXCIsIFwiXCIpOgogICAgICAgICAgICBlbmFibGUgPSBGYWxzZQogICAgcmV0dXJuIGVuYWJsZQoKCmlmIF9zaG91bGRfZW5hYmxlX3dhcm5pbmdzKAogICAgc3lzLndhcm5vcHRpb25zLCBvcy5lbnZpcm9uLmdldChcIlBZUEFSU0lOR0VOQUJMRUFMTFdBUk5JTkdTXCIpCik6CiAgICBlbmFibGVfYWxsX3dhcm5pbmdzKCkKCgojIGJ1aWxkIGxpc3Qgb2Ygc2luZ2xlIGFyZyBidWlsdGlucywgdGhhdCBjYW4gYmUgdXNlZCBhcyBwYXJzZSBhY3Rpb25zCl9zaW5nbGVfYXJnX2J1aWx0aW5zID0gewogICAgc3VtLAogICAgbGVuLAogICAgc29ydGVkLAogICAgcmV2ZXJzZWQsCiAgICBsaXN0LAogICAgdHVwbGUsCiAgICBzZXQsCiAgICBhbnksCiAgICBhbGwsCiAgICBtaW4sCiAgICBtYXgsCn0KCl9nZW5lcmF0b3JUeXBlID0gdHlwZXMuR2VuZXJhdG9yVHlwZQpQYXJzZUFjdGlvbiA9IFVuaW9uWwogICAgQ2FsbGFibGVbW10sIEFueV0sCiAgICBDYWxsYWJsZVtbUGFyc2VSZXN1bHRzXSwgQW55XSwKICAgIENhbGxhYmxlW1tpbnQsIFBhcnNlUmVzdWx0c10sIEFueV0sCiAgICBDYWxsYWJsZVtbc3RyLCBpbnQsIFBhcnNlUmVzdWx0c10sIEFueV0sCl0KUGFyc2VDb25kaXRpb24gPSBVbmlvblsKICAgIENhbGxhYmxlW1tdLCBib29sXSwKICAgIENhbGxhYmxlW1tQYXJzZVJlc3VsdHNdLCBib29sXSwKICAgIENhbGxhYmxlW1tpbnQsIFBhcnNlUmVzdWx0c10sIGJvb2xdLAogICAgQ2FsbGFibGVbW3N0ciwgaW50LCBQYXJzZVJlc3VsdHNdLCBib29sXSwKXQpQYXJzZUZhaWxBY3Rpb24gPSBDYWxsYWJsZVtbc3RyLCBpbnQsIFwiUGFyc2VyRWxlbWVudFwiLCBFeGNlcHRpb25dLCBOb25lXQpEZWJ1Z1N0YXJ0QWN0aW9uID0gQ2FsbGFibGVbW3N0ciwgaW50LCBcIlBhcnNlckVsZW1lbnRcIiwgYm9vbF0sIE5vbmVdCkRlYnVnU3VjY2Vzc0FjdGlvbiA9IENhbGxhYmxlWwogICAgW3N0ciwgaW50LCBpbnQsIFwiUGFyc2VyRWxlbWVudFwiLCBQYXJzZVJlc3VsdHMsIGJvb2xdLCBOb25lCl0KRGVidWdFeGNlcHRpb25BY3Rpb24gPSBDYWxsYWJsZVtbc3RyLCBpbnQsIFwiUGFyc2VyRWxlbWVudFwiLCBFeGNlcHRpb24sIGJvb2xdLCBOb25lXQoKCmFscGhhcyA9IHN0cmluZy5hc2NpaV91cHBlcmNhc2UgKyBzdHJpbmcuYXNjaWlfbG93ZXJjYXNlCmlkZW50Y2hhcnMgPSBweXBhcnNpbmdfdW5pY29kZS5MYXRpbjEuaWRlbnRjaGFycwppZGVudGJvZHljaGFycyA9IHB5cGFyc2luZ191bmljb2RlLkxhdGluMS5pZGVudGJvZHljaGFycwpudW1zID0gXCIwMTIzNDU2Nzg5XCIKaGV4bnVtcyA9IG51bXMgKyBcIkFCQ0RFRmFiY2RlZlwiCmFscGhhbnVtcyA9IGFscGhhcyArIG51bXMKcHJpbnRhYmxlcyA9IFwiXCIuam9pbihbYyBmb3IgYyBpbiBzdHJpbmcucHJpbnRhYmxlIGlmIGMgbm90IGluIHN0cmluZy53aGl0ZXNwYWNlXSkKCl90cmltX2FyaXR5X2NhbGxfbGluZTogdHJhY2ViYWNrLlN0YWNrU3VtbWFyeSA9IE5vbmUKCgpkZWYgX3RyaW1fYXJpdHkoZnVuYywgbWF4X2xpbWl0PTMpOgogICAgXCJcIlwiZGVjb3JhdG9yIHRvIHRyaW0gZnVuY3Rpb24gY2FsbHMgdG8gbWF0Y2ggdGhlIGFyaXR5IG9mIHRoZSB0YXJnZXRcIlwiXCIKICAgIGdsb2JhbCBfdHJpbV9hcml0eV9jYWxsX2xpbmUKCiAgICBpZiBmdW5jIGluIF9zaW5nbGVfYXJnX2J1aWx0aW5zOgogICAgICAgIHJldHVybiBsYW1iZGEgcywgbCwgdDogZnVuYyh0KQoKICAgIGxpbWl0ID0gMAogICAgZm91bmRfYXJpdHkgPSBGYWxzZQoKICAgIGRlZiBleHRyYWN0X3RiKHRiLCBsaW1pdD0wKToKICAgICAgICBmcmFtZXMgPSB0cmFjZWJhY2suZXh0cmFjdF90Yih0YiwgbGltaXQ9bGltaXQpCiAgICAgICAgZnJhbWVfc3VtbWFyeSA9IGZyYW1lc1stMV0KICAgICAgICByZXR1cm4gW2ZyYW1lX3N1bW1hcnlbOjJdXQoKICAgICMgc3ludGhlc2l6ZSB3aGF0IHdvdWxkIGJlIHJldHVybmVkIGJ5IHRyYWNlYmFjay5leHRyYWN0X3N0YWNrIGF0IHRoZSBjYWxsIHRvCiAgICAjIHVzZXIncyBwYXJzZSBhY3Rpb24gJ2Z1bmMnLCBzbyB0aGF0IHdlIGRvbid0IGluY3VyIGNhbGwgcGVuYWx0eSBhdCBwYXJzZSB0aW1lCgogICAgIyBmbXQ6IG9mZgogICAgTElORV9ESUZGID0gNwogICAgIyBJRiBBTlkgQ09ERSBDSEFOR0VTLCBFVkVOIEpVU1QgQ09NTUVOVFMgT1IgQkxBTksgTElORVMsIEJFVFdFRU4gVEhFIE5FWFQgTElORSBBTkQKICAgICMgVEhFIENBTEwgVE8gRlVOQyBJTlNJREUgV1JBUFBFUiwgTElORV9ESUZGIE1VU1QgQkUgTU9ESUZJRUQhISEhCiAgICBfdHJpbV9hcml0eV9jYWxsX2xpbmUgPSAoX3RyaW1fYXJpdHlfY2FsbF9saW5lIG9yIHRyYWNlYmFjay5leHRyYWN0X3N0YWNrKGxpbWl0PTIpWy0xXSkKICAgIHBhX2NhbGxfbGluZV9zeW50aCA9IChfdHJpbV9hcml0eV9jYWxsX2xpbmVbMF0sIF90cmltX2FyaXR5X2NhbGxfbGluZVsxXSArIExJTkVfRElGRikKCiAgICBkZWYgd3JhcHBlcigqYXJncyk6CiAgICAgICAgbm9ubG9jYWwgZm91bmRfYXJpdHksIGxpbWl0CiAgICAgICAgd2hpbGUgMToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0ID0gZnVuYygqYXJnc1tsaW1pdDpdKQogICAgICAgICAgICAgICAgZm91bmRfYXJpdHkgPSBUcnVlCiAgICAgICAgICAgICAgICByZXR1cm4gcmV0CiAgICAgICAgICAgIGV4Y2VwdCBUeXBlRXJyb3IgYXMgdGU6CiAgICAgICAgICAgICAgICAjIHJlLXJhaXNlIFR5cGVFcnJvcnMgaWYgdGhleSBkaWQgbm90IGNvbWUgZnJvbSBvdXIgYXJpdHkgdGVzdGluZwogICAgICAgICAgICAgICAgaWYgZm91bmRfYXJpdHk6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdGIgPSB0ZS5fX3RyYWNlYmFja19fCiAgICAgICAgICAgICAgICAgICAgdHJpbV9hcml0eV90eXBlX2Vycm9yID0gKAogICAgICAgICAgICAgICAgICAgICAgICBleHRyYWN0X3RiKHRiLCBsaW1pdD0yKVstMV1bOjJdID09IHBhX2NhbGxfbGluZV9zeW50aAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBkZWwgdGIKCiAgICAgICAgICAgICAgICAgICAgaWYgdHJpbV9hcml0eV90eXBlX2Vycm9yOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBsaW1pdCA8IG1heF9saW1pdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0ICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAjIGZtdDogb24KCiAgICAjIGNvcHkgZnVuYyBuYW1lIHRvIHdyYXBwZXIgZm9yIHNlbnNpYmxlIGRlYnVnIG91dHB1dAogICAgIyAoY2FuJ3QgdXNlIGZ1bmN0b29scy53cmFwcywgc2luY2UgdGhhdCBtZXNzZXMgd2l0aCBmdW5jdGlvbiBzaWduYXR1cmUpCiAgICBmdW5jX25hbWUgPSBnZXRhdHRyKGZ1bmMsIFwiX19uYW1lX19cIiwgZ2V0YXR0cihmdW5jLCBcIl9fY2xhc3NfX1wiKS5fX25hbWVfXykKICAgIHdyYXBwZXIuX19uYW1lX18gPSBmdW5jX25hbWUKICAgIHdyYXBwZXIuX19kb2NfXyA9IGZ1bmMuX19kb2NfXwoKICAgIHJldHVybiB3cmFwcGVyCgoKZGVmIGNvbmRpdGlvbl9hc19wYXJzZV9hY3Rpb24oCiAgICBmbjogUGFyc2VDb25kaXRpb24sIG1lc3NhZ2U6IHN0ciA9IE5vbmUsIGZhdGFsOiBib29sID0gRmFsc2UKKSAtPiBQYXJzZUFjdGlvbjoKICAgIFwiXCJcIgogICAgRnVuY3Rpb24gdG8gY29udmVydCBhIHNpbXBsZSBwcmVkaWNhdGUgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGBgVHJ1ZWBgIG9yIGBgRmFsc2VgYAogICAgaW50byBhIHBhcnNlIGFjdGlvbi4gQ2FuIGJlIHVzZWQgaW4gcGxhY2VzIHdoZW4gYSBwYXJzZSBhY3Rpb24gaXMgcmVxdWlyZWQKICAgIGFuZCA6Y2xhc3M6YFBhcnNlckVsZW1lbnQuYWRkX2NvbmRpdGlvbmAgY2Fubm90IGJlIHVzZWQgKHN1Y2ggYXMgd2hlbiBhZGRpbmcgYSBjb25kaXRpb24KICAgIHRvIGFuIG9wZXJhdG9yIGxldmVsIGluIDpjbGFzczpgaW5maXhfbm90YXRpb25gKS4KCiAgICBPcHRpb25hbCBrZXl3b3JkIGFyZ3VtZW50czoKCiAgICAtIGBgbWVzc2FnZWBgIC0gZGVmaW5lIGEgY3VzdG9tIG1lc3NhZ2UgdG8gYmUgdXNlZCBpbiB0aGUgcmFpc2VkIGV4Y2VwdGlvbgogICAgLSBgYGZhdGFsYGAgLSBpZiBUcnVlLCB3aWxsIHJhaXNlIDpjbGFzczpgUGFyc2VGYXRhbEV4Y2VwdGlvbmAgdG8gc3RvcCBwYXJzaW5nIGltbWVkaWF0ZWx5OwogICAgICBvdGhlcndpc2Ugd2lsbCByYWlzZSA6Y2xhc3M6YFBhcnNlRXhjZXB0aW9uYAoKICAgIFwiXCJcIgogICAgbXNnID0gbWVzc2FnZSBpZiBtZXNzYWdlIGlzIG5vdCBOb25lIGVsc2UgXCJmYWlsZWQgdXNlci1kZWZpbmVkIGNvbmRpdGlvblwiCiAgICBleGNfdHlwZSA9IFBhcnNlRmF0YWxFeGNlcHRpb24gaWYgZmF0YWwgZWxzZSBQYXJzZUV4Y2VwdGlvbgogICAgZm4gPSBfdHJpbV9hcml0eShmbikKCiAgICBAd3JhcHMoZm4pCiAgICBkZWYgcGEocywgbCwgdCk6CiAgICAgICAgaWYgbm90IGJvb2woZm4ocywgbCwgdCkpOgogICAgICAgICAgICByYWlzZSBleGNfdHlwZShzLCBsLCBtc2cpCgogICAgcmV0dXJuIHBhCgoKZGVmIF9kZWZhdWx0X3N0YXJ0X2RlYnVnX2FjdGlvbigKICAgIGluc3RyaW5nOiBzdHIsIGxvYzogaW50LCBleHByOiBcIlBhcnNlckVsZW1lbnRcIiwgY2FjaGVfaGl0OiBib29sID0gRmFsc2UKKToKICAgIGNhY2hlX2hpdF9zdHIgPSBcIipcIiBpZiBjYWNoZV9oaXQgZWxzZSBcIlwiCiAgICBwcmludCgKICAgICAgICAoCiAgICAgICAgICAgIFwie31NYXRjaCB7fSBhdCBsb2Mge30oe30se30pXFxuICB7fVxcbiAge31eXCIuZm9ybWF0KAogICAgICAgICAgICAgICAgY2FjaGVfaGl0X3N0ciwKICAgICAgICAgICAgICAgIGV4cHIsCiAgICAgICAgICAgICAgICBsb2MsCiAgICAgICAgICAgICAgICBsaW5lbm8obG9jLCBpbnN0cmluZyksCiAgICAgICAgICAgICAgICBjb2wobG9jLCBpbnN0cmluZyksCiAgICAgICAgICAgICAgICBsaW5lKGxvYywgaW5zdHJpbmcpLAogICAgICAgICAgICAgICAgXCIgXCIgKiAoY29sKGxvYywgaW5zdHJpbmcpIC0gMSksCiAgICAgICAgICAgICkKICAgICAgICApCiAgICApCgoKZGVmIF9kZWZhdWx0X3N1Y2Nlc3NfZGVidWdfYWN0aW9uKAogICAgaW5zdHJpbmc6IHN0ciwKICAgIHN0YXJ0bG9jOiBpbnQsCiAgICBlbmRsb2M6IGludCwKICAgIGV4cHI6IFwiUGFyc2VyRWxlbWVudFwiLAogICAgdG9rczogUGFyc2VSZXN1bHRzLAogICAgY2FjaGVfaGl0OiBib29sID0gRmFsc2UsCik6CiAgICBjYWNoZV9oaXRfc3RyID0gXCIqXCIgaWYgY2FjaGVfaGl0IGVsc2UgXCJcIgogICAgcHJpbnQoXCJ7fU1hdGNoZWQge30gLT4ge31cIi5mb3JtYXQoY2FjaGVfaGl0X3N0ciwgZXhwciwgdG9rcy5hc19saXN0KCkpKQoKCmRlZiBfZGVmYXVsdF9leGNlcHRpb25fZGVidWdfYWN0aW9uKAogICAgaW5zdHJpbmc6IHN0ciwKICAgIGxvYzogaW50LAogICAgZXhwcjogXCJQYXJzZXJFbGVtZW50XCIsCiAgICBleGM6IEV4Y2VwdGlvbiwKICAgIGNhY2hlX2hpdDogYm9vbCA9IEZhbHNlLAopOgogICAgY2FjaGVfaGl0X3N0ciA9IFwiKlwiIGlmIGNhY2hlX2hpdCBlbHNlIFwiXCIKICAgIHByaW50KAogICAgICAgIFwie31NYXRjaCB7fSBmYWlsZWQsIHt9IHJhaXNlZDoge31cIi5mb3JtYXQoCiAgICAgICAgICAgIGNhY2hlX2hpdF9zdHIsIGV4cHIsIHR5cGUoZXhjKS5fX25hbWVfXywgZXhjCiAgICAgICAgKQogICAgKQoKCmRlZiBudWxsX2RlYnVnX2FjdGlvbigqYXJncyk6CiAgICBcIlwiXCInRG8tbm90aGluZycgZGVidWcgYWN0aW9uLCB0byBzdXBwcmVzcyBkZWJ1Z2dpbmcgb3V0cHV0IGR1cmluZyBwYXJzaW5nLlwiXCJcIgoKCmNsYXNzIFBhcnNlckVsZW1lbnQoQUJDKToKICAgIFwiXCJcIkFic3RyYWN0IGJhc2UgbGV2ZWwgcGFyc2VyIGVsZW1lbnQgY2xhc3MuXCJcIlwiCgogICAgREVGQVVMVF9XSElURV9DSEFSUzogc3RyID0gXCIgXFxuXFx0XFxyXCIKICAgIHZlcmJvc2Vfc3RhY2t0cmFjZTogYm9vbCA9IEZhbHNlCiAgICBfbGl0ZXJhbFN0cmluZ0NsYXNzOiB0eXBpbmcuT3B0aW9uYWxbdHlwZV0gPSBOb25lCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHNldF9kZWZhdWx0X3doaXRlc3BhY2VfY2hhcnMoY2hhcnM6IHN0cikgLT4gTm9uZToKICAgICAgICByXCJcIlwiCiAgICAgICAgT3ZlcnJpZGVzIHRoZSBkZWZhdWx0IHdoaXRlc3BhY2UgY2hhcnMKCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICAjIGRlZmF1bHQgd2hpdGVzcGFjZSBjaGFycyBhcmUgc3BhY2UsIDxUQUI+IGFuZCBuZXdsaW5lCiAgICAgICAgICAgIFdvcmQoYWxwaGFzKVsxLCAuLi5dLnBhcnNlX3N0cmluZyhcImFiYyBkZWZcXG5naGkgamtsXCIpICAjIC0+IFsnYWJjJywgJ2RlZicsICdnaGknLCAnamtsJ10KCiAgICAgICAgICAgICMgY2hhbmdlIHRvIGp1c3QgdHJlYXQgbmV3bGluZSBhcyBzaWduaWZpY2FudAogICAgICAgICAgICBQYXJzZXJFbGVtZW50LnNldF9kZWZhdWx0X3doaXRlc3BhY2VfY2hhcnMoXCIgXFx0XCIpCiAgICAgICAgICAgIFdvcmQoYWxwaGFzKVsxLCAuLi5dLnBhcnNlX3N0cmluZyhcImFiYyBkZWZcXG5naGkgamtsXCIpICAjIC0+IFsnYWJjJywgJ2RlZiddCiAgICAgICAgXCJcIlwiCiAgICAgICAgUGFyc2VyRWxlbWVudC5ERUZBVUxUX1dISVRFX0NIQVJTID0gY2hhcnMKCiAgICAgICAgIyB1cGRhdGUgd2hpdGVzcGFjZSBhbGwgcGFyc2UgZXhwcmVzc2lvbnMgZGVmaW5lZCBpbiB0aGlzIG1vZHVsZQogICAgICAgIGZvciBleHByIGluIF9idWlsdGluX2V4cHJzOgogICAgICAgICAgICBpZiBleHByLmNvcHlEZWZhdWx0V2hpdGVDaGFyczoKICAgICAgICAgICAgICAgIGV4cHIud2hpdGVDaGFycyA9IHNldChjaGFycykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgaW5saW5lX2xpdGVyYWxzX3VzaW5nKGNsczogdHlwZSkgLT4gTm9uZToKICAgICAgICBcIlwiXCIKICAgICAgICBTZXQgY2xhc3MgdG8gYmUgdXNlZCBmb3IgaW5jbHVzaW9uIG9mIHN0cmluZyBsaXRlcmFscyBpbnRvIGEgcGFyc2VyLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgICMgZGVmYXVsdCBsaXRlcmFsIGNsYXNzIHVzZWQgaXMgTGl0ZXJhbAogICAgICAgICAgICBpbnRlZ2VyID0gV29yZChudW1zKQogICAgICAgICAgICBkYXRlX3N0ciA9IGludGVnZXIoXCJ5ZWFyXCIpICsgJy8nICsgaW50ZWdlcihcIm1vbnRoXCIpICsgJy8nICsgaW50ZWdlcihcImRheVwiKQoKICAgICAgICAgICAgZGF0ZV9zdHIucGFyc2Vfc3RyaW5nKFwiMTk5OS8xMi8zMVwiKSAgIyAtPiBbJzE5OTknLCAnLycsICcxMicsICcvJywgJzMxJ10KCgogICAgICAgICAgICAjIGNoYW5nZSB0byBTdXBwcmVzcwogICAgICAgICAgICBQYXJzZXJFbGVtZW50LmlubGluZV9saXRlcmFsc191c2luZyhTdXBwcmVzcykKICAgICAgICAgICAgZGF0ZV9zdHIgPSBpbnRlZ2VyKFwieWVhclwiKSArICcvJyArIGludGVnZXIoXCJtb250aFwiKSArICcvJyArIGludGVnZXIoXCJkYXlcIikKCiAgICAgICAgICAgIGRhdGVfc3RyLnBhcnNlX3N0cmluZyhcIjE5OTkvMTIvMzFcIikgICMgLT4gWycxOTk5JywgJzEyJywgJzMxJ10KICAgICAgICBcIlwiXCIKICAgICAgICBQYXJzZXJFbGVtZW50Ll9saXRlcmFsU3RyaW5nQ2xhc3MgPSBjbHMKCiAgICBjbGFzcyBEZWJ1Z0FjdGlvbnMoTmFtZWRUdXBsZSk6CiAgICAgICAgZGVidWdfdHJ5OiB0eXBpbmcuT3B0aW9uYWxbRGVidWdTdGFydEFjdGlvbl0KICAgICAgICBkZWJ1Z19tYXRjaDogdHlwaW5nLk9wdGlvbmFsW0RlYnVnU3VjY2Vzc0FjdGlvbl0KICAgICAgICBkZWJ1Z19mYWlsOiB0eXBpbmcuT3B0aW9uYWxbRGVidWdFeGNlcHRpb25BY3Rpb25dCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNhdmVsaXN0OiBib29sID0gRmFsc2UpOgogICAgICAgIHNlbGYucGFyc2VBY3Rpb246IExpc3RbUGFyc2VBY3Rpb25dID0gbGlzdCgpCiAgICAgICAgc2VsZi5mYWlsQWN0aW9uOiB0eXBpbmcuT3B0aW9uYWxbUGFyc2VGYWlsQWN0aW9uXSA9IE5vbmUKICAgICAgICBzZWxmLmN1c3RvbU5hbWUgPSBOb25lCiAgICAgICAgc2VsZi5fZGVmYXVsdE5hbWUgPSBOb25lCiAgICAgICAgc2VsZi5yZXN1bHRzTmFtZSA9IE5vbmUKICAgICAgICBzZWxmLnNhdmVBc0xpc3QgPSBzYXZlbGlzdAogICAgICAgIHNlbGYuc2tpcFdoaXRlc3BhY2UgPSBUcnVlCiAgICAgICAgc2VsZi53aGl0ZUNoYXJzID0gc2V0KFBhcnNlckVsZW1lbnQuREVGQVVMVF9XSElURV9DSEFSUykKICAgICAgICBzZWxmLmNvcHlEZWZhdWx0V2hpdGVDaGFycyA9IFRydWUKICAgICAgICAjIHVzZWQgd2hlbiBjaGVja2luZyBmb3IgbGVmdC1yZWN1cnNpb24KICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gRmFsc2UKICAgICAgICBzZWxmLmtlZXBUYWJzID0gRmFsc2UKICAgICAgICBzZWxmLmlnbm9yZUV4cHJzOiBMaXN0W1wiUGFyc2VyRWxlbWVudFwiXSA9IGxpc3QoKQogICAgICAgIHNlbGYuZGVidWcgPSBGYWxzZQogICAgICAgIHNlbGYuc3RyZWFtbGluZWQgPSBGYWxzZQogICAgICAgICMgb3B0aW1pemUgZXhjZXB0aW9uIGhhbmRsaW5nIGZvciBzdWJjbGFzc2VzIHRoYXQgZG9uJ3QgYWR2YW5jZSBwYXJzZSBpbmRleAogICAgICAgIHNlbGYubWF5SW5kZXhFcnJvciA9IFRydWUKICAgICAgICBzZWxmLmVycm1zZyA9IFwiXCIKICAgICAgICAjIG1hcmsgcmVzdWx0cyBuYW1lcyBhcyBtb2RhbCAocmVwb3J0IG9ubHkgbGFzdCkgb3IgY3VtdWxhdGl2ZSAobGlzdCBhbGwpCiAgICAgICAgc2VsZi5tb2RhbFJlc3VsdHMgPSBUcnVlCiAgICAgICAgIyBjdXN0b20gZGVidWcgYWN0aW9ucwogICAgICAgIHNlbGYuZGVidWdBY3Rpb25zID0gc2VsZi5EZWJ1Z0FjdGlvbnMoTm9uZSwgTm9uZSwgTm9uZSkKICAgICAgICAjIGF2b2lkIHJlZHVuZGFudCBjYWxscyB0byBwcmVQYXJzZQogICAgICAgIHNlbGYuY2FsbFByZXBhcnNlID0gVHJ1ZQogICAgICAgIHNlbGYuY2FsbER1cmluZ1RyeSA9IEZhbHNlCiAgICAgICAgc2VsZi5zdXBwcmVzc193YXJuaW5nc186IExpc3RbRGlhZ25vc3RpY3NdID0gW10KCiAgICBkZWYgc3VwcHJlc3Nfd2FybmluZyhzZWxmLCB3YXJuaW5nX3R5cGU6IERpYWdub3N0aWNzKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBTdXBwcmVzcyB3YXJuaW5ncyBlbWl0dGVkIGZvciBhIHBhcnRpY3VsYXIgZGlhZ25vc3RpYyBvbiB0aGlzIGV4cHJlc3Npb24uCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgYmFzZSA9IHBwLkZvcndhcmQoKQogICAgICAgICAgICBiYXNlLnN1cHByZXNzX3dhcm5pbmcoRGlhZ25vc3RpY3Mud2Fybl9vbl9wYXJzZV91c2luZ19lbXB0eV9Gb3J3YXJkKQoKICAgICAgICAgICAgIyBzdGF0ZW1lbnQgd291bGQgbm9ybWFsbHkgcmFpc2UgYSB3YXJuaW5nLCBidXQgaXMgbm93IHN1cHByZXNzZWQKICAgICAgICAgICAgcHJpbnQoYmFzZS5wYXJzZVN0cmluZyhcInhcIikpCgogICAgICAgIFwiXCJcIgogICAgICAgIHNlbGYuc3VwcHJlc3Nfd2FybmluZ3NfLmFwcGVuZCh3YXJuaW5nX3R5cGUpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgY29weShzZWxmKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBNYWtlIGEgY29weSBvZiB0aGlzIDpjbGFzczpgUGFyc2VyRWxlbWVudGAuICBVc2VmdWwgZm9yIGRlZmluaW5nCiAgICAgICAgZGlmZmVyZW50IHBhcnNlIGFjdGlvbnMgZm9yIHRoZSBzYW1lIHBhcnNpbmcgcGF0dGVybiwgdXNpbmcgY29waWVzIG9mCiAgICAgICAgdGhlIG9yaWdpbmFsIHBhcnNlIGVsZW1lbnQuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgaW50ZWdlciA9IFdvcmQobnVtcykuc2V0X3BhcnNlX2FjdGlvbihsYW1iZGEgdG9rczogaW50KHRva3NbMF0pKQogICAgICAgICAgICBpbnRlZ2VySyA9IGludGVnZXIuY29weSgpLmFkZF9wYXJzZV9hY3Rpb24obGFtYmRhIHRva3M6IHRva3NbMF0gKiAxMDI0KSArIFN1cHByZXNzKFwiS1wiKQogICAgICAgICAgICBpbnRlZ2VyTSA9IGludGVnZXIuY29weSgpLmFkZF9wYXJzZV9hY3Rpb24obGFtYmRhIHRva3M6IHRva3NbMF0gKiAxMDI0ICogMTAyNCkgKyBTdXBwcmVzcyhcIk1cIikKCiAgICAgICAgICAgIHByaW50KChpbnRlZ2VySyB8IGludGVnZXJNIHwgaW50ZWdlcilbMSwgLi4uXS5wYXJzZV9zdHJpbmcoXCI1SyAxMDAgNjQwSyAyNTZNXCIpKQoKICAgICAgICBwcmludHM6OgoKICAgICAgICAgICAgWzUxMjAsIDEwMCwgNjU1MzYwLCAyNjg0MzU0NTZdCgogICAgICAgIEVxdWl2YWxlbnQgZm9ybSBvZiBgYGV4cHIuY29weSgpYGAgaXMganVzdCBgYGV4cHIoKWBgOjoKCiAgICAgICAgICAgIGludGVnZXJNID0gaW50ZWdlcigpLmFkZF9wYXJzZV9hY3Rpb24obGFtYmRhIHRva3M6IHRva3NbMF0gKiAxMDI0ICogMTAyNCkgKyBTdXBwcmVzcyhcIk1cIikKICAgICAgICBcIlwiXCIKICAgICAgICBjcHkgPSBjb3B5LmNvcHkoc2VsZikKICAgICAgICBjcHkucGFyc2VBY3Rpb24gPSBzZWxmLnBhcnNlQWN0aW9uWzpdCiAgICAgICAgY3B5Lmlnbm9yZUV4cHJzID0gc2VsZi5pZ25vcmVFeHByc1s6XQogICAgICAgIGlmIHNlbGYuY29weURlZmF1bHRXaGl0ZUNoYXJzOgogICAgICAgICAgICBjcHkud2hpdGVDaGFycyA9IHNldChQYXJzZXJFbGVtZW50LkRFRkFVTFRfV0hJVEVfQ0hBUlMpCiAgICAgICAgcmV0dXJuIGNweQoKICAgIGRlZiBzZXRfcmVzdWx0c19uYW1lKAogICAgICAgIHNlbGYsIG5hbWU6IHN0ciwgbGlzdF9hbGxfbWF0Y2hlczogYm9vbCA9IEZhbHNlLCAqLCBsaXN0QWxsTWF0Y2hlczogYm9vbCA9IEZhbHNlCiAgICApIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIERlZmluZSBuYW1lIGZvciByZWZlcmVuY2luZyBtYXRjaGluZyB0b2tlbnMgYXMgYSBuZXN0ZWQgYXR0cmlidXRlCiAgICAgICAgb2YgdGhlIHJldHVybmVkIHBhcnNlIHJlc3VsdHMuCgogICAgICAgIE5vcm1hbGx5LCByZXN1bHRzIG5hbWVzIGFyZSBhc3NpZ25lZCBhcyB5b3Ugd291bGQgYXNzaWduIGtleXMgaW4gYSBkaWN0OgogICAgICAgIGFueSBleGlzdGluZyB2YWx1ZSBpcyBvdmVyd3JpdHRlbiBieSBsYXRlciB2YWx1ZXMuIElmIGl0IGlzIG5lY2Vzc2FyeSB0bwogICAgICAgIGtlZXAgYWxsIHZhbHVlcyBjYXB0dXJlZCBmb3IgYSBwYXJ0aWN1bGFyIHJlc3VsdHMgbmFtZSwgY2FsbCBgYHNldF9yZXN1bHRzX25hbWVgYAogICAgICAgIHdpdGggYGBsaXN0X2FsbF9tYXRjaGVzYGAgPSBUcnVlLgoKICAgICAgICBOT1RFOiBgYHNldF9yZXN1bHRzX25hbWVgYCByZXR1cm5zIGEgKmNvcHkqIG9mIHRoZSBvcmlnaW5hbCA6Y2xhc3M6YFBhcnNlckVsZW1lbnRgIG9iamVjdDsKICAgICAgICB0aGlzIGlzIHNvIHRoYXQgdGhlIGNsaWVudCBjYW4gZGVmaW5lIGEgYmFzaWMgZWxlbWVudCwgc3VjaCBhcyBhbgogICAgICAgIGludGVnZXIsIGFuZCByZWZlcmVuY2UgaXQgaW4gbXVsdGlwbGUgcGxhY2VzIHdpdGggZGlmZmVyZW50IG5hbWVzLgoKICAgICAgICBZb3UgY2FuIGFsc28gc2V0IHJlc3VsdHMgbmFtZXMgdXNpbmcgdGhlIGFiYnJldmlhdGVkIHN5bnRheCwKICAgICAgICBgYGV4cHIoXCJuYW1lXCIpYGAgaW4gcGxhY2Ugb2YgYGBleHByLnNldF9yZXN1bHRzX25hbWUoXCJuYW1lXCIpYGAKICAgICAgICAtIHNlZSA6Y2xhc3M6YF9fY2FsbF9fYC4gSWYgYGBsaXN0X2FsbF9tYXRjaGVzYGAgaXMgcmVxdWlyZWQsIHVzZQogICAgICAgIGBgZXhwcihcIm5hbWUqXCIpYGAuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgZGF0ZV9zdHIgPSAoaW50ZWdlci5zZXRfcmVzdWx0c19uYW1lKFwieWVhclwiKSArICcvJwogICAgICAgICAgICAgICAgICAgICAgICArIGludGVnZXIuc2V0X3Jlc3VsdHNfbmFtZShcIm1vbnRoXCIpICsgJy8nCiAgICAgICAgICAgICAgICAgICAgICAgICsgaW50ZWdlci5zZXRfcmVzdWx0c19uYW1lKFwiZGF5XCIpKQoKICAgICAgICAgICAgIyBlcXVpdmFsZW50IGZvcm06CiAgICAgICAgICAgIGRhdGVfc3RyID0gaW50ZWdlcihcInllYXJcIikgKyAnLycgKyBpbnRlZ2VyKFwibW9udGhcIikgKyAnLycgKyBpbnRlZ2VyKFwiZGF5XCIpCiAgICAgICAgXCJcIlwiCiAgICAgICAgbGlzdEFsbE1hdGNoZXMgPSBsaXN0QWxsTWF0Y2hlcyBvciBsaXN0X2FsbF9tYXRjaGVzCiAgICAgICAgcmV0dXJuIHNlbGYuX3NldFJlc3VsdHNOYW1lKG5hbWUsIGxpc3RBbGxNYXRjaGVzKQoKICAgIGRlZiBfc2V0UmVzdWx0c05hbWUoc2VsZiwgbmFtZSwgbGlzdEFsbE1hdGNoZXM9RmFsc2UpOgogICAgICAgIGlmIG5hbWUgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYKICAgICAgICBuZXdzZWxmID0gc2VsZi5jb3B5KCkKICAgICAgICBpZiBuYW1lLmVuZHN3aXRoKFwiKlwiKToKICAgICAgICAgICAgbmFtZSA9IG5hbWVbOi0xXQogICAgICAgICAgICBsaXN0QWxsTWF0Y2hlcyA9IFRydWUKICAgICAgICBuZXdzZWxmLnJlc3VsdHNOYW1lID0gbmFtZQogICAgICAgIG5ld3NlbGYubW9kYWxSZXN1bHRzID0gbm90IGxpc3RBbGxNYXRjaGVzCiAgICAgICAgcmV0dXJuIG5ld3NlbGYKCiAgICBkZWYgc2V0X2JyZWFrKHNlbGYsIGJyZWFrX2ZsYWc6IGJvb2wgPSBUcnVlKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBNZXRob2QgdG8gaW52b2tlIHRoZSBQeXRob24gcGRiIGRlYnVnZ2VyIHdoZW4gdGhpcyBlbGVtZW50IGlzCiAgICAgICAgYWJvdXQgdG8gYmUgcGFyc2VkLiBTZXQgYGBicmVha19mbGFnYGAgdG8gYGBUcnVlYGAgdG8gZW5hYmxlLCBgYEZhbHNlYGAgdG8KICAgICAgICBkaXNhYmxlLgogICAgICAgIFwiXCJcIgogICAgICAgIGlmIGJyZWFrX2ZsYWc6CiAgICAgICAgICAgIF9wYXJzZU1ldGhvZCA9IHNlbGYuX3BhcnNlCgogICAgICAgICAgICBkZWYgYnJlYWtlcihpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSwgY2FsbFByZVBhcnNlPVRydWUpOgogICAgICAgICAgICAgICAgaW1wb3J0IHBkYgoKICAgICAgICAgICAgICAgICMgdGhpcyBjYWxsIHRvIHBkYi5zZXRfdHJhY2UoKSBpcyBpbnRlbnRpb25hbCwgbm90IGEgY2hlY2tpbiBlcnJvcgogICAgICAgICAgICAgICAgcGRiLnNldF90cmFjZSgpCiAgICAgICAgICAgICAgICByZXR1cm4gX3BhcnNlTWV0aG9kKGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucywgY2FsbFByZVBhcnNlKQoKICAgICAgICAgICAgYnJlYWtlci5fb3JpZ2luYWxQYXJzZU1ldGhvZCA9IF9wYXJzZU1ldGhvZAogICAgICAgICAgICBzZWxmLl9wYXJzZSA9IGJyZWFrZXIKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYuX3BhcnNlLCBcIl9vcmlnaW5hbFBhcnNlTWV0aG9kXCIpOgogICAgICAgICAgICAgICAgc2VsZi5fcGFyc2UgPSBzZWxmLl9wYXJzZS5fb3JpZ2luYWxQYXJzZU1ldGhvZAogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHNldF9wYXJzZV9hY3Rpb24oc2VsZiwgKmZuczogUGFyc2VBY3Rpb24sICoqa3dhcmdzKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBEZWZpbmUgb25lIG9yIG1vcmUgYWN0aW9ucyB0byBwZXJmb3JtIHdoZW4gc3VjY2Vzc2Z1bGx5IG1hdGNoaW5nIHBhcnNlIGVsZW1lbnQgZGVmaW5pdGlvbi4KCiAgICAgICAgUGFyc2UgYWN0aW9ucyBjYW4gYmUgY2FsbGVkIHRvIHBlcmZvcm0gZGF0YSBjb252ZXJzaW9ucywgZG8gZXh0cmEgdmFsaWRhdGlvbiwKICAgICAgICB1cGRhdGUgZXh0ZXJuYWwgZGF0YSBzdHJ1Y3R1cmVzLCBvciBlbmhhbmNlIG9yIHJlcGxhY2UgdGhlIHBhcnNlZCB0b2tlbnMuCiAgICAgICAgRWFjaCBwYXJzZSBhY3Rpb24gYGBmbmBgIGlzIGEgY2FsbGFibGUgbWV0aG9kIHdpdGggMC0zIGFyZ3VtZW50cywgY2FsbGVkIGFzCiAgICAgICAgYGBmbihzLCBsb2MsIHRva3MpYGAgLCBgYGZuKGxvYywgdG9rcylgYCAsIGBgZm4odG9rcylgYCAsIG9yIGp1c3QgYGBmbigpYGAgLCB3aGVyZToKCiAgICAgICAgLSBzICAgPSB0aGUgb3JpZ2luYWwgc3RyaW5nIGJlaW5nIHBhcnNlZCAoc2VlIG5vdGUgYmVsb3cpCiAgICAgICAgLSBsb2MgPSB0aGUgbG9jYXRpb24gb2YgdGhlIG1hdGNoaW5nIHN1YnN0cmluZwogICAgICAgIC0gdG9rcyA9IGEgbGlzdCBvZiB0aGUgbWF0Y2hlZCB0b2tlbnMsIHBhY2thZ2VkIGFzIGEgOmNsYXNzOmBQYXJzZVJlc3VsdHNgIG9iamVjdAoKICAgICAgICBUaGUgcGFyc2VkIHRva2VucyBhcmUgcGFzc2VkIHRvIHRoZSBwYXJzZSBhY3Rpb24gYXMgUGFyc2VSZXN1bHRzLiBUaGV5IGNhbiBiZQogICAgICAgIG1vZGlmaWVkIGluIHBsYWNlIHVzaW5nIGxpc3Qtc3R5bGUgYXBwZW5kLCBleHRlbmQsIGFuZCBwb3Agb3BlcmF0aW9ucyB0byB1cGRhdGUKICAgICAgICB0aGUgcGFyc2VkIGxpc3QgZWxlbWVudHM7IGFuZCB3aXRoIGRpY3Rpb25hcnktc3R5bGUgaXRlbSBzZXQgYW5kIGRlbCBvcGVyYXRpb25zCiAgICAgICAgdG8gYWRkLCB1cGRhdGUsIG9yIHJlbW92ZSBhbnkgbmFtZWQgcmVzdWx0cy4gSWYgdGhlIHRva2VucyBhcmUgbW9kaWZpZWQgaW4gcGxhY2UsCiAgICAgICAgaXQgaXMgbm90IG5lY2Vzc2FyeSB0byByZXR1cm4gdGhlbSB3aXRoIGEgcmV0dXJuIHN0YXRlbWVudC4KCiAgICAgICAgUGFyc2UgYWN0aW9ucyBjYW4gYWxzbyBjb21wbGV0ZWx5IHJlcGxhY2UgdGhlIGdpdmVuIHRva2Vucywgd2l0aCBhbm90aGVyIGBgUGFyc2VSZXN1bHRzYGAKICAgICAgICBvYmplY3QsIG9yIHdpdGggc29tZSBlbnRpcmVseSBkaWZmZXJlbnQgb2JqZWN0IChjb21tb24gZm9yIHBhcnNlIGFjdGlvbnMgdGhhdCBwZXJmb3JtIGRhdGEKICAgICAgICBjb252ZXJzaW9ucykuIEEgY29udmVuaWVudCB3YXkgdG8gYnVpbGQgYSBuZXcgcGFyc2UgcmVzdWx0IGlzIHRvIGRlZmluZSB0aGUgdmFsdWVzCiAgICAgICAgdXNpbmcgYSBkaWN0LCBhbmQgdGhlbiBjcmVhdGUgdGhlIHJldHVybiB2YWx1ZSB1c2luZyA6Y2xhc3M6YFBhcnNlUmVzdWx0cy5mcm9tX2RpY3RgLgoKICAgICAgICBJZiBOb25lIGlzIHBhc3NlZCBhcyB0aGUgYGBmbmBgIHBhcnNlIGFjdGlvbiwgYWxsIHByZXZpb3VzbHkgYWRkZWQgcGFyc2UgYWN0aW9ucyBmb3IgdGhpcwogICAgICAgIGV4cHJlc3Npb24gYXJlIGNsZWFyZWQuCgogICAgICAgIE9wdGlvbmFsIGtleXdvcmQgYXJndW1lbnRzOgoKICAgICAgICAtIGNhbGxfZHVyaW5nX3RyeSA9IChkZWZhdWx0PSBgYEZhbHNlYGApIGluZGljYXRlIGlmIHBhcnNlIGFjdGlvbiBzaG91bGQgYmUgcnVuIGR1cmluZwogICAgICAgICAgbG9va2FoZWFkcyBhbmQgYWx0ZXJuYXRlIHRlc3RpbmcuIEZvciBwYXJzZSBhY3Rpb25zIHRoYXQgaGF2ZSBzaWRlIGVmZmVjdHMsIGl0IGlzCiAgICAgICAgICBpbXBvcnRhbnQgdG8gb25seSBjYWxsIHRoZSBwYXJzZSBhY3Rpb24gb25jZSBpdCBpcyBkZXRlcm1pbmVkIHRoYXQgaXQgaXMgYmVpbmcKICAgICAgICAgIGNhbGxlZCBhcyBwYXJ0IG9mIGEgc3VjY2Vzc2Z1bCBwYXJzZS4gRm9yIHBhcnNlIGFjdGlvbnMgdGhhdCBwZXJmb3JtIGFkZGl0aW9uYWwKICAgICAgICAgIHZhbGlkYXRpb24sIHRoZW4gY2FsbF9kdXJpbmdfdHJ5IHNob3VsZCBiZSBwYXNzZWQgYXMgVHJ1ZSwgc28gdGhhdCB0aGUgdmFsaWRhdGlvbgogICAgICAgICAgY29kZSBpcyBpbmNsdWRlZCBpbiB0aGUgcHJlbGltaW5hcnkgXCJ0cnlcIiBwYXJzZXMuCgogICAgICAgIE5vdGU6IHRoZSBkZWZhdWx0IHBhcnNpbmcgYmVoYXZpb3IgaXMgdG8gZXhwYW5kIHRhYnMgaW4gdGhlIGlucHV0IHN0cmluZwogICAgICAgIGJlZm9yZSBzdGFydGluZyB0aGUgcGFyc2luZyBwcm9jZXNzLiAgU2VlIDpjbGFzczpgcGFyc2Vfc3RyaW5nYCBmb3IgbW9yZQogICAgICAgIGluZm9ybWF0aW9uIG9uIHBhcnNpbmcgc3RyaW5ncyBjb250YWluaW5nIGBgPFRBQj5gYCBzLCBhbmQgc3VnZ2VzdGVkCiAgICAgICAgbWV0aG9kcyB0byBtYWludGFpbiBhIGNvbnNpc3RlbnQgdmlldyBvZiB0aGUgcGFyc2VkIHN0cmluZywgdGhlIHBhcnNlCiAgICAgICAgbG9jYXRpb24sIGFuZCBsaW5lIGFuZCBjb2x1bW4gcG9zaXRpb25zIHdpdGhpbiB0aGUgcGFyc2VkIHN0cmluZy4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICAjIHBhcnNlIGRhdGVzIGluIHRoZSBmb3JtIFlZWVkvTU0vREQKCiAgICAgICAgICAgICMgdXNlIHBhcnNlIGFjdGlvbiB0byBjb252ZXJ0IHRva3MgZnJvbSBzdHIgdG8gaW50IGF0IHBhcnNlIHRpbWUKICAgICAgICAgICAgZGVmIGNvbnZlcnRfdG9faW50KHRva3MpOgogICAgICAgICAgICAgICAgcmV0dXJuIGludCh0b2tzWzBdKQoKICAgICAgICAgICAgIyB1c2UgYSBwYXJzZSBhY3Rpb24gdG8gdmVyaWZ5IHRoYXQgdGhlIGRhdGUgaXMgYSB2YWxpZCBkYXRlCiAgICAgICAgICAgIGRlZiBpc192YWxpZF9kYXRlKGluc3RyaW5nLCBsb2MsIHRva3MpOgogICAgICAgICAgICAgICAgZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZQogICAgICAgICAgICAgICAgeWVhciwgbW9udGgsIGRheSA9IHRva3NbOjoyXQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRhdGUoeWVhciwgbW9udGgsIGRheSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIFwiaW52YWxpZCBkYXRlIGdpdmVuXCIpCgogICAgICAgICAgICBpbnRlZ2VyID0gV29yZChudW1zKQogICAgICAgICAgICBkYXRlX3N0ciA9IGludGVnZXIgKyAnLycgKyBpbnRlZ2VyICsgJy8nICsgaW50ZWdlcgoKICAgICAgICAgICAgIyBhZGQgcGFyc2UgYWN0aW9ucwogICAgICAgICAgICBpbnRlZ2VyLnNldF9wYXJzZV9hY3Rpb24oY29udmVydF90b19pbnQpCiAgICAgICAgICAgIGRhdGVfc3RyLnNldF9wYXJzZV9hY3Rpb24oaXNfdmFsaWRfZGF0ZSkKCiAgICAgICAgICAgICMgbm90ZSB0aGF0IGludGVnZXIgZmllbGRzIGFyZSBub3cgaW50cywgbm90IHN0cmluZ3MKICAgICAgICAgICAgZGF0ZV9zdHIucnVuX3Rlc3RzKCcnJwogICAgICAgICAgICAgICAgIyBzdWNjZXNzZnVsIHBhcnNlIC0gbm90ZSB0aGF0IGludGVnZXIgZmllbGRzIHdlcmUgY29udmVydGVkIHRvIGludHMKICAgICAgICAgICAgICAgIDE5OTkvMTIvMzEKCiAgICAgICAgICAgICAgICAjIGZhaWwgLSBpbnZhbGlkIGRhdGUKICAgICAgICAgICAgICAgIDE5OTkvMTMvMzEKICAgICAgICAgICAgICAgICcnJykKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBsaXN0KGZucykgPT0gW05vbmVdOgogICAgICAgICAgICBzZWxmLnBhcnNlQWN0aW9uID0gW10KICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3QgYWxsKGNhbGxhYmxlKGZuKSBmb3IgZm4gaW4gZm5zKToKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihcInBhcnNlIGFjdGlvbnMgbXVzdCBiZSBjYWxsYWJsZVwiKQogICAgICAgICAgICBzZWxmLnBhcnNlQWN0aW9uID0gW190cmltX2FyaXR5KGZuKSBmb3IgZm4gaW4gZm5zXQogICAgICAgICAgICBzZWxmLmNhbGxEdXJpbmdUcnkgPSBrd2FyZ3MuZ2V0KAogICAgICAgICAgICAgICAgXCJjYWxsX2R1cmluZ190cnlcIiwga3dhcmdzLmdldChcImNhbGxEdXJpbmdUcnlcIiwgRmFsc2UpCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBhZGRfcGFyc2VfYWN0aW9uKHNlbGYsICpmbnM6IFBhcnNlQWN0aW9uLCAqKmt3YXJncykgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgQWRkIG9uZSBvciBtb3JlIHBhcnNlIGFjdGlvbnMgdG8gZXhwcmVzc2lvbidzIGxpc3Qgb2YgcGFyc2UgYWN0aW9ucy4gU2VlIDpjbGFzczpgc2V0X3BhcnNlX2FjdGlvbmAuCgogICAgICAgIFNlZSBleGFtcGxlcyBpbiA6Y2xhc3M6YGNvcHlgLgogICAgICAgIFwiXCJcIgogICAgICAgIHNlbGYucGFyc2VBY3Rpb24gKz0gW190cmltX2FyaXR5KGZuKSBmb3IgZm4gaW4gZm5zXQogICAgICAgIHNlbGYuY2FsbER1cmluZ1RyeSA9IHNlbGYuY2FsbER1cmluZ1RyeSBvciBrd2FyZ3MuZ2V0KAogICAgICAgICAgICBcImNhbGxfZHVyaW5nX3RyeVwiLCBrd2FyZ3MuZ2V0KFwiY2FsbER1cmluZ1RyeVwiLCBGYWxzZSkKICAgICAgICApCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgYWRkX2NvbmRpdGlvbihzZWxmLCAqZm5zOiBQYXJzZUNvbmRpdGlvbiwgKiprd2FyZ3MpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIkFkZCBhIGJvb2xlYW4gcHJlZGljYXRlIGZ1bmN0aW9uIHRvIGV4cHJlc3Npb24ncyBsaXN0IG9mIHBhcnNlIGFjdGlvbnMuIFNlZQogICAgICAgIDpjbGFzczpgc2V0X3BhcnNlX2FjdGlvbmAgZm9yIGZ1bmN0aW9uIGNhbGwgc2lnbmF0dXJlcy4gVW5saWtlIGBgc2V0X3BhcnNlX2FjdGlvbmBgLAogICAgICAgIGZ1bmN0aW9ucyBwYXNzZWQgdG8gYGBhZGRfY29uZGl0aW9uYGAgbmVlZCB0byByZXR1cm4gYm9vbGVhbiBzdWNjZXNzL2ZhaWwgb2YgdGhlIGNvbmRpdGlvbi4KCiAgICAgICAgT3B0aW9uYWwga2V5d29yZCBhcmd1bWVudHM6CgogICAgICAgIC0gbWVzc2FnZSA9IGRlZmluZSBhIGN1c3RvbSBtZXNzYWdlIHRvIGJlIHVzZWQgaW4gdGhlIHJhaXNlZCBleGNlcHRpb24KICAgICAgICAtIGZhdGFsID0gaWYgVHJ1ZSwgd2lsbCByYWlzZSBQYXJzZUZhdGFsRXhjZXB0aW9uIHRvIHN0b3AgcGFyc2luZyBpbW1lZGlhdGVseTsgb3RoZXJ3aXNlIHdpbGwgcmFpc2UKICAgICAgICAgIFBhcnNlRXhjZXB0aW9uCiAgICAgICAgLSBjYWxsX2R1cmluZ190cnkgPSBib29sZWFuIHRvIGluZGljYXRlIGlmIHRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgZHVyaW5nIGludGVybmFsIHRyeVBhcnNlIGNhbGxzLAogICAgICAgICAgZGVmYXVsdD1GYWxzZQoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIGludGVnZXIgPSBXb3JkKG51bXMpLnNldF9wYXJzZV9hY3Rpb24obGFtYmRhIHRva3M6IGludCh0b2tzWzBdKSkKICAgICAgICAgICAgeWVhcl9pbnQgPSBpbnRlZ2VyLmNvcHkoKQogICAgICAgICAgICB5ZWFyX2ludC5hZGRfY29uZGl0aW9uKGxhbWJkYSB0b2tzOiB0b2tzWzBdID49IDIwMDAsIG1lc3NhZ2U9XCJPbmx5IHN1cHBvcnQgeWVhcnMgMjAwMCBhbmQgbGF0ZXJcIikKICAgICAgICAgICAgZGF0ZV9zdHIgPSB5ZWFyX2ludCArICcvJyArIGludGVnZXIgKyAnLycgKyBpbnRlZ2VyCgogICAgICAgICAgICByZXN1bHQgPSBkYXRlX3N0ci5wYXJzZV9zdHJpbmcoXCIxOTk5LzEyLzMxXCIpICAjIC0+IEV4Y2VwdGlvbjogT25seSBzdXBwb3J0IHllYXJzIDIwMDAgYW5kIGxhdGVyIChhdCBjaGFyIDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGxpbmU6MSwgY29sOjEpCiAgICAgICAgXCJcIlwiCiAgICAgICAgZm9yIGZuIGluIGZuczoKICAgICAgICAgICAgc2VsZi5wYXJzZUFjdGlvbi5hcHBlbmQoCiAgICAgICAgICAgICAgICBjb25kaXRpb25fYXNfcGFyc2VfYWN0aW9uKAogICAgICAgICAgICAgICAgICAgIGZuLCBtZXNzYWdlPWt3YXJncy5nZXQoXCJtZXNzYWdlXCIpLCBmYXRhbD1rd2FyZ3MuZ2V0KFwiZmF0YWxcIiwgRmFsc2UpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKCiAgICAgICAgc2VsZi5jYWxsRHVyaW5nVHJ5ID0gc2VsZi5jYWxsRHVyaW5nVHJ5IG9yIGt3YXJncy5nZXQoCiAgICAgICAgICAgIFwiY2FsbF9kdXJpbmdfdHJ5XCIsIGt3YXJncy5nZXQoXCJjYWxsRHVyaW5nVHJ5XCIsIEZhbHNlKQogICAgICAgICkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBzZXRfZmFpbF9hY3Rpb24oc2VsZiwgZm46IFBhcnNlRmFpbEFjdGlvbikgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRGVmaW5lIGFjdGlvbiB0byBwZXJmb3JtIGlmIHBhcnNpbmcgZmFpbHMgYXQgdGhpcyBleHByZXNzaW9uLgogICAgICAgIEZhaWwgYWN0b24gZm4gaXMgYSBjYWxsYWJsZSBmdW5jdGlvbiB0aGF0IHRha2VzIHRoZSBhcmd1bWVudHMKICAgICAgICBgYGZuKHMsIGxvYywgZXhwciwgZXJyKWBgIHdoZXJlOgoKICAgICAgICAtIHMgPSBzdHJpbmcgYmVpbmcgcGFyc2VkCiAgICAgICAgLSBsb2MgPSBsb2NhdGlvbiB3aGVyZSBleHByZXNzaW9uIG1hdGNoIHdhcyBhdHRlbXB0ZWQgYW5kIGZhaWxlZAogICAgICAgIC0gZXhwciA9IHRoZSBwYXJzZSBleHByZXNzaW9uIHRoYXQgZmFpbGVkCiAgICAgICAgLSBlcnIgPSB0aGUgZXhjZXB0aW9uIHRocm93bgoKICAgICAgICBUaGUgZnVuY3Rpb24gcmV0dXJucyBubyB2YWx1ZS4gIEl0IG1heSB0aHJvdyA6Y2xhc3M6YFBhcnNlRmF0YWxFeGNlcHRpb25gCiAgICAgICAgaWYgaXQgaXMgZGVzaXJlZCB0byBzdG9wIHBhcnNpbmcgaW1tZWRpYXRlbHkuXCJcIlwiCiAgICAgICAgc2VsZi5mYWlsQWN0aW9uID0gZm4KICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfc2tpcElnbm9yYWJsZXMoc2VsZiwgaW5zdHJpbmcsIGxvYyk6CiAgICAgICAgZXhwcnNGb3VuZCA9IFRydWUKICAgICAgICB3aGlsZSBleHByc0ZvdW5kOgogICAgICAgICAgICBleHByc0ZvdW5kID0gRmFsc2UKICAgICAgICAgICAgZm9yIGUgaW4gc2VsZi5pZ25vcmVFeHByczoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICAgICAgICAgICAgICBsb2MsIGR1bW15ID0gZS5fcGFyc2UoaW5zdHJpbmcsIGxvYykKICAgICAgICAgICAgICAgICAgICAgICAgZXhwcnNGb3VuZCA9IFRydWUKICAgICAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgcmV0dXJuIGxvYwoKICAgIGRlZiBwcmVQYXJzZShzZWxmLCBpbnN0cmluZywgbG9jKToKICAgICAgICBpZiBzZWxmLmlnbm9yZUV4cHJzOgogICAgICAgICAgICBsb2MgPSBzZWxmLl9za2lwSWdub3JhYmxlcyhpbnN0cmluZywgbG9jKQoKICAgICAgICBpZiBzZWxmLnNraXBXaGl0ZXNwYWNlOgogICAgICAgICAgICBpbnN0cmxlbiA9IGxlbihpbnN0cmluZykKICAgICAgICAgICAgd2hpdGVfY2hhcnMgPSBzZWxmLndoaXRlQ2hhcnMKICAgICAgICAgICAgd2hpbGUgbG9jIDwgaW5zdHJsZW4gYW5kIGluc3RyaW5nW2xvY10gaW4gd2hpdGVfY2hhcnM6CiAgICAgICAgICAgICAgICBsb2MgKz0gMQoKICAgICAgICByZXR1cm4gbG9jCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgcmV0dXJuIGxvYywgW10KCiAgICBkZWYgcG9zdFBhcnNlKHNlbGYsIGluc3RyaW5nLCBsb2MsIHRva2VubGlzdCk6CiAgICAgICAgcmV0dXJuIHRva2VubGlzdAoKICAgICMgQHByb2ZpbGUKICAgIGRlZiBfcGFyc2VOb0NhY2hlKAogICAgICAgIHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlLCBjYWxsUHJlUGFyc2U9VHJ1ZQogICAgKSAtPiBUdXBsZVtpbnQsIFBhcnNlUmVzdWx0c106CiAgICAgICAgVFJZLCBNQVRDSCwgRkFJTCA9IDAsIDEsIDIKICAgICAgICBkZWJ1Z2dpbmcgPSBzZWxmLmRlYnVnICAjIGFuZCBkb0FjdGlvbnMpCiAgICAgICAgbGVuX2luc3RyaW5nID0gbGVuKGluc3RyaW5nKQoKICAgICAgICBpZiBkZWJ1Z2dpbmcgb3Igc2VsZi5mYWlsQWN0aW9uOgogICAgICAgICAgICAjIHByaW50KFwiTWF0Y2gge30gYXQgbG9jIHt9KHt9LCB7fSlcIi5mb3JtYXQoc2VsZiwgbG9jLCBsaW5lbm8obG9jLCBpbnN0cmluZyksIGNvbChsb2MsIGluc3RyaW5nKSkpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGNhbGxQcmVQYXJzZSBhbmQgc2VsZi5jYWxsUHJlcGFyc2U6CiAgICAgICAgICAgICAgICAgICAgcHJlX2xvYyA9IHNlbGYucHJlUGFyc2UoaW5zdHJpbmcsIGxvYykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJlX2xvYyA9IGxvYwogICAgICAgICAgICAgICAgdG9rZW5zX3N0YXJ0ID0gcHJlX2xvYwogICAgICAgICAgICAgICAgaWYgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGVidWdBY3Rpb25zLmRlYnVnX3RyeShpbnN0cmluZywgdG9rZW5zX3N0YXJ0LCBzZWxmLCBGYWxzZSkKICAgICAgICAgICAgICAgIGlmIHNlbGYubWF5SW5kZXhFcnJvciBvciBwcmVfbG9jID49IGxlbl9pbnN0cmluZzoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGxvYywgdG9rZW5zID0gc2VsZi5wYXJzZUltcGwoaW5zdHJpbmcsIHByZV9sb2MsIGRvQWN0aW9ucykKICAgICAgICAgICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxlbl9pbnN0cmluZywgc2VsZi5lcnJtc2csIHNlbGYpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxvYywgdG9rZW5zID0gc2VsZi5wYXJzZUltcGwoaW5zdHJpbmcsIHByZV9sb2MsIGRvQWN0aW9ucykKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlcnI6CiAgICAgICAgICAgICAgICAjIHByaW50KFwiRXhjZXB0aW9uIHJhaXNlZDpcIiwgZXJyKQogICAgICAgICAgICAgICAgaWYgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfZmFpbDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmRlYnVnQWN0aW9ucy5kZWJ1Z19mYWlsKAogICAgICAgICAgICAgICAgICAgICAgICBpbnN0cmluZywgdG9rZW5zX3N0YXJ0LCBzZWxmLCBlcnIsIEZhbHNlCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaWYgc2VsZi5mYWlsQWN0aW9uOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZmFpbEFjdGlvbihpbnN0cmluZywgdG9rZW5zX3N0YXJ0LCBzZWxmLCBlcnIpCiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIGNhbGxQcmVQYXJzZSBhbmQgc2VsZi5jYWxsUHJlcGFyc2U6CiAgICAgICAgICAgICAgICBwcmVfbG9jID0gc2VsZi5wcmVQYXJzZShpbnN0cmluZywgbG9jKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJlX2xvYyA9IGxvYwogICAgICAgICAgICB0b2tlbnNfc3RhcnQgPSBwcmVfbG9jCiAgICAgICAgICAgIGlmIHNlbGYubWF5SW5kZXhFcnJvciBvciBwcmVfbG9jID49IGxlbl9pbnN0cmluZzoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBsb2MsIHRva2VucyA9IHNlbGYucGFyc2VJbXBsKGluc3RyaW5nLCBwcmVfbG9jLCBkb0FjdGlvbnMpCiAgICAgICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbGVuX2luc3RyaW5nLCBzZWxmLmVycm1zZywgc2VsZikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGxvYywgdG9rZW5zID0gc2VsZi5wYXJzZUltcGwoaW5zdHJpbmcsIHByZV9sb2MsIGRvQWN0aW9ucykKCiAgICAgICAgdG9rZW5zID0gc2VsZi5wb3N0UGFyc2UoaW5zdHJpbmcsIGxvYywgdG9rZW5zKQoKICAgICAgICByZXRfdG9rZW5zID0gUGFyc2VSZXN1bHRzKAogICAgICAgICAgICB0b2tlbnMsIHNlbGYucmVzdWx0c05hbWUsIGFzTGlzdD1zZWxmLnNhdmVBc0xpc3QsIG1vZGFsPXNlbGYubW9kYWxSZXN1bHRzCiAgICAgICAgKQogICAgICAgIGlmIHNlbGYucGFyc2VBY3Rpb24gYW5kIChkb0FjdGlvbnMgb3Igc2VsZi5jYWxsRHVyaW5nVHJ5KToKICAgICAgICAgICAgaWYgZGVidWdnaW5nOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGZvciBmbiBpbiBzZWxmLnBhcnNlQWN0aW9uOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMgPSBmbihpbnN0cmluZywgdG9rZW5zX3N0YXJ0LCByZXRfdG9rZW5zKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvciBhcyBwYXJzZV9hY3Rpb25fZXhjOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjID0gUGFyc2VFeGNlcHRpb24oXCJleGNlcHRpb24gcmFpc2VkIGluIHBhcnNlIGFjdGlvblwiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgZXhjIGZyb20gcGFyc2VfYWN0aW9uX2V4YwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9rZW5zIGlzIG5vdCBOb25lIGFuZCB0b2tlbnMgaXMgbm90IHJldF90b2tlbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRfdG9rZW5zID0gUGFyc2VSZXN1bHRzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VucywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdHNOYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdD1zZWxmLnNhdmVBc0xpc3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgaXNpbnN0YW5jZSh0b2tlbnMsIChQYXJzZVJlc3VsdHMsIGxpc3QpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbD1zZWxmLm1vZGFsUmVzdWx0cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXJyOgogICAgICAgICAgICAgICAgICAgICMgcHJpbnQgXCJFeGNlcHRpb24gcmFpc2VkIGluIHVzZXIgcGFyc2UgYWN0aW9uOlwiLCBlcnIKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLmRlYnVnQWN0aW9ucy5kZWJ1Z19mYWlsOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRlYnVnQWN0aW9ucy5kZWJ1Z19mYWlsKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHJpbmcsIHRva2Vuc19zdGFydCwgc2VsZiwgZXJyLCBGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGZvciBmbiBpbiBzZWxmLnBhcnNlQWN0aW9uOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gZm4oaW5zdHJpbmcsIHRva2Vuc19zdGFydCwgcmV0X3Rva2VucykKICAgICAgICAgICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvciBhcyBwYXJzZV9hY3Rpb25fZXhjOgogICAgICAgICAgICAgICAgICAgICAgICBleGMgPSBQYXJzZUV4Y2VwdGlvbihcImV4Y2VwdGlvbiByYWlzZWQgaW4gcGFyc2UgYWN0aW9uXCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlIGV4YyBmcm9tIHBhcnNlX2FjdGlvbl9leGMKCiAgICAgICAgICAgICAgICAgICAgaWYgdG9rZW5zIGlzIG5vdCBOb25lIGFuZCB0b2tlbnMgaXMgbm90IHJldF90b2tlbnM6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldF90b2tlbnMgPSBQYXJzZVJlc3VsdHMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdHNOYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0PXNlbGYuc2F2ZUFzTGlzdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGlzaW5zdGFuY2UodG9rZW5zLCAoUGFyc2VSZXN1bHRzLCBsaXN0KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbD1zZWxmLm1vZGFsUmVzdWx0cywKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgIGlmIGRlYnVnZ2luZzoKICAgICAgICAgICAgIyBwcmludChcIk1hdGNoZWRcIiwgc2VsZiwgXCItPlwiLCByZXRfdG9rZW5zLmFzX2xpc3QoKSkKICAgICAgICAgICAgaWYgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfbWF0Y2g6CiAgICAgICAgICAgICAgICBzZWxmLmRlYnVnQWN0aW9ucy5kZWJ1Z19tYXRjaCgKICAgICAgICAgICAgICAgICAgICBpbnN0cmluZywgdG9rZW5zX3N0YXJ0LCBsb2MsIHNlbGYsIHJldF90b2tlbnMsIEZhbHNlCiAgICAgICAgICAgICAgICApCgogICAgICAgIHJldHVybiBsb2MsIHJldF90b2tlbnMKCiAgICBkZWYgdHJ5X3BhcnNlKHNlbGYsIGluc3RyaW5nOiBzdHIsIGxvYzogaW50LCByYWlzZV9mYXRhbDogYm9vbCA9IEZhbHNlKSAtPiBpbnQ6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZi5fcGFyc2UoaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPUZhbHNlKVswXQogICAgICAgIGV4Y2VwdCBQYXJzZUZhdGFsRXhjZXB0aW9uOgogICAgICAgICAgICBpZiByYWlzZV9mYXRhbDoKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQoKICAgIGRlZiBjYW5fcGFyc2VfbmV4dChzZWxmLCBpbnN0cmluZzogc3RyLCBsb2M6IGludCkgLT4gYm9vbDoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYudHJ5X3BhcnNlKGluc3RyaW5nLCBsb2MpCiAgICAgICAgZXhjZXB0IChQYXJzZUV4Y2VwdGlvbiwgSW5kZXhFcnJvcik6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgIyBjYWNoZSBmb3IgbGVmdC1yZWN1cnNpb24gaW4gRm9yd2FyZCByZWZlcmVuY2VzCiAgICByZWN1cnNpb25fbG9jayA9IFJMb2NrKCkKICAgIHJlY3Vyc2lvbl9tZW1vczogdHlwaW5nLkRpY3RbCiAgICAgICAgVHVwbGVbaW50LCBcIkZvcndhcmRcIiwgYm9vbF0sIFR1cGxlW2ludCwgVW5pb25bUGFyc2VSZXN1bHRzLCBFeGNlcHRpb25dXQogICAgXSA9IHt9CgogICAgIyBhcmd1bWVudCBjYWNoZSBmb3Igb3B0aW1pemluZyByZXBlYXRlZCBjYWxscyB3aGVuIGJhY2t0cmFja2luZyB0aHJvdWdoIHJlY3Vyc2l2ZSBleHByZXNzaW9ucwogICAgcGFja3JhdF9jYWNoZSA9ICgKICAgICAgICB7fQogICAgKSAgIyB0aGlzIGlzIHNldCBsYXRlciBieSBlbmFibGVkX3BhY2tyYXQoKTsgdGhpcyBpcyBoZXJlIHNvIHRoYXQgcmVzZXRfY2FjaGUoKSBkb2Vzbid0IGZhaWwKICAgIHBhY2tyYXRfY2FjaGVfbG9jayA9IFJMb2NrKCkKICAgIHBhY2tyYXRfY2FjaGVfc3RhdHMgPSBbMCwgMF0KCiAgICAjIHRoaXMgbWV0aG9kIGdldHMgcmVwZWF0ZWRseSBjYWxsZWQgZHVyaW5nIGJhY2t0cmFja2luZyB3aXRoIHRoZSBzYW1lIGFyZ3VtZW50cyAtCiAgICAjIHdlIGNhbiBjYWNoZSB0aGVzZSBhcmd1bWVudHMgYW5kIHNhdmUgb3Vyc2VsdmVzIHRoZSB0cm91YmxlIG9mIHJlLXBhcnNpbmcgdGhlIGNvbnRhaW5lZCBleHByZXNzaW9uCiAgICBkZWYgX3BhcnNlQ2FjaGUoCiAgICAgICAgc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUsIGNhbGxQcmVQYXJzZT1UcnVlCiAgICApIC0+IFR1cGxlW2ludCwgUGFyc2VSZXN1bHRzXToKICAgICAgICBISVQsIE1JU1MgPSAwLCAxCiAgICAgICAgVFJZLCBNQVRDSCwgRkFJTCA9IDAsIDEsIDIKICAgICAgICBsb29rdXAgPSAoc2VsZiwgaW5zdHJpbmcsIGxvYywgY2FsbFByZVBhcnNlLCBkb0FjdGlvbnMpCiAgICAgICAgd2l0aCBQYXJzZXJFbGVtZW50LnBhY2tyYXRfY2FjaGVfbG9jazoKICAgICAgICAgICAgY2FjaGUgPSBQYXJzZXJFbGVtZW50LnBhY2tyYXRfY2FjaGUKICAgICAgICAgICAgdmFsdWUgPSBjYWNoZS5nZXQobG9va3VwKQogICAgICAgICAgICBpZiB2YWx1ZSBpcyBjYWNoZS5ub3RfaW5fY2FjaGU6CiAgICAgICAgICAgICAgICBQYXJzZXJFbGVtZW50LnBhY2tyYXRfY2FjaGVfc3RhdHNbTUlTU10gKz0gMQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsZi5fcGFyc2VOb0NhY2hlKGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucywgY2FsbFByZVBhcnNlKQogICAgICAgICAgICAgICAgZXhjZXB0IFBhcnNlQmFzZUV4Y2VwdGlvbiBhcyBwZToKICAgICAgICAgICAgICAgICAgICAjIGNhY2hlIGEgY29weSBvZiB0aGUgZXhjZXB0aW9uLCB3aXRob3V0IHRoZSB0cmFjZWJhY2sKICAgICAgICAgICAgICAgICAgICBjYWNoZS5zZXQobG9va3VwLCBwZS5fX2NsYXNzX18oKnBlLmFyZ3MpKQogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNhY2hlLnNldChsb29rdXAsICh2YWx1ZVswXSwgdmFsdWVbMV0uY29weSgpLCBsb2MpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgUGFyc2VyRWxlbWVudC5wYWNrcmF0X2NhY2hlX3N0YXRzW0hJVF0gKz0gMQogICAgICAgICAgICAgICAgaWYgc2VsZi5kZWJ1ZyBhbmQgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfdHJ5OgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfdHJ5KGluc3RyaW5nLCBsb2MsIHNlbGYsIGNhY2hlX2hpdD1UcnVlKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIEV4Y2VwdGlvbik6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5kZWJ1ZyBhbmQgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfZmFpbDoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfZmFpbCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0cmluZywgbG9jLCBzZWxmLCB2YWx1ZSwgY2FjaGVfaGl0PVRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICByYWlzZSB2YWx1ZQoKICAgICAgICAgICAgICAgIGxvY18sIHJlc3VsdCwgZW5kbG9jID0gdmFsdWVbMF0sIHZhbHVlWzFdLmNvcHkoKSwgdmFsdWVbMl0KICAgICAgICAgICAgICAgIGlmIHNlbGYuZGVidWcgYW5kIHNlbGYuZGVidWdBY3Rpb25zLmRlYnVnX21hdGNoOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZWJ1Z0FjdGlvbnMuZGVidWdfbWF0Y2goCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0cmluZywgbG9jXywgZW5kbG9jLCBzZWxmLCByZXN1bHQsIGNhY2hlX2hpdD1UcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgcmV0dXJuIGxvY18sIHJlc3VsdAoKICAgIF9wYXJzZSA9IF9wYXJzZU5vQ2FjaGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcmVzZXRfY2FjaGUoKSAtPiBOb25lOgogICAgICAgIFBhcnNlckVsZW1lbnQucGFja3JhdF9jYWNoZS5jbGVhcigpCiAgICAgICAgUGFyc2VyRWxlbWVudC5wYWNrcmF0X2NhY2hlX3N0YXRzWzpdID0gWzBdICogbGVuKAogICAgICAgICAgICBQYXJzZXJFbGVtZW50LnBhY2tyYXRfY2FjaGVfc3RhdHMKICAgICAgICApCiAgICAgICAgUGFyc2VyRWxlbWVudC5yZWN1cnNpb25fbWVtb3MuY2xlYXIoKQoKICAgIF9wYWNrcmF0RW5hYmxlZCA9IEZhbHNlCiAgICBfbGVmdF9yZWN1cnNpb25fZW5hYmxlZCA9IEZhbHNlCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRpc2FibGVfbWVtb2l6YXRpb24oKSAtPiBOb25lOgogICAgICAgIFwiXCJcIgogICAgICAgIERpc2FibGVzIGFjdGl2ZSBQYWNrcmF0IG9yIExlZnQgUmVjdXJzaW9uIHBhcnNpbmcgYW5kIHRoZWlyIG1lbW9pemF0aW9uCgogICAgICAgIFRoaXMgbWV0aG9kIGFsc28gd29ya3MgaWYgbmVpdGhlciBQYWNrcmF0IG5vciBMZWZ0IFJlY3Vyc2lvbiBhcmUgZW5hYmxlZC4KICAgICAgICBUaGlzIG1ha2VzIGl0IHNhZmUgdG8gY2FsbCBiZWZvcmUgYWN0aXZhdGluZyBQYWNrcmF0IG5vciBMZWZ0IFJlY3Vyc2lvbgogICAgICAgIHRvIGNsZWFyIGFueSBwcmV2aW91cyBzZXR0aW5ncy4KICAgICAgICBcIlwiXCIKICAgICAgICBQYXJzZXJFbGVtZW50LnJlc2V0X2NhY2hlKCkKICAgICAgICBQYXJzZXJFbGVtZW50Ll9sZWZ0X3JlY3Vyc2lvbl9lbmFibGVkID0gRmFsc2UKICAgICAgICBQYXJzZXJFbGVtZW50Ll9wYWNrcmF0RW5hYmxlZCA9IEZhbHNlCiAgICAgICAgUGFyc2VyRWxlbWVudC5fcGFyc2UgPSBQYXJzZXJFbGVtZW50Ll9wYXJzZU5vQ2FjaGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZW5hYmxlX2xlZnRfcmVjdXJzaW9uKAogICAgICAgIGNhY2hlX3NpemVfbGltaXQ6IHR5cGluZy5PcHRpb25hbFtpbnRdID0gTm9uZSwgKiwgZm9yY2U9RmFsc2UKICAgICkgLT4gTm9uZToKICAgICAgICBcIlwiXCIKICAgICAgICBFbmFibGVzIFwiYm91bmRlZCByZWN1cnNpb25cIiBwYXJzaW5nLCB3aGljaCBhbGxvd3MgZm9yIGJvdGggZGlyZWN0IGFuZCBpbmRpcmVjdAogICAgICAgIGxlZnQtcmVjdXJzaW9uLiBEdXJpbmcgcGFyc2luZywgbGVmdC1yZWN1cnNpdmUgOmNsYXNzOmBGb3J3YXJkYCBlbGVtZW50cyBhcmUKICAgICAgICByZXBlYXRlZGx5IG1hdGNoZWQgd2l0aCBhIGZpeGVkIHJlY3Vyc2lvbiBkZXB0aCB0aGF0IGlzIGdyYWR1YWxseSBpbmNyZWFzZWQKICAgICAgICB1bnRpbCBmaW5kaW5nIHRoZSBsb25nZXN0IG1hdGNoLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIGltcG9ydCBweXBhcnNpbmcgYXMgcHAKICAgICAgICAgICAgcHAuUGFyc2VyRWxlbWVudC5lbmFibGVfbGVmdF9yZWN1cnNpb24oKQoKICAgICAgICAgICAgRSA9IHBwLkZvcndhcmQoXCJFXCIpCiAgICAgICAgICAgIG51bSA9IHBwLldvcmQocHAubnVtcykKICAgICAgICAgICAgIyBtYXRjaCBgbnVtYCwgb3IgYG51bSAnKycgbnVtYCwgb3IgYG51bSAnKycgbnVtICcrJyBudW1gLCAuLi4KICAgICAgICAgICAgRSA8PD0gRSArICcrJyAtIG51bSB8IG51bQoKICAgICAgICAgICAgcHJpbnQoRS5wYXJzZV9zdHJpbmcoXCIxKzIrM1wiKSkKCiAgICAgICAgUmVjdXJzaW9uIHNlYXJjaCBuYXR1cmFsbHkgbWVtb2l6ZXMgbWF0Y2hlcyBvZiBgYEZvcndhcmRgYCBlbGVtZW50cyBhbmQgbWF5CiAgICAgICAgdGh1cyBza2lwIHJlZXZhbHVhdGlvbiBvZiBwYXJzZSBhY3Rpb25zIGR1cmluZyBiYWNrdHJhY2tpbmcuIFRoaXMgbWF5IGJyZWFrCiAgICAgICAgcHJvZ3JhbXMgd2l0aCBwYXJzZSBhY3Rpb25zIHdoaWNoIHJlbHkgb24gc3RyaWN0IG9yZGVyaW5nIG9mIHNpZGUtZWZmZWN0cy4KCiAgICAgICAgUGFyYW1ldGVyczoKCiAgICAgICAgLSBjYWNoZV9zaXplX2xpbWl0IC0gKGRlZmF1bHQ9YGBOb25lYGApIC0gbWVtb2l6ZSBhdCBtb3N0IHRoaXMgbWFueQogICAgICAgICAgYGBGb3J3YXJkYGAgZWxlbWVudHMgZHVyaW5nIG1hdGNoaW5nOyBpZiBgYE5vbmVgYCAodGhlIGRlZmF1bHQpLAogICAgICAgICAgbWVtb2l6ZSBhbGwgYGBGb3J3YXJkYGAgZWxlbWVudHMuCgogICAgICAgIEJvdW5kZWQgUmVjdXJzaW9uIHBhcnNpbmcgd29ya3Mgc2ltaWxhciBidXQgbm90IGlkZW50aWNhbCB0byBQYWNrcmF0IHBhcnNpbmcsCiAgICAgICAgdGh1cyB0aGUgdHdvIGNhbm5vdCBiZSB1c2VkIHRvZ2V0aGVyLiBVc2UgYGBmb3JjZT1UcnVlYGAgdG8gZGlzYWJsZSBhbnkKICAgICAgICBwcmV2aW91cywgY29uZmxpY3Rpbmcgc2V0dGluZ3MuCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYgZm9yY2U6CiAgICAgICAgICAgIFBhcnNlckVsZW1lbnQuZGlzYWJsZV9tZW1vaXphdGlvbigpCiAgICAgICAgZWxpZiBQYXJzZXJFbGVtZW50Ll9wYWNrcmF0RW5hYmxlZDoKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKFwiUGFja3JhdCBhbmQgQm91bmRlZCBSZWN1cnNpb24gYXJlIG5vdCBjb21wYXRpYmxlXCIpCiAgICAgICAgaWYgY2FjaGVfc2l6ZV9saW1pdCBpcyBOb25lOgogICAgICAgICAgICBQYXJzZXJFbGVtZW50LnJlY3Vyc2lvbl9tZW1vcyA9IF9VbmJvdW5kZWRNZW1vKCkKICAgICAgICBlbGlmIGNhY2hlX3NpemVfbGltaXQgPiAwOgogICAgICAgICAgICBQYXJzZXJFbGVtZW50LnJlY3Vyc2lvbl9tZW1vcyA9IF9MUlVNZW1vKGNhcGFjaXR5PWNhY2hlX3NpemVfbGltaXQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcihcIk1lbW8gc2l6ZSBvZiAlc1wiICUgY2FjaGVfc2l6ZV9saW1pdCkKICAgICAgICBQYXJzZXJFbGVtZW50Ll9sZWZ0X3JlY3Vyc2lvbl9lbmFibGVkID0gVHJ1ZQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBlbmFibGVfcGFja3JhdChjYWNoZV9zaXplX2xpbWl0OiBpbnQgPSAxMjgsICosIGZvcmNlOiBib29sID0gRmFsc2UpIC0+IE5vbmU6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRW5hYmxlcyBcInBhY2tyYXRcIiBwYXJzaW5nLCB3aGljaCBhZGRzIG1lbW9pemluZyB0byB0aGUgcGFyc2luZyBsb2dpYy4KICAgICAgICBSZXBlYXRlZCBwYXJzZSBhdHRlbXB0cyBhdCB0aGUgc2FtZSBzdHJpbmcgbG9jYXRpb24gKHdoaWNoIGhhcHBlbnMKICAgICAgICBvZnRlbiBpbiBtYW55IGNvbXBsZXggZ3JhbW1hcnMpIGNhbiBpbW1lZGlhdGVseSByZXR1cm4gYSBjYWNoZWQgdmFsdWUsCiAgICAgICAgaW5zdGVhZCBvZiByZS1leGVjdXRpbmcgcGFyc2luZy92YWxpZGF0aW5nIGNvZGUuICBNZW1vaXppbmcgaXMgZG9uZSBvZgogICAgICAgIGJvdGggdmFsaWQgcmVzdWx0cyBhbmQgcGFyc2luZyBleGNlcHRpb25zLgoKICAgICAgICBQYXJhbWV0ZXJzOgoKICAgICAgICAtIGNhY2hlX3NpemVfbGltaXQgLSAoZGVmYXVsdD0gYGAxMjhgYCkgLSBpZiBhbiBpbnRlZ2VyIHZhbHVlIGlzIHByb3ZpZGVkCiAgICAgICAgICB3aWxsIGxpbWl0IHRoZSBzaXplIG9mIHRoZSBwYWNrcmF0IGNhY2hlOyBpZiBOb25lIGlzIHBhc3NlZCwgdGhlbgogICAgICAgICAgdGhlIGNhY2hlIHNpemUgd2lsbCBiZSB1bmJvdW5kZWQ7IGlmIDAgaXMgcGFzc2VkLCB0aGUgY2FjaGUgd2lsbAogICAgICAgICAgYmUgZWZmZWN0aXZlbHkgZGlzYWJsZWQuCgogICAgICAgIFRoaXMgc3BlZWR1cCBtYXkgYnJlYWsgZXhpc3RpbmcgcHJvZ3JhbXMgdGhhdCB1c2UgcGFyc2UgYWN0aW9ucyB0aGF0CiAgICAgICAgaGF2ZSBzaWRlLWVmZmVjdHMuICBGb3IgdGhpcyByZWFzb24sIHBhY2tyYXQgcGFyc2luZyBpcyBkaXNhYmxlZCB3aGVuCiAgICAgICAgeW91IGZpcnN0IGltcG9ydCBweXBhcnNpbmcuICBUbyBhY3RpdmF0ZSB0aGUgcGFja3JhdCBmZWF0dXJlLCB5b3VyCiAgICAgICAgcHJvZ3JhbSBtdXN0IGNhbGwgdGhlIGNsYXNzIG1ldGhvZCA6Y2xhc3M6YFBhcnNlckVsZW1lbnQuZW5hYmxlX3BhY2tyYXRgLgogICAgICAgIEZvciBiZXN0IHJlc3VsdHMsIGNhbGwgYGBlbmFibGVfcGFja3JhdCgpYGAgaW1tZWRpYXRlbHkgYWZ0ZXIKICAgICAgICBpbXBvcnRpbmcgcHlwYXJzaW5nLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIGltcG9ydCBweXBhcnNpbmcKICAgICAgICAgICAgcHlwYXJzaW5nLlBhcnNlckVsZW1lbnQuZW5hYmxlX3BhY2tyYXQoKQoKICAgICAgICBQYWNrcmF0IHBhcnNpbmcgd29ya3Mgc2ltaWxhciBidXQgbm90IGlkZW50aWNhbCB0byBCb3VuZGVkIFJlY3Vyc2lvbiBwYXJzaW5nLAogICAgICAgIHRodXMgdGhlIHR3byBjYW5ub3QgYmUgdXNlZCB0b2dldGhlci4gVXNlIGBgZm9yY2U9VHJ1ZWBgIHRvIGRpc2FibGUgYW55CiAgICAgICAgcHJldmlvdXMsIGNvbmZsaWN0aW5nIHNldHRpbmdzLgogICAgICAgIFwiXCJcIgogICAgICAgIGlmIGZvcmNlOgogICAgICAgICAgICBQYXJzZXJFbGVtZW50LmRpc2FibGVfbWVtb2l6YXRpb24oKQogICAgICAgIGVsaWYgUGFyc2VyRWxlbWVudC5fbGVmdF9yZWN1cnNpb25fZW5hYmxlZDoKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKFwiUGFja3JhdCBhbmQgQm91bmRlZCBSZWN1cnNpb24gYXJlIG5vdCBjb21wYXRpYmxlXCIpCiAgICAgICAgaWYgbm90IFBhcnNlckVsZW1lbnQuX3BhY2tyYXRFbmFibGVkOgogICAgICAgICAgICBQYXJzZXJFbGVtZW50Ll9wYWNrcmF0RW5hYmxlZCA9IFRydWUKICAgICAgICAgICAgaWYgY2FjaGVfc2l6ZV9saW1pdCBpcyBOb25lOgogICAgICAgICAgICAgICAgUGFyc2VyRWxlbWVudC5wYWNrcmF0X2NhY2hlID0gX1VuYm91bmRlZENhY2hlKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIFBhcnNlckVsZW1lbnQucGFja3JhdF9jYWNoZSA9IF9GaWZvQ2FjaGUoY2FjaGVfc2l6ZV9saW1pdCkKICAgICAgICAgICAgUGFyc2VyRWxlbWVudC5fcGFyc2UgPSBQYXJzZXJFbGVtZW50Ll9wYXJzZUNhY2hlCgogICAgZGVmIHBhcnNlX3N0cmluZygKICAgICAgICBzZWxmLCBpbnN0cmluZzogc3RyLCBwYXJzZV9hbGw6IGJvb2wgPSBGYWxzZSwgKiwgcGFyc2VBbGw6IGJvb2wgPSBGYWxzZQogICAgKSAtPiBQYXJzZVJlc3VsdHM6CiAgICAgICAgXCJcIlwiCiAgICAgICAgUGFyc2UgYSBzdHJpbmcgd2l0aCByZXNwZWN0IHRvIHRoZSBwYXJzZXIgZGVmaW5pdGlvbi4gVGhpcyBmdW5jdGlvbiBpcyBpbnRlbmRlZCBhcyB0aGUgcHJpbWFyeSBpbnRlcmZhY2UgdG8gdGhlCiAgICAgICAgY2xpZW50IGNvZGUuCgogICAgICAgIDpwYXJhbSBpbnN0cmluZzogVGhlIGlucHV0IHN0cmluZyB0byBiZSBwYXJzZWQuCiAgICAgICAgOnBhcmFtIHBhcnNlX2FsbDogSWYgc2V0LCB0aGUgZW50aXJlIGlucHV0IHN0cmluZyBtdXN0IG1hdGNoIHRoZSBncmFtbWFyLgogICAgICAgIDpwYXJhbSBwYXJzZUFsbDogcmV0YWluZWQgZm9yIHByZS1QRVA4IGNvbXBhdGliaWxpdHksIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSByZWxlYXNlLgogICAgICAgIDpyYWlzZXMgUGFyc2VFeGNlcHRpb246IFJhaXNlZCBpZiBgYHBhcnNlX2FsbGBgIGlzIHNldCBhbmQgdGhlIGlucHV0IHN0cmluZyBkb2VzIG5vdCBtYXRjaCB0aGUgd2hvbGUgZ3JhbW1hci4KICAgICAgICA6cmV0dXJuczogdGhlIHBhcnNlZCBkYXRhIGFzIGEgOmNsYXNzOmBQYXJzZVJlc3VsdHNgIG9iamVjdCwgd2hpY2ggbWF5IGJlIGFjY2Vzc2VkIGFzIGEgYGxpc3RgLCBhIGBkaWN0YCwgb3IKICAgICAgICAgIGFuIG9iamVjdCB3aXRoIGF0dHJpYnV0ZXMgaWYgdGhlIGdpdmVuIHBhcnNlciBpbmNsdWRlcyByZXN1bHRzIG5hbWVzLgoKICAgICAgICBJZiB0aGUgaW5wdXQgc3RyaW5nIGlzIHJlcXVpcmVkIHRvIG1hdGNoIHRoZSBlbnRpcmUgZ3JhbW1hciwgYGBwYXJzZV9hbGxgYCBmbGFnIG11c3QgYmUgc2V0IHRvIGBgVHJ1ZWBgLiBUaGlzCiAgICAgICAgaXMgYWxzbyBlcXVpdmFsZW50IHRvIGVuZGluZyB0aGUgZ3JhbW1hciB3aXRoIDpjbGFzczpgU3RyaW5nRW5kYCgpLgoKICAgICAgICBUbyByZXBvcnQgcHJvcGVyIGNvbHVtbiBudW1iZXJzLCBgYHBhcnNlX3N0cmluZ2BgIG9wZXJhdGVzIG9uIGEgY29weSBvZiB0aGUgaW5wdXQgc3RyaW5nIHdoZXJlIGFsbCB0YWJzIGFyZQogICAgICAgIGNvbnZlcnRlZCB0byBzcGFjZXMgKDggc3BhY2VzIHBlciB0YWIsIGFzIHBlciB0aGUgZGVmYXVsdCBpbiBgYHN0cmluZy5leHBhbmR0YWJzYGApLiBJZiB0aGUgaW5wdXQgc3RyaW5nCiAgICAgICAgY29udGFpbnMgdGFicyBhbmQgdGhlIGdyYW1tYXIgdXNlcyBwYXJzZSBhY3Rpb25zIHRoYXQgdXNlIHRoZSBgYGxvY2BgIGFyZ3VtZW50IHRvIGluZGV4IGludG8gdGhlIHN0cmluZwogICAgICAgIGJlaW5nIHBhcnNlZCwgb25lIGNhbiBlbnN1cmUgYSBjb25zaXN0ZW50IHZpZXcgb2YgdGhlIGlucHV0IHN0cmluZyBieSBkb2luZyBvbmUgb2YgdGhlIGZvbGxvd2luZzoKCiAgICAgICAgLSBjYWxsaW5nIGBgcGFyc2Vfd2l0aF90YWJzYGAgb24geW91ciBncmFtbWFyIGJlZm9yZSBjYWxsaW5nIGBgcGFyc2Vfc3RyaW5nYGAgKHNlZSA6Y2xhc3M6YHBhcnNlX3dpdGhfdGFic2ApLAogICAgICAgIC0gZGVmaW5lIHlvdXIgcGFyc2UgYWN0aW9uIHVzaW5nIHRoZSBmdWxsIGBgKHMsbG9jLHRva3MpYGAgc2lnbmF0dXJlLCBhbmQgcmVmZXJlbmNlIHRoZSBpbnB1dCBzdHJpbmcgdXNpbmcgdGhlCiAgICAgICAgICBwYXJzZSBhY3Rpb24ncyBgYHNgYCBhcmd1bWVudCwgb3IKICAgICAgICAtIGV4cGxpY2l0bHkgZXhwYW5kIHRoZSB0YWJzIGluIHlvdXIgaW5wdXQgc3RyaW5nIGJlZm9yZSBjYWxsaW5nIGBgcGFyc2Vfc3RyaW5nYGAuCgogICAgICAgIEV4YW1wbGVzOgoKICAgICAgICBCeSBkZWZhdWx0LCBwYXJ0aWFsIG1hdGNoZXMgYXJlIE9LLgoKICAgICAgICA+Pj4gcmVzID0gV29yZCgnYScpLnBhcnNlX3N0cmluZygnYWFhYWFiYWFhJykKICAgICAgICA+Pj4gcHJpbnQocmVzKQogICAgICAgIFsnYWFhYWEnXQoKICAgICAgICBUaGUgcGFyc2luZyBiZWhhdmlvciB2YXJpZXMgYnkgdGhlIGluaGVyaXRpbmcgY2xhc3Mgb2YgdGhpcyBhYnN0cmFjdCBjbGFzcy4gUGxlYXNlIHJlZmVyIHRvIHRoZSBjaGlsZHJlbgogICAgICAgIGRpcmVjdGx5IHRvIHNlZSBtb3JlIGV4YW1wbGVzLgoKICAgICAgICBJdCByYWlzZXMgYW4gZXhjZXB0aW9uIGlmIHBhcnNlX2FsbCBmbGFnIGlzIHNldCBhbmQgaW5zdHJpbmcgZG9lcyBub3QgbWF0Y2ggdGhlIHdob2xlIGdyYW1tYXIuCgogICAgICAgID4+PiByZXMgPSBXb3JkKCdhJykucGFyc2Vfc3RyaW5nKCdhYWFhYWJhYWEnLCBwYXJzZV9hbGw9VHJ1ZSkKICAgICAgICBUcmFjZWJhY2sgKG1vc3QgcmVjZW50IGNhbGwgbGFzdCk6CiAgICAgICAgLi4uCiAgICAgICAgcHlwYXJzaW5nLlBhcnNlRXhjZXB0aW9uOiBFeHBlY3RlZCBlbmQgb2YgdGV4dCwgZm91bmQgJ2InICAoYXQgY2hhciA1KSwgKGxpbmU6MSwgY29sOjYpCiAgICAgICAgXCJcIlwiCiAgICAgICAgcGFyc2VBbGwgPSBwYXJzZV9hbGwgb3IgcGFyc2VBbGwKCiAgICAgICAgUGFyc2VyRWxlbWVudC5yZXNldF9jYWNoZSgpCiAgICAgICAgaWYgbm90IHNlbGYuc3RyZWFtbGluZWQ6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtbGluZSgpCiAgICAgICAgZm9yIGUgaW4gc2VsZi5pZ25vcmVFeHByczoKICAgICAgICAgICAgZS5zdHJlYW1saW5lKCkKICAgICAgICBpZiBub3Qgc2VsZi5rZWVwVGFiczoKICAgICAgICAgICAgaW5zdHJpbmcgPSBpbnN0cmluZy5leHBhbmR0YWJzKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYywgdG9rZW5zID0gc2VsZi5fcGFyc2UoaW5zdHJpbmcsIDApCiAgICAgICAgICAgIGlmIHBhcnNlQWxsOgogICAgICAgICAgICAgICAgbG9jID0gc2VsZi5wcmVQYXJzZShpbnN0cmluZywgbG9jKQogICAgICAgICAgICAgICAgc2UgPSBFbXB0eSgpICsgU3RyaW5nRW5kKCkKICAgICAgICAgICAgICAgIHNlLl9wYXJzZShpbnN0cmluZywgbG9jKQogICAgICAgIGV4Y2VwdCBQYXJzZUJhc2VFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICBpZiBQYXJzZXJFbGVtZW50LnZlcmJvc2Vfc3RhY2t0cmFjZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIGNhdGNoIGFuZCByZS1yYWlzZSBleGNlcHRpb24gZnJvbSBoZXJlLCBjbGVhcmluZyBvdXQgcHlwYXJzaW5nIGludGVybmFsIHN0YWNrIHRyYWNlCiAgICAgICAgICAgICAgICByYWlzZSBleGMud2l0aF90cmFjZWJhY2soTm9uZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gdG9rZW5zCgogICAgZGVmIHNjYW5fc3RyaW5nKAogICAgICAgIHNlbGYsCiAgICAgICAgaW5zdHJpbmc6IHN0ciwKICAgICAgICBtYXhfbWF0Y2hlczogaW50ID0gX01BWF9JTlQsCiAgICAgICAgb3ZlcmxhcDogYm9vbCA9IEZhbHNlLAogICAgICAgICosCiAgICAgICAgZGVidWc6IGJvb2wgPSBGYWxzZSwKICAgICAgICBtYXhNYXRjaGVzOiBpbnQgPSBfTUFYX0lOVCwKICAgICkgLT4gR2VuZXJhdG9yW1R1cGxlW1BhcnNlUmVzdWx0cywgaW50LCBpbnRdLCBOb25lLCBOb25lXToKICAgICAgICBcIlwiXCIKICAgICAgICBTY2FuIHRoZSBpbnB1dCBzdHJpbmcgZm9yIGV4cHJlc3Npb24gbWF0Y2hlcy4gIEVhY2ggbWF0Y2ggd2lsbCByZXR1cm4gdGhlCiAgICAgICAgbWF0Y2hpbmcgdG9rZW5zLCBzdGFydCBsb2NhdGlvbiwgYW5kIGVuZCBsb2NhdGlvbi4gIE1heSBiZSBjYWxsZWQgd2l0aCBvcHRpb25hbAogICAgICAgIGBgbWF4X21hdGNoZXNgYCBhcmd1bWVudCwgdG8gY2xpcCBzY2FubmluZyBhZnRlciAnbicgbWF0Y2hlcyBhcmUgZm91bmQuICBJZgogICAgICAgIGBgb3ZlcmxhcGBgIGlzIHNwZWNpZmllZCwgdGhlbiBvdmVybGFwcGluZyBtYXRjaGVzIHdpbGwgYmUgcmVwb3J0ZWQuCgogICAgICAgIE5vdGUgdGhhdCB0aGUgc3RhcnQgYW5kIGVuZCBsb2NhdGlvbnMgYXJlIHJlcG9ydGVkIHJlbGF0aXZlIHRvIHRoZSBzdHJpbmcKICAgICAgICBiZWluZyBwYXJzZWQuICBTZWUgOmNsYXNzOmBwYXJzZV9zdHJpbmdgIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIHBhcnNpbmcKICAgICAgICBzdHJpbmdzIHdpdGggZW1iZWRkZWQgdGFicy4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBzb3VyY2UgPSBcInNsZGpmMTIzbHNkamprZjM0NXNsZGtqZjg3OWxranNmZDk4N1wiCiAgICAgICAgICAgIHByaW50KHNvdXJjZSkKICAgICAgICAgICAgZm9yIHRva2Vucywgc3RhcnQsIGVuZCBpbiBXb3JkKGFscGhhcykuc2Nhbl9zdHJpbmcoc291cmNlKToKICAgICAgICAgICAgICAgIHByaW50KCcgJypzdGFydCArICdeJyooZW5kLXN0YXJ0KSkKICAgICAgICAgICAgICAgIHByaW50KCcgJypzdGFydCArIHRva2Vuc1swXSkKCiAgICAgICAgcHJpbnRzOjoKCiAgICAgICAgICAgIHNsZGpmMTIzbHNkamprZjM0NXNsZGtqZjg3OWxranNmZDk4NwogICAgICAgICAgICBeXl5eXgogICAgICAgICAgICBzbGRqZgogICAgICAgICAgICAgICAgICAgIF5eXl5eXl4KICAgICAgICAgICAgICAgICAgICBsc2RqamtmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF5eXl5eXgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGRramYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXl5eXl5eCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxranNmZAogICAgICAgIFwiXCJcIgogICAgICAgIG1heE1hdGNoZXMgPSBtaW4obWF4TWF0Y2hlcywgbWF4X21hdGNoZXMpCiAgICAgICAgaWYgbm90IHNlbGYuc3RyZWFtbGluZWQ6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtbGluZSgpCiAgICAgICAgZm9yIGUgaW4gc2VsZi5pZ25vcmVFeHByczoKICAgICAgICAgICAgZS5zdHJlYW1saW5lKCkKCiAgICAgICAgaWYgbm90IHNlbGYua2VlcFRhYnM6CiAgICAgICAgICAgIGluc3RyaW5nID0gc3RyKGluc3RyaW5nKS5leHBhbmR0YWJzKCkKICAgICAgICBpbnN0cmxlbiA9IGxlbihpbnN0cmluZykKICAgICAgICBsb2MgPSAwCiAgICAgICAgcHJlcGFyc2VGbiA9IHNlbGYucHJlUGFyc2UKICAgICAgICBwYXJzZUZuID0gc2VsZi5fcGFyc2UKICAgICAgICBQYXJzZXJFbGVtZW50LnJlc2V0Q2FjaGUoKQogICAgICAgIG1hdGNoZXMgPSAwCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aGlsZSBsb2MgPD0gaW5zdHJsZW4gYW5kIG1hdGNoZXMgPCBtYXhNYXRjaGVzOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHByZWxvYyA9IHByZXBhcnNlRm4oaW5zdHJpbmcsIGxvYykKICAgICAgICAgICAgICAgICAgICBuZXh0TG9jLCB0b2tlbnMgPSBwYXJzZUZuKGluc3RyaW5nLCBwcmVsb2MsIGNhbGxQcmVQYXJzZT1GYWxzZSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgICAgICBsb2MgPSBwcmVsb2MgKyAxCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGlmIG5leHRMb2MgPiBsb2M6CiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICBpZiBkZWJ1ZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b2tlbnNcIjogdG9rZW5zLmFzTGlzdCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXJ0XCI6IHByZWxvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbmRcIjogbmV4dExvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRva2VucywgcHJlbG9jLCBuZXh0TG9jCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG92ZXJsYXA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0bG9jID0gcHJlcGFyc2VGbihpbnN0cmluZywgbG9jKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmV4dGxvYyA+IGxvYzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2MgPSBuZXh0TG9jCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYyArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2MgPSBuZXh0TG9jCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9jID0gcHJlbG9jICsgMQogICAgICAgIGV4Y2VwdCBQYXJzZUJhc2VFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICBpZiBQYXJzZXJFbGVtZW50LnZlcmJvc2Vfc3RhY2t0cmFjZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIGNhdGNoIGFuZCByZS1yYWlzZSBleGNlcHRpb24gZnJvbSBoZXJlLCBjbGVhcnMgb3V0IHB5cGFyc2luZyBpbnRlcm5hbCBzdGFjayB0cmFjZQogICAgICAgICAgICAgICAgcmFpc2UgZXhjLndpdGhfdHJhY2ViYWNrKE5vbmUpCgogICAgZGVmIHRyYW5zZm9ybV9zdHJpbmcoc2VsZiwgaW5zdHJpbmc6IHN0ciwgKiwgZGVidWc6IGJvb2wgPSBGYWxzZSkgLT4gc3RyOgogICAgICAgIFwiXCJcIgogICAgICAgIEV4dGVuc2lvbiB0byA6Y2xhc3M6YHNjYW5fc3RyaW5nYCwgdG8gbW9kaWZ5IG1hdGNoaW5nIHRleHQgd2l0aCBtb2RpZmllZCB0b2tlbnMgdGhhdCBtYXkKICAgICAgICBiZSByZXR1cm5lZCBmcm9tIGEgcGFyc2UgYWN0aW9uLiAgVG8gdXNlIGBgdHJhbnNmb3JtX3N0cmluZ2BgLCBkZWZpbmUgYSBncmFtbWFyIGFuZAogICAgICAgIGF0dGFjaCBhIHBhcnNlIGFjdGlvbiB0byBpdCB0aGF0IG1vZGlmaWVzIHRoZSByZXR1cm5lZCB0b2tlbiBsaXN0LgogICAgICAgIEludm9raW5nIGBgdHJhbnNmb3JtX3N0cmluZygpYGAgb24gYSB0YXJnZXQgc3RyaW5nIHdpbGwgdGhlbiBzY2FuIGZvciBtYXRjaGVzLAogICAgICAgIGFuZCByZXBsYWNlIHRoZSBtYXRjaGVkIHRleHQgcGF0dGVybnMgYWNjb3JkaW5nIHRvIHRoZSBsb2dpYyBpbiB0aGUgcGFyc2UKICAgICAgICBhY3Rpb24uICBgYHRyYW5zZm9ybV9zdHJpbmcoKWBgIHJldHVybnMgdGhlIHJlc3VsdGluZyB0cmFuc2Zvcm1lZCBzdHJpbmcuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgd2QgPSBXb3JkKGFscGhhcykKICAgICAgICAgICAgd2Quc2V0X3BhcnNlX2FjdGlvbihsYW1iZGEgdG9rczogdG9rc1swXS50aXRsZSgpKQoKICAgICAgICAgICAgcHJpbnQod2QudHJhbnNmb3JtX3N0cmluZyhcIm5vdyBpcyB0aGUgd2ludGVyIG9mIG91ciBkaXNjb250ZW50IG1hZGUgZ2xvcmlvdXMgc3VtbWVyIGJ5IHRoaXMgc3VuIG9mIHlvcmsuXCIpKQoKICAgICAgICBwcmludHM6OgoKICAgICAgICAgICAgTm93IElzIFRoZSBXaW50ZXIgT2YgT3VyIERpc2NvbnRlbnQgTWFkZSBHbG9yaW91cyBTdW1tZXIgQnkgVGhpcyBTdW4gT2YgWW9yay4KICAgICAgICBcIlwiXCIKICAgICAgICBvdXQ6IExpc3Rbc3RyXSA9IFtdCiAgICAgICAgbGFzdEUgPSAwCiAgICAgICAgIyBmb3JjZSBwcmVzZXJ2YXRpb24gb2YgPFRBQj5zLCB0byBtaW5pbWl6ZSB1bndhbnRlZCB0cmFuc2Zvcm1hdGlvbiBvZiBzdHJpbmcsIGFuZCB0bwogICAgICAgICMga2VlcCBzdHJpbmcgbG9jcyBzdHJhaWdodCBiZXR3ZWVuIHRyYW5zZm9ybV9zdHJpbmcgYW5kIHNjYW5fc3RyaW5nCiAgICAgICAgc2VsZi5rZWVwVGFicyA9IFRydWUKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZvciB0LCBzLCBlIGluIHNlbGYuc2Nhbl9zdHJpbmcoaW5zdHJpbmcsIGRlYnVnPWRlYnVnKToKICAgICAgICAgICAgICAgIG91dC5hcHBlbmQoaW5zdHJpbmdbbGFzdEU6c10pCiAgICAgICAgICAgICAgICBpZiB0OgogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodCwgUGFyc2VSZXN1bHRzKToKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IHQuYXNfbGlzdCgpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHQsIEl0ZXJhYmxlKSBhbmQgbm90IGlzaW5zdGFuY2UodCwgc3RyX3R5cGUpOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQuZXh0ZW5kKHQpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZCh0KQogICAgICAgICAgICAgICAgbGFzdEUgPSBlCiAgICAgICAgICAgIG91dC5hcHBlbmQoaW5zdHJpbmdbbGFzdEU6XSkKICAgICAgICAgICAgb3V0ID0gW28gZm9yIG8gaW4gb3V0IGlmIG9dCiAgICAgICAgICAgIHJldHVybiBcIlwiLmpvaW4oW3N0cihzKSBmb3IgcyBpbiBfZmxhdHRlbihvdXQpXSkKICAgICAgICBleGNlcHQgUGFyc2VCYXNlRXhjZXB0aW9uIGFzIGV4YzoKICAgICAgICAgICAgaWYgUGFyc2VyRWxlbWVudC52ZXJib3NlX3N0YWNrdHJhY2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBjYXRjaCBhbmQgcmUtcmFpc2UgZXhjZXB0aW9uIGZyb20gaGVyZSwgY2xlYXJzIG91dCBweXBhcnNpbmcgaW50ZXJuYWwgc3RhY2sgdHJhY2UKICAgICAgICAgICAgICAgIHJhaXNlIGV4Yy53aXRoX3RyYWNlYmFjayhOb25lKQoKICAgIGRlZiBzZWFyY2hfc3RyaW5nKAogICAgICAgIHNlbGYsCiAgICAgICAgaW5zdHJpbmc6IHN0ciwKICAgICAgICBtYXhfbWF0Y2hlczogaW50ID0gX01BWF9JTlQsCiAgICAgICAgKiwKICAgICAgICBkZWJ1ZzogYm9vbCA9IEZhbHNlLAogICAgICAgIG1heE1hdGNoZXM6IGludCA9IF9NQVhfSU5ULAogICAgKSAtPiBQYXJzZVJlc3VsdHM6CiAgICAgICAgXCJcIlwiCiAgICAgICAgQW5vdGhlciBleHRlbnNpb24gdG8gOmNsYXNzOmBzY2FuX3N0cmluZ2AsIHNpbXBsaWZ5aW5nIHRoZSBhY2Nlc3MgdG8gdGhlIHRva2VucyBmb3VuZAogICAgICAgIHRvIG1hdGNoIHRoZSBnaXZlbiBwYXJzZSBleHByZXNzaW9uLiAgTWF5IGJlIGNhbGxlZCB3aXRoIG9wdGlvbmFsCiAgICAgICAgYGBtYXhfbWF0Y2hlc2BgIGFyZ3VtZW50LCB0byBjbGlwIHNlYXJjaGluZyBhZnRlciAnbicgbWF0Y2hlcyBhcmUgZm91bmQuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgIyBhIGNhcGl0YWxpemVkIHdvcmQgc3RhcnRzIHdpdGggYW4gdXBwZXJjYXNlIGxldHRlciwgZm9sbG93ZWQgYnkgemVybyBvciBtb3JlIGxvd2VyY2FzZSBsZXR0ZXJzCiAgICAgICAgICAgIGNhcF93b3JkID0gV29yZChhbHBoYXMudXBwZXIoKSwgYWxwaGFzLmxvd2VyKCkpCgogICAgICAgICAgICBwcmludChjYXBfd29yZC5zZWFyY2hfc3RyaW5nKFwiTW9yZSB0aGFuIElyb24sIG1vcmUgdGhhbiBMZWFkLCBtb3JlIHRoYW4gR29sZCBJIG5lZWQgRWxlY3RyaWNpdHlcIikpCgogICAgICAgICAgICAjIHRoZSBzdW0oKSBidWlsdGluIGNhbiBiZSB1c2VkIHRvIG1lcmdlIHJlc3VsdHMgaW50byBhIHNpbmdsZSBQYXJzZVJlc3VsdHMgb2JqZWN0CiAgICAgICAgICAgIHByaW50KHN1bShjYXBfd29yZC5zZWFyY2hfc3RyaW5nKFwiTW9yZSB0aGFuIElyb24sIG1vcmUgdGhhbiBMZWFkLCBtb3JlIHRoYW4gR29sZCBJIG5lZWQgRWxlY3RyaWNpdHlcIikpKQoKICAgICAgICBwcmludHM6OgoKICAgICAgICAgICAgW1snTW9yZSddLCBbJ0lyb24nXSwgWydMZWFkJ10sIFsnR29sZCddLCBbJ0knXSwgWydFbGVjdHJpY2l0eSddXQogICAgICAgICAgICBbJ01vcmUnLCAnSXJvbicsICdMZWFkJywgJ0dvbGQnLCAnSScsICdFbGVjdHJpY2l0eSddCiAgICAgICAgXCJcIlwiCiAgICAgICAgbWF4TWF0Y2hlcyA9IG1pbihtYXhNYXRjaGVzLCBtYXhfbWF0Y2hlcykKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBQYXJzZVJlc3VsdHMoCiAgICAgICAgICAgICAgICBbdCBmb3IgdCwgcywgZSBpbiBzZWxmLnNjYW5fc3RyaW5nKGluc3RyaW5nLCBtYXhNYXRjaGVzLCBkZWJ1Zz1kZWJ1ZyldCiAgICAgICAgICAgICkKICAgICAgICBleGNlcHQgUGFyc2VCYXNlRXhjZXB0aW9uIGFzIGV4YzoKICAgICAgICAgICAgaWYgUGFyc2VyRWxlbWVudC52ZXJib3NlX3N0YWNrdHJhY2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBjYXRjaCBhbmQgcmUtcmFpc2UgZXhjZXB0aW9uIGZyb20gaGVyZSwgY2xlYXJzIG91dCBweXBhcnNpbmcgaW50ZXJuYWwgc3RhY2sgdHJhY2UKICAgICAgICAgICAgICAgIHJhaXNlIGV4Yy53aXRoX3RyYWNlYmFjayhOb25lKQoKICAgIGRlZiBzcGxpdCgKICAgICAgICBzZWxmLAogICAgICAgIGluc3RyaW5nOiBzdHIsCiAgICAgICAgbWF4c3BsaXQ6IGludCA9IF9NQVhfSU5ULAogICAgICAgIGluY2x1ZGVfc2VwYXJhdG9yczogYm9vbCA9IEZhbHNlLAogICAgICAgICosCiAgICAgICAgaW5jbHVkZVNlcGFyYXRvcnM9RmFsc2UsCiAgICApIC0+IEdlbmVyYXRvcltzdHIsIE5vbmUsIE5vbmVdOgogICAgICAgIFwiXCJcIgogICAgICAgIEdlbmVyYXRvciBtZXRob2QgdG8gc3BsaXQgYSBzdHJpbmcgdXNpbmcgdGhlIGdpdmVuIGV4cHJlc3Npb24gYXMgYSBzZXBhcmF0b3IuCiAgICAgICAgTWF5IGJlIGNhbGxlZCB3aXRoIG9wdGlvbmFsIGBgbWF4c3BsaXRgYCBhcmd1bWVudCwgdG8gbGltaXQgdGhlIG51bWJlciBvZiBzcGxpdHM7CiAgICAgICAgYW5kIHRoZSBvcHRpb25hbCBgYGluY2x1ZGVfc2VwYXJhdG9yc2BgIGFyZ3VtZW50IChkZWZhdWx0PSBgYEZhbHNlYGApLCBpZiB0aGUgc2VwYXJhdGluZwogICAgICAgIG1hdGNoaW5nIHRleHQgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBzcGxpdCByZXN1bHRzLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIHB1bmMgPSBvbmVfb2YobGlzdChcIi4sOzovLSE/XCIpKQogICAgICAgICAgICBwcmludChsaXN0KHB1bmMuc3BsaXQoXCJUaGlzLCB0aGlzPywgdGhpcyBzZW50ZW5jZSwgaXMgYmFkbHkgcHVuY3R1YXRlZCFcIikpKQoKICAgICAgICBwcmludHM6OgoKICAgICAgICAgICAgWydUaGlzJywgJyB0aGlzJywgJycsICcgdGhpcyBzZW50ZW5jZScsICcgaXMgYmFkbHkgcHVuY3R1YXRlZCcsICcnXQogICAgICAgIFwiXCJcIgogICAgICAgIGluY2x1ZGVTZXBhcmF0b3JzID0gaW5jbHVkZVNlcGFyYXRvcnMgb3IgaW5jbHVkZV9zZXBhcmF0b3JzCiAgICAgICAgbGFzdCA9IDAKICAgICAgICBmb3IgdCwgcywgZSBpbiBzZWxmLnNjYW5fc3RyaW5nKGluc3RyaW5nLCBtYXhfbWF0Y2hlcz1tYXhzcGxpdCk6CiAgICAgICAgICAgIHlpZWxkIGluc3RyaW5nW2xhc3Q6c10KICAgICAgICAgICAgaWYgaW5jbHVkZVNlcGFyYXRvcnM6CiAgICAgICAgICAgICAgICB5aWVsZCB0WzBdCiAgICAgICAgICAgIGxhc3QgPSBlCiAgICAgICAgeWllbGQgaW5zdHJpbmdbbGFzdDpdCgogICAgZGVmIF9fYWRkX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgK2BgIG9wZXJhdG9yIC0gcmV0dXJucyA6Y2xhc3M6YEFuZGAuIEFkZGluZyBzdHJpbmdzIHRvIGEgOmNsYXNzOmBQYXJzZXJFbGVtZW50YAogICAgICAgIGNvbnZlcnRzIHRoZW0gdG8gOmNsYXNzOmBMaXRlcmFsYHMgYnkgZGVmYXVsdC4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBncmVldCA9IFdvcmQoYWxwaGFzKSArIFwiLFwiICsgV29yZChhbHBoYXMpICsgXCIhXCIKICAgICAgICAgICAgaGVsbG8gPSBcIkhlbGxvLCBXb3JsZCFcIgogICAgICAgICAgICBwcmludChoZWxsbywgXCItPlwiLCBncmVldC5wYXJzZV9zdHJpbmcoaGVsbG8pKQoKICAgICAgICBwcmludHM6OgoKICAgICAgICAgICAgSGVsbG8sIFdvcmxkISAtPiBbJ0hlbGxvJywgJywnLCAnV29ybGQnLCAnISddCgogICAgICAgIGBgLi4uYGAgbWF5IGJlIHVzZWQgYXMgYSBwYXJzZSBleHByZXNzaW9uIGFzIGEgc2hvcnQgZm9ybSBvZiA6Y2xhc3M6YFNraXBUb2AuCgogICAgICAgICAgICBMaXRlcmFsKCdzdGFydCcpICsgLi4uICsgTGl0ZXJhbCgnZW5kJykKCiAgICAgICAgaXMgZXF1aXZhbGVudCB0bzoKCiAgICAgICAgICAgIExpdGVyYWwoJ3N0YXJ0JykgKyBTa2lwVG8oJ2VuZCcpKFwiX3NraXBwZWQqXCIpICsgTGl0ZXJhbCgnZW5kJykKCiAgICAgICAgTm90ZSB0aGF0IHRoZSBza2lwcGVkIHRleHQgaXMgcmV0dXJuZWQgd2l0aCAnX3NraXBwZWQnIGFzIGEgcmVzdWx0cyBuYW1lLAogICAgICAgIGFuZCB0byBzdXBwb3J0IGhhdmluZyBtdWx0aXBsZSBza2lwcyBpbiB0aGUgc2FtZSBwYXJzZXIsIHRoZSB2YWx1ZSByZXR1cm5lZCBpcwogICAgICAgIGEgbGlzdCBvZiBhbGwgc2tpcHBlZCB0ZXh0LgogICAgICAgIFwiXCJcIgogICAgICAgIGlmIG90aGVyIGlzIEVsbGlwc2lzOgogICAgICAgICAgICByZXR1cm4gX1BlbmRpbmdTa2lwKHNlbGYpCgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHN0cl90eXBlKToKICAgICAgICAgICAgb3RoZXIgPSBzZWxmLl9saXRlcmFsU3RyaW5nQ2xhc3Mob3RoZXIpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIFBhcnNlckVsZW1lbnQpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoCiAgICAgICAgICAgICAgICBcIkNhbm5vdCBjb21iaW5lIGVsZW1lbnQgb2YgdHlwZSB7fSB3aXRoIFBhcnNlckVsZW1lbnRcIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgdHlwZShvdGhlcikuX19uYW1lX18KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgIHJldHVybiBBbmQoW3NlbGYsIG90aGVyXSkKCiAgICBkZWYgX19yYWRkX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgK2BgIG9wZXJhdG9yIHdoZW4gbGVmdCBvcGVyYW5kIGlzIG5vdCBhIDpjbGFzczpgUGFyc2VyRWxlbWVudGAKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBvdGhlciBpcyBFbGxpcHNpczoKICAgICAgICAgICAgcmV0dXJuIFNraXBUbyhzZWxmKShcIl9za2lwcGVkKlwiKSArIHNlbGYKCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvdGhlciA9IHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhvdGhlcikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgUGFyc2VyRWxlbWVudCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIFwiQ2Fubm90IGNvbWJpbmUgZWxlbWVudCBvZiB0eXBlIHt9IHdpdGggUGFyc2VyRWxlbWVudFwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICB0eXBlKG90aGVyKS5fX25hbWVfXwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgcmV0dXJuIG90aGVyICsgc2VsZgoKICAgIGRlZiBfX3N1Yl9fKHNlbGYsIG90aGVyKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBJbXBsZW1lbnRhdGlvbiBvZiBgYC1gYCBvcGVyYXRvciwgcmV0dXJucyA6Y2xhc3M6YEFuZGAgd2l0aCBlcnJvciBzdG9wCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvdGhlciA9IHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhvdGhlcikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgUGFyc2VyRWxlbWVudCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIFwiQ2Fubm90IGNvbWJpbmUgZWxlbWVudCBvZiB0eXBlIHt9IHdpdGggUGFyc2VyRWxlbWVudFwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICB0eXBlKG90aGVyKS5fX25hbWVfXwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgcmV0dXJuIHNlbGYgKyBBbmQuX0Vycm9yU3RvcCgpICsgb3RoZXIKCiAgICBkZWYgX19yc3ViX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgLWBgIG9wZXJhdG9yIHdoZW4gbGVmdCBvcGVyYW5kIGlzIG5vdCBhIDpjbGFzczpgUGFyc2VyRWxlbWVudGAKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKG90aGVyKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBQYXJzZXJFbGVtZW50KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgXCJDYW5ub3QgY29tYmluZSBlbGVtZW50IG9mIHR5cGUge30gd2l0aCBQYXJzZXJFbGVtZW50XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHR5cGUob3RoZXIpLl9fbmFtZV9fCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gb3RoZXIgLSBzZWxmCgogICAgZGVmIF9fbXVsX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgKmBgIG9wZXJhdG9yLCBhbGxvd3MgdXNlIG9mIGBgZXhwciAqIDNgYCBpbiBwbGFjZSBvZgogICAgICAgIGBgZXhwciArIGV4cHIgKyBleHByYGAuICBFeHByZXNzaW9ucyBtYXkgYWxzbyBiZSBtdWx0aXBsaWVkIGJ5IGEgMi1pbnRlZ2VyCiAgICAgICAgdHVwbGUsIHNpbWlsYXIgdG8gYGB7bWluLCBtYXh9YGAgbXVsdGlwbGllcnMgaW4gcmVndWxhciBleHByZXNzaW9ucy4gIFR1cGxlcwogICAgICAgIG1heSBhbHNvIGluY2x1ZGUgYGBOb25lYGAgYXMgaW46CiAgICAgICAgLSBgYGV4cHIqKG4sIE5vbmUpYGAgb3IgYGBleHByKihuLCApYGAgaXMgZXF1aXZhbGVudAogICAgICAgICAgICAgdG8gYGBleHByKm4gKyBaZXJvT3JNb3JlKGV4cHIpYGAKICAgICAgICAgICAgIChyZWFkIGFzIFwiYXQgbGVhc3QgbiBpbnN0YW5jZXMgb2YgYGBleHByYGBcIikKICAgICAgICAtIGBgZXhwciooTm9uZSwgbilgYCBpcyBlcXVpdmFsZW50IHRvIGBgZXhwciooMCwgbilgYAogICAgICAgICAgICAgKHJlYWQgYXMgXCIwIHRvIG4gaW5zdGFuY2VzIG9mIGBgZXhwcmBgXCIpCiAgICAgICAgLSBgYGV4cHIqKE5vbmUsIE5vbmUpYGAgaXMgZXF1aXZhbGVudCB0byBgYFplcm9Pck1vcmUoZXhwcilgYAogICAgICAgIC0gYGBleHByKigxLCBOb25lKWBgIGlzIGVxdWl2YWxlbnQgdG8gYGBPbmVPck1vcmUoZXhwcilgYAoKICAgICAgICBOb3RlIHRoYXQgYGBleHByKihOb25lLCBuKWBgIGRvZXMgbm90IHJhaXNlIGFuIGV4Y2VwdGlvbiBpZgogICAgICAgIG1vcmUgdGhhbiBuIGV4cHJzIGV4aXN0IGluIHRoZSBpbnB1dCBzdHJlYW07IHRoYXQgaXMsCiAgICAgICAgYGBleHByKihOb25lLCBuKWBgIGRvZXMgbm90IGVuZm9yY2UgYSBtYXhpbXVtIG51bWJlciBvZiBleHByCiAgICAgICAgb2NjdXJyZW5jZXMuICBJZiB0aGlzIGJlaGF2aW9yIGlzIGRlc2lyZWQsIHRoZW4gd3JpdGUKICAgICAgICBgYGV4cHIqKE5vbmUsIG4pICsgfmV4cHJgYAogICAgICAgIFwiXCJcIgogICAgICAgIGlmIG90aGVyIGlzIEVsbGlwc2lzOgogICAgICAgICAgICBvdGhlciA9ICgwLCBOb25lKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvdGhlciwgdHVwbGUpIGFuZCBvdGhlcls6MV0gPT0gKEVsbGlwc2lzLCk6CiAgICAgICAgICAgIG90aGVyID0gKCgwLCkgKyBvdGhlclsxOl0gKyAoTm9uZSwpKVs6Ml0KCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgaW50KToKICAgICAgICAgICAgbWluRWxlbWVudHMsIG9wdEVsZW1lbnRzID0gb3RoZXIsIDAKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uob3RoZXIsIHR1cGxlKToKICAgICAgICAgICAgb3RoZXIgPSB0dXBsZShvIGlmIG8gaXMgbm90IEVsbGlwc2lzIGVsc2UgTm9uZSBmb3IgbyBpbiBvdGhlcikKICAgICAgICAgICAgb3RoZXIgPSAob3RoZXIgKyAoTm9uZSwgTm9uZSkpWzoyXQogICAgICAgICAgICBpZiBvdGhlclswXSBpcyBOb25lOgogICAgICAgICAgICAgICAgb3RoZXIgPSAoMCwgb3RoZXJbMV0pCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXJbMF0sIGludCkgYW5kIG90aGVyWzFdIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBpZiBvdGhlclswXSA9PSAwOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBaZXJvT3JNb3JlKHNlbGYpCiAgICAgICAgICAgICAgICBpZiBvdGhlclswXSA9PSAxOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBPbmVPck1vcmUoc2VsZikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYgKiBvdGhlclswXSArIFplcm9Pck1vcmUoc2VsZikKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyWzBdLCBpbnQpIGFuZCBpc2luc3RhbmNlKG90aGVyWzFdLCBpbnQpOgogICAgICAgICAgICAgICAgbWluRWxlbWVudHMsIG9wdEVsZW1lbnRzID0gb3RoZXIKICAgICAgICAgICAgICAgIG9wdEVsZW1lbnRzIC09IG1pbkVsZW1lbnRzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgXCJjYW5ub3QgbXVsdGlwbHkgUGFyc2VyRWxlbWVudCBhbmQgKHt9KSBvYmplY3RzXCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICBcIixcIi5qb2luKHR5cGUoaXRlbSkuX19uYW1lX18gZm9yIGl0ZW0gaW4gb3RoZXIpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIFwiY2Fubm90IG11bHRpcGx5IFBhcnNlckVsZW1lbnQgYW5kIHt9IG9iamVjdHNcIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgdHlwZShvdGhlcikuX19uYW1lX18KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICBpZiBtaW5FbGVtZW50cyA8IDA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoXCJjYW5ub3QgbXVsdGlwbHkgUGFyc2VyRWxlbWVudCBieSBuZWdhdGl2ZSB2YWx1ZVwiKQogICAgICAgIGlmIG9wdEVsZW1lbnRzIDwgMDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgIFwic2Vjb25kIHR1cGxlIHZhbHVlIG11c3QgYmUgZ3JlYXRlciBvciBlcXVhbCB0byBmaXJzdCB0dXBsZSB2YWx1ZVwiCiAgICAgICAgICAgICkKICAgICAgICBpZiBtaW5FbGVtZW50cyA9PSBvcHRFbGVtZW50cyA9PSAwOgogICAgICAgICAgICByZXR1cm4gQW5kKFtdKQoKICAgICAgICBpZiBvcHRFbGVtZW50czoKCiAgICAgICAgICAgIGRlZiBtYWtlT3B0aW9uYWxMaXN0KG4pOgogICAgICAgICAgICAgICAgaWYgbiA+IDE6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9wdChzZWxmICsgbWFrZU9wdGlvbmFsTGlzdChuIC0gMSkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBPcHQoc2VsZikKCiAgICAgICAgICAgIGlmIG1pbkVsZW1lbnRzOgogICAgICAgICAgICAgICAgaWYgbWluRWxlbWVudHMgPT0gMToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzZWxmICsgbWFrZU9wdGlvbmFsTGlzdChvcHRFbGVtZW50cykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gQW5kKFtzZWxmXSAqIG1pbkVsZW1lbnRzKSArIG1ha2VPcHRpb25hbExpc3Qob3B0RWxlbWVudHMpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXQgPSBtYWtlT3B0aW9uYWxMaXN0KG9wdEVsZW1lbnRzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIG1pbkVsZW1lbnRzID09IDE6CiAgICAgICAgICAgICAgICByZXQgPSBzZWxmCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXQgPSBBbmQoW3NlbGZdICogbWluRWxlbWVudHMpCiAgICAgICAgcmV0dXJuIHJldAoKICAgIGRlZiBfX3JtdWxfXyhzZWxmLCBvdGhlcikgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgcmV0dXJuIHNlbGYuX19tdWxfXyhvdGhlcikKCiAgICBkZWYgX19vcl9fKHNlbGYsIG90aGVyKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBJbXBsZW1lbnRhdGlvbiBvZiBgYHxgYCBvcGVyYXRvciAtIHJldHVybnMgOmNsYXNzOmBNYXRjaEZpcnN0YAogICAgICAgIFwiXCJcIgogICAgICAgIGlmIG90aGVyIGlzIEVsbGlwc2lzOgogICAgICAgICAgICByZXR1cm4gX1BlbmRpbmdTa2lwKHNlbGYsIG11c3Rfc2tpcD1UcnVlKQoKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKG90aGVyKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBQYXJzZXJFbGVtZW50KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgXCJDYW5ub3QgY29tYmluZSBlbGVtZW50IG9mIHR5cGUge30gd2l0aCBQYXJzZXJFbGVtZW50XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHR5cGUob3RoZXIpLl9fbmFtZV9fCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gTWF0Y2hGaXJzdChbc2VsZiwgb3RoZXJdKQoKICAgIGRlZiBfX3Jvcl9fKHNlbGYsIG90aGVyKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBJbXBsZW1lbnRhdGlvbiBvZiBgYHxgYCBvcGVyYXRvciB3aGVuIGxlZnQgb3BlcmFuZCBpcyBub3QgYSA6Y2xhc3M6YFBhcnNlckVsZW1lbnRgCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvdGhlciA9IHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhvdGhlcikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgUGFyc2VyRWxlbWVudCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIFwiQ2Fubm90IGNvbWJpbmUgZWxlbWVudCBvZiB0eXBlIHt9IHdpdGggUGFyc2VyRWxlbWVudFwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICB0eXBlKG90aGVyKS5fX25hbWVfXwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgcmV0dXJuIG90aGVyIHwgc2VsZgoKICAgIGRlZiBfX3hvcl9fKHNlbGYsIG90aGVyKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBJbXBsZW1lbnRhdGlvbiBvZiBgYF5gYCBvcGVyYXRvciAtIHJldHVybnMgOmNsYXNzOmBPcmAKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKG90aGVyKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBQYXJzZXJFbGVtZW50KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgXCJDYW5ub3QgY29tYmluZSBlbGVtZW50IG9mIHR5cGUge30gd2l0aCBQYXJzZXJFbGVtZW50XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHR5cGUob3RoZXIpLl9fbmFtZV9fCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gT3IoW3NlbGYsIG90aGVyXSkKCiAgICBkZWYgX19yeG9yX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgXmBgIG9wZXJhdG9yIHdoZW4gbGVmdCBvcGVyYW5kIGlzIG5vdCBhIDpjbGFzczpgUGFyc2VyRWxlbWVudGAKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKG90aGVyKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBQYXJzZXJFbGVtZW50KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgXCJDYW5ub3QgY29tYmluZSBlbGVtZW50IG9mIHR5cGUge30gd2l0aCBQYXJzZXJFbGVtZW50XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHR5cGUob3RoZXIpLl9fbmFtZV9fCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gb3RoZXIgXiBzZWxmCgogICAgZGVmIF9fYW5kX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgJmBgIG9wZXJhdG9yIC0gcmV0dXJucyA6Y2xhc3M6YEVhY2hgCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvdGhlciA9IHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhvdGhlcikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgUGFyc2VyRWxlbWVudCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIFwiQ2Fubm90IGNvbWJpbmUgZWxlbWVudCBvZiB0eXBlIHt9IHdpdGggUGFyc2VyRWxlbWVudFwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICB0eXBlKG90aGVyKS5fX25hbWVfXwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgcmV0dXJuIEVhY2goW3NlbGYsIG90aGVyXSkKCiAgICBkZWYgX19yYW5kX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEltcGxlbWVudGF0aW9uIG9mIGBgJmBgIG9wZXJhdG9yIHdoZW4gbGVmdCBvcGVyYW5kIGlzIG5vdCBhIDpjbGFzczpgUGFyc2VyRWxlbWVudGAKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKG90aGVyKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBQYXJzZXJFbGVtZW50KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgXCJDYW5ub3QgY29tYmluZSBlbGVtZW50IG9mIHR5cGUge30gd2l0aCBQYXJzZXJFbGVtZW50XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHR5cGUob3RoZXIpLl9fbmFtZV9fCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gb3RoZXIgJiBzZWxmCgogICAgZGVmIF9faW52ZXJ0X18oc2VsZikgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgSW1wbGVtZW50YXRpb24gb2YgYGB+YGAgb3BlcmF0b3IgLSByZXR1cm5zIDpjbGFzczpgTm90QW55YAogICAgICAgIFwiXCJcIgogICAgICAgIHJldHVybiBOb3RBbnkoc2VsZikKCiAgICAjIGRpc2FibGUgX19pdGVyX18gdG8gb3ZlcnJpZGUgbGVnYWN5IHVzZSBvZiBzZXF1ZW50aWFsIGFjY2VzcyB0byBfX2dldGl0ZW1fXyB0bwogICAgIyBpdGVyYXRlIG92ZXIgYSBzZXF1ZW5jZQogICAgX19pdGVyX18gPSBOb25lCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgXCJcIlwiCiAgICAgICAgdXNlIGBgW11gYCBpbmRleGluZyBub3RhdGlvbiBhcyBhIHNob3J0IGZvcm0gZm9yIGV4cHJlc3Npb24gcmVwZXRpdGlvbjoKCiAgICAgICAgLSBgYGV4cHJbbl1gYCBpcyBlcXVpdmFsZW50IHRvIGBgZXhwcipuYGAKICAgICAgICAtIGBgZXhwclttLCBuXWBgIGlzIGVxdWl2YWxlbnQgdG8gYGBleHByKihtLCBuKWBgCiAgICAgICAgLSBgYGV4cHJbbiwgLi4uXWBgIG9yIGBgZXhwcltuLF1gYCBpcyBlcXVpdmFsZW50CiAgICAgICAgICAgICB0byBgYGV4cHIqbiArIFplcm9Pck1vcmUoZXhwcilgYAogICAgICAgICAgICAgKHJlYWQgYXMgXCJhdCBsZWFzdCBuIGluc3RhbmNlcyBvZiBgYGV4cHJgYFwiKQogICAgICAgIC0gYGBleHByWy4uLiwgbl1gYCBpcyBlcXVpdmFsZW50IHRvIGBgZXhwciooMCwgbilgYAogICAgICAgICAgICAgKHJlYWQgYXMgXCIwIHRvIG4gaW5zdGFuY2VzIG9mIGBgZXhwcmBgXCIpCiAgICAgICAgLSBgYGV4cHJbLi4uXWBgIGFuZCBgYGV4cHJbMCwgLi4uXWBgIGFyZSBlcXVpdmFsZW50IHRvIGBgWmVyb09yTW9yZShleHByKWBgCiAgICAgICAgLSBgYGV4cHJbMSwgLi4uXWBgIGlzIGVxdWl2YWxlbnQgdG8gYGBPbmVPck1vcmUoZXhwcilgYAoKICAgICAgICBgYE5vbmVgYCBtYXkgYmUgdXNlZCBpbiBwbGFjZSBvZiBgYC4uLmBgLgoKICAgICAgICBOb3RlIHRoYXQgYGBleHByWy4uLiwgbl1gYCBhbmQgYGBleHByW20sIG5dYGBkbyBub3QgcmFpc2UgYW4gZXhjZXB0aW9uCiAgICAgICAgaWYgbW9yZSB0aGFuIGBgbmBgIGBgZXhwcmBgcyBleGlzdCBpbiB0aGUgaW5wdXQgc3RyZWFtLiAgSWYgdGhpcyBiZWhhdmlvciBpcwogICAgICAgIGRlc2lyZWQsIHRoZW4gd3JpdGUgYGBleHByWy4uLiwgbl0gKyB+ZXhwcmBgLgogICAgICAgIFwiXCJcIgoKICAgICAgICAjIGNvbnZlcnQgc2luZ2xlIGFyZyBrZXlzIHRvIHR1cGxlcwogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShrZXksIHN0cl90eXBlKToKICAgICAgICAgICAgICAgIGtleSA9IChrZXksKQogICAgICAgICAgICBpdGVyKGtleSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICBrZXkgPSAoa2V5LCBrZXkpCgogICAgICAgIGlmIGxlbihrZXkpID4gMjoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgXCJvbmx5IDEgb3IgMiBpbmRleCBhcmd1bWVudHMgc3VwcG9ydGVkICh7fXt9KVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBrZXlbOjVdLCBcIi4uLiBbe31dXCIuZm9ybWF0KGxlbihrZXkpKSBpZiBsZW4oa2V5KSA+IDUgZWxzZSBcIlwiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKCiAgICAgICAgIyBjbGlwIHRvIDIgZWxlbWVudHMKICAgICAgICByZXQgPSBzZWxmICogdHVwbGUoa2V5WzoyXSkKICAgICAgICByZXR1cm4gcmV0CgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIG5hbWU6IHN0ciA9IE5vbmUpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIFNob3J0Y3V0IGZvciA6Y2xhc3M6YHNldF9yZXN1bHRzX25hbWVgLCB3aXRoIGBgbGlzdF9hbGxfbWF0Y2hlcz1GYWxzZWBgLgoKICAgICAgICBJZiBgYG5hbWVgYCBpcyBnaXZlbiB3aXRoIGEgdHJhaWxpbmcgYGAnKidgYCBjaGFyYWN0ZXIsIHRoZW4gYGBsaXN0X2FsbF9tYXRjaGVzYGAgd2lsbCBiZQogICAgICAgIHBhc3NlZCBhcyBgYFRydWVgYC4KCiAgICAgICAgSWYgYGBuYW1lYCBpcyBvbWl0dGVkLCBzYW1lIGFzIGNhbGxpbmcgOmNsYXNzOmBjb3B5YC4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICAjIHRoZXNlIGFyZSBlcXVpdmFsZW50CiAgICAgICAgICAgIHVzZXJkYXRhID0gV29yZChhbHBoYXMpLnNldF9yZXN1bHRzX25hbWUoXCJuYW1lXCIpICsgV29yZChudW1zICsgXCItXCIpLnNldF9yZXN1bHRzX25hbWUoXCJzb2NzZWNub1wiKQogICAgICAgICAgICB1c2VyZGF0YSA9IFdvcmQoYWxwaGFzKShcIm5hbWVcIikgKyBXb3JkKG51bXMgKyBcIi1cIikoXCJzb2NzZWNub1wiKQogICAgICAgIFwiXCJcIgogICAgICAgIGlmIG5hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9zZXRSZXN1bHRzTmFtZShuYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmNvcHkoKQoKICAgIGRlZiBzdXBwcmVzcyhzZWxmKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBTdXBwcmVzc2VzIHRoZSBvdXRwdXQgb2YgdGhpcyA6Y2xhc3M6YFBhcnNlckVsZW1lbnRgOyB1c2VmdWwgdG8ga2VlcCBwdW5jdHVhdGlvbiBmcm9tCiAgICAgICAgY2x1dHRlcmluZyB1cCByZXR1cm5lZCBvdXRwdXQuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIFN1cHByZXNzKHNlbGYpCgogICAgZGVmIGlnbm9yZV93aGl0ZXNwYWNlKHNlbGYsIHJlY3Vyc2l2ZTogYm9vbCA9IFRydWUpIC0+IFwiUGFyc2VyRWxlbWVudFwiOgogICAgICAgIFwiXCJcIgogICAgICAgIEVuYWJsZXMgdGhlIHNraXBwaW5nIG9mIHdoaXRlc3BhY2UgYmVmb3JlIG1hdGNoaW5nIHRoZSBjaGFyYWN0ZXJzIGluIHRoZQogICAgICAgIDpjbGFzczpgUGFyc2VyRWxlbWVudGAncyBkZWZpbmVkIHBhdHRlcm4uCgogICAgICAgIDpwYXJhbSByZWN1cnNpdmU6IElmIGBgVHJ1ZWBgICh0aGUgZGVmYXVsdCksIGFsc28gZW5hYmxlIHdoaXRlc3BhY2Ugc2tpcHBpbmcgaW4gY2hpbGQgZWxlbWVudHMgKGlmIGFueSkKICAgICAgICBcIlwiXCIKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gVHJ1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIGxlYXZlX3doaXRlc3BhY2Uoc2VsZiwgcmVjdXJzaXZlOiBib29sID0gVHJ1ZSkgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRGlzYWJsZXMgdGhlIHNraXBwaW5nIG9mIHdoaXRlc3BhY2UgYmVmb3JlIG1hdGNoaW5nIHRoZSBjaGFyYWN0ZXJzIGluIHRoZQogICAgICAgIDpjbGFzczpgUGFyc2VyRWxlbWVudGAncyBkZWZpbmVkIHBhdHRlcm4uICBUaGlzIGlzIG5vcm1hbGx5IG9ubHkgdXNlZCBpbnRlcm5hbGx5IGJ5CiAgICAgICAgdGhlIHB5cGFyc2luZyBtb2R1bGUsIGJ1dCBtYXkgYmUgbmVlZGVkIGluIHNvbWUgd2hpdGVzcGFjZS1zZW5zaXRpdmUgZ3JhbW1hcnMuCgogICAgICAgIDpwYXJhbSByZWN1cnNpdmU6IElmIHRydWUgKHRoZSBkZWZhdWx0KSwgYWxzbyBkaXNhYmxlIHdoaXRlc3BhY2Ugc2tpcHBpbmcgaW4gY2hpbGQgZWxlbWVudHMgKGlmIGFueSkKICAgICAgICBcIlwiXCIKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gRmFsc2UKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBzZXRfd2hpdGVzcGFjZV9jaGFycygKICAgICAgICBzZWxmLCBjaGFyczogVW5pb25bU2V0W3N0cl0sIHN0cl0sIGNvcHlfZGVmYXVsdHM6IGJvb2wgPSBGYWxzZQogICAgKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBPdmVycmlkZXMgdGhlIGRlZmF1bHQgd2hpdGVzcGFjZSBjaGFycwogICAgICAgIFwiXCJcIgogICAgICAgIHNlbGYuc2tpcFdoaXRlc3BhY2UgPSBUcnVlCiAgICAgICAgc2VsZi53aGl0ZUNoYXJzID0gc2V0KGNoYXJzKQogICAgICAgIHNlbGYuY29weURlZmF1bHRXaGl0ZUNoYXJzID0gY29weV9kZWZhdWx0cwogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHBhcnNlX3dpdGhfdGFicyhzZWxmKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBPdmVycmlkZXMgZGVmYXVsdCBiZWhhdmlvciB0byBleHBhbmQgYGA8VEFCPmBgIHMgdG8gc3BhY2VzIGJlZm9yZSBwYXJzaW5nIHRoZSBpbnB1dCBzdHJpbmcuCiAgICAgICAgTXVzdCBiZSBjYWxsZWQgYmVmb3JlIGBgcGFyc2Vfc3RyaW5nYGAgd2hlbiB0aGUgaW5wdXQgZ3JhbW1hciBjb250YWlucyBlbGVtZW50cyB0aGF0CiAgICAgICAgbWF0Y2ggYGA8VEFCPmBgIGNoYXJhY3RlcnMuCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi5rZWVwVGFicyA9IFRydWUKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBpZ25vcmUoc2VsZiwgb3RoZXI6IFwiUGFyc2VyRWxlbWVudFwiKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBcIlwiXCIKICAgICAgICBEZWZpbmUgZXhwcmVzc2lvbiB0byBiZSBpZ25vcmVkIChlLmcuLCBjb21tZW50cykgd2hpbGUgZG9pbmcgcGF0dGVybgogICAgICAgIG1hdGNoaW5nOyBtYXkgYmUgY2FsbGVkIHJlcGVhdGVkbHksIHRvIGRlZmluZSBtdWx0aXBsZSBjb21tZW50IG9yIG90aGVyCiAgICAgICAgaWdub3JhYmxlIHBhdHRlcm5zLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIHBhdHQgPSBXb3JkKGFscGhhcylbMSwgLi4uXQogICAgICAgICAgICBwYXR0LnBhcnNlX3N0cmluZygnYWJsYWogLyogY29tbWVudCAqLyBsc2tqZCcpCiAgICAgICAgICAgICMgLT4gWydhYmxhaiddCgogICAgICAgICAgICBwYXR0Lmlnbm9yZShjX3N0eWxlX2NvbW1lbnQpCiAgICAgICAgICAgIHBhdHQucGFyc2Vfc3RyaW5nKCdhYmxhaiAvKiBjb21tZW50ICovIGxza2pkJykKICAgICAgICAgICAgIyAtPiBbJ2FibGFqJywgJ2xza2pkJ10KICAgICAgICBcIlwiXCIKICAgICAgICBpbXBvcnQgdHlwaW5nCgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHN0cl90eXBlKToKICAgICAgICAgICAgb3RoZXIgPSBTdXBwcmVzcyhvdGhlcikKCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgU3VwcHJlc3MpOgogICAgICAgICAgICBpZiBvdGhlciBub3QgaW4gc2VsZi5pZ25vcmVFeHByczoKICAgICAgICAgICAgICAgIHNlbGYuaWdub3JlRXhwcnMuYXBwZW5kKG90aGVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaWdub3JlRXhwcnMuYXBwZW5kKFN1cHByZXNzKG90aGVyLmNvcHkoKSkpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgc2V0X2RlYnVnX2FjdGlvbnMoCiAgICAgICAgc2VsZiwKICAgICAgICBzdGFydF9hY3Rpb246IERlYnVnU3RhcnRBY3Rpb24sCiAgICAgICAgc3VjY2Vzc19hY3Rpb246IERlYnVnU3VjY2Vzc0FjdGlvbiwKICAgICAgICBleGNlcHRpb25fYWN0aW9uOiBEZWJ1Z0V4Y2VwdGlvbkFjdGlvbiwKICAgICkgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgQ3VzdG9taXplIGRpc3BsYXkgb2YgZGVidWdnaW5nIG1lc3NhZ2VzIHdoaWxlIGRvaW5nIHBhdHRlcm4gbWF0Y2hpbmc6CgogICAgICAgIC0gYGBzdGFydF9hY3Rpb25gYCAtIG1ldGhvZCB0byBiZSBjYWxsZWQgd2hlbiBhbiBleHByZXNzaW9uIGlzIGFib3V0IHRvIGJlIHBhcnNlZDsKICAgICAgICAgIHNob3VsZCBoYXZlIHRoZSBzaWduYXR1cmUgYGBmbihpbnB1dF9zdHJpbmc6IHN0ciwgbG9jYXRpb246IGludCwgZXhwcmVzc2lvbjogUGFyc2VyRWxlbWVudCwgY2FjaGVfaGl0OiBib29sKWBgCgogICAgICAgIC0gYGBzdWNjZXNzX2FjdGlvbmBgIC0gbWV0aG9kIHRvIGJlIGNhbGxlZCB3aGVuIGFuIGV4cHJlc3Npb24gaGFzIHN1Y2Nlc3NmdWxseSBwYXJzZWQ7CiAgICAgICAgICBzaG91bGQgaGF2ZSB0aGUgc2lnbmF0dXJlIGBgZm4oaW5wdXRfc3RyaW5nOiBzdHIsIHN0YXJ0X2xvY2F0aW9uOiBpbnQsIGVuZF9sb2NhdGlvbjogaW50LCBleHByZXNzaW9uOiBQYXJzZXJFTGVtZW50LCBwYXJzZWRfdG9rZW5zOiBQYXJzZVJlc3VsdHMsIGNhY2hlX2hpdDogYm9vbClgYAoKICAgICAgICAtIGBgZXhjZXB0aW9uX2FjdGlvbmBgIC0gbWV0aG9kIHRvIGJlIGNhbGxlZCB3aGVuIGV4cHJlc3Npb24gZmFpbHMgdG8gcGFyc2U7CiAgICAgICAgICBzaG91bGQgaGF2ZSB0aGUgc2lnbmF0dXJlIGBgZm4oaW5wdXRfc3RyaW5nOiBzdHIsIGxvY2F0aW9uOiBpbnQsIGV4cHJlc3Npb246IFBhcnNlckVsZW1lbnQsIGV4Y2VwdGlvbjogRXhjZXB0aW9uLCBjYWNoZV9oaXQ6IGJvb2wpYGAKICAgICAgICBcIlwiXCIKICAgICAgICBzZWxmLmRlYnVnQWN0aW9ucyA9IHNlbGYuRGVidWdBY3Rpb25zKAogICAgICAgICAgICBzdGFydF9hY3Rpb24gb3IgX2RlZmF1bHRfc3RhcnRfZGVidWdfYWN0aW9uLAogICAgICAgICAgICBzdWNjZXNzX2FjdGlvbiBvciBfZGVmYXVsdF9zdWNjZXNzX2RlYnVnX2FjdGlvbiwKICAgICAgICAgICAgZXhjZXB0aW9uX2FjdGlvbiBvciBfZGVmYXVsdF9leGNlcHRpb25fZGVidWdfYWN0aW9uLAogICAgICAgICkKICAgICAgICBzZWxmLmRlYnVnID0gVHJ1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHNldF9kZWJ1ZyhzZWxmLCBmbGFnOiBib29sID0gVHJ1ZSkgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRW5hYmxlIGRpc3BsYXkgb2YgZGVidWdnaW5nIG1lc3NhZ2VzIHdoaWxlIGRvaW5nIHBhdHRlcm4gbWF0Y2hpbmcuCiAgICAgICAgU2V0IGBgZmxhZ2BgIHRvIGBgVHJ1ZWBgIHRvIGVuYWJsZSwgYGBGYWxzZWBgIHRvIGRpc2FibGUuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgd2QgPSBXb3JkKGFscGhhcykuc2V0X25hbWUoXCJhbHBoYXdvcmRcIikKICAgICAgICAgICAgaW50ZWdlciA9IFdvcmQobnVtcykuc2V0X25hbWUoXCJudW13b3JkXCIpCiAgICAgICAgICAgIHRlcm0gPSB3ZCB8IGludGVnZXIKCiAgICAgICAgICAgICMgdHVybiBvbiBkZWJ1Z2dpbmcgZm9yIHdkCiAgICAgICAgICAgIHdkLnNldF9kZWJ1ZygpCgogICAgICAgICAgICB0ZXJtWzEsIC4uLl0ucGFyc2Vfc3RyaW5nKFwiYWJjIDEyMyB4eXogODkwXCIpCgogICAgICAgIHByaW50czo6CgogICAgICAgICAgICBNYXRjaCBhbHBoYXdvcmQgYXQgbG9jIDAoMSwxKQogICAgICAgICAgICBNYXRjaGVkIGFscGhhd29yZCAtPiBbJ2FiYyddCiAgICAgICAgICAgIE1hdGNoIGFscGhhd29yZCBhdCBsb2MgMygxLDQpCiAgICAgICAgICAgIEV4Y2VwdGlvbiByYWlzZWQ6RXhwZWN0ZWQgYWxwaGF3b3JkIChhdCBjaGFyIDQpLCAobGluZToxLCBjb2w6NSkKICAgICAgICAgICAgTWF0Y2ggYWxwaGF3b3JkIGF0IGxvYyA3KDEsOCkKICAgICAgICAgICAgTWF0Y2hlZCBhbHBoYXdvcmQgLT4gWyd4eXonXQogICAgICAgICAgICBNYXRjaCBhbHBoYXdvcmQgYXQgbG9jIDExKDEsMTIpCiAgICAgICAgICAgIEV4Y2VwdGlvbiByYWlzZWQ6RXhwZWN0ZWQgYWxwaGF3b3JkIChhdCBjaGFyIDEyKSwgKGxpbmU6MSwgY29sOjEzKQogICAgICAgICAgICBNYXRjaCBhbHBoYXdvcmQgYXQgbG9jIDE1KDEsMTYpCiAgICAgICAgICAgIEV4Y2VwdGlvbiByYWlzZWQ6RXhwZWN0ZWQgYWxwaGF3b3JkIChhdCBjaGFyIDE1KSwgKGxpbmU6MSwgY29sOjE2KQoKICAgICAgICBUaGUgb3V0cHV0IHNob3duIGlzIHRoYXQgcHJvZHVjZWQgYnkgdGhlIGRlZmF1bHQgZGVidWcgYWN0aW9ucyAtIGN1c3RvbSBkZWJ1ZyBhY3Rpb25zIGNhbiBiZQogICAgICAgIHNwZWNpZmllZCB1c2luZyA6Y2xhc3M6YHNldF9kZWJ1Z19hY3Rpb25zYC4gUHJpb3IgdG8gYXR0ZW1wdGluZwogICAgICAgIHRvIG1hdGNoIHRoZSBgYHdkYGAgZXhwcmVzc2lvbiwgdGhlIGRlYnVnZ2luZyBtZXNzYWdlIGBgXCJNYXRjaCA8ZXhwcm5hbWU+IGF0IGxvYyA8bj4oPGxpbmU+LDxjb2w+KVwiYGAKICAgICAgICBpcyBzaG93bi4gVGhlbiBpZiB0aGUgcGFyc2Ugc3VjY2VlZHMsIGEgYGBcIk1hdGNoZWRcImBgIG1lc3NhZ2UgaXMgc2hvd24sIG9yIGFuIGBgXCJFeGNlcHRpb24gcmFpc2VkXCJgYAogICAgICAgIG1lc3NhZ2UgaXMgc2hvd24uIEFsc28gbm90ZSB0aGUgdXNlIG9mIDpjbGFzczpgc2V0X25hbWVgIHRvIGFzc2lnbiBhIGh1bWFuLXJlYWRhYmxlIG5hbWUgdG8gdGhlIGV4cHJlc3Npb24sCiAgICAgICAgd2hpY2ggbWFrZXMgZGVidWdnaW5nIGFuZCBleGNlcHRpb24gbWVzc2FnZXMgZWFzaWVyIHRvIHVuZGVyc3RhbmQgLSBmb3IgaW5zdGFuY2UsIHRoZSBkZWZhdWx0CiAgICAgICAgbmFtZSBjcmVhdGVkIGZvciB0aGUgOmNsYXNzOmBXb3JkYCBleHByZXNzaW9uIHdpdGhvdXQgY2FsbGluZyBgYHNldF9uYW1lYGAgaXMgYGBcIlc6KEEtWmEteilcImBgLgogICAgICAgIFwiXCJcIgogICAgICAgIGlmIGZsYWc6CiAgICAgICAgICAgIHNlbGYuc2V0X2RlYnVnX2FjdGlvbnMoCiAgICAgICAgICAgICAgICBfZGVmYXVsdF9zdGFydF9kZWJ1Z19hY3Rpb24sCiAgICAgICAgICAgICAgICBfZGVmYXVsdF9zdWNjZXNzX2RlYnVnX2FjdGlvbiwKICAgICAgICAgICAgICAgIF9kZWZhdWx0X2V4Y2VwdGlvbl9kZWJ1Z19hY3Rpb24sCiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmRlYnVnID0gRmFsc2UKICAgICAgICByZXR1cm4gc2VsZgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGRlZmF1bHRfbmFtZShzZWxmKSAtPiBzdHI6CiAgICAgICAgaWYgc2VsZi5fZGVmYXVsdE5hbWUgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5fZGVmYXVsdE5hbWUgPSBzZWxmLl9nZW5lcmF0ZURlZmF1bHROYW1lKCkKICAgICAgICByZXR1cm4gc2VsZi5fZGVmYXVsdE5hbWUKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICBcIlwiXCIKICAgICAgICBDaGlsZCBjbGFzc2VzIG11c3QgZGVmaW5lIHRoaXMgbWV0aG9kLCB3aGljaCBkZWZpbmVzIGhvdyB0aGUgYGBkZWZhdWx0X25hbWVgYCBpcyBzZXQuCiAgICAgICAgXCJcIlwiCgogICAgZGVmIHNldF9uYW1lKHNlbGYsIG5hbWU6IHN0cikgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRGVmaW5lIG5hbWUgZm9yIHRoaXMgZXhwcmVzc2lvbiwgbWFrZXMgZGVidWdnaW5nIGFuZCBleGNlcHRpb24gbWVzc2FnZXMgY2xlYXJlci4KICAgICAgICBFeGFtcGxlOjoKICAgICAgICAgICAgV29yZChudW1zKS5wYXJzZV9zdHJpbmcoXCJBQkNcIikgICMgLT4gRXhjZXB0aW9uOiBFeHBlY3RlZCBXOigwLTkpIChhdCBjaGFyIDApLCAobGluZToxLCBjb2w6MSkKICAgICAgICAgICAgV29yZChudW1zKS5zZXRfbmFtZShcImludGVnZXJcIikucGFyc2Vfc3RyaW5nKFwiQUJDXCIpICAjIC0+IEV4Y2VwdGlvbjogRXhwZWN0ZWQgaW50ZWdlciAoYXQgY2hhciAwKSwgKGxpbmU6MSwgY29sOjEpCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi5jdXN0b21OYW1lID0gbmFtZQogICAgICAgIHNlbGYuZXJybXNnID0gXCJFeHBlY3RlZCBcIiArIHNlbGYubmFtZQogICAgICAgIGlmIF9fZGlhZ19fLmVuYWJsZV9kZWJ1Z19vbl9uYW1lZF9leHByZXNzaW9uczoKICAgICAgICAgICAgc2VsZi5zZXRfZGVidWcoKQogICAgICAgIHJldHVybiBzZWxmCgogICAgQHByb3BlcnR5CiAgICBkZWYgbmFtZShzZWxmKSAtPiBzdHI6CiAgICAgICAgIyBUaGlzIHdpbGwgdXNlIGEgdXNlci1kZWZpbmVkIG5hbWUgaWYgYXZhaWxhYmxlLCBidXQgb3RoZXJ3aXNlIGRlZmF1bHRzIGJhY2sgdG8gdGhlIGF1dG8tZ2VuZXJhdGVkIG5hbWUKICAgICAgICByZXR1cm4gc2VsZi5jdXN0b21OYW1lIGlmIHNlbGYuY3VzdG9tTmFtZSBpcyBub3QgTm9uZSBlbHNlIHNlbGYuZGVmYXVsdF9uYW1lCgogICAgZGVmIF9fc3RyX18oc2VsZikgLT4gc3RyOgogICAgICAgIHJldHVybiBzZWxmLm5hbWUKCiAgICBkZWYgX19yZXByX18oc2VsZikgLT4gc3RyOgogICAgICAgIHJldHVybiBzdHIoc2VsZikKCiAgICBkZWYgc3RyZWFtbGluZShzZWxmKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBzZWxmLnN0cmVhbWxpbmVkID0gVHJ1ZQogICAgICAgIHNlbGYuX2RlZmF1bHROYW1lID0gTm9uZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHJlY3Vyc2Uoc2VsZikgLT4gU2VxdWVuY2VbXCJQYXJzZXJFbGVtZW50XCJdOgogICAgICAgIHJldHVybiBbXQoKICAgIGRlZiBfY2hlY2tSZWN1cnNpb24oc2VsZiwgcGFyc2VFbGVtZW50TGlzdCk6CiAgICAgICAgc3ViUmVjQ2hlY2tMaXN0ID0gcGFyc2VFbGVtZW50TGlzdFs6XSArIFtzZWxmXQogICAgICAgIGZvciBlIGluIHNlbGYucmVjdXJzZSgpOgogICAgICAgICAgICBlLl9jaGVja1JlY3Vyc2lvbihzdWJSZWNDaGVja0xpc3QpCgogICAgZGVmIHZhbGlkYXRlKHNlbGYsIHZhbGlkYXRlVHJhY2U9Tm9uZSkgLT4gTm9uZToKICAgICAgICBcIlwiXCIKICAgICAgICBDaGVjayBkZWZpbmVkIGV4cHJlc3Npb25zIGZvciB2YWxpZCBzdHJ1Y3R1cmUsIGNoZWNrIGZvciBpbmZpbml0ZSByZWN1cnNpdmUgZGVmaW5pdGlvbnMuCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi5fY2hlY2tSZWN1cnNpb24oW10pCgogICAgZGVmIHBhcnNlX2ZpbGUoCiAgICAgICAgc2VsZiwKICAgICAgICBmaWxlX29yX2ZpbGVuYW1lOiBVbmlvbltzdHIsIFBhdGgsIFRleHRJT10sCiAgICAgICAgZW5jb2Rpbmc6IHN0ciA9IFwidXRmLThcIiwKICAgICAgICBwYXJzZV9hbGw6IGJvb2wgPSBGYWxzZSwKICAgICAgICAqLAogICAgICAgIHBhcnNlQWxsOiBib29sID0gRmFsc2UsCiAgICApIC0+IFBhcnNlUmVzdWx0czoKICAgICAgICBcIlwiXCIKICAgICAgICBFeGVjdXRlIHRoZSBwYXJzZSBleHByZXNzaW9uIG9uIHRoZSBnaXZlbiBmaWxlIG9yIGZpbGVuYW1lLgogICAgICAgIElmIGEgZmlsZW5hbWUgaXMgc3BlY2lmaWVkIChpbnN0ZWFkIG9mIGEgZmlsZSBvYmplY3QpLAogICAgICAgIHRoZSBlbnRpcmUgZmlsZSBpcyBvcGVuZWQsIHJlYWQsIGFuZCBjbG9zZWQgYmVmb3JlIHBhcnNpbmcuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcGFyc2VBbGwgPSBwYXJzZUFsbCBvciBwYXJzZV9hbGwKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZpbGVfY29udGVudHMgPSBmaWxlX29yX2ZpbGVuYW1lLnJlYWQoKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgd2l0aCBvcGVuKGZpbGVfb3JfZmlsZW5hbWUsIFwiclwiLCBlbmNvZGluZz1lbmNvZGluZykgYXMgZjoKICAgICAgICAgICAgICAgIGZpbGVfY29udGVudHMgPSBmLnJlYWQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIHNlbGYucGFyc2Vfc3RyaW5nKGZpbGVfY29udGVudHMsIHBhcnNlQWxsKQogICAgICAgIGV4Y2VwdCBQYXJzZUJhc2VFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICBpZiBQYXJzZXJFbGVtZW50LnZlcmJvc2Vfc3RhY2t0cmFjZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIGNhdGNoIGFuZCByZS1yYWlzZSBleGNlcHRpb24gZnJvbSBoZXJlLCBjbGVhcnMgb3V0IHB5cGFyc2luZyBpbnRlcm5hbCBzdGFjayB0cmFjZQogICAgICAgICAgICAgICAgcmFpc2UgZXhjLndpdGhfdHJhY2ViYWNrKE5vbmUpCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgc2VsZiBpcyBvdGhlcjoKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uob3RoZXIsIHN0cl90eXBlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYubWF0Y2hlcyhvdGhlciwgcGFyc2VfYWxsPVRydWUpCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyLCBQYXJzZXJFbGVtZW50KToKICAgICAgICAgICAgcmV0dXJuIHZhcnMoc2VsZikgPT0gdmFycyhvdGhlcikKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGlkKHNlbGYpCgogICAgZGVmIG1hdGNoZXMoCiAgICAgICAgc2VsZiwgdGVzdF9zdHJpbmc6IHN0ciwgcGFyc2VfYWxsOiBib29sID0gVHJ1ZSwgKiwgcGFyc2VBbGw6IGJvb2wgPSBUcnVlCiAgICApIC0+IGJvb2w6CiAgICAgICAgXCJcIlwiCiAgICAgICAgTWV0aG9kIGZvciBxdWljayB0ZXN0aW5nIG9mIGEgcGFyc2VyIGFnYWluc3QgYSB0ZXN0IHN0cmluZy4gR29vZCBmb3Igc2ltcGxlCiAgICAgICAgaW5saW5lIG1pY3JvdGVzdHMgb2Ygc3ViIGV4cHJlc3Npb25zIHdoaWxlIGJ1aWxkaW5nIHVwIGxhcmdlciBwYXJzZXIuCgogICAgICAgIFBhcmFtZXRlcnM6CiAgICAgICAgLSBgYHRlc3Rfc3RyaW5nYGAgLSB0byB0ZXN0IGFnYWluc3QgdGhpcyBleHByZXNzaW9uIGZvciBhIG1hdGNoCiAgICAgICAgLSBgYHBhcnNlX2FsbGBgIC0gKGRlZmF1bHQ9IGBgVHJ1ZWBgKSAtIGZsYWcgdG8gcGFzcyB0byA6Y2xhc3M6YHBhcnNlX3N0cmluZ2Agd2hlbiBydW5uaW5nIHRlc3RzCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgZXhwciA9IFdvcmQobnVtcykKICAgICAgICAgICAgYXNzZXJ0IGV4cHIubWF0Y2hlcyhcIjEwMFwiKQogICAgICAgIFwiXCJcIgogICAgICAgIHBhcnNlQWxsID0gcGFyc2VBbGwgYW5kIHBhcnNlX2FsbAogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5wYXJzZV9zdHJpbmcoc3RyKHRlc3Rfc3RyaW5nKSwgcGFyc2VfYWxsPXBhcnNlQWxsKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdCBQYXJzZUJhc2VFeGNlcHRpb246CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBydW5fdGVzdHMoCiAgICAgICAgc2VsZiwKICAgICAgICB0ZXN0czogVW5pb25bc3RyLCBMaXN0W3N0cl1dLAogICAgICAgIHBhcnNlX2FsbDogYm9vbCA9IFRydWUsCiAgICAgICAgY29tbWVudDogdHlwaW5nLk9wdGlvbmFsW1VuaW9uW1wiUGFyc2VyRWxlbWVudFwiLCBzdHJdXSA9IFwiI1wiLAogICAgICAgIGZ1bGxfZHVtcDogYm9vbCA9IFRydWUsCiAgICAgICAgcHJpbnRfcmVzdWx0czogYm9vbCA9IFRydWUsCiAgICAgICAgZmFpbHVyZV90ZXN0czogYm9vbCA9IEZhbHNlLAogICAgICAgIHBvc3RfcGFyc2U6IENhbGxhYmxlW1tzdHIsIFBhcnNlUmVzdWx0c10sIHN0cl0gPSBOb25lLAogICAgICAgIGZpbGU6IHR5cGluZy5PcHRpb25hbFtUZXh0SU9dID0gTm9uZSwKICAgICAgICB3aXRoX2xpbmVfbnVtYmVyczogYm9vbCA9IEZhbHNlLAogICAgICAgICosCiAgICAgICAgcGFyc2VBbGw6IGJvb2wgPSBUcnVlLAogICAgICAgIGZ1bGxEdW1wOiBib29sID0gVHJ1ZSwKICAgICAgICBwcmludFJlc3VsdHM6IGJvb2wgPSBUcnVlLAogICAgICAgIGZhaWx1cmVUZXN0czogYm9vbCA9IEZhbHNlLAogICAgICAgIHBvc3RQYXJzZTogQ2FsbGFibGVbW3N0ciwgUGFyc2VSZXN1bHRzXSwgc3RyXSA9IE5vbmUsCiAgICApIC0+IFR1cGxlW2Jvb2wsIExpc3RbVHVwbGVbc3RyLCBVbmlvbltQYXJzZVJlc3VsdHMsIEV4Y2VwdGlvbl1dXV06CiAgICAgICAgXCJcIlwiCiAgICAgICAgRXhlY3V0ZSB0aGUgcGFyc2UgZXhwcmVzc2lvbiBvbiBhIHNlcmllcyBvZiB0ZXN0IHN0cmluZ3MsIHNob3dpbmcgZWFjaAogICAgICAgIHRlc3QsIHRoZSBwYXJzZWQgcmVzdWx0cyBvciB3aGVyZSB0aGUgcGFyc2UgZmFpbGVkLiBRdWljayBhbmQgZWFzeSB3YXkgdG8KICAgICAgICBydW4gYSBwYXJzZSBleHByZXNzaW9uIGFnYWluc3QgYSBsaXN0IG9mIHNhbXBsZSBzdHJpbmdzLgoKICAgICAgICBQYXJhbWV0ZXJzOgogICAgICAgIC0gYGB0ZXN0c2BgIC0gYSBsaXN0IG9mIHNlcGFyYXRlIHRlc3Qgc3RyaW5ncywgb3IgYSBtdWx0aWxpbmUgc3RyaW5nIG9mIHRlc3Qgc3RyaW5ncwogICAgICAgIC0gYGBwYXJzZV9hbGxgYCAtIChkZWZhdWx0PSBgYFRydWVgYCkgLSBmbGFnIHRvIHBhc3MgdG8gOmNsYXNzOmBwYXJzZV9zdHJpbmdgIHdoZW4gcnVubmluZyB0ZXN0cwogICAgICAgIC0gYGBjb21tZW50YGAgLSAoZGVmYXVsdD0gYGAnIydgYCkgLSBleHByZXNzaW9uIGZvciBpbmRpY2F0aW5nIGVtYmVkZGVkIGNvbW1lbnRzIGluIHRoZSB0ZXN0CiAgICAgICAgICBzdHJpbmc7IHBhc3MgTm9uZSB0byBkaXNhYmxlIGNvbW1lbnQgZmlsdGVyaW5nCiAgICAgICAgLSBgYGZ1bGxfZHVtcGBgIC0gKGRlZmF1bHQ9IGBgVHJ1ZWBgKSAtIGR1bXAgcmVzdWx0cyBhcyBsaXN0IGZvbGxvd2VkIGJ5IHJlc3VsdHMgbmFtZXMgaW4gbmVzdGVkIG91dGxpbmU7CiAgICAgICAgICBpZiBGYWxzZSwgb25seSBkdW1wIG5lc3RlZCBsaXN0CiAgICAgICAgLSBgYHByaW50X3Jlc3VsdHNgYCAtIChkZWZhdWx0PSBgYFRydWVgYCkgcHJpbnRzIHRlc3Qgb3V0cHV0IHRvIHN0ZG91dAogICAgICAgIC0gYGBmYWlsdXJlX3Rlc3RzYGAgLSAoZGVmYXVsdD0gYGBGYWxzZWBgKSBpbmRpY2F0ZXMgaWYgdGhlc2UgdGVzdHMgYXJlIGV4cGVjdGVkIHRvIGZhaWwgcGFyc2luZwogICAgICAgIC0gYGBwb3N0X3BhcnNlYGAgLSAoZGVmYXVsdD0gYGBOb25lYGApIG9wdGlvbmFsIGNhbGxiYWNrIGZvciBzdWNjZXNzZnVsIHBhcnNlIHJlc3VsdHM7IGNhbGxlZCBhcwogICAgICAgICAgYGZuKHRlc3Rfc3RyaW5nLCBwYXJzZV9yZXN1bHRzKWAgYW5kIHJldHVybnMgYSBzdHJpbmcgdG8gYmUgYWRkZWQgdG8gdGhlIHRlc3Qgb3V0cHV0CiAgICAgICAgLSBgYGZpbGVgYCAtIChkZWZhdWx0PSBgYE5vbmVgYCkgb3B0aW9uYWwgZmlsZS1saWtlIG9iamVjdCB0byB3aGljaCB0ZXN0IG91dHB1dCB3aWxsIGJlIHdyaXR0ZW47CiAgICAgICAgICBpZiBOb25lLCB3aWxsIGRlZmF1bHQgdG8gYGBzeXMuc3Rkb3V0YGAKICAgICAgICAtIGBgd2l0aF9saW5lX251bWJlcnNgYCAtIGRlZmF1bHQ9IGBgRmFsc2VgYCkgc2hvdyB0ZXN0IHN0cmluZ3Mgd2l0aCBsaW5lIGFuZCBjb2x1bW4gbnVtYmVycwoKICAgICAgICBSZXR1cm5zOiBhIChzdWNjZXNzLCByZXN1bHRzKSB0dXBsZSwgd2hlcmUgc3VjY2VzcyBpbmRpY2F0ZXMgdGhhdCBhbGwgdGVzdHMgc3VjY2VlZGVkCiAgICAgICAgKG9yIGZhaWxlZCBpZiBgYGZhaWx1cmVfdGVzdHNgYCBpcyBUcnVlKSwgYW5kIHRoZSByZXN1bHRzIGNvbnRhaW4gYSBsaXN0IG9mIGxpbmVzIG9mIGVhY2gKICAgICAgICB0ZXN0J3Mgb3V0cHV0CgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgbnVtYmVyX2V4cHIgPSBweXBhcnNpbmdfY29tbW9uLm51bWJlci5jb3B5KCkKCiAgICAgICAgICAgIHJlc3VsdCA9IG51bWJlcl9leHByLnJ1bl90ZXN0cygnJycKICAgICAgICAgICAgICAgICMgdW5zaWduZWQgaW50ZWdlcgogICAgICAgICAgICAgICAgMTAwCiAgICAgICAgICAgICAgICAjIG5lZ2F0aXZlIGludGVnZXIKICAgICAgICAgICAgICAgIC0xMDAKICAgICAgICAgICAgICAgICMgZmxvYXQgd2l0aCBzY2llbnRpZmljIG5vdGF0aW9uCiAgICAgICAgICAgICAgICA2LjAyZTIzCiAgICAgICAgICAgICAgICAjIGludGVnZXIgd2l0aCBzY2llbnRpZmljIG5vdGF0aW9uCiAgICAgICAgICAgICAgICAxZS0xMgogICAgICAgICAgICAgICAgJycnKQogICAgICAgICAgICBwcmludChcIlN1Y2Nlc3NcIiBpZiByZXN1bHRbMF0gZWxzZSBcIkZhaWxlZCFcIikKCiAgICAgICAgICAgIHJlc3VsdCA9IG51bWJlcl9leHByLnJ1bl90ZXN0cygnJycKICAgICAgICAgICAgICAgICMgc3RyYXkgY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAxMDBaCiAgICAgICAgICAgICAgICAjIG1pc3NpbmcgbGVhZGluZyBkaWdpdCBiZWZvcmUgJy4nCiAgICAgICAgICAgICAgICAtLjEwMAogICAgICAgICAgICAgICAgIyB0b28gbWFueSAnLicKICAgICAgICAgICAgICAgIDMuMTQuMTU5CiAgICAgICAgICAgICAgICAnJycsIGZhaWx1cmVfdGVzdHM9VHJ1ZSkKICAgICAgICAgICAgcHJpbnQoXCJTdWNjZXNzXCIgaWYgcmVzdWx0WzBdIGVsc2UgXCJGYWlsZWQhXCIpCgogICAgICAgIHByaW50czo6CgogICAgICAgICAgICAjIHVuc2lnbmVkIGludGVnZXIKICAgICAgICAgICAgMTAwCiAgICAgICAgICAgIFsxMDBdCgogICAgICAgICAgICAjIG5lZ2F0aXZlIGludGVnZXIKICAgICAgICAgICAgLTEwMAogICAgICAgICAgICBbLTEwMF0KCiAgICAgICAgICAgICMgZmxvYXQgd2l0aCBzY2llbnRpZmljIG5vdGF0aW9uCiAgICAgICAgICAgIDYuMDJlMjMKICAgICAgICAgICAgWzYuMDJlKzIzXQoKICAgICAgICAgICAgIyBpbnRlZ2VyIHdpdGggc2NpZW50aWZpYyBub3RhdGlvbgogICAgICAgICAgICAxZS0xMgogICAgICAgICAgICBbMWUtMTJdCgogICAgICAgICAgICBTdWNjZXNzCgogICAgICAgICAgICAjIHN0cmF5IGNoYXJhY3RlcgogICAgICAgICAgICAxMDBaCiAgICAgICAgICAgICAgIF4KICAgICAgICAgICAgRkFJTDogRXhwZWN0ZWQgZW5kIG9mIHRleHQgKGF0IGNoYXIgMyksIChsaW5lOjEsIGNvbDo0KQoKICAgICAgICAgICAgIyBtaXNzaW5nIGxlYWRpbmcgZGlnaXQgYmVmb3JlICcuJwogICAgICAgICAgICAtLjEwMAogICAgICAgICAgICBeCiAgICAgICAgICAgIEZBSUw6IEV4cGVjdGVkIHtyZWFsIG51bWJlciB3aXRoIHNjaWVudGlmaWMgbm90YXRpb24gfCByZWFsIG51bWJlciB8IHNpZ25lZCBpbnRlZ2VyfSAoYXQgY2hhciAwKSwgKGxpbmU6MSwgY29sOjEpCgogICAgICAgICAgICAjIHRvbyBtYW55ICcuJwogICAgICAgICAgICAzLjE0LjE1OQogICAgICAgICAgICAgICAgXgogICAgICAgICAgICBGQUlMOiBFeHBlY3RlZCBlbmQgb2YgdGV4dCAoYXQgY2hhciA0KSwgKGxpbmU6MSwgY29sOjUpCgogICAgICAgICAgICBTdWNjZXNzCgogICAgICAgIEVhY2ggdGVzdCBzdHJpbmcgbXVzdCBiZSBvbiBhIHNpbmdsZSBsaW5lLiBJZiB5b3Ugd2FudCB0byB0ZXN0IGEgc3RyaW5nIHRoYXQgc3BhbnMgbXVsdGlwbGUKICAgICAgICBsaW5lcywgY3JlYXRlIGEgdGVzdCBsaWtlIHRoaXM6OgoKICAgICAgICAgICAgZXhwci5ydW5fdGVzdHMoclwidGhpcyBpcyBhIHRlc3RcXFxcbiBvZiBzdHJpbmdzIHRoYXQgc3BhbnMgXFxcXG4gMyBsaW5lc1wiKQoKICAgICAgICAoTm90ZSB0aGF0IHRoaXMgaXMgYSByYXcgc3RyaW5nIGxpdGVyYWwsIHlvdSBtdXN0IGluY2x1ZGUgdGhlIGxlYWRpbmcgYGAncidgYC4pCiAgICAgICAgXCJcIlwiCiAgICAgICAgZnJvbSAudGVzdGluZyBpbXBvcnQgcHlwYXJzaW5nX3Rlc3QKCiAgICAgICAgcGFyc2VBbGwgPSBwYXJzZUFsbCBhbmQgcGFyc2VfYWxsCiAgICAgICAgZnVsbER1bXAgPSBmdWxsRHVtcCBhbmQgZnVsbF9kdW1wCiAgICAgICAgcHJpbnRSZXN1bHRzID0gcHJpbnRSZXN1bHRzIGFuZCBwcmludF9yZXN1bHRzCiAgICAgICAgZmFpbHVyZVRlc3RzID0gZmFpbHVyZVRlc3RzIG9yIGZhaWx1cmVfdGVzdHMKICAgICAgICBwb3N0UGFyc2UgPSBwb3N0UGFyc2Ugb3IgcG9zdF9wYXJzZQogICAgICAgIGlmIGlzaW5zdGFuY2UodGVzdHMsIHN0cl90eXBlKToKICAgICAgICAgICAgbGluZV9zdHJpcCA9IHR5cGUodGVzdHMpLnN0cmlwCiAgICAgICAgICAgIHRlc3RzID0gW2xpbmVfc3RyaXAodGVzdF9saW5lKSBmb3IgdGVzdF9saW5lIGluIHRlc3RzLnJzdHJpcCgpLnNwbGl0bGluZXMoKV0KICAgICAgICBpZiBpc2luc3RhbmNlKGNvbW1lbnQsIHN0cl90eXBlKToKICAgICAgICAgICAgY29tbWVudCA9IExpdGVyYWwoY29tbWVudCkKICAgICAgICBpZiBmaWxlIGlzIE5vbmU6CiAgICAgICAgICAgIGZpbGUgPSBzeXMuc3Rkb3V0CiAgICAgICAgcHJpbnRfID0gZmlsZS53cml0ZQoKICAgICAgICByZXN1bHQ6IFVuaW9uW1BhcnNlUmVzdWx0cywgRXhjZXB0aW9uXQogICAgICAgIGFsbFJlc3VsdHMgPSBbXQogICAgICAgIGNvbW1lbnRzID0gW10KICAgICAgICBzdWNjZXNzID0gVHJ1ZQogICAgICAgIE5MID0gTGl0ZXJhbChyXCJcXG5cIikuYWRkX3BhcnNlX2FjdGlvbihyZXBsYWNlX3dpdGgoXCJcXG5cIikpLmlnbm9yZShxdW90ZWRfc3RyaW5nKQogICAgICAgIEJPTSA9IFwiXFx1ZmVmZlwiCiAgICAgICAgZm9yIHQgaW4gdGVzdHM6CiAgICAgICAgICAgIGlmIGNvbW1lbnQgaXMgbm90IE5vbmUgYW5kIGNvbW1lbnQubWF0Y2hlcyh0LCBGYWxzZSkgb3IgY29tbWVudHMgYW5kIG5vdCB0OgogICAgICAgICAgICAgICAgY29tbWVudHMuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHB5cGFyc2luZ190ZXN0LndpdGhfbGluZV9udW1iZXJzKHQpIGlmIHdpdGhfbGluZV9udW1iZXJzIGVsc2UgdAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYgbm90IHQ6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBvdXQgPSBbCiAgICAgICAgICAgICAgICBcIlxcblwiICsgXCJcXG5cIi5qb2luKGNvbW1lbnRzKSBpZiBjb21tZW50cyBlbHNlIFwiXCIsCiAgICAgICAgICAgICAgICBweXBhcnNpbmdfdGVzdC53aXRoX2xpbmVfbnVtYmVycyh0KSBpZiB3aXRoX2xpbmVfbnVtYmVycyBlbHNlIHQsCiAgICAgICAgICAgIF0KICAgICAgICAgICAgY29tbWVudHMgPSBbXQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIGNvbnZlcnQgbmV3bGluZSBtYXJrcyB0byBhY3R1YWwgbmV3bGluZXMsIGFuZCBzdHJpcCBsZWFkaW5nIEJPTSBpZiBwcmVzZW50CiAgICAgICAgICAgICAgICB0ID0gTkwudHJhbnNmb3JtX3N0cmluZyh0LmxzdHJpcChCT00pKQogICAgICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5wYXJzZV9zdHJpbmcodCwgcGFyc2VfYWxsPXBhcnNlQWxsKQogICAgICAgICAgICBleGNlcHQgUGFyc2VCYXNlRXhjZXB0aW9uIGFzIHBlOgogICAgICAgICAgICAgICAgZmF0YWwgPSBcIihGQVRBTClcIiBpZiBpc2luc3RhbmNlKHBlLCBQYXJzZUZhdGFsRXhjZXB0aW9uKSBlbHNlIFwiXCIKICAgICAgICAgICAgICAgIG91dC5hcHBlbmQocGUuZXhwbGFpbigpKQogICAgICAgICAgICAgICAgb3V0LmFwcGVuZChcIkZBSUw6IFwiICsgc3RyKHBlKSkKICAgICAgICAgICAgICAgIGlmIFBhcnNlckVsZW1lbnQudmVyYm9zZV9zdGFja3RyYWNlOgogICAgICAgICAgICAgICAgICAgIG91dC5leHRlbmQodHJhY2ViYWNrLmZvcm1hdF90YihwZS5fX3RyYWNlYmFja19fKSkKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBzdWNjZXNzIGFuZCBmYWlsdXJlVGVzdHMKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHBlCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICAgICAgb3V0LmFwcGVuZChcIkZBSUwtRVhDRVBUSU9OOiB7fToge31cIi5mb3JtYXQodHlwZShleGMpLl9fbmFtZV9fLCBleGMpKQogICAgICAgICAgICAgICAgaWYgUGFyc2VyRWxlbWVudC52ZXJib3NlX3N0YWNrdHJhY2U6CiAgICAgICAgICAgICAgICAgICAgb3V0LmV4dGVuZCh0cmFjZWJhY2suZm9ybWF0X3RiKGV4Yy5fX3RyYWNlYmFja19fKSkKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBzdWNjZXNzIGFuZCBmYWlsdXJlVGVzdHMKICAgICAgICAgICAgICAgIHJlc3VsdCA9IGV4YwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc3VjY2VzcyA9IHN1Y2Nlc3MgYW5kIG5vdCBmYWlsdXJlVGVzdHMKICAgICAgICAgICAgICAgIGlmIHBvc3RQYXJzZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHBwX3ZhbHVlID0gcG9zdFBhcnNlKHQsIHJlc3VsdCkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgcHBfdmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHBwX3ZhbHVlLCBQYXJzZVJlc3VsdHMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dC5hcHBlbmQocHBfdmFsdWUuZHVtcCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKHN0cihwcF92YWx1ZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKHJlc3VsdC5kdW1wKCkpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKHJlc3VsdC5kdW1wKGZ1bGw9ZnVsbER1bXApKQogICAgICAgICAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ7fSBmYWlsZWQ6IHt9OiB7fVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0UGFyc2UuX19uYW1lX18sIHR5cGUoZSkuX19uYW1lX18sIGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKHJlc3VsdC5kdW1wKGZ1bGw9ZnVsbER1bXApKQogICAgICAgICAgICBvdXQuYXBwZW5kKFwiXCIpCgogICAgICAgICAgICBpZiBwcmludFJlc3VsdHM6CiAgICAgICAgICAgICAgICBwcmludF8oXCJcXG5cIi5qb2luKG91dCkpCgogICAgICAgICAgICBhbGxSZXN1bHRzLmFwcGVuZCgodCwgcmVzdWx0KSkKCiAgICAgICAgcmV0dXJuIHN1Y2Nlc3MsIGFsbFJlc3VsdHMKCiAgICBkZWYgY3JlYXRlX2RpYWdyYW0oCiAgICAgICAgc2VsZiwKICAgICAgICBvdXRwdXRfaHRtbDogVW5pb25bVGV4dElPLCBQYXRoLCBzdHJdLAogICAgICAgIHZlcnRpY2FsOiBpbnQgPSAzLAogICAgICAgIHNob3dfcmVzdWx0c19uYW1lczogYm9vbCA9IEZhbHNlLAogICAgICAgIHNob3dfZ3JvdXBzOiBib29sID0gRmFsc2UsCiAgICAgICAgKiprd2FyZ3MsCiAgICApIC0+IE5vbmU6CiAgICAgICAgXCJcIlwiCiAgICAgICAgQ3JlYXRlIGEgcmFpbHJvYWQgZGlhZ3JhbSBmb3IgdGhlIHBhcnNlci4KCiAgICAgICAgUGFyYW1ldGVyczoKICAgICAgICAtIG91dHB1dF9odG1sIChzdHIgb3IgZmlsZS1saWtlIG9iamVjdCkgLSBvdXRwdXQgdGFyZ2V0IGZvciBnZW5lcmF0ZWQKICAgICAgICAgIGRpYWdyYW0gSFRNTAogICAgICAgIC0gdmVydGljYWwgKGludCkgLSB0aHJlc2hvbGQgZm9yIGZvcm1hdHRpbmcgbXVsdGlwbGUgYWx0ZXJuYXRpdmVzIHZlcnRpY2FsbHkKICAgICAgICAgIGluc3RlYWQgb2YgaG9yaXpvbnRhbGx5IChkZWZhdWx0PTMpCiAgICAgICAgLSBzaG93X3Jlc3VsdHNfbmFtZXMgLSBib29sIGZsYWcgd2hldGhlciBkaWFncmFtIHNob3VsZCBzaG93IGFubm90YXRpb25zIGZvcgogICAgICAgICAgZGVmaW5lZCByZXN1bHRzIG5hbWVzCiAgICAgICAgLSBzaG93X2dyb3VwcyAtIGJvb2wgZmxhZyB3aGV0aGVyIGdyb3VwcyBzaG91bGQgYmUgaGlnaGxpZ2h0ZWQgd2l0aCBhbiB1bmxhYmVsZWQgc3Vycm91bmRpbmcgYm94CiAgICAgICAgQWRkaXRpb25hbCBkaWFncmFtLWZvcm1hdHRpbmcga2V5d29yZCBhcmd1bWVudHMgY2FuIGFsc28gYmUgaW5jbHVkZWQ7CiAgICAgICAgc2VlIHJhaWxyb2FkLkRpYWdyYW0gY2xhc3MuCiAgICAgICAgXCJcIlwiCgogICAgICAgIHRyeToKICAgICAgICAgICAgZnJvbSAuZGlhZ3JhbSBpbXBvcnQgdG9fcmFpbHJvYWQsIHJhaWxyb2FkX3RvX2h0bWwKICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3IgYXMgaWU6CiAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIFwibXVzdCBgYHBpcCBpbnN0YWxsIHB5cGFyc2luZ1tkaWFncmFtc11gYCB0byBnZW5lcmF0ZSBwYXJzZXIgcmFpbHJvYWQgZGlhZ3JhbXNcIgogICAgICAgICAgICApIGZyb20gaWUKCiAgICAgICAgc2VsZi5zdHJlYW1saW5lKCkKCiAgICAgICAgcmFpbHJvYWQgPSB0b19yYWlscm9hZCgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgdmVydGljYWw9dmVydGljYWwsCiAgICAgICAgICAgIHNob3dfcmVzdWx0c19uYW1lcz1zaG93X3Jlc3VsdHNfbmFtZXMsCiAgICAgICAgICAgIHNob3dfZ3JvdXBzPXNob3dfZ3JvdXBzLAogICAgICAgICAgICBkaWFncmFtX2t3YXJncz1rd2FyZ3MsCiAgICAgICAgKQogICAgICAgIGlmIGlzaW5zdGFuY2Uob3V0cHV0X2h0bWwsIChzdHIsIFBhdGgpKToKICAgICAgICAgICAgd2l0aCBvcGVuKG91dHB1dF9odG1sLCBcIndcIiwgZW5jb2Rpbmc9XCJ1dGYtOFwiKSBhcyBkaWFnX2ZpbGU6CiAgICAgICAgICAgICAgICBkaWFnX2ZpbGUud3JpdGUocmFpbHJvYWRfdG9faHRtbChyYWlscm9hZCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyB3ZSB3ZXJlIHBhc3NlZCBhIGZpbGUtbGlrZSBvYmplY3QsIGp1c3Qgd3JpdGUgdG8gaXQKICAgICAgICAgICAgb3V0cHV0X2h0bWwud3JpdGUocmFpbHJvYWRfdG9faHRtbChyYWlscm9hZCkpCgogICAgc2V0RGVmYXVsdFdoaXRlc3BhY2VDaGFycyA9IHNldF9kZWZhdWx0X3doaXRlc3BhY2VfY2hhcnMKICAgIGlubGluZUxpdGVyYWxzVXNpbmcgPSBpbmxpbmVfbGl0ZXJhbHNfdXNpbmcKICAgIHNldFJlc3VsdHNOYW1lID0gc2V0X3Jlc3VsdHNfbmFtZQogICAgc2V0QnJlYWsgPSBzZXRfYnJlYWsKICAgIHNldFBhcnNlQWN0aW9uID0gc2V0X3BhcnNlX2FjdGlvbgogICAgYWRkUGFyc2VBY3Rpb24gPSBhZGRfcGFyc2VfYWN0aW9uCiAgICBhZGRDb25kaXRpb24gPSBhZGRfY29uZGl0aW9uCiAgICBzZXRGYWlsQWN0aW9uID0gc2V0X2ZhaWxfYWN0aW9uCiAgICB0cnlQYXJzZSA9IHRyeV9wYXJzZQogICAgY2FuUGFyc2VOZXh0ID0gY2FuX3BhcnNlX25leHQKICAgIHJlc2V0Q2FjaGUgPSByZXNldF9jYWNoZQogICAgZW5hYmxlTGVmdFJlY3Vyc2lvbiA9IGVuYWJsZV9sZWZ0X3JlY3Vyc2lvbgogICAgZW5hYmxlUGFja3JhdCA9IGVuYWJsZV9wYWNrcmF0CiAgICBwYXJzZVN0cmluZyA9IHBhcnNlX3N0cmluZwogICAgc2NhblN0cmluZyA9IHNjYW5fc3RyaW5nCiAgICBzZWFyY2hTdHJpbmcgPSBzZWFyY2hfc3RyaW5nCiAgICB0cmFuc2Zvcm1TdHJpbmcgPSB0cmFuc2Zvcm1fc3RyaW5nCiAgICBzZXRXaGl0ZXNwYWNlQ2hhcnMgPSBzZXRfd2hpdGVzcGFjZV9jaGFycwogICAgcGFyc2VXaXRoVGFicyA9IHBhcnNlX3dpdGhfdGFicwogICAgc2V0RGVidWdBY3Rpb25zID0gc2V0X2RlYnVnX2FjdGlvbnMKICAgIHNldERlYnVnID0gc2V0X2RlYnVnCiAgICBkZWZhdWx0TmFtZSA9IGRlZmF1bHRfbmFtZQogICAgc2V0TmFtZSA9IHNldF9uYW1lCiAgICBwYXJzZUZpbGUgPSBwYXJzZV9maWxlCiAgICBydW5UZXN0cyA9IHJ1bl90ZXN0cwogICAgaWdub3JlV2hpdGVzcGFjZSA9IGlnbm9yZV93aGl0ZXNwYWNlCiAgICBsZWF2ZVdoaXRlc3BhY2UgPSBsZWF2ZV93aGl0ZXNwYWNlCgoKY2xhc3MgX1BlbmRpbmdTa2lwKFBhcnNlckVsZW1lbnQpOgogICAgIyBpbnRlcm5hbCBwbGFjZWhvbGRlciBjbGFzcyB0byBob2xkIGEgcGxhY2Ugd2VyZSAnLi4uJyBpcyBhZGRlZCB0byBhIHBhcnNlciBlbGVtZW50LAogICAgIyBvbmNlIGFub3RoZXIgUGFyc2VyRWxlbWVudCBpcyBhZGRlZCwgdGhpcyBwbGFjZWhvbGRlciB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSBTa2lwVG8KICAgIGRlZiBfX2luaXRfXyhzZWxmLCBleHByOiBQYXJzZXJFbGVtZW50LCBtdXN0X3NraXA6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5hbmNob3IgPSBleHByCiAgICAgICAgc2VsZi5tdXN0X3NraXAgPSBtdXN0X3NraXAKCiAgICBkZWYgX2dlbmVyYXRlRGVmYXVsdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIHN0cihzZWxmLmFuY2hvciArIEVtcHR5KCkpLnJlcGxhY2UoXCJFbXB0eVwiLCBcIi4uLlwiKQoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKSAtPiBcIlBhcnNlckVsZW1lbnRcIjoKICAgICAgICBza2lwcGVyID0gU2tpcFRvKG90aGVyKS5zZXRfbmFtZShcIi4uLlwiKShcIl9za2lwcGVkKlwiKQogICAgICAgIGlmIHNlbGYubXVzdF9za2lwOgoKICAgICAgICAgICAgZGVmIG11c3Rfc2tpcCh0KToKICAgICAgICAgICAgICAgIGlmIG5vdCB0Ll9za2lwcGVkIG9yIHQuX3NraXBwZWQuYXNfbGlzdCgpID09IFtcIlwiXToKICAgICAgICAgICAgICAgICAgICBkZWwgdFswXQogICAgICAgICAgICAgICAgICAgIHQucG9wKFwiX3NraXBwZWRcIiwgTm9uZSkKCiAgICAgICAgICAgIGRlZiBzaG93X3NraXAodCk6CiAgICAgICAgICAgICAgICBpZiB0Ll9za2lwcGVkLmFzX2xpc3QoKVstMTpdID09IFtcIlwiXToKICAgICAgICAgICAgICAgICAgICB0LnBvcChcIl9za2lwcGVkXCIpCiAgICAgICAgICAgICAgICAgICAgdFtcIl9za2lwcGVkXCJdID0gXCJtaXNzaW5nIDxcIiArIHJlcHIoc2VsZi5hbmNob3IpICsgXCI+XCIKCiAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICBzZWxmLmFuY2hvciArIHNraXBwZXIoKS5hZGRfcGFyc2VfYWN0aW9uKG11c3Rfc2tpcCkKICAgICAgICAgICAgICAgIHwgc2tpcHBlcigpLmFkZF9wYXJzZV9hY3Rpb24oc2hvd19za2lwKQogICAgICAgICAgICApICsgb3RoZXIKCiAgICAgICAgcmV0dXJuIHNlbGYuYW5jaG9yICsgc2tpcHBlciArIG90aGVyCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRlZmF1bHROYW1lCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCAqYXJncyk6CiAgICAgICAgcmFpc2UgRXhjZXB0aW9uKAogICAgICAgICAgICBcInVzZSBvZiBgLi4uYCBleHByZXNzaW9uIHdpdGhvdXQgZm9sbG93aW5nIFNraXBUbyB0YXJnZXQgZXhwcmVzc2lvblwiCiAgICAgICAgKQoKCmNsYXNzIFRva2VuKFBhcnNlckVsZW1lbnQpOgogICAgXCJcIlwiQWJzdHJhY3QgOmNsYXNzOmBQYXJzZXJFbGVtZW50YCBzdWJjbGFzcywgZm9yIGRlZmluaW5nIGF0b21pYwogICAgbWF0Y2hpbmcgcGF0dGVybnMuCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhzYXZlbGlzdD1GYWxzZSkKCiAgICBkZWYgX2dlbmVyYXRlRGVmYXVsdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIHR5cGUoc2VsZikuX19uYW1lX18KCgpjbGFzcyBFbXB0eShUb2tlbik6CiAgICBcIlwiXCIKICAgIEFuIGVtcHR5IHRva2VuLCB3aWxsIGFsd2F5cyBtYXRjaC4KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gVHJ1ZQogICAgICAgIHNlbGYubWF5SW5kZXhFcnJvciA9IEZhbHNlCgoKY2xhc3MgTm9NYXRjaChUb2tlbik6CiAgICBcIlwiXCIKICAgIEEgdG9rZW4gdGhhdCB3aWxsIG5ldmVyIG1hdGNoLgogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCiAgICAgICAgc2VsZi5tYXlJbmRleEVycm9yID0gRmFsc2UKICAgICAgICBzZWxmLmVycm1zZyA9IFwiVW5tYXRjaGFibGUgdG9rZW5cIgoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQoKCmNsYXNzIExpdGVyYWwoVG9rZW4pOgogICAgXCJcIlwiCiAgICBUb2tlbiB0byBleGFjdGx5IG1hdGNoIGEgc3BlY2lmaWVkIHN0cmluZy4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgTGl0ZXJhbCgnYmxhaCcpLnBhcnNlX3N0cmluZygnYmxhaCcpICAjIC0+IFsnYmxhaCddCiAgICAgICAgTGl0ZXJhbCgnYmxhaCcpLnBhcnNlX3N0cmluZygnYmxhaGZvb2JsYWgnKSAgIyAtPiBbJ2JsYWgnXQogICAgICAgIExpdGVyYWwoJ2JsYWgnKS5wYXJzZV9zdHJpbmcoJ2JsYScpICAjIC0+IEV4Y2VwdGlvbjogRXhwZWN0ZWQgXCJibGFoXCIKCiAgICBGb3IgY2FzZS1pbnNlbnNpdGl2ZSBtYXRjaGluZywgdXNlIDpjbGFzczpgQ2FzZWxlc3NMaXRlcmFsYC4KCiAgICBGb3Iga2V5d29yZCBtYXRjaGluZyAoZm9yY2Ugd29yZCBicmVhayBiZWZvcmUgYW5kIGFmdGVyIHRoZSBtYXRjaGVkIHN0cmluZyksCiAgICB1c2UgOmNsYXNzOmBLZXl3b3JkYCBvciA6Y2xhc3M6YENhc2VsZXNzS2V5d29yZGAuCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWF0Y2hfc3RyaW5nOiBzdHIgPSBcIlwiLCAqLCBtYXRjaFN0cmluZzogc3RyID0gXCJcIik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgbWF0Y2hfc3RyaW5nID0gbWF0Y2hTdHJpbmcgb3IgbWF0Y2hfc3RyaW5nCiAgICAgICAgc2VsZi5tYXRjaCA9IG1hdGNoX3N0cmluZwogICAgICAgIHNlbGYubWF0Y2hMZW4gPSBsZW4obWF0Y2hfc3RyaW5nKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5maXJzdE1hdGNoQ2hhciA9IG1hdGNoX3N0cmluZ1swXQogICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKFwibnVsbCBzdHJpbmcgcGFzc2VkIHRvIExpdGVyYWw7IHVzZSBFbXB0eSgpIGluc3RlYWRcIikKICAgICAgICBzZWxmLmVycm1zZyA9IFwiRXhwZWN0ZWQgXCIgKyBzZWxmLm5hbWUKICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gRmFsc2UKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBGYWxzZQoKICAgICAgICAjIFBlcmZvcm1hbmNlIHR1bmluZzogbW9kaWZ5IF9fY2xhc3NfXyB0byBzZWxlY3QKICAgICAgICAjIGEgcGFyc2VJbXBsIG9wdGltaXplZCBmb3Igc2luZ2xlLWNoYXJhY3RlciBjaGVjawogICAgICAgIGlmIHNlbGYubWF0Y2hMZW4gPT0gMSBhbmQgdHlwZShzZWxmKSBpcyBMaXRlcmFsOgogICAgICAgICAgICBzZWxmLl9fY2xhc3NfXyA9IF9TaW5nbGVDaGFyTGl0ZXJhbAoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gcmVwcihzZWxmLm1hdGNoKQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIGlmIGluc3RyaW5nW2xvY10gPT0gc2VsZi5maXJzdE1hdGNoQ2hhciBhbmQgaW5zdHJpbmcuc3RhcnRzd2l0aCgKICAgICAgICAgICAgc2VsZi5tYXRjaCwgbG9jCiAgICAgICAgKToKICAgICAgICAgICAgcmV0dXJuIGxvYyArIHNlbGYubWF0Y2hMZW4sIHNlbGYubWF0Y2gKICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKCgpjbGFzcyBfU2luZ2xlQ2hhckxpdGVyYWwoTGl0ZXJhbCk6CiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBpZiBpbnN0cmluZ1tsb2NdID09IHNlbGYuZmlyc3RNYXRjaENoYXI6CiAgICAgICAgICAgIHJldHVybiBsb2MgKyAxLCBzZWxmLm1hdGNoCiAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgoKUGFyc2VyRWxlbWVudC5fbGl0ZXJhbFN0cmluZ0NsYXNzID0gTGl0ZXJhbAoKCmNsYXNzIEtleXdvcmQoVG9rZW4pOgogICAgXCJcIlwiCiAgICBUb2tlbiB0byBleGFjdGx5IG1hdGNoIGEgc3BlY2lmaWVkIHN0cmluZyBhcyBhIGtleXdvcmQsIHRoYXQgaXMsCiAgICBpdCBtdXN0IGJlIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IGEgbm9uLWtleXdvcmQgY2hhcmFjdGVyLiAgQ29tcGFyZQogICAgd2l0aCA6Y2xhc3M6YExpdGVyYWxgOgoKICAgIC0gYGBMaXRlcmFsKFwiaWZcIilgYCB3aWxsIG1hdGNoIHRoZSBsZWFkaW5nIGBgJ2lmJ2BgIGluCiAgICAgIGBgJ2lmQW5kT25seUlmJ2BgLgogICAgLSBgYEtleXdvcmQoXCJpZlwiKWBgIHdpbGwgbm90OyBpdCB3aWxsIG9ubHkgbWF0Y2ggdGhlIGxlYWRpbmcKICAgICAgYGAnaWYnYGAgaW4gYGAnaWYgeD0xJ2BgLCBvciBgYCdpZih5PT0yKSdgYAoKICAgIEFjY2VwdHMgdHdvIG9wdGlvbmFsIGNvbnN0cnVjdG9yIGFyZ3VtZW50cyBpbiBhZGRpdGlvbiB0byB0aGUKICAgIGtleXdvcmQgc3RyaW5nOgoKICAgIC0gYGBpZGVudENoYXJzYGAgaXMgYSBzdHJpbmcgb2YgY2hhcmFjdGVycyB0aGF0IHdvdWxkIGJlIHZhbGlkCiAgICAgIGlkZW50aWZpZXIgY2hhcmFjdGVycywgZGVmYXVsdGluZyB0byBhbGwgYWxwaGFudW1lcmljcyArIFwiX1wiIGFuZAogICAgICBcIiRcIgogICAgLSBgYGNhc2VsZXNzYGAgYWxsb3dzIGNhc2UtaW5zZW5zaXRpdmUgbWF0Y2hpbmcsIGRlZmF1bHQgaXMgYGBGYWxzZWBgLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBLZXl3b3JkKFwic3RhcnRcIikucGFyc2Vfc3RyaW5nKFwic3RhcnRcIikgICMgLT4gWydzdGFydCddCiAgICAgICAgS2V5d29yZChcInN0YXJ0XCIpLnBhcnNlX3N0cmluZyhcInN0YXJ0aW5nXCIpICAjIC0+IEV4Y2VwdGlvbgoKICAgIEZvciBjYXNlLWluc2Vuc2l0aXZlIG1hdGNoaW5nLCB1c2UgOmNsYXNzOmBDYXNlbGVzc0tleXdvcmRgLgogICAgXCJcIlwiCgogICAgREVGQVVMVF9LRVlXT1JEX0NIQVJTID0gYWxwaGFudW1zICsgXCJfJFwiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgbWF0Y2hfc3RyaW5nOiBzdHIgPSBcIlwiLAogICAgICAgIGlkZW50X2NoYXJzOiB0eXBpbmcuT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgY2FzZWxlc3M6IGJvb2wgPSBGYWxzZSwKICAgICAgICAqLAogICAgICAgIG1hdGNoU3RyaW5nOiBzdHIgPSBcIlwiLAogICAgICAgIGlkZW50Q2hhcnM6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgaWRlbnRDaGFycyA9IGlkZW50Q2hhcnMgb3IgaWRlbnRfY2hhcnMKICAgICAgICBpZiBpZGVudENoYXJzIGlzIE5vbmU6CiAgICAgICAgICAgIGlkZW50Q2hhcnMgPSBLZXl3b3JkLkRFRkFVTFRfS0VZV09SRF9DSEFSUwogICAgICAgIG1hdGNoX3N0cmluZyA9IG1hdGNoU3RyaW5nIG9yIG1hdGNoX3N0cmluZwogICAgICAgIHNlbGYubWF0Y2ggPSBtYXRjaF9zdHJpbmcKICAgICAgICBzZWxmLm1hdGNoTGVuID0gbGVuKG1hdGNoX3N0cmluZykKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuZmlyc3RNYXRjaENoYXIgPSBtYXRjaF9zdHJpbmdbMF0KICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihcIm51bGwgc3RyaW5nIHBhc3NlZCB0byBLZXl3b3JkOyB1c2UgRW1wdHkoKSBpbnN0ZWFkXCIpCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIkV4cGVjdGVkIHt9IHt9XCIuZm9ybWF0KHR5cGUoc2VsZikuX19uYW1lX18sIHNlbGYubmFtZSkKICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gRmFsc2UKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBGYWxzZQogICAgICAgIHNlbGYuY2FzZWxlc3MgPSBjYXNlbGVzcwogICAgICAgIGlmIGNhc2VsZXNzOgogICAgICAgICAgICBzZWxmLmNhc2VsZXNzbWF0Y2ggPSBtYXRjaF9zdHJpbmcudXBwZXIoKQogICAgICAgICAgICBpZGVudENoYXJzID0gaWRlbnRDaGFycy51cHBlcigpCiAgICAgICAgc2VsZi5pZGVudENoYXJzID0gc2V0KGlkZW50Q2hhcnMpCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiByZXByKHNlbGYubWF0Y2gpCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgZXJybXNnID0gc2VsZi5lcnJtc2cKICAgICAgICBlcnJsb2MgPSBsb2MKICAgICAgICBpZiBzZWxmLmNhc2VsZXNzOgogICAgICAgICAgICBpZiBpbnN0cmluZ1tsb2MgOiBsb2MgKyBzZWxmLm1hdGNoTGVuXS51cHBlcigpID09IHNlbGYuY2FzZWxlc3NtYXRjaDoKICAgICAgICAgICAgICAgIGlmIGxvYyA9PSAwIG9yIGluc3RyaW5nW2xvYyAtIDFdLnVwcGVyKCkgbm90IGluIHNlbGYuaWRlbnRDaGFyczoKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgIGxvYyA+PSBsZW4oaW5zdHJpbmcpIC0gc2VsZi5tYXRjaExlbgogICAgICAgICAgICAgICAgICAgICAgICBvciBpbnN0cmluZ1tsb2MgKyBzZWxmLm1hdGNoTGVuXS51cHBlcigpIG5vdCBpbiBzZWxmLmlkZW50Q2hhcnMKICAgICAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jICsgc2VsZi5tYXRjaExlbiwgc2VsZi5tYXRjaAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICMgZm9sbG93ZWQgYnkga2V5d29yZCBjaGFyCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm1zZyArPSBcIiwgd2FzIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IGtleXdvcmQgY2hhcmFjdGVyXCIKICAgICAgICAgICAgICAgICAgICAgICAgZXJybG9jID0gbG9jICsgc2VsZi5tYXRjaExlbgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIHByZWNlZGVkIGJ5IGtleXdvcmQgY2hhcgogICAgICAgICAgICAgICAgICAgIGVycm1zZyArPSBcIiwga2V5d29yZCB3YXMgaW1tZWRpYXRlbHkgcHJlY2VkZWQgYnkga2V5d29yZCBjaGFyYWN0ZXJcIgogICAgICAgICAgICAgICAgICAgIGVycmxvYyA9IGxvYyAtIDEKICAgICAgICAgICAgIyBlbHNlIG5vIG1hdGNoIGp1c3QgcmFpc2UgcGxhaW4gZXhjZXB0aW9uCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGluc3RyaW5nW2xvY10gPT0gc2VsZi5maXJzdE1hdGNoQ2hhcgogICAgICAgICAgICAgICAgYW5kIHNlbGYubWF0Y2hMZW4gPT0gMQogICAgICAgICAgICAgICAgb3IgaW5zdHJpbmcuc3RhcnRzd2l0aChzZWxmLm1hdGNoLCBsb2MpCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBpZiBsb2MgPT0gMCBvciBpbnN0cmluZ1tsb2MgLSAxXSBub3QgaW4gc2VsZi5pZGVudENoYXJzOgogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgbG9jID49IGxlbihpbnN0cmluZykgLSBzZWxmLm1hdGNoTGVuCiAgICAgICAgICAgICAgICAgICAgICAgIG9yIGluc3RyaW5nW2xvYyArIHNlbGYubWF0Y2hMZW5dIG5vdCBpbiBzZWxmLmlkZW50Q2hhcnMKICAgICAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jICsgc2VsZi5tYXRjaExlbiwgc2VsZi5tYXRjaAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICMgZm9sbG93ZWQgYnkga2V5d29yZCBjaGFyCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm1zZyArPSAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiwga2V5d29yZCB3YXMgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkga2V5d29yZCBjaGFyYWN0ZXJcIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGVycmxvYyA9IGxvYyArIHNlbGYubWF0Y2hMZW4KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyBwcmVjZWRlZCBieSBrZXl3b3JkIGNoYXIKICAgICAgICAgICAgICAgICAgICBlcnJtc2cgKz0gXCIsIGtleXdvcmQgd2FzIGltbWVkaWF0ZWx5IHByZWNlZGVkIGJ5IGtleXdvcmQgY2hhcmFjdGVyXCIKICAgICAgICAgICAgICAgICAgICBlcnJsb2MgPSBsb2MgLSAxCiAgICAgICAgICAgICMgZWxzZSBubyBtYXRjaCBqdXN0IHJhaXNlIHBsYWluIGV4Y2VwdGlvbgoKICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgZXJybG9jLCBlcnJtc2csIHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHNldF9kZWZhdWx0X2tleXdvcmRfY2hhcnMoY2hhcnMpIC0+IE5vbmU6CiAgICAgICAgXCJcIlwiCiAgICAgICAgT3ZlcnJpZGVzIHRoZSBkZWZhdWx0IGNoYXJhY3RlcnMgdXNlZCBieSA6Y2xhc3M6YEtleXdvcmRgIGV4cHJlc3Npb25zLgogICAgICAgIFwiXCJcIgogICAgICAgIEtleXdvcmQuREVGQVVMVF9LRVlXT1JEX0NIQVJTID0gY2hhcnMKCiAgICBzZXREZWZhdWx0S2V5d29yZENoYXJzID0gc2V0X2RlZmF1bHRfa2V5d29yZF9jaGFycwoKCmNsYXNzIENhc2VsZXNzTGl0ZXJhbChMaXRlcmFsKToKICAgIFwiXCJcIgogICAgVG9rZW4gdG8gbWF0Y2ggYSBzcGVjaWZpZWQgc3RyaW5nLCBpZ25vcmluZyBjYXNlIG9mIGxldHRlcnMuCiAgICBOb3RlOiB0aGUgbWF0Y2hlZCByZXN1bHRzIHdpbGwgYWx3YXlzIGJlIGluIHRoZSBjYXNlIG9mIHRoZSBnaXZlbgogICAgbWF0Y2ggc3RyaW5nLCBOT1QgdGhlIGNhc2Ugb2YgdGhlIGlucHV0IHRleHQuCgogICAgRXhhbXBsZTo6CgogICAgICAgIENhc2VsZXNzTGl0ZXJhbChcIkNNRFwiKVsxLCAuLi5dLnBhcnNlX3N0cmluZyhcImNtZCBDTUQgQ21kMTBcIikKICAgICAgICAjIC0+IFsnQ01EJywgJ0NNRCcsICdDTUQnXQoKICAgIChDb250cmFzdCB3aXRoIGV4YW1wbGUgZm9yIDpjbGFzczpgQ2FzZWxlc3NLZXl3b3JkYC4pCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWF0Y2hfc3RyaW5nOiBzdHIgPSBcIlwiLCAqLCBtYXRjaFN0cmluZzogc3RyID0gXCJcIik6CiAgICAgICAgbWF0Y2hfc3RyaW5nID0gbWF0Y2hTdHJpbmcgb3IgbWF0Y2hfc3RyaW5nCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhtYXRjaF9zdHJpbmcudXBwZXIoKSkKICAgICAgICAjIFByZXNlcnZlIHRoZSBkZWZpbmluZyBsaXRlcmFsLgogICAgICAgIHNlbGYucmV0dXJuU3RyaW5nID0gbWF0Y2hfc3RyaW5nCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIkV4cGVjdGVkIFwiICsgc2VsZi5uYW1lCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgaW5zdHJpbmdbbG9jIDogbG9jICsgc2VsZi5tYXRjaExlbl0udXBwZXIoKSA9PSBzZWxmLm1hdGNoOgogICAgICAgICAgICByZXR1cm4gbG9jICsgc2VsZi5tYXRjaExlbiwgc2VsZi5yZXR1cm5TdHJpbmcKICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKCgpjbGFzcyBDYXNlbGVzc0tleXdvcmQoS2V5d29yZCk6CiAgICBcIlwiXCIKICAgIENhc2VsZXNzIHZlcnNpb24gb2YgOmNsYXNzOmBLZXl3b3JkYC4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgQ2FzZWxlc3NLZXl3b3JkKFwiQ01EXCIpWzEsIC4uLl0ucGFyc2Vfc3RyaW5nKFwiY21kIENNRCBDbWQxMFwiKQogICAgICAgICMgLT4gWydDTUQnLCAnQ01EJ10KCiAgICAoQ29udHJhc3Qgd2l0aCBleGFtcGxlIGZvciA6Y2xhc3M6YENhc2VsZXNzTGl0ZXJhbGAuKQogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgbWF0Y2hfc3RyaW5nOiBzdHIgPSBcIlwiLAogICAgICAgIGlkZW50X2NoYXJzOiB0eXBpbmcuT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgKiwKICAgICAgICBtYXRjaFN0cmluZzogc3RyID0gXCJcIiwKICAgICAgICBpZGVudENoYXJzOiB0eXBpbmcuT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICApOgogICAgICAgIGlkZW50Q2hhcnMgPSBpZGVudENoYXJzIG9yIGlkZW50X2NoYXJzCiAgICAgICAgbWF0Y2hfc3RyaW5nID0gbWF0Y2hTdHJpbmcgb3IgbWF0Y2hfc3RyaW5nCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhtYXRjaF9zdHJpbmcsIGlkZW50Q2hhcnMsIGNhc2VsZXNzPVRydWUpCgoKY2xhc3MgQ2xvc2VNYXRjaChUb2tlbik6CiAgICBcIlwiXCJBIHZhcmlhdGlvbiBvbiA6Y2xhc3M6YExpdGVyYWxgIHdoaWNoIG1hdGNoZXMgXCJjbG9zZVwiIG1hdGNoZXMsCiAgICB0aGF0IGlzLCBzdHJpbmdzIHdpdGggYXQgbW9zdCAnbicgbWlzbWF0Y2hpbmcgY2hhcmFjdGVycy4KICAgIDpjbGFzczpgQ2xvc2VNYXRjaGAgdGFrZXMgcGFyYW1ldGVyczoKCiAgICAtIGBgbWF0Y2hfc3RyaW5nYGAgLSBzdHJpbmcgdG8gYmUgbWF0Y2hlZAogICAgLSBgYGNhc2VsZXNzYGAgLSBhIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIHRvIGlnbm9yZSBjYXNpbmcgd2hlbiBjb21wYXJpbmcgY2hhcmFjdGVycwogICAgLSBgYG1heF9taXNtYXRjaGVzYGAgLSAoYGBkZWZhdWx0PTFgYCkgbWF4aW11bSBudW1iZXIgb2YKICAgICAgbWlzbWF0Y2hlcyBhbGxvd2VkIHRvIGNvdW50IGFzIGEgbWF0Y2gKCiAgICBUaGUgcmVzdWx0cyBmcm9tIGEgc3VjY2Vzc2Z1bCBwYXJzZSB3aWxsIGNvbnRhaW4gdGhlIG1hdGNoZWQgdGV4dAogICAgZnJvbSB0aGUgaW5wdXQgc3RyaW5nIGFuZCB0aGUgZm9sbG93aW5nIG5hbWVkIHJlc3VsdHM6CgogICAgLSBgYG1pc21hdGNoZXNgYCAtIGEgbGlzdCBvZiB0aGUgcG9zaXRpb25zIHdpdGhpbiB0aGUKICAgICAgbWF0Y2hfc3RyaW5nIHdoZXJlIG1pc21hdGNoZXMgd2VyZSBmb3VuZAogICAgLSBgYG9yaWdpbmFsYGAgLSB0aGUgb3JpZ2luYWwgbWF0Y2hfc3RyaW5nIHVzZWQgdG8gY29tcGFyZQogICAgICBhZ2FpbnN0IHRoZSBpbnB1dCBzdHJpbmcKCiAgICBJZiBgYG1pc21hdGNoZXNgYCBpcyBhbiBlbXB0eSBsaXN0LCB0aGVuIHRoZSBtYXRjaCB3YXMgYW4gZXhhY3QKICAgIG1hdGNoLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBwYXR0ID0gQ2xvc2VNYXRjaChcIkFUQ0FUQ0dBQVRHR0FcIikKICAgICAgICBwYXR0LnBhcnNlX3N0cmluZyhcIkFUQ0FUQ0dBQVhHR0FcIikgIyAtPiAoWydBVENBVENHQUFYR0dBJ10sIHsnbWlzbWF0Y2hlcyc6IFtbOV1dLCAnb3JpZ2luYWwnOiBbJ0FUQ0FUQ0dBQVRHR0EnXX0pCiAgICAgICAgcGF0dC5wYXJzZV9zdHJpbmcoXCJBVENBWENHQUFYR0dBXCIpICMgLT4gRXhjZXB0aW9uOiBFeHBlY3RlZCAnQVRDQVRDR0FBVEdHQScgKHdpdGggdXAgdG8gMSBtaXNtYXRjaGVzKSAoYXQgY2hhciAwKSwgKGxpbmU6MSwgY29sOjEpCgogICAgICAgICMgZXhhY3QgbWF0Y2gKICAgICAgICBwYXR0LnBhcnNlX3N0cmluZyhcIkFUQ0FUQ0dBQVRHR0FcIikgIyAtPiAoWydBVENBVENHQUFUR0dBJ10sIHsnbWlzbWF0Y2hlcyc6IFtbXV0sICdvcmlnaW5hbCc6IFsnQVRDQVRDR0FBVEdHQSddfSkKCiAgICAgICAgIyBjbG9zZSBtYXRjaCBhbGxvd2luZyB1cCB0byAyIG1pc21hdGNoZXMKICAgICAgICBwYXR0ID0gQ2xvc2VNYXRjaChcIkFUQ0FUQ0dBQVRHR0FcIiwgbWF4X21pc21hdGNoZXM9MikKICAgICAgICBwYXR0LnBhcnNlX3N0cmluZyhcIkFUQ0FYQ0dBQVhHR0FcIikgIyAtPiAoWydBVENBWENHQUFYR0dBJ10sIHsnbWlzbWF0Y2hlcyc6IFtbNCwgOV1dLCAnb3JpZ2luYWwnOiBbJ0FUQ0FUQ0dBQVRHR0EnXX0pCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBtYXRjaF9zdHJpbmc6IHN0ciwKICAgICAgICBtYXhfbWlzbWF0Y2hlczogaW50ID0gTm9uZSwKICAgICAgICAqLAogICAgICAgIG1heE1pc21hdGNoZXM6IGludCA9IDEsCiAgICAgICAgY2FzZWxlc3M9RmFsc2UsCiAgICApOgogICAgICAgIG1heE1pc21hdGNoZXMgPSBtYXhfbWlzbWF0Y2hlcyBpZiBtYXhfbWlzbWF0Y2hlcyBpcyBub3QgTm9uZSBlbHNlIG1heE1pc21hdGNoZXMKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLm1hdGNoX3N0cmluZyA9IG1hdGNoX3N0cmluZwogICAgICAgIHNlbGYubWF4TWlzbWF0Y2hlcyA9IG1heE1pc21hdGNoZXMKICAgICAgICBzZWxmLmVycm1zZyA9IFwiRXhwZWN0ZWQgeyFyfSAod2l0aCB1cCB0byB7fSBtaXNtYXRjaGVzKVwiLmZvcm1hdCgKICAgICAgICAgICAgc2VsZi5tYXRjaF9zdHJpbmcsIHNlbGYubWF4TWlzbWF0Y2hlcwogICAgICAgICkKICAgICAgICBzZWxmLmNhc2VsZXNzID0gY2FzZWxlc3MKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBGYWxzZQogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBGYWxzZQoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gXCJ7fTp7IXJ9XCIuZm9ybWF0KHR5cGUoc2VsZikuX19uYW1lX18sIHNlbGYubWF0Y2hfc3RyaW5nKQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIHN0YXJ0ID0gbG9jCiAgICAgICAgaW5zdHJsZW4gPSBsZW4oaW5zdHJpbmcpCiAgICAgICAgbWF4bG9jID0gc3RhcnQgKyBsZW4oc2VsZi5tYXRjaF9zdHJpbmcpCgogICAgICAgIGlmIG1heGxvYyA8PSBpbnN0cmxlbjoKICAgICAgICAgICAgbWF0Y2hfc3RyaW5nID0gc2VsZi5tYXRjaF9zdHJpbmcKICAgICAgICAgICAgbWF0Y2hfc3RyaW5nbG9jID0gMAogICAgICAgICAgICBtaXNtYXRjaGVzID0gW10KICAgICAgICAgICAgbWF4TWlzbWF0Y2hlcyA9IHNlbGYubWF4TWlzbWF0Y2hlcwoKICAgICAgICAgICAgZm9yIG1hdGNoX3N0cmluZ2xvYywgc19tIGluIGVudW1lcmF0ZSgKICAgICAgICAgICAgICAgIHppcChpbnN0cmluZ1tsb2M6bWF4bG9jXSwgbWF0Y2hfc3RyaW5nKQogICAgICAgICAgICApOgogICAgICAgICAgICAgICAgc3JjLCBtYXQgPSBzX20KICAgICAgICAgICAgICAgIGlmIHNlbGYuY2FzZWxlc3M6CiAgICAgICAgICAgICAgICAgICAgc3JjLCBtYXQgPSBzcmMubG93ZXIoKSwgbWF0Lmxvd2VyKCkKCiAgICAgICAgICAgICAgICBpZiBzcmMgIT0gbWF0OgogICAgICAgICAgICAgICAgICAgIG1pc21hdGNoZXMuYXBwZW5kKG1hdGNoX3N0cmluZ2xvYykKICAgICAgICAgICAgICAgICAgICBpZiBsZW4obWlzbWF0Y2hlcykgPiBtYXhNaXNtYXRjaGVzOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbG9jID0gc3RhcnQgKyBtYXRjaF9zdHJpbmdsb2MgKyAxCiAgICAgICAgICAgICAgICByZXN1bHRzID0gUGFyc2VSZXN1bHRzKFtpbnN0cmluZ1tzdGFydDpsb2NdXSkKICAgICAgICAgICAgICAgIHJlc3VsdHNbXCJvcmlnaW5hbFwiXSA9IG1hdGNoX3N0cmluZwogICAgICAgICAgICAgICAgcmVzdWx0c1tcIm1pc21hdGNoZXNcIl0gPSBtaXNtYXRjaGVzCiAgICAgICAgICAgICAgICByZXR1cm4gbG9jLCByZXN1bHRzCgogICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQoKCmNsYXNzIFdvcmQoVG9rZW4pOgogICAgXCJcIlwiVG9rZW4gZm9yIG1hdGNoaW5nIHdvcmRzIGNvbXBvc2VkIG9mIGFsbG93ZWQgY2hhcmFjdGVyIHNldHMuCiAgICBQYXJhbWV0ZXJzOgogICAgLSBgYGluaXRfY2hhcnNgYCAtIHN0cmluZyBvZiBhbGwgY2hhcmFjdGVycyB0aGF0IHNob3VsZCBiZSB1c2VkIHRvCiAgICAgIG1hdGNoIGFzIGEgd29yZDsgXCJBQkNcIiB3aWxsIG1hdGNoIFwiQUFBXCIsIFwiQUJBQlwiLCBcIkNCQUNcIiwgZXRjLjsKICAgICAgaWYgYGBib2R5X2NoYXJzYGAgaXMgYWxzbyBzcGVjaWZpZWQsIHRoZW4gdGhpcyBpcyB0aGUgc3RyaW5nIG9mCiAgICAgIGluaXRpYWwgY2hhcmFjdGVycwogICAgLSBgYGJvZHlfY2hhcnNgYCAtIHN0cmluZyBvZiBjaGFyYWN0ZXJzIHRoYXQKICAgICAgY2FuIGJlIHVzZWQgZm9yIG1hdGNoaW5nIGFmdGVyIGEgbWF0Y2hlZCBpbml0aWFsIGNoYXJhY3RlciBhcwogICAgICBnaXZlbiBpbiBgYGluaXRfY2hhcnNgYDsgaWYgb21pdHRlZCwgc2FtZSBhcyB0aGUgaW5pdGlhbCBjaGFyYWN0ZXJzCiAgICAgIChkZWZhdWx0PWBgTm9uZWBgKQogICAgLSBgYG1pbmBgIC0gbWluaW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyB0byBtYXRjaCAoZGVmYXVsdD0xKQogICAgLSBgYG1heGBgIC0gbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyB0byBtYXRjaCAoZGVmYXVsdD0wKQogICAgLSBgYGV4YWN0YGAgLSBleGFjdCBudW1iZXIgb2YgY2hhcmFjdGVycyB0byBtYXRjaCAoZGVmYXVsdD0wKQogICAgLSBgYGFzX2tleXdvcmRgYCAtIG1hdGNoIGFzIGEga2V5d29yZCAoZGVmYXVsdD1gYEZhbHNlYGApCiAgICAtIGBgZXhjbHVkZV9jaGFyc2BgIC0gY2hhcmFjdGVycyB0aGF0IG1pZ2h0IGJlCiAgICAgIGZvdW5kIGluIHRoZSBpbnB1dCBgYGJvZHlfY2hhcnNgYCBzdHJpbmcgYnV0IHdoaWNoIHNob3VsZCBub3QgYmUKICAgICAgYWNjZXB0ZWQgZm9yIG1hdGNoaW5nIDt1c2VmdWwgdG8gZGVmaW5lIGEgd29yZCBvZiBhbGwKICAgICAgcHJpbnRhYmxlcyBleGNlcHQgZm9yIG9uZSBvciB0d28gY2hhcmFjdGVycywgZm9yIGluc3RhbmNlCiAgICAgIChkZWZhdWx0PWBgTm9uZWBgKQoKICAgIDpjbGFzczpgc3JhbmdlYCBpcyB1c2VmdWwgZm9yIGRlZmluaW5nIGN1c3RvbSBjaGFyYWN0ZXIgc2V0IHN0cmluZ3MKICAgIGZvciBkZWZpbmluZyA6Y2xhc3M6YFdvcmRgIGV4cHJlc3Npb25zLCB1c2luZyByYW5nZSBub3RhdGlvbiBmcm9tCiAgICByZWd1bGFyIGV4cHJlc3Npb24gY2hhcmFjdGVyIHNldHMuCgogICAgQSBjb21tb24gbWlzdGFrZSBpcyB0byB1c2UgOmNsYXNzOmBXb3JkYCB0byBtYXRjaCBhIHNwZWNpZmljIGxpdGVyYWwKICAgIHN0cmluZywgYXMgaW4gYGBXb3JkKFwiQWRkcmVzc1wiKWBgLiBSZW1lbWJlciB0aGF0IDpjbGFzczpgV29yZGAKICAgIHVzZXMgdGhlIHN0cmluZyBhcmd1bWVudCB0byBkZWZpbmUgKnNldHMqIG9mIG1hdGNoYWJsZSBjaGFyYWN0ZXJzLgogICAgVGhpcyBleHByZXNzaW9uIHdvdWxkIG1hdGNoIFwiQWRkXCIsIFwiQUFBXCIsIFwiZEFyZWRcIiwgb3IgYW55IG90aGVyIHdvcmQKICAgIG1hZGUgdXAgb2YgdGhlIGNoYXJhY3RlcnMgJ0EnLCAnZCcsICdyJywgJ2UnLCBhbmQgJ3MnLiBUbyBtYXRjaCBhbgogICAgZXhhY3QgbGl0ZXJhbCBzdHJpbmcsIHVzZSA6Y2xhc3M6YExpdGVyYWxgIG9yIDpjbGFzczpgS2V5d29yZGAuCgogICAgcHlwYXJzaW5nIGluY2x1ZGVzIGhlbHBlciBzdHJpbmdzIGZvciBidWlsZGluZyBXb3JkczoKCiAgICAtIDpjbGFzczpgYWxwaGFzYAogICAgLSA6Y2xhc3M6YG51bXNgCiAgICAtIDpjbGFzczpgYWxwaGFudW1zYAogICAgLSA6Y2xhc3M6YGhleG51bXNgCiAgICAtIDpjbGFzczpgYWxwaGFzOGJpdGAgKGFscGhhYmV0aWMgY2hhcmFjdGVycyBpbiBBU0NJSSByYW5nZSAxMjgtMjU1CiAgICAgIC0gYWNjZW50ZWQsIHRpbGRlZCwgdW1sYXV0ZWQsIGV0Yy4pCiAgICAtIDpjbGFzczpgcHVuYzhiaXRgIChub24tYWxwaGFiZXRpYyBjaGFyYWN0ZXJzIGluIEFTQ0lJIHJhbmdlCiAgICAgIDEyOC0yNTUgLSBjdXJyZW5jeSwgc3ltYm9scywgc3VwZXJzY3JpcHRzLCBkaWFjcml0aWNhbHMsIGV0Yy4pCiAgICAtIDpjbGFzczpgcHJpbnRhYmxlc2AgKGFueSBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXIpCgogICAgYGBhbHBoYXNgYCwgYGBudW1zYGAsIGFuZCBgYHByaW50YWJsZXNgYCBhcmUgYWxzbyBkZWZpbmVkIGluIHNldmVyYWwKICAgIFVuaWNvZGUgc2V0cyAtIHNlZSA6Y2xhc3M6YHB5cGFyc2luZ191bmljb2RlYGAuCgogICAgRXhhbXBsZTo6CgogICAgICAgICMgYSB3b3JkIGNvbXBvc2VkIG9mIGRpZ2l0cwogICAgICAgIGludGVnZXIgPSBXb3JkKG51bXMpICMgZXF1aXZhbGVudCB0byBXb3JkKFwiMDEyMzQ1Njc4OVwiKSBvciBXb3JkKHNyYW5nZShcIjAtOVwiKSkKCiAgICAgICAgIyBhIHdvcmQgd2l0aCBhIGxlYWRpbmcgY2FwaXRhbCwgYW5kIHplcm8gb3IgbW9yZSBsb3dlcmNhc2UKICAgICAgICBjYXBpdGFsX3dvcmQgPSBXb3JkKGFscGhhcy51cHBlcigpLCBhbHBoYXMubG93ZXIoKSkKCiAgICAgICAgIyBob3N0bmFtZXMgYXJlIGFscGhhbnVtZXJpYywgd2l0aCBsZWFkaW5nIGFscGhhLCBhbmQgJy0nCiAgICAgICAgaG9zdG5hbWUgPSBXb3JkKGFscGhhcywgYWxwaGFudW1zICsgJy0nKQoKICAgICAgICAjIHJvbWFuIG51bWVyYWwgKG5vdCBhIHN0cmljdCBwYXJzZXIsIGFjY2VwdHMgaW52YWxpZCBtaXggb2YgY2hhcmFjdGVycykKICAgICAgICByb21hbiA9IFdvcmQoXCJJVlhMQ0RNXCIpCgogICAgICAgICMgYW55IHN0cmluZyBvZiBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXJzLCBleGNlcHQgZm9yICcsJwogICAgICAgIGNzdl92YWx1ZSA9IFdvcmQocHJpbnRhYmxlcywgZXhjbHVkZV9jaGFycz1cIixcIikKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIGluaXRfY2hhcnM6IHN0ciA9IFwiXCIsCiAgICAgICAgYm9keV9jaGFyczogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgIG1pbjogaW50ID0gMSwKICAgICAgICBtYXg6IGludCA9IDAsCiAgICAgICAgZXhhY3Q6IGludCA9IDAsCiAgICAgICAgYXNfa2V5d29yZDogYm9vbCA9IEZhbHNlLAogICAgICAgIGV4Y2x1ZGVfY2hhcnM6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICAqLAogICAgICAgIGluaXRDaGFyczogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgIGJvZHlDaGFyczogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgIGFzS2V5d29yZDogYm9vbCA9IEZhbHNlLAogICAgICAgIGV4Y2x1ZGVDaGFyczogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgKToKICAgICAgICBpbml0Q2hhcnMgPSBpbml0Q2hhcnMgb3IgaW5pdF9jaGFycwogICAgICAgIGJvZHlDaGFycyA9IGJvZHlDaGFycyBvciBib2R5X2NoYXJzCiAgICAgICAgYXNLZXl3b3JkID0gYXNLZXl3b3JkIG9yIGFzX2tleXdvcmQKICAgICAgICBleGNsdWRlQ2hhcnMgPSBleGNsdWRlQ2hhcnMgb3IgZXhjbHVkZV9jaGFycwogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIGlmIG5vdCBpbml0Q2hhcnM6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICBcImludmFsaWQge30sIGluaXRDaGFycyBjYW5ub3QgYmUgZW1wdHkgc3RyaW5nXCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHR5cGUoc2VsZikuX19uYW1lX18KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICBpbml0Q2hhcnMgPSBzZXQoaW5pdENoYXJzKQogICAgICAgIHNlbGYuaW5pdENoYXJzID0gaW5pdENoYXJzCiAgICAgICAgaWYgZXhjbHVkZUNoYXJzOgogICAgICAgICAgICBleGNsdWRlQ2hhcnMgPSBzZXQoZXhjbHVkZUNoYXJzKQogICAgICAgICAgICBpbml0Q2hhcnMgLT0gZXhjbHVkZUNoYXJzCiAgICAgICAgICAgIGlmIGJvZHlDaGFyczoKICAgICAgICAgICAgICAgIGJvZHlDaGFycyA9IHNldChib2R5Q2hhcnMpIC0gZXhjbHVkZUNoYXJzCiAgICAgICAgc2VsZi5pbml0Q2hhcnNPcmlnID0gXCJcIi5qb2luKHNvcnRlZChpbml0Q2hhcnMpKQoKICAgICAgICBpZiBib2R5Q2hhcnM6CiAgICAgICAgICAgIHNlbGYuYm9keUNoYXJzT3JpZyA9IFwiXCIuam9pbihzb3J0ZWQoYm9keUNoYXJzKSkKICAgICAgICAgICAgc2VsZi5ib2R5Q2hhcnMgPSBzZXQoYm9keUNoYXJzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYm9keUNoYXJzT3JpZyA9IFwiXCIuam9pbihzb3J0ZWQoaW5pdENoYXJzKSkKICAgICAgICAgICAgc2VsZi5ib2R5Q2hhcnMgPSBzZXQoaW5pdENoYXJzKQoKICAgICAgICBzZWxmLm1heFNwZWNpZmllZCA9IG1heCA+IDAKCiAgICAgICAgaWYgbWluIDwgMToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgIFwiY2Fubm90IHNwZWNpZnkgYSBtaW5pbXVtIGxlbmd0aCA8IDE7IHVzZSBPcHQoV29yZCgpKSBpZiB6ZXJvLWxlbmd0aCB3b3JkIGlzIHBlcm1pdHRlZFwiCiAgICAgICAgICAgICkKCiAgICAgICAgc2VsZi5taW5MZW4gPSBtaW4KCiAgICAgICAgaWYgbWF4ID4gMDoKICAgICAgICAgICAgc2VsZi5tYXhMZW4gPSBtYXgKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1heExlbiA9IF9NQVhfSU5UCgogICAgICAgIGlmIGV4YWN0ID4gMDoKICAgICAgICAgICAgc2VsZi5tYXhMZW4gPSBleGFjdAogICAgICAgICAgICBzZWxmLm1pbkxlbiA9IGV4YWN0CgogICAgICAgIHNlbGYuZXJybXNnID0gXCJFeHBlY3RlZCBcIiArIHNlbGYubmFtZQogICAgICAgIHNlbGYubWF5SW5kZXhFcnJvciA9IEZhbHNlCiAgICAgICAgc2VsZi5hc0tleXdvcmQgPSBhc0tleXdvcmQKCiAgICAgICAgIyBzZWUgaWYgd2UgY2FuIG1ha2UgYSByZWdleCBmb3IgdGhpcyBXb3JkCiAgICAgICAgaWYgXCIgXCIgbm90IGluIHNlbGYuaW5pdENoYXJzIHwgc2VsZi5ib2R5Q2hhcnMgYW5kIChtaW4gPT0gMSBhbmQgZXhhY3QgPT0gMCk6CiAgICAgICAgICAgIGlmIHNlbGYuYm9keUNoYXJzID09IHNlbGYuaW5pdENoYXJzOgogICAgICAgICAgICAgICAgaWYgbWF4ID09IDA6CiAgICAgICAgICAgICAgICAgICAgcmVwZWF0ID0gXCIrXCIKICAgICAgICAgICAgICAgIGVsaWYgbWF4ID09IDE6CiAgICAgICAgICAgICAgICAgICAgcmVwZWF0ID0gXCJcIgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByZXBlYXQgPSBcInt7e30se319fVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5taW5MZW4sIFwiXCIgaWYgc2VsZi5tYXhMZW4gPT0gX01BWF9JTlQgZWxzZSBzZWxmLm1heExlbgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHNlbGYucmVTdHJpbmcgPSBcIlt7fV17fVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBfY29sbGFwc2Vfc3RyaW5nX3RvX3JhbmdlcyhzZWxmLmluaXRDaGFycyksCiAgICAgICAgICAgICAgICAgICAgcmVwZWF0LAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbGlmIGxlbihzZWxmLmluaXRDaGFycykgPT0gMToKICAgICAgICAgICAgICAgIGlmIG1heCA9PSAwOgogICAgICAgICAgICAgICAgICAgIHJlcGVhdCA9IFwiKlwiCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlcGVhdCA9IFwie3swLHt9fX1cIi5mb3JtYXQobWF4IC0gMSkKICAgICAgICAgICAgICAgIHNlbGYucmVTdHJpbmcgPSBcInt9W3t9XXt9XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHJlLmVzY2FwZShzZWxmLmluaXRDaGFyc09yaWcpLAogICAgICAgICAgICAgICAgICAgIF9jb2xsYXBzZV9zdHJpbmdfdG9fcmFuZ2VzKHNlbGYuYm9keUNoYXJzKSwKICAgICAgICAgICAgICAgICAgICByZXBlYXQsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBtYXggPT0gMDoKICAgICAgICAgICAgICAgICAgICByZXBlYXQgPSBcIipcIgogICAgICAgICAgICAgICAgZWxpZiBtYXggPT0gMjoKICAgICAgICAgICAgICAgICAgICByZXBlYXQgPSBcIlwiCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlcGVhdCA9IFwie3swLHt9fX1cIi5mb3JtYXQobWF4IC0gMSkKICAgICAgICAgICAgICAgIHNlbGYucmVTdHJpbmcgPSBcIlt7fV1be31de31cIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgX2NvbGxhcHNlX3N0cmluZ190b19yYW5nZXMoc2VsZi5pbml0Q2hhcnMpLAogICAgICAgICAgICAgICAgICAgIF9jb2xsYXBzZV9zdHJpbmdfdG9fcmFuZ2VzKHNlbGYuYm9keUNoYXJzKSwKICAgICAgICAgICAgICAgICAgICByZXBlYXQsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGlmIHNlbGYuYXNLZXl3b3JkOgogICAgICAgICAgICAgICAgc2VsZi5yZVN0cmluZyA9IHJcIlxcYlwiICsgc2VsZi5yZVN0cmluZyArIHJcIlxcYlwiCgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLnJlID0gcmUuY29tcGlsZShzZWxmLnJlU3RyaW5nKQogICAgICAgICAgICBleGNlcHQgcmUuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnJlID0gTm9uZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5yZV9tYXRjaCA9IHNlbGYucmUubWF0Y2gKICAgICAgICAgICAgICAgIHNlbGYuX19jbGFzc19fID0gX1dvcmRSZWdleAoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICBkZWYgY2hhcnNBc1N0cihzKToKICAgICAgICAgICAgbWF4X3JlcHJfbGVuID0gMTYKICAgICAgICAgICAgcyA9IF9jb2xsYXBzZV9zdHJpbmdfdG9fcmFuZ2VzKHMsIHJlX2VzY2FwZT1GYWxzZSkKICAgICAgICAgICAgaWYgbGVuKHMpID4gbWF4X3JlcHJfbGVuOgogICAgICAgICAgICAgICAgcmV0dXJuIHNbOiBtYXhfcmVwcl9sZW4gLSAzXSArIFwiLi4uXCIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBzCgogICAgICAgIGlmIHNlbGYuaW5pdENoYXJzICE9IHNlbGYuYm9keUNoYXJzOgogICAgICAgICAgICBiYXNlID0gXCJXOih7fSwge30pXCIuZm9ybWF0KAogICAgICAgICAgICAgICAgY2hhcnNBc1N0cihzZWxmLmluaXRDaGFycyksIGNoYXJzQXNTdHIoc2VsZi5ib2R5Q2hhcnMpCiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXNlID0gXCJXOih7fSlcIi5mb3JtYXQoY2hhcnNBc1N0cihzZWxmLmluaXRDaGFycykpCgogICAgICAgICMgYWRkIGxlbmd0aCBzcGVjaWZpY2F0aW9uCiAgICAgICAgaWYgc2VsZi5taW5MZW4gPiAxIG9yIHNlbGYubWF4TGVuICE9IF9NQVhfSU5UOgogICAgICAgICAgICBpZiBzZWxmLm1pbkxlbiA9PSBzZWxmLm1heExlbjoKICAgICAgICAgICAgICAgIGlmIHNlbGYubWluTGVuID09IDE6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJhc2VbMjpdCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBiYXNlICsgXCJ7e3t9fX1cIi5mb3JtYXQoc2VsZi5taW5MZW4pCiAgICAgICAgICAgIGVsaWYgc2VsZi5tYXhMZW4gPT0gX01BWF9JTlQ6CiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZSArIFwie3t7fSwuLi59fVwiLmZvcm1hdChzZWxmLm1pbkxlbikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBiYXNlICsgXCJ7e3t9LHt9fX1cIi5mb3JtYXQoc2VsZi5taW5MZW4sIHNlbGYubWF4TGVuKQogICAgICAgIHJldHVybiBiYXNlCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgaW5zdHJpbmdbbG9jXSBub3QgaW4gc2VsZi5pbml0Q2hhcnM6CiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQoKICAgICAgICBzdGFydCA9IGxvYwogICAgICAgIGxvYyArPSAxCiAgICAgICAgaW5zdHJsZW4gPSBsZW4oaW5zdHJpbmcpCiAgICAgICAgYm9keWNoYXJzID0gc2VsZi5ib2R5Q2hhcnMKICAgICAgICBtYXhsb2MgPSBzdGFydCArIHNlbGYubWF4TGVuCiAgICAgICAgbWF4bG9jID0gbWluKG1heGxvYywgaW5zdHJsZW4pCiAgICAgICAgd2hpbGUgbG9jIDwgbWF4bG9jIGFuZCBpbnN0cmluZ1tsb2NdIGluIGJvZHljaGFyczoKICAgICAgICAgICAgbG9jICs9IDEKCiAgICAgICAgdGhyb3dFeGNlcHRpb24gPSBGYWxzZQogICAgICAgIGlmIGxvYyAtIHN0YXJ0IDwgc2VsZi5taW5MZW46CiAgICAgICAgICAgIHRocm93RXhjZXB0aW9uID0gVHJ1ZQogICAgICAgIGVsaWYgc2VsZi5tYXhTcGVjaWZpZWQgYW5kIGxvYyA8IGluc3RybGVuIGFuZCBpbnN0cmluZ1tsb2NdIGluIGJvZHljaGFyczoKICAgICAgICAgICAgdGhyb3dFeGNlcHRpb24gPSBUcnVlCiAgICAgICAgZWxpZiBzZWxmLmFzS2V5d29yZDoKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgc3RhcnQgPiAwCiAgICAgICAgICAgICAgICBhbmQgaW5zdHJpbmdbc3RhcnQgLSAxXSBpbiBib2R5Y2hhcnMKICAgICAgICAgICAgICAgIG9yIGxvYyA8IGluc3RybGVuCiAgICAgICAgICAgICAgICBhbmQgaW5zdHJpbmdbbG9jXSBpbiBib2R5Y2hhcnMKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIHRocm93RXhjZXB0aW9uID0gVHJ1ZQoKICAgICAgICBpZiB0aHJvd0V4Y2VwdGlvbjoKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgogICAgICAgIHJldHVybiBsb2MsIGluc3RyaW5nW3N0YXJ0OmxvY10KCgpjbGFzcyBfV29yZFJlZ2V4KFdvcmQpOgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgcmVzdWx0ID0gc2VsZi5yZV9tYXRjaChpbnN0cmluZywgbG9jKQogICAgICAgIGlmIG5vdCByZXN1bHQ6CiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQoKICAgICAgICBsb2MgPSByZXN1bHQuZW5kKCkKICAgICAgICByZXR1cm4gbG9jLCByZXN1bHQuZ3JvdXAoKQoKCmNsYXNzIENoYXIoX1dvcmRSZWdleCk6CiAgICBcIlwiXCJBIHNob3J0LWN1dCBjbGFzcyBmb3IgZGVmaW5pbmcgOmNsYXNzOmBXb3JkYCBgYChjaGFyYWN0ZXJzLCBleGFjdD0xKWBgLAogICAgd2hlbiBkZWZpbmluZyBhIG1hdGNoIG9mIGFueSBzaW5nbGUgY2hhcmFjdGVyIGluIGEgc3RyaW5nIG9mCiAgICBjaGFyYWN0ZXJzLgogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgY2hhcnNldDogc3RyLAogICAgICAgIGFzX2tleXdvcmQ6IGJvb2wgPSBGYWxzZSwKICAgICAgICBleGNsdWRlX2NoYXJzOiB0eXBpbmcuT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgKiwKICAgICAgICBhc0tleXdvcmQ6IGJvb2wgPSBGYWxzZSwKICAgICAgICBleGNsdWRlQ2hhcnM6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICk6CiAgICAgICAgYXNLZXl3b3JkID0gYXNLZXl3b3JkIG9yIGFzX2tleXdvcmQKICAgICAgICBleGNsdWRlQ2hhcnMgPSBleGNsdWRlQ2hhcnMgb3IgZXhjbHVkZV9jaGFycwogICAgICAgIHN1cGVyKCkuX19pbml0X18oCiAgICAgICAgICAgIGNoYXJzZXQsIGV4YWN0PTEsIGFzS2V5d29yZD1hc0tleXdvcmQsIGV4Y2x1ZGVDaGFycz1leGNsdWRlQ2hhcnMKICAgICAgICApCiAgICAgICAgc2VsZi5yZVN0cmluZyA9IFwiW3t9XVwiLmZvcm1hdChfY29sbGFwc2Vfc3RyaW5nX3RvX3JhbmdlcyhzZWxmLmluaXRDaGFycykpCiAgICAgICAgaWYgYXNLZXl3b3JkOgogICAgICAgICAgICBzZWxmLnJlU3RyaW5nID0gclwiXFxie31cXGJcIi5mb3JtYXQoc2VsZi5yZVN0cmluZykKICAgICAgICBzZWxmLnJlID0gcmUuY29tcGlsZShzZWxmLnJlU3RyaW5nKQogICAgICAgIHNlbGYucmVfbWF0Y2ggPSBzZWxmLnJlLm1hdGNoCgoKY2xhc3MgUmVnZXgoVG9rZW4pOgogICAgclwiXCJcIlRva2VuIGZvciBtYXRjaGluZyBzdHJpbmdzIHRoYXQgbWF0Y2ggYSBnaXZlbiByZWd1bGFyCiAgICBleHByZXNzaW9uLiBEZWZpbmVkIHdpdGggc3RyaW5nIHNwZWNpZnlpbmcgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBpbgogICAgYSBmb3JtIHJlY29nbml6ZWQgYnkgdGhlIHN0ZGxpYiBQeXRob24gIGByZSBtb2R1bGUgPGh0dHBzOi8vZG9jcy5weXRob24ub3JnLzMvbGlicmFyeS9yZS5odG1sPmBfLgogICAgSWYgdGhlIGdpdmVuIHJlZ2V4IGNvbnRhaW5zIG5hbWVkIGdyb3VwcyAoZGVmaW5lZCB1c2luZyBgYCg/UDxuYW1lPi4uLilgYCksCiAgICB0aGVzZSB3aWxsIGJlIHByZXNlcnZlZCBhcyBuYW1lZCA6Y2xhc3M6YFBhcnNlUmVzdWx0c2AuCgogICAgSWYgaW5zdGVhZCBvZiB0aGUgUHl0aG9uIHN0ZGxpYiBgYHJlYGAgbW9kdWxlIHlvdSB3aXNoIHRvIHVzZSBhIGRpZmZlcmVudCBSRSBtb2R1bGUKICAgIChzdWNoIGFzIHRoZSBgYHJlZ2V4YGAgbW9kdWxlKSwgeW91IGNhbiBkbyBzbyBieSBidWlsZGluZyB5b3VyIGBgUmVnZXhgYCBvYmplY3Qgd2l0aAogICAgYSBjb21waWxlZCBSRSB0aGF0IHdhcyBjb21waWxlZCB1c2luZyBgYHJlZ2V4YGAuCgogICAgRXhhbXBsZTo6CgogICAgICAgIHJlYWxudW0gPSBSZWdleChyXCJbKy1dP1xcZCtcXC5cXGQqXCIpCiAgICAgICAgIyByZWY6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI2NzM5OS9ob3ctZG8teW91LW1hdGNoLW9ubHktdmFsaWQtcm9tYW4tbnVtZXJhbHMtd2l0aC1hLXJlZ3VsYXItZXhwcmVzc2lvbgogICAgICAgIHJvbWFuID0gUmVnZXgoclwiTXswLDR9KENNfENEfEQ/ezAsM30pKFhDfFhMfEw/WHswLDN9KShJWHxJVnxWP0l7MCwzfSlcIikKCiAgICAgICAgIyBuYW1lZCBmaWVsZHMgaW4gYSByZWdleCB3aWxsIGJlIHJldHVybmVkIGFzIG5hbWVkIHJlc3VsdHMKICAgICAgICBkYXRlID0gUmVnZXgocicoP1A8eWVhcj5cXGR7NH0pLSg/UDxtb250aD5cXGRcXGQ/KS0oP1A8ZGF5PlxcZFxcZD8pJykKCiAgICAgICAgIyB0aGUgUmVnZXggY2xhc3Mgd2lsbCBhY2NlcHQgcmUncyBjb21waWxlZCB1c2luZyB0aGUgcmVnZXggbW9kdWxlCiAgICAgICAgaW1wb3J0IHJlZ2V4CiAgICAgICAgcGFyc2VyID0gcHAuUmVnZXgocmVnZXguY29tcGlsZShyJ1swLTldJykpCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBwYXR0ZXJuOiBBbnksCiAgICAgICAgZmxhZ3M6IFVuaW9uW3JlLlJlZ2V4RmxhZywgaW50XSA9IDAsCiAgICAgICAgYXNfZ3JvdXBfbGlzdDogYm9vbCA9IEZhbHNlLAogICAgICAgIGFzX21hdGNoOiBib29sID0gRmFsc2UsCiAgICAgICAgKiwKICAgICAgICBhc0dyb3VwTGlzdDogYm9vbCA9IEZhbHNlLAogICAgICAgIGFzTWF0Y2g6IGJvb2wgPSBGYWxzZSwKICAgICk6CiAgICAgICAgXCJcIlwiVGhlIHBhcmFtZXRlcnMgYGBwYXR0ZXJuYGAgYW5kIGBgZmxhZ3NgYCBhcmUgcGFzc2VkCiAgICAgICAgdG8gdGhlIGBgcmUuY29tcGlsZSgpYGAgZnVuY3Rpb24gYXMtaXMuIFNlZSB0aGUgUHl0aG9uCiAgICAgICAgYHJlIG1vZHVsZSA8aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy9saWJyYXJ5L3JlLmh0bWw+YF8gbW9kdWxlIGZvciBhbgogICAgICAgIGV4cGxhbmF0aW9uIG9mIHRoZSBhY2NlcHRhYmxlIHBhdHRlcm5zIGFuZCBmbGFncy4KICAgICAgICBcIlwiXCIKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBhc0dyb3VwTGlzdCA9IGFzR3JvdXBMaXN0IG9yIGFzX2dyb3VwX2xpc3QKICAgICAgICBhc01hdGNoID0gYXNNYXRjaCBvciBhc19tYXRjaAoKICAgICAgICBpZiBpc2luc3RhbmNlKHBhdHRlcm4sIHN0cl90eXBlKToKICAgICAgICAgICAgaWYgbm90IHBhdHRlcm46CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKFwibnVsbCBzdHJpbmcgcGFzc2VkIHRvIFJlZ2V4OyB1c2UgRW1wdHkoKSBpbnN0ZWFkXCIpCgogICAgICAgICAgICBzZWxmLl9yZSA9IE5vbmUKICAgICAgICAgICAgc2VsZi5yZVN0cmluZyA9IHNlbGYucGF0dGVybiA9IHBhdHRlcm4KICAgICAgICAgICAgc2VsZi5mbGFncyA9IGZsYWdzCgogICAgICAgIGVsaWYgaGFzYXR0cihwYXR0ZXJuLCBcInBhdHRlcm5cIikgYW5kIGhhc2F0dHIocGF0dGVybiwgXCJtYXRjaFwiKToKICAgICAgICAgICAgc2VsZi5fcmUgPSBwYXR0ZXJuCiAgICAgICAgICAgIHNlbGYucGF0dGVybiA9IHNlbGYucmVTdHJpbmcgPSBwYXR0ZXJuLnBhdHRlcm4KICAgICAgICAgICAgc2VsZi5mbGFncyA9IGZsYWdzCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIFwiUmVnZXggbWF5IG9ubHkgYmUgY29uc3RydWN0ZWQgd2l0aCBhIHN0cmluZyBvciBhIGNvbXBpbGVkIFJFIG9iamVjdFwiCiAgICAgICAgICAgICkKCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIkV4cGVjdGVkIFwiICsgc2VsZi5uYW1lCiAgICAgICAgc2VsZi5tYXlJbmRleEVycm9yID0gRmFsc2UKICAgICAgICBzZWxmLmFzR3JvdXBMaXN0ID0gYXNHcm91cExpc3QKICAgICAgICBzZWxmLmFzTWF0Y2ggPSBhc01hdGNoCiAgICAgICAgaWYgc2VsZi5hc0dyb3VwTGlzdDoKICAgICAgICAgICAgc2VsZi5wYXJzZUltcGwgPSBzZWxmLnBhcnNlSW1wbEFzR3JvdXBMaXN0CiAgICAgICAgaWYgc2VsZi5hc01hdGNoOgogICAgICAgICAgICBzZWxmLnBhcnNlSW1wbCA9IHNlbGYucGFyc2VJbXBsQXNNYXRjaAoKICAgIEBjYWNoZWRfcHJvcGVydHkKICAgIGRlZiByZShzZWxmKToKICAgICAgICBpZiBzZWxmLl9yZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3JlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIHJlLmNvbXBpbGUoc2VsZi5wYXR0ZXJuLCBzZWxmLmZsYWdzKQogICAgICAgICAgICBleGNlcHQgcmUuZXJyb3I6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgICAgIFwiaW52YWxpZCBwYXR0ZXJuICh7IXJ9KSBwYXNzZWQgdG8gUmVnZXhcIi5mb3JtYXQoc2VsZi5wYXR0ZXJuKQogICAgICAgICAgICAgICAgKQoKICAgIEBjYWNoZWRfcHJvcGVydHkKICAgIGRlZiByZV9tYXRjaChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5yZS5tYXRjaAoKICAgIEBjYWNoZWRfcHJvcGVydHkKICAgIGRlZiBtYXlSZXR1cm5FbXB0eShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5yZV9tYXRjaChcIlwiKSBpcyBub3QgTm9uZQoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gXCJSZTooe30pXCIuZm9ybWF0KHJlcHIoc2VsZi5wYXR0ZXJuKS5yZXBsYWNlKFwiXFxcXFxcXFxcIiwgXCJcXFxcXCIpKQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIHJlc3VsdCA9IHNlbGYucmVfbWF0Y2goaW5zdHJpbmcsIGxvYykKICAgICAgICBpZiBub3QgcmVzdWx0OgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKCiAgICAgICAgbG9jID0gcmVzdWx0LmVuZCgpCiAgICAgICAgcmV0ID0gUGFyc2VSZXN1bHRzKHJlc3VsdC5ncm91cCgpKQogICAgICAgIGQgPSByZXN1bHQuZ3JvdXBkaWN0KCkKICAgICAgICBpZiBkOgogICAgICAgICAgICBmb3IgaywgdiBpbiBkLml0ZW1zKCk6CiAgICAgICAgICAgICAgICByZXRba10gPSB2CiAgICAgICAgcmV0dXJuIGxvYywgcmV0CgogICAgZGVmIHBhcnNlSW1wbEFzR3JvdXBMaXN0KHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICByZXN1bHQgPSBzZWxmLnJlX21hdGNoKGluc3RyaW5nLCBsb2MpCiAgICAgICAgaWYgbm90IHJlc3VsdDoKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgogICAgICAgIGxvYyA9IHJlc3VsdC5lbmQoKQogICAgICAgIHJldCA9IHJlc3VsdC5ncm91cHMoKQogICAgICAgIHJldHVybiBsb2MsIHJldAoKICAgIGRlZiBwYXJzZUltcGxBc01hdGNoKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICByZXN1bHQgPSBzZWxmLnJlX21hdGNoKGluc3RyaW5nLCBsb2MpCiAgICAgICAgaWYgbm90IHJlc3VsdDoKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgogICAgICAgIGxvYyA9IHJlc3VsdC5lbmQoKQogICAgICAgIHJldCA9IHJlc3VsdAogICAgICAgIHJldHVybiBsb2MsIHJldAoKICAgIGRlZiBzdWIoc2VsZiwgcmVwbDogc3RyKSAtPiBQYXJzZXJFbGVtZW50OgogICAgICAgIHJcIlwiXCIKICAgICAgICBSZXR1cm4gOmNsYXNzOmBSZWdleGAgd2l0aCBhbiBhdHRhY2hlZCBwYXJzZSBhY3Rpb24gdG8gdHJhbnNmb3JtIHRoZSBwYXJzZWQKICAgICAgICByZXN1bHQgYXMgaWYgY2FsbGVkIHVzaW5nIGByZS5zdWIoZXhwciwgcmVwbCwgc3RyaW5nKSA8aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy9saWJyYXJ5L3JlLmh0bWwjcmUuc3ViPmBfLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIG1ha2VfaHRtbCA9IFJlZ2V4KHJcIihcXHcrKTooLio/KTpcIikuc3ViKHJcIjxcXDE+XFwyPC9cXDE+XCIpCiAgICAgICAgICAgIHByaW50KG1ha2VfaHRtbC50cmFuc2Zvcm1fc3RyaW5nKFwiaDE6bWFpbiB0aXRsZTpcIikpCiAgICAgICAgICAgICMgcHJpbnRzIFwiPGgxPm1haW4gdGl0bGU8L2gxPlwiCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYgc2VsZi5hc0dyb3VwTGlzdDoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKFwiY2Fubm90IHVzZSBzdWIoKSB3aXRoIFJlZ2V4KGFzR3JvdXBMaXN0PVRydWUpXCIpCgogICAgICAgIGlmIHNlbGYuYXNNYXRjaCBhbmQgY2FsbGFibGUocmVwbCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihcImNhbm5vdCB1c2Ugc3ViKCkgd2l0aCBhIGNhbGxhYmxlIHdpdGggUmVnZXgoYXNNYXRjaD1UcnVlKVwiKQoKICAgICAgICBpZiBzZWxmLmFzTWF0Y2g6CgogICAgICAgICAgICBkZWYgcGEodG9rZW5zKToKICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbnNbMF0uZXhwYW5kKHJlcGwpCgogICAgICAgIGVsc2U6CgogICAgICAgICAgICBkZWYgcGEodG9rZW5zKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnJlLnN1YihyZXBsLCB0b2tlbnNbMF0pCgogICAgICAgIHJldHVybiBzZWxmLmFkZF9wYXJzZV9hY3Rpb24ocGEpCgoKY2xhc3MgUXVvdGVkU3RyaW5nKFRva2VuKToKICAgIHJcIlwiXCIKICAgIFRva2VuIGZvciBtYXRjaGluZyBzdHJpbmdzIHRoYXQgYXJlIGRlbGltaXRlZCBieSBxdW90aW5nIGNoYXJhY3RlcnMuCgogICAgRGVmaW5lZCB3aXRoIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoKCiAgICAtIGBgcXVvdGVfY2hhcmBgIC0gc3RyaW5nIG9mIG9uZSBvciBtb3JlIGNoYXJhY3RlcnMgZGVmaW5pbmcgdGhlCiAgICAgIHF1b3RlIGRlbGltaXRpbmcgc3RyaW5nCiAgICAtIGBgZXNjX2NoYXJgYCAtIGNoYXJhY3RlciB0byByZV9lc2NhcGUgcXVvdGVzLCB0eXBpY2FsbHkgYmFja3NsYXNoCiAgICAgIChkZWZhdWx0PSBgYE5vbmVgYCkKICAgIC0gYGBlc2NfcXVvdGVgYCAtIHNwZWNpYWwgcXVvdGUgc2VxdWVuY2UgdG8gcmVfZXNjYXBlIGFuIGVtYmVkZGVkIHF1b3RlCiAgICAgIHN0cmluZyAoc3VjaCBhcyBTUUwncyBgYFwiXCJgYCB0byByZV9lc2NhcGUgYW4gZW1iZWRkZWQgYGBcImBgKQogICAgICAoZGVmYXVsdD0gYGBOb25lYGApCiAgICAtIGBgbXVsdGlsaW5lYGAgLSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciBxdW90ZXMgY2FuIHNwYW4KICAgICAgbXVsdGlwbGUgbGluZXMgKGRlZmF1bHQ9IGBgRmFsc2VgYCkKICAgIC0gYGB1bnF1b3RlX3Jlc3VsdHNgYCAtIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIHRoZSBtYXRjaGVkIHRleHQKICAgICAgc2hvdWxkIGJlIHVucXVvdGVkIChkZWZhdWx0PSBgYFRydWVgYCkKICAgIC0gYGBlbmRfcXVvdGVfY2hhcmBgIC0gc3RyaW5nIG9mIG9uZSBvciBtb3JlIGNoYXJhY3RlcnMgZGVmaW5pbmcgdGhlCiAgICAgIGVuZCBvZiB0aGUgcXVvdGUgZGVsaW1pdGVkIHN0cmluZyAoZGVmYXVsdD0gYGBOb25lYGAgID0+IHNhbWUgYXMKICAgICAgcXVvdGVfY2hhcikKICAgIC0gYGBjb252ZXJ0X3doaXRlc3BhY2VfZXNjYXBlc2BgIC0gY29udmVydCBlc2NhcGVkIHdoaXRlc3BhY2UKICAgICAgKGBgJ1xcdCdgYCwgYGAnXFxuJ2BgLCBldGMuKSB0byBhY3R1YWwgd2hpdGVzcGFjZQogICAgICAoZGVmYXVsdD0gYGBUcnVlYGApCgogICAgRXhhbXBsZTo6CgogICAgICAgIHFzID0gUXVvdGVkU3RyaW5nKCdcIicpCiAgICAgICAgcHJpbnQocXMuc2VhcmNoX3N0cmluZygnbHNqZGYgXCJUaGlzIGlzIHRoZSBxdW90ZVwiIHNsZGpmJykpCiAgICAgICAgY29tcGxleF9xcyA9IFF1b3RlZFN0cmluZygne3snLCBlbmRfcXVvdGVfY2hhcj0nfX0nKQogICAgICAgIHByaW50KGNvbXBsZXhfcXMuc2VhcmNoX3N0cmluZygnbHNqZGYge3tUaGlzIGlzIHRoZSBcInF1b3RlXCJ9fSBzbGRqZicpKQogICAgICAgIHNxbF9xcyA9IFF1b3RlZFN0cmluZygnXCInLCBlc2NfcXVvdGU9J1wiXCInKQogICAgICAgIHByaW50KHNxbF9xcy5zZWFyY2hfc3RyaW5nKCdsc2pkZiBcIlRoaXMgaXMgdGhlIHF1b3RlIHdpdGggXCJcImVtYmVkZGVkXCJcIiBxdW90ZXNcIiBzbGRqZicpKQoKICAgIHByaW50czo6CgogICAgICAgIFtbJ1RoaXMgaXMgdGhlIHF1b3RlJ11dCiAgICAgICAgW1snVGhpcyBpcyB0aGUgXCJxdW90ZVwiJ11dCiAgICAgICAgW1snVGhpcyBpcyB0aGUgcXVvdGUgd2l0aCBcImVtYmVkZGVkXCIgcXVvdGVzJ11dCiAgICBcIlwiXCIKICAgIHdzX21hcCA9ICgoclwiXFx0XCIsIFwiXFx0XCIpLCAoclwiXFxuXCIsIFwiXFxuXCIpLCAoclwiXFxmXCIsIFwiXFxmXCIpLCAoclwiXFxyXCIsIFwiXFxyXCIpKQoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIHF1b3RlX2NoYXI6IHN0ciA9IFwiXCIsCiAgICAgICAgZXNjX2NoYXI6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICBlc2NfcXVvdGU6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICBtdWx0aWxpbmU6IGJvb2wgPSBGYWxzZSwKICAgICAgICB1bnF1b3RlX3Jlc3VsdHM6IGJvb2wgPSBUcnVlLAogICAgICAgIGVuZF9xdW90ZV9jaGFyOiB0eXBpbmcuT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgY29udmVydF93aGl0ZXNwYWNlX2VzY2FwZXM6IGJvb2wgPSBUcnVlLAogICAgICAgICosCiAgICAgICAgcXVvdGVDaGFyOiBzdHIgPSBcIlwiLAogICAgICAgIGVzY0NoYXI6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICBlc2NRdW90ZTogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgIHVucXVvdGVSZXN1bHRzOiBib29sID0gVHJ1ZSwKICAgICAgICBlbmRRdW90ZUNoYXI6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICBjb252ZXJ0V2hpdGVzcGFjZUVzY2FwZXM6IGJvb2wgPSBUcnVlLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBlc2NDaGFyID0gZXNjQ2hhciBvciBlc2NfY2hhcgogICAgICAgIGVzY1F1b3RlID0gZXNjUXVvdGUgb3IgZXNjX3F1b3RlCiAgICAgICAgdW5xdW90ZVJlc3VsdHMgPSB1bnF1b3RlUmVzdWx0cyBhbmQgdW5xdW90ZV9yZXN1bHRzCiAgICAgICAgZW5kUXVvdGVDaGFyID0gZW5kUXVvdGVDaGFyIG9yIGVuZF9xdW90ZV9jaGFyCiAgICAgICAgY29udmVydFdoaXRlc3BhY2VFc2NhcGVzID0gKAogICAgICAgICAgICBjb252ZXJ0V2hpdGVzcGFjZUVzY2FwZXMgYW5kIGNvbnZlcnRfd2hpdGVzcGFjZV9lc2NhcGVzCiAgICAgICAgKQogICAgICAgIHF1b3RlX2NoYXIgPSBxdW90ZUNoYXIgb3IgcXVvdGVfY2hhcgoKICAgICAgICAjIHJlbW92ZSB3aGl0ZSBzcGFjZSBmcm9tIHF1b3RlIGNoYXJzIC0gd29udCB3b3JrIGFueXdheQogICAgICAgIHF1b3RlX2NoYXIgPSBxdW90ZV9jaGFyLnN0cmlwKCkKICAgICAgICBpZiBub3QgcXVvdGVfY2hhcjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihcInF1b3RlX2NoYXIgY2Fubm90IGJlIHRoZSBlbXB0eSBzdHJpbmdcIikKCiAgICAgICAgaWYgZW5kUXVvdGVDaGFyIGlzIE5vbmU6CiAgICAgICAgICAgIGVuZFF1b3RlQ2hhciA9IHF1b3RlX2NoYXIKICAgICAgICBlbHNlOgogICAgICAgICAgICBlbmRRdW90ZUNoYXIgPSBlbmRRdW90ZUNoYXIuc3RyaXAoKQogICAgICAgICAgICBpZiBub3QgZW5kUXVvdGVDaGFyOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihcImVuZFF1b3RlQ2hhciBjYW5ub3QgYmUgdGhlIGVtcHR5IHN0cmluZ1wiKQoKICAgICAgICBzZWxmLnF1b3RlQ2hhciA9IHF1b3RlX2NoYXIKICAgICAgICBzZWxmLnF1b3RlQ2hhckxlbiA9IGxlbihxdW90ZV9jaGFyKQogICAgICAgIHNlbGYuZmlyc3RRdW90ZUNoYXIgPSBxdW90ZV9jaGFyWzBdCiAgICAgICAgc2VsZi5lbmRRdW90ZUNoYXIgPSBlbmRRdW90ZUNoYXIKICAgICAgICBzZWxmLmVuZFF1b3RlQ2hhckxlbiA9IGxlbihlbmRRdW90ZUNoYXIpCiAgICAgICAgc2VsZi5lc2NDaGFyID0gZXNjQ2hhcgogICAgICAgIHNlbGYuZXNjUXVvdGUgPSBlc2NRdW90ZQogICAgICAgIHNlbGYudW5xdW90ZVJlc3VsdHMgPSB1bnF1b3RlUmVzdWx0cwogICAgICAgIHNlbGYuY29udmVydFdoaXRlc3BhY2VFc2NhcGVzID0gY29udmVydFdoaXRlc3BhY2VFc2NhcGVzCgogICAgICAgIHNlcCA9IFwiXCIKICAgICAgICBpbm5lcl9wYXR0ZXJuID0gXCJcIgoKICAgICAgICBpZiBlc2NRdW90ZToKICAgICAgICAgICAgaW5uZXJfcGF0dGVybiArPSByXCJ7fSg/Ont9KVwiLmZvcm1hdChzZXAsIHJlLmVzY2FwZShlc2NRdW90ZSkpCiAgICAgICAgICAgIHNlcCA9IFwifFwiCgogICAgICAgIGlmIGVzY0NoYXI6CiAgICAgICAgICAgIGlubmVyX3BhdHRlcm4gKz0gclwie30oPzp7fS4pXCIuZm9ybWF0KHNlcCwgcmUuZXNjYXBlKGVzY0NoYXIpKQogICAgICAgICAgICBzZXAgPSBcInxcIgogICAgICAgICAgICBzZWxmLmVzY0NoYXJSZXBsYWNlUGF0dGVybiA9IHJlLmVzY2FwZShzZWxmLmVzY0NoYXIpICsgXCIoLilcIgoKICAgICAgICBpZiBsZW4oc2VsZi5lbmRRdW90ZUNoYXIpID4gMToKICAgICAgICAgICAgaW5uZXJfcGF0dGVybiArPSAoCiAgICAgICAgICAgICAgICBcInt9KD86XCIuZm9ybWF0KHNlcCkKICAgICAgICAgICAgICAgICsgXCJ8XCIuam9pbigKICAgICAgICAgICAgICAgICAgICBcIig/Ont9KD8he30pKVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgcmUuZXNjYXBlKHNlbGYuZW5kUXVvdGVDaGFyWzppXSksCiAgICAgICAgICAgICAgICAgICAgICAgIHJlLmVzY2FwZShzZWxmLmVuZFF1b3RlQ2hhcltpOl0pLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZShsZW4oc2VsZi5lbmRRdW90ZUNoYXIpIC0gMSwgMCwgLTEpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICArIFwiKVwiCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VwID0gXCJ8XCIKCiAgICAgICAgaWYgbXVsdGlsaW5lOgogICAgICAgICAgICBzZWxmLmZsYWdzID0gcmUuTVVMVElMSU5FIHwgcmUuRE9UQUxMCiAgICAgICAgICAgIGlubmVyX3BhdHRlcm4gKz0gclwie30oPzpbXnt9e31dKVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgIHNlcCwKICAgICAgICAgICAgICAgIF9lc2NhcGVfcmVnZXhfcmFuZ2VfY2hhcnMoc2VsZi5lbmRRdW90ZUNoYXJbMF0pLAogICAgICAgICAgICAgICAgKF9lc2NhcGVfcmVnZXhfcmFuZ2VfY2hhcnMoZXNjQ2hhcikgaWYgZXNjQ2hhciBpcyBub3QgTm9uZSBlbHNlIFwiXCIpLAogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mbGFncyA9IDAKICAgICAgICAgICAgaW5uZXJfcGF0dGVybiArPSByXCJ7fSg/Oltee31cXG5cXHJ7fV0pXCIuZm9ybWF0KAogICAgICAgICAgICAgICAgc2VwLAogICAgICAgICAgICAgICAgX2VzY2FwZV9yZWdleF9yYW5nZV9jaGFycyhzZWxmLmVuZFF1b3RlQ2hhclswXSksCiAgICAgICAgICAgICAgICAoX2VzY2FwZV9yZWdleF9yYW5nZV9jaGFycyhlc2NDaGFyKSBpZiBlc2NDaGFyIGlzIG5vdCBOb25lIGVsc2UgXCJcIiksCiAgICAgICAgICAgICkKCiAgICAgICAgc2VsZi5wYXR0ZXJuID0gXCJcIi5qb2luKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICByZS5lc2NhcGUoc2VsZi5xdW90ZUNoYXIpLAogICAgICAgICAgICAgICAgXCIoPzpcIiwKICAgICAgICAgICAgICAgIGlubmVyX3BhdHRlcm4sCiAgICAgICAgICAgICAgICBcIikqXCIsCiAgICAgICAgICAgICAgICByZS5lc2NhcGUoc2VsZi5lbmRRdW90ZUNoYXIpLAogICAgICAgICAgICBdCiAgICAgICAgKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYucmUgPSByZS5jb21waWxlKHNlbGYucGF0dGVybiwgc2VsZi5mbGFncykKICAgICAgICAgICAgc2VsZi5yZVN0cmluZyA9IHNlbGYucGF0dGVybgogICAgICAgICAgICBzZWxmLnJlX21hdGNoID0gc2VsZi5yZS5tYXRjaAogICAgICAgIGV4Y2VwdCByZS5lcnJvcjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgIFwiaW52YWxpZCBwYXR0ZXJuIHshcn0gcGFzc2VkIHRvIFJlZ2V4XCIuZm9ybWF0KHNlbGYucGF0dGVybikKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLmVycm1zZyA9IFwiRXhwZWN0ZWQgXCIgKyBzZWxmLm5hbWUKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBGYWxzZQogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIGlmIHNlbGYucXVvdGVDaGFyID09IHNlbGYuZW5kUXVvdGVDaGFyIGFuZCBpc2luc3RhbmNlKHNlbGYucXVvdGVDaGFyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIHJldHVybiBcInN0cmluZyBlbmNsb3NlZCBpbiB7IXJ9XCIuZm9ybWF0KHNlbGYucXVvdGVDaGFyKQoKICAgICAgICByZXR1cm4gXCJxdW90ZWQgc3RyaW5nLCBzdGFydGluZyB3aXRoIHt9IGVuZGluZyB3aXRoIHt9XCIuZm9ybWF0KAogICAgICAgICAgICBzZWxmLnF1b3RlQ2hhciwgc2VsZi5lbmRRdW90ZUNoYXIKICAgICAgICApCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgcmVzdWx0ID0gKAogICAgICAgICAgICBpbnN0cmluZ1tsb2NdID09IHNlbGYuZmlyc3RRdW90ZUNoYXIKICAgICAgICAgICAgYW5kIHNlbGYucmVfbWF0Y2goaW5zdHJpbmcsIGxvYykKICAgICAgICAgICAgb3IgTm9uZQogICAgICAgICkKICAgICAgICBpZiBub3QgcmVzdWx0OgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKCiAgICAgICAgbG9jID0gcmVzdWx0LmVuZCgpCiAgICAgICAgcmV0ID0gcmVzdWx0Lmdyb3VwKCkKCiAgICAgICAgaWYgc2VsZi51bnF1b3RlUmVzdWx0czoKCiAgICAgICAgICAgICMgc3RyaXAgb2ZmIHF1b3RlcwogICAgICAgICAgICByZXQgPSByZXRbc2VsZi5xdW90ZUNoYXJMZW4gOiAtc2VsZi5lbmRRdW90ZUNoYXJMZW5dCgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHJldCwgc3RyX3R5cGUpOgogICAgICAgICAgICAgICAgIyByZXBsYWNlIGVzY2FwZWQgd2hpdGVzcGFjZQogICAgICAgICAgICAgICAgaWYgXCJcXFxcXCIgaW4gcmV0IGFuZCBzZWxmLmNvbnZlcnRXaGl0ZXNwYWNlRXNjYXBlczoKICAgICAgICAgICAgICAgICAgICBmb3Igd3NsaXQsIHdzY2hhciBpbiBzZWxmLndzX21hcDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gcmV0LnJlcGxhY2Uod3NsaXQsIHdzY2hhcikKCiAgICAgICAgICAgICAgICAjIHJlcGxhY2UgZXNjYXBlZCBjaGFyYWN0ZXJzCiAgICAgICAgICAgICAgICBpZiBzZWxmLmVzY0NoYXI6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gcmUuc3ViKHNlbGYuZXNjQ2hhclJlcGxhY2VQYXR0ZXJuLCByXCJcXGc8MT5cIiwgcmV0KQoKICAgICAgICAgICAgICAgICMgcmVwbGFjZSBlc2NhcGVkIHF1b3RlcwogICAgICAgICAgICAgICAgaWYgc2VsZi5lc2NRdW90ZToKICAgICAgICAgICAgICAgICAgICByZXQgPSByZXQucmVwbGFjZShzZWxmLmVzY1F1b3RlLCBzZWxmLmVuZFF1b3RlQ2hhcikKCiAgICAgICAgcmV0dXJuIGxvYywgcmV0CgoKY2xhc3MgQ2hhcnNOb3RJbihUb2tlbik6CiAgICBcIlwiXCJUb2tlbiBmb3IgbWF0Y2hpbmcgd29yZHMgY29tcG9zZWQgb2YgY2hhcmFjdGVycyAqbm90KiBpbiBhIGdpdmVuCiAgICBzZXQgKHdpbGwgaW5jbHVkZSB3aGl0ZXNwYWNlIGluIG1hdGNoZWQgY2hhcmFjdGVycyBpZiBub3QgbGlzdGVkIGluCiAgICB0aGUgcHJvdmlkZWQgZXhjbHVzaW9uIHNldCAtIHNlZSBleGFtcGxlKS4gRGVmaW5lZCB3aXRoIHN0cmluZwogICAgY29udGFpbmluZyBhbGwgZGlzYWxsb3dlZCBjaGFyYWN0ZXJzLCBhbmQgYW4gb3B0aW9uYWwgbWluaW11bSwKICAgIG1heGltdW0sIGFuZC9vciBleGFjdCBsZW5ndGguICBUaGUgZGVmYXVsdCB2YWx1ZSBmb3IgYGBtaW5gYCBpcwogICAgMSAoYSBtaW5pbXVtIHZhbHVlIDwgMSBpcyBub3QgdmFsaWQpOyB0aGUgZGVmYXVsdCB2YWx1ZXMgZm9yCiAgICBgYG1heGBgIGFuZCBgYGV4YWN0YGAgYXJlIDAsIG1lYW5pbmcgbm8gbWF4aW11bSBvciBleGFjdAogICAgbGVuZ3RoIHJlc3RyaWN0aW9uLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICAjIGRlZmluZSBhIGNvbW1hLXNlcGFyYXRlZC12YWx1ZSBhcyBhbnl0aGluZyB0aGF0IGlzIG5vdCBhICcsJwogICAgICAgIGNzdl92YWx1ZSA9IENoYXJzTm90SW4oJywnKQogICAgICAgIHByaW50KGRlbGltaXRlZF9saXN0KGNzdl92YWx1ZSkucGFyc2Vfc3RyaW5nKFwiZGtscyxsc2RramYsczEyIDM0LEAhIywyMTNcIikpCgogICAgcHJpbnRzOjoKCiAgICAgICAgWydka2xzJywgJ2xzZGtqZicsICdzMTIgMzQnLCAnQCEjJywgJzIxMyddCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBub3RfY2hhcnM6IHN0ciA9IFwiXCIsCiAgICAgICAgbWluOiBpbnQgPSAxLAogICAgICAgIG1heDogaW50ID0gMCwKICAgICAgICBleGFjdDogaW50ID0gMCwKICAgICAgICAqLAogICAgICAgIG5vdENoYXJzOiBzdHIgPSBcIlwiLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gRmFsc2UKICAgICAgICBzZWxmLm5vdENoYXJzID0gbm90X2NoYXJzIG9yIG5vdENoYXJzCiAgICAgICAgc2VsZi5ub3RDaGFyc1NldCA9IHNldChzZWxmLm5vdENoYXJzKQoKICAgICAgICBpZiBtaW4gPCAxOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgXCJjYW5ub3Qgc3BlY2lmeSBhIG1pbmltdW0gbGVuZ3RoIDwgMTsgdXNlIFwiCiAgICAgICAgICAgICAgICBcIk9wdChDaGFyc05vdEluKCkpIGlmIHplcm8tbGVuZ3RoIGNoYXIgZ3JvdXAgaXMgcGVybWl0dGVkXCIKICAgICAgICAgICAgKQoKICAgICAgICBzZWxmLm1pbkxlbiA9IG1pbgoKICAgICAgICBpZiBtYXggPiAwOgogICAgICAgICAgICBzZWxmLm1heExlbiA9IG1heAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYubWF4TGVuID0gX01BWF9JTlQKCiAgICAgICAgaWYgZXhhY3QgPiAwOgogICAgICAgICAgICBzZWxmLm1heExlbiA9IGV4YWN0CiAgICAgICAgICAgIHNlbGYubWluTGVuID0gZXhhY3QKCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIkV4cGVjdGVkIFwiICsgc2VsZi5uYW1lCiAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IHNlbGYubWluTGVuID09IDAKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBGYWxzZQoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICBub3RfY2hhcnNfc3RyID0gX2NvbGxhcHNlX3N0cmluZ190b19yYW5nZXMoc2VsZi5ub3RDaGFycykKICAgICAgICBpZiBsZW4obm90X2NoYXJzX3N0cikgPiAxNjoKICAgICAgICAgICAgcmV0dXJuIFwiIVc6KHt9Li4uKVwiLmZvcm1hdChzZWxmLm5vdENoYXJzWzogMTYgLSAzXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gXCIhVzooe30pXCIuZm9ybWF0KHNlbGYubm90Q2hhcnMpCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgbm90Y2hhcnMgPSBzZWxmLm5vdENoYXJzU2V0CiAgICAgICAgaWYgaW5zdHJpbmdbbG9jXSBpbiBub3RjaGFyczoKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgogICAgICAgIHN0YXJ0ID0gbG9jCiAgICAgICAgbG9jICs9IDEKICAgICAgICBtYXhsZW4gPSBtaW4oc3RhcnQgKyBzZWxmLm1heExlbiwgbGVuKGluc3RyaW5nKSkKICAgICAgICB3aGlsZSBsb2MgPCBtYXhsZW4gYW5kIGluc3RyaW5nW2xvY10gbm90IGluIG5vdGNoYXJzOgogICAgICAgICAgICBsb2MgKz0gMQoKICAgICAgICBpZiBsb2MgLSBzdGFydCA8IHNlbGYubWluTGVuOgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKCiAgICAgICAgcmV0dXJuIGxvYywgaW5zdHJpbmdbc3RhcnQ6bG9jXQoKCmNsYXNzIFdoaXRlKFRva2VuKToKICAgIFwiXCJcIlNwZWNpYWwgbWF0Y2hpbmcgY2xhc3MgZm9yIG1hdGNoaW5nIHdoaXRlc3BhY2UuICBOb3JtYWxseSwKICAgIHdoaXRlc3BhY2UgaXMgaWdub3JlZCBieSBweXBhcnNpbmcgZ3JhbW1hcnMuICBUaGlzIGNsYXNzIGlzIGluY2x1ZGVkCiAgICB3aGVuIHNvbWUgd2hpdGVzcGFjZSBzdHJ1Y3R1cmVzIGFyZSBzaWduaWZpY2FudC4gIERlZmluZSB3aXRoCiAgICBhIHN0cmluZyBjb250YWluaW5nIHRoZSB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMgdG8gYmUgbWF0Y2hlZDsgZGVmYXVsdAogICAgaXMgYGBcIiBcXFxcdFxcXFxyXFxcXG5cImBgLiAgQWxzbyB0YWtlcyBvcHRpb25hbCBgYG1pbmBgLAogICAgYGBtYXhgYCwgYW5kIGBgZXhhY3RgYCBhcmd1bWVudHMsIGFzIGRlZmluZWQgZm9yIHRoZQogICAgOmNsYXNzOmBXb3JkYCBjbGFzcy4KICAgIFwiXCJcIgoKICAgIHdoaXRlU3RycyA9IHsKICAgICAgICBcIiBcIjogXCI8U1A+XCIsCiAgICAgICAgXCJcXHRcIjogXCI8VEFCPlwiLAogICAgICAgIFwiXFxuXCI6IFwiPExGPlwiLAogICAgICAgIFwiXFxyXCI6IFwiPENSPlwiLAogICAgICAgIFwiXFxmXCI6IFwiPEZGPlwiLAogICAgICAgIFwiXFx1MDBBMFwiOiBcIjxOQlNQPlwiLAogICAgICAgIFwiXFx1MTY4MFwiOiBcIjxPR0hBTV9TUEFDRV9NQVJLPlwiLAogICAgICAgIFwiXFx1MTgwRVwiOiBcIjxNT05HT0xJQU5fVk9XRUxfU0VQQVJBVE9SPlwiLAogICAgICAgIFwiXFx1MjAwMFwiOiBcIjxFTl9RVUFEPlwiLAogICAgICAgIFwiXFx1MjAwMVwiOiBcIjxFTV9RVUFEPlwiLAogICAgICAgIFwiXFx1MjAwMlwiOiBcIjxFTl9TUEFDRT5cIiwKICAgICAgICBcIlxcdTIwMDNcIjogXCI8RU1fU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDA0XCI6IFwiPFRIUkVFLVBFUi1FTV9TUEFDRT5cIiwKICAgICAgICBcIlxcdTIwMDVcIjogXCI8Rk9VUi1QRVItRU1fU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDA2XCI6IFwiPFNJWC1QRVItRU1fU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDA3XCI6IFwiPEZJR1VSRV9TUEFDRT5cIiwKICAgICAgICBcIlxcdTIwMDhcIjogXCI8UFVOQ1RVQVRJT05fU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDA5XCI6IFwiPFRISU5fU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDBBXCI6IFwiPEhBSVJfU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDBCXCI6IFwiPFpFUk9fV0lEVEhfU1BBQ0U+XCIsCiAgICAgICAgXCJcXHUyMDJGXCI6IFwiPE5OQlNQPlwiLAogICAgICAgIFwiXFx1MjA1RlwiOiBcIjxNTVNQPlwiLAogICAgICAgIFwiXFx1MzAwMFwiOiBcIjxJREVPR1JBUEhJQ19TUEFDRT5cIiwKICAgIH0KCiAgICBkZWYgX19pbml0X18oc2VsZiwgd3M6IHN0ciA9IFwiIFxcdFxcclxcblwiLCBtaW46IGludCA9IDEsIG1heDogaW50ID0gMCwgZXhhY3Q6IGludCA9IDApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYubWF0Y2hXaGl0ZSA9IHdzCiAgICAgICAgc2VsZi5zZXRfd2hpdGVzcGFjZV9jaGFycygKICAgICAgICAgICAgXCJcIi5qb2luKGMgZm9yIGMgaW4gc2VsZi53aGl0ZVN0cnMgaWYgYyBub3QgaW4gc2VsZi5tYXRjaFdoaXRlKSwKICAgICAgICAgICAgY29weV9kZWZhdWx0cz1UcnVlLAogICAgICAgICkKICAgICAgICAjIHNlbGYubGVhdmVfd2hpdGVzcGFjZSgpCiAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IFRydWUKICAgICAgICBzZWxmLmVycm1zZyA9IFwiRXhwZWN0ZWQgXCIgKyBzZWxmLm5hbWUKCiAgICAgICAgc2VsZi5taW5MZW4gPSBtaW4KCiAgICAgICAgaWYgbWF4ID4gMDoKICAgICAgICAgICAgc2VsZi5tYXhMZW4gPSBtYXgKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1heExlbiA9IF9NQVhfSU5UCgogICAgICAgIGlmIGV4YWN0ID4gMDoKICAgICAgICAgICAgc2VsZi5tYXhMZW4gPSBleGFjdAogICAgICAgICAgICBzZWxmLm1pbkxlbiA9IGV4YWN0CgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBcIlwiLmpvaW4oV2hpdGUud2hpdGVTdHJzW2NdIGZvciBjIGluIHNlbGYubWF0Y2hXaGl0ZSkKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBpZiBpbnN0cmluZ1tsb2NdIG5vdCBpbiBzZWxmLm1hdGNoV2hpdGU6CiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQogICAgICAgIHN0YXJ0ID0gbG9jCiAgICAgICAgbG9jICs9IDEKICAgICAgICBtYXhsb2MgPSBzdGFydCArIHNlbGYubWF4TGVuCiAgICAgICAgbWF4bG9jID0gbWluKG1heGxvYywgbGVuKGluc3RyaW5nKSkKICAgICAgICB3aGlsZSBsb2MgPCBtYXhsb2MgYW5kIGluc3RyaW5nW2xvY10gaW4gc2VsZi5tYXRjaFdoaXRlOgogICAgICAgICAgICBsb2MgKz0gMQoKICAgICAgICBpZiBsb2MgLSBzdGFydCA8IHNlbGYubWluTGVuOgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKCiAgICAgICAgcmV0dXJuIGxvYywgaW5zdHJpbmdbc3RhcnQ6bG9jXQoKCmNsYXNzIFBvc2l0aW9uVG9rZW4oVG9rZW4pOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCiAgICAgICAgc2VsZi5tYXlJbmRleEVycm9yID0gRmFsc2UKCgpjbGFzcyBHb1RvQ29sdW1uKFBvc2l0aW9uVG9rZW4pOgogICAgXCJcIlwiVG9rZW4gdG8gYWR2YW5jZSB0byBhIHNwZWNpZmljIGNvbHVtbiBvZiBpbnB1dCB0ZXh0OyB1c2VmdWwgZm9yCiAgICB0YWJ1bGFyIHJlcG9ydCBzY3JhcGluZy4KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb2xubzogaW50KToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmNvbCA9IGNvbG5vCgogICAgZGVmIHByZVBhcnNlKHNlbGYsIGluc3RyaW5nLCBsb2MpOgogICAgICAgIGlmIGNvbChsb2MsIGluc3RyaW5nKSAhPSBzZWxmLmNvbDoKICAgICAgICAgICAgaW5zdHJsZW4gPSBsZW4oaW5zdHJpbmcpCiAgICAgICAgICAgIGlmIHNlbGYuaWdub3JlRXhwcnM6CiAgICAgICAgICAgICAgICBsb2MgPSBzZWxmLl9za2lwSWdub3JhYmxlcyhpbnN0cmluZywgbG9jKQogICAgICAgICAgICB3aGlsZSAoCiAgICAgICAgICAgICAgICBsb2MgPCBpbnN0cmxlbgogICAgICAgICAgICAgICAgYW5kIGluc3RyaW5nW2xvY10uaXNzcGFjZSgpCiAgICAgICAgICAgICAgICBhbmQgY29sKGxvYywgaW5zdHJpbmcpICE9IHNlbGYuY29sCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBsb2MgKz0gMQogICAgICAgIHJldHVybiBsb2MKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICB0aGlzY29sID0gY29sKGxvYywgaW5zdHJpbmcpCiAgICAgICAgaWYgdGhpc2NvbCA+IHNlbGYuY29sOgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBcIlRleHQgbm90IGluIGV4cGVjdGVkIGNvbHVtblwiLCBzZWxmKQogICAgICAgIG5ld2xvYyA9IGxvYyArIHNlbGYuY29sIC0gdGhpc2NvbAogICAgICAgIHJldCA9IGluc3RyaW5nW2xvYzpuZXdsb2NdCiAgICAgICAgcmV0dXJuIG5ld2xvYywgcmV0CgoKY2xhc3MgTGluZVN0YXJ0KFBvc2l0aW9uVG9rZW4pOgogICAgclwiXCJcIk1hdGNoZXMgaWYgY3VycmVudCBwb3NpdGlvbiBpcyBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgbGluZSB3aXRoaW4KICAgIHRoZSBwYXJzZSBzdHJpbmcKCiAgICBFeGFtcGxlOjoKCiAgICAgICAgdGVzdCA9ICcnJ1xcCiAgICAgICAgQUFBIHRoaXMgbGluZQogICAgICAgIEFBQSBhbmQgdGhpcyBsaW5lCiAgICAgICAgICBBQUEgYnV0IG5vdCB0aGlzIG9uZQogICAgICAgIEIgQUFBIGFuZCBkZWZpbml0ZWx5IG5vdCB0aGlzIG9uZQogICAgICAgICcnJwoKICAgICAgICBmb3IgdCBpbiAoTGluZVN0YXJ0KCkgKyAnQUFBJyArIHJlc3RPZkxpbmUpLnNlYXJjaF9zdHJpbmcodGVzdCk6CiAgICAgICAgICAgIHByaW50KHQpCgogICAgcHJpbnRzOjoKCiAgICAgICAgWydBQUEnLCAnIHRoaXMgbGluZSddCiAgICAgICAgWydBQUEnLCAnIGFuZCB0aGlzIGxpbmUnXQoKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmxlYXZlX3doaXRlc3BhY2UoKQogICAgICAgIHNlbGYub3JpZ193aGl0ZUNoYXJzID0gc2V0KCkgfCBzZWxmLndoaXRlQ2hhcnMKICAgICAgICBzZWxmLndoaXRlQ2hhcnMuZGlzY2FyZChcIlxcblwiKQogICAgICAgIHNlbGYuc2tpcHBlciA9IEVtcHR5KCkuc2V0X3doaXRlc3BhY2VfY2hhcnMoc2VsZi53aGl0ZUNoYXJzKQogICAgICAgIHNlbGYuZXJybXNnID0gXCJFeHBlY3RlZCBzdGFydCBvZiBsaW5lXCIKCiAgICBkZWYgcHJlUGFyc2Uoc2VsZiwgaW5zdHJpbmcsIGxvYyk6CiAgICAgICAgaWYgbG9jID09IDA6CiAgICAgICAgICAgIHJldHVybiBsb2MKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXQgPSBzZWxmLnNraXBwZXIucHJlUGFyc2UoaW5zdHJpbmcsIGxvYykKICAgICAgICAgICAgaWYgXCJcXG5cIiBpbiBzZWxmLm9yaWdfd2hpdGVDaGFyczoKICAgICAgICAgICAgICAgIHdoaWxlIGluc3RyaW5nW3JldCA6IHJldCArIDFdID09IFwiXFxuXCI6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc2VsZi5za2lwcGVyLnByZVBhcnNlKGluc3RyaW5nLCByZXQgKyAxKQogICAgICAgICAgICByZXR1cm4gcmV0CgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgY29sKGxvYywgaW5zdHJpbmcpID09IDE6CiAgICAgICAgICAgIHJldHVybiBsb2MsIFtdCiAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgoKY2xhc3MgTGluZUVuZChQb3NpdGlvblRva2VuKToKICAgIFwiXCJcIk1hdGNoZXMgaWYgY3VycmVudCBwb3NpdGlvbiBpcyBhdCB0aGUgZW5kIG9mIGEgbGluZSB3aXRoaW4gdGhlCiAgICBwYXJzZSBzdHJpbmcKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLndoaXRlQ2hhcnMuZGlzY2FyZChcIlxcblwiKQogICAgICAgIHNlbGYuc2V0X3doaXRlc3BhY2VfY2hhcnMoc2VsZi53aGl0ZUNoYXJzLCBjb3B5X2RlZmF1bHRzPUZhbHNlKQogICAgICAgIHNlbGYuZXJybXNnID0gXCJFeHBlY3RlZCBlbmQgb2YgbGluZVwiCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgbG9jIDwgbGVuKGluc3RyaW5nKToKICAgICAgICAgICAgaWYgaW5zdHJpbmdbbG9jXSA9PSBcIlxcblwiOgogICAgICAgICAgICAgICAgcmV0dXJuIGxvYyArIDEsIFwiXFxuXCIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQogICAgICAgIGVsaWYgbG9jID09IGxlbihpbnN0cmluZyk6CiAgICAgICAgICAgIHJldHVybiBsb2MgKyAxLCBbXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQoKCmNsYXNzIFN0cmluZ1N0YXJ0KFBvc2l0aW9uVG9rZW4pOgogICAgXCJcIlwiTWF0Y2hlcyBpZiBjdXJyZW50IHBvc2l0aW9uIGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHBhcnNlCiAgICBzdHJpbmcKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmVycm1zZyA9IFwiRXhwZWN0ZWQgc3RhcnQgb2YgdGV4dFwiCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgbG9jICE9IDA6CiAgICAgICAgICAgICMgc2VlIGlmIGVudGlyZSBzdHJpbmcgdXAgdG8gaGVyZSBpcyBqdXN0IHdoaXRlc3BhY2UgYW5kIGlnbm9yZWFibGVzCiAgICAgICAgICAgIGlmIGxvYyAhPSBzZWxmLnByZVBhcnNlKGluc3RyaW5nLCAwKToKICAgICAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQogICAgICAgIHJldHVybiBsb2MsIFtdCgoKY2xhc3MgU3RyaW5nRW5kKFBvc2l0aW9uVG9rZW4pOgogICAgXCJcIlwiCiAgICBNYXRjaGVzIGlmIGN1cnJlbnQgcG9zaXRpb24gaXMgYXQgdGhlIGVuZCBvZiB0aGUgcGFyc2Ugc3RyaW5nCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIkV4cGVjdGVkIGVuZCBvZiB0ZXh0XCIKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBpZiBsb2MgPCBsZW4oaW5zdHJpbmcpOgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBzZWxmLmVycm1zZywgc2VsZikKICAgICAgICBlbGlmIGxvYyA9PSBsZW4oaW5zdHJpbmcpOgogICAgICAgICAgICByZXR1cm4gbG9jICsgMSwgW10KICAgICAgICBlbGlmIGxvYyA+IGxlbihpbnN0cmluZyk6CiAgICAgICAgICAgIHJldHVybiBsb2MsIFtdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgoKY2xhc3MgV29yZFN0YXJ0KFBvc2l0aW9uVG9rZW4pOgogICAgXCJcIlwiTWF0Y2hlcyBpZiB0aGUgY3VycmVudCBwb3NpdGlvbiBpcyBhdCB0aGUgYmVnaW5uaW5nIG9mIGEKICAgIDpjbGFzczpgV29yZGAsIGFuZCBpcyBub3QgcHJlY2VkZWQgYnkgYW55IGNoYXJhY3RlciBpbiBhIGdpdmVuCiAgICBzZXQgb2YgYGB3b3JkX2NoYXJzYGAgKGRlZmF1bHQ9IGBgcHJpbnRhYmxlc2BgKS4gVG8gZW11bGF0ZSB0aGUKICAgIGBgXFxiYGAgYmVoYXZpb3Igb2YgcmVndWxhciBleHByZXNzaW9ucywgdXNlCiAgICBgYFdvcmRTdGFydChhbHBoYW51bXMpYGAuIGBgV29yZFN0YXJ0YGAgd2lsbCBhbHNvIG1hdGNoIGF0CiAgICB0aGUgYmVnaW5uaW5nIG9mIHRoZSBzdHJpbmcgYmVpbmcgcGFyc2VkLCBvciBhdCB0aGUgYmVnaW5uaW5nIG9mCiAgICBhIGxpbmUuCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgd29yZF9jaGFyczogc3RyID0gcHJpbnRhYmxlcywgKiwgd29yZENoYXJzOiBzdHIgPSBwcmludGFibGVzKToKICAgICAgICB3b3JkQ2hhcnMgPSB3b3JkX2NoYXJzIGlmIHdvcmRDaGFycyA9PSBwcmludGFibGVzIGVsc2Ugd29yZENoYXJzCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi53b3JkQ2hhcnMgPSBzZXQod29yZENoYXJzKQogICAgICAgIHNlbGYuZXJybXNnID0gXCJOb3QgYXQgdGhlIHN0YXJ0IG9mIGEgd29yZFwiCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgbG9jICE9IDA6CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGluc3RyaW5nW2xvYyAtIDFdIGluIHNlbGYud29yZENoYXJzCiAgICAgICAgICAgICAgICBvciBpbnN0cmluZ1tsb2NdIG5vdCBpbiBzZWxmLndvcmRDaGFycwogICAgICAgICAgICApOgogICAgICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCiAgICAgICAgcmV0dXJuIGxvYywgW10KCgpjbGFzcyBXb3JkRW5kKFBvc2l0aW9uVG9rZW4pOgogICAgXCJcIlwiTWF0Y2hlcyBpZiB0aGUgY3VycmVudCBwb3NpdGlvbiBpcyBhdCB0aGUgZW5kIG9mIGEgOmNsYXNzOmBXb3JkYCwKICAgIGFuZCBpcyBub3QgZm9sbG93ZWQgYnkgYW55IGNoYXJhY3RlciBpbiBhIGdpdmVuIHNldCBvZiBgYHdvcmRfY2hhcnNgYAogICAgKGRlZmF1bHQ9IGBgcHJpbnRhYmxlc2BgKS4gVG8gZW11bGF0ZSB0aGUgYGBcXGJgYCBiZWhhdmlvciBvZgogICAgcmVndWxhciBleHByZXNzaW9ucywgdXNlIGBgV29yZEVuZChhbHBoYW51bXMpYGAuIGBgV29yZEVuZGBgCiAgICB3aWxsIGFsc28gbWF0Y2ggYXQgdGhlIGVuZCBvZiB0aGUgc3RyaW5nIGJlaW5nIHBhcnNlZCwgb3IgYXQgdGhlIGVuZAogICAgb2YgYSBsaW5lLgogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHdvcmRfY2hhcnM6IHN0ciA9IHByaW50YWJsZXMsICosIHdvcmRDaGFyczogc3RyID0gcHJpbnRhYmxlcyk6CiAgICAgICAgd29yZENoYXJzID0gd29yZF9jaGFycyBpZiB3b3JkQ2hhcnMgPT0gcHJpbnRhYmxlcyBlbHNlIHdvcmRDaGFycwogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYud29yZENoYXJzID0gc2V0KHdvcmRDaGFycykKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gRmFsc2UKICAgICAgICBzZWxmLmVycm1zZyA9IFwiTm90IGF0IHRoZSBlbmQgb2YgYSB3b3JkXCIKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBpbnN0cmxlbiA9IGxlbihpbnN0cmluZykKICAgICAgICBpZiBpbnN0cmxlbiA+IDAgYW5kIGxvYyA8IGluc3RybGVuOgogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBpbnN0cmluZ1tsb2NdIGluIHNlbGYud29yZENoYXJzCiAgICAgICAgICAgICAgICBvciBpbnN0cmluZ1tsb2MgLSAxXSBub3QgaW4gc2VsZi53b3JkQ2hhcnMKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQogICAgICAgIHJldHVybiBsb2MsIFtdCgoKY2xhc3MgUGFyc2VFeHByZXNzaW9uKFBhcnNlckVsZW1lbnQpOgogICAgXCJcIlwiQWJzdHJhY3Qgc3ViY2xhc3Mgb2YgUGFyc2VyRWxlbWVudCwgZm9yIGNvbWJpbmluZyBhbmQKICAgIHBvc3QtcHJvY2Vzc2luZyBwYXJzZWQgdG9rZW5zLgogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4cHJzOiB0eXBpbmcuSXRlcmFibGVbUGFyc2VyRWxlbWVudF0sIHNhdmVsaXN0OiBib29sID0gRmFsc2UpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oc2F2ZWxpc3QpCiAgICAgICAgc2VsZi5leHByczogTGlzdFtQYXJzZXJFbGVtZW50XQogICAgICAgIGlmIGlzaW5zdGFuY2UoZXhwcnMsIF9nZW5lcmF0b3JUeXBlKToKICAgICAgICAgICAgZXhwcnMgPSBsaXN0KGV4cHJzKQoKICAgICAgICBpZiBpc2luc3RhbmNlKGV4cHJzLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIHNlbGYuZXhwcnMgPSBbc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKGV4cHJzKV0KICAgICAgICBlbGlmIGlzaW5zdGFuY2UoZXhwcnMsIFBhcnNlckVsZW1lbnQpOgogICAgICAgICAgICBzZWxmLmV4cHJzID0gW2V4cHJzXQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShleHBycywgSXRlcmFibGUpOgogICAgICAgICAgICBleHBycyA9IGxpc3QoZXhwcnMpCiAgICAgICAgICAgICMgaWYgc2VxdWVuY2Ugb2Ygc3RyaW5ncyBwcm92aWRlZCwgd3JhcCB3aXRoIExpdGVyYWwKICAgICAgICAgICAgaWYgYW55KGlzaW5zdGFuY2UoZXhwciwgc3RyX3R5cGUpIGZvciBleHByIGluIGV4cHJzKToKICAgICAgICAgICAgICAgIGV4cHJzID0gKAogICAgICAgICAgICAgICAgICAgIHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhlKSBpZiBpc2luc3RhbmNlKGUsIHN0cl90eXBlKSBlbHNlIGUKICAgICAgICAgICAgICAgICAgICBmb3IgZSBpbiBleHBycwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLmV4cHJzID0gbGlzdChleHBycykKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLmV4cHJzID0gbGlzdChleHBycykKICAgICAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgICAgIHNlbGYuZXhwcnMgPSBbZXhwcnNdCiAgICAgICAgc2VsZi5jYWxsUHJlcGFyc2UgPSBGYWxzZQoKICAgIGRlZiByZWN1cnNlKHNlbGYpIC0+IFNlcXVlbmNlW1BhcnNlckVsZW1lbnRdOgogICAgICAgIHJldHVybiBzZWxmLmV4cHJzWzpdCgogICAgZGVmIGFwcGVuZChzZWxmLCBvdGhlcikgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBzZWxmLmV4cHJzLmFwcGVuZChvdGhlcikKICAgICAgICBzZWxmLl9kZWZhdWx0TmFtZSA9IE5vbmUKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBsZWF2ZV93aGl0ZXNwYWNlKHNlbGYsIHJlY3Vyc2l2ZTogYm9vbCA9IFRydWUpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRXh0ZW5kcyBgYGxlYXZlX3doaXRlc3BhY2VgYCBkZWZpbmVkIGluIGJhc2UgY2xhc3MsIGFuZCBhbHNvIGludm9rZXMgYGBsZWF2ZV93aGl0ZXNwYWNlYGAgb24KICAgICAgICAgICBhbGwgY29udGFpbmVkIGV4cHJlc3Npb25zLgogICAgICAgIFwiXCJcIgogICAgICAgIHN1cGVyKCkubGVhdmVfd2hpdGVzcGFjZShyZWN1cnNpdmUpCgogICAgICAgIGlmIHJlY3Vyc2l2ZToKICAgICAgICAgICAgc2VsZi5leHBycyA9IFtlLmNvcHkoKSBmb3IgZSBpbiBzZWxmLmV4cHJzXQogICAgICAgICAgICBmb3IgZSBpbiBzZWxmLmV4cHJzOgogICAgICAgICAgICAgICAgZS5sZWF2ZV93aGl0ZXNwYWNlKHJlY3Vyc2l2ZSkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBpZ25vcmVfd2hpdGVzcGFjZShzZWxmLCByZWN1cnNpdmU6IGJvb2wgPSBUcnVlKSAtPiBQYXJzZXJFbGVtZW50OgogICAgICAgIFwiXCJcIgogICAgICAgIEV4dGVuZHMgYGBpZ25vcmVfd2hpdGVzcGFjZWBgIGRlZmluZWQgaW4gYmFzZSBjbGFzcywgYW5kIGFsc28gaW52b2tlcyBgYGxlYXZlX3doaXRlc3BhY2VgYCBvbgogICAgICAgICAgIGFsbCBjb250YWluZWQgZXhwcmVzc2lvbnMuCiAgICAgICAgXCJcIlwiCiAgICAgICAgc3VwZXIoKS5pZ25vcmVfd2hpdGVzcGFjZShyZWN1cnNpdmUpCiAgICAgICAgaWYgcmVjdXJzaXZlOgogICAgICAgICAgICBzZWxmLmV4cHJzID0gW2UuY29weSgpIGZvciBlIGluIHNlbGYuZXhwcnNdCiAgICAgICAgICAgIGZvciBlIGluIHNlbGYuZXhwcnM6CiAgICAgICAgICAgICAgICBlLmlnbm9yZV93aGl0ZXNwYWNlKHJlY3Vyc2l2ZSkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBpZ25vcmUoc2VsZiwgb3RoZXIpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgU3VwcHJlc3MpOgogICAgICAgICAgICBpZiBvdGhlciBub3QgaW4gc2VsZi5pZ25vcmVFeHByczoKICAgICAgICAgICAgICAgIHN1cGVyKCkuaWdub3JlKG90aGVyKQogICAgICAgICAgICAgICAgZm9yIGUgaW4gc2VsZi5leHByczoKICAgICAgICAgICAgICAgICAgICBlLmlnbm9yZShzZWxmLmlnbm9yZUV4cHJzWy0xXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdXBlcigpLmlnbm9yZShvdGhlcikKICAgICAgICAgICAgZm9yIGUgaW4gc2VsZi5leHByczoKICAgICAgICAgICAgICAgIGUuaWdub3JlKHNlbGYuaWdub3JlRXhwcnNbLTFdKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBcInt9Oih7fSlcIi5mb3JtYXQoc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIHN0cihzZWxmLmV4cHJzKSkKCiAgICBkZWYgc3RyZWFtbGluZShzZWxmKSAtPiBQYXJzZXJFbGVtZW50OgogICAgICAgIGlmIHNlbGYuc3RyZWFtbGluZWQ6CiAgICAgICAgICAgIHJldHVybiBzZWxmCgogICAgICAgIHN1cGVyKCkuc3RyZWFtbGluZSgpCgogICAgICAgIGZvciBlIGluIHNlbGYuZXhwcnM6CiAgICAgICAgICAgIGUuc3RyZWFtbGluZSgpCgogICAgICAgICMgY29sbGFwc2UgbmVzdGVkIDpjbGFzczpgQW5kYCdzIG9mIHRoZSBmb3JtIGBgQW5kKEFuZChBbmQoYSwgYiksIGMpLCBkKWBgIHRvIGBgQW5kKGEsIGIsIGMsIGQpYGAKICAgICAgICAjIGJ1dCBvbmx5IGlmIHRoZXJlIGFyZSBubyBwYXJzZSBhY3Rpb25zIG9yIHJlc3VsdHNOYW1lcyBvbiB0aGUgbmVzdGVkIEFuZCdzCiAgICAgICAgIyAobGlrZXdpc2UgZm9yIDpjbGFzczpgT3JgJ3MgYW5kIDpjbGFzczpgTWF0Y2hGaXJzdGAncykKICAgICAgICBpZiBsZW4oc2VsZi5leHBycykgPT0gMjoKICAgICAgICAgICAgb3RoZXIgPSBzZWxmLmV4cHJzWzBdCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2Uob3RoZXIsIHNlbGYuX19jbGFzc19fKQogICAgICAgICAgICAgICAgYW5kIG5vdCBvdGhlci5wYXJzZUFjdGlvbgogICAgICAgICAgICAgICAgYW5kIG90aGVyLnJlc3VsdHNOYW1lIGlzIE5vbmUKICAgICAgICAgICAgICAgIGFuZCBub3Qgb3RoZXIuZGVidWcKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIHNlbGYuZXhwcnMgPSBvdGhlci5leHByc1s6XSArIFtzZWxmLmV4cHJzWzFdXQogICAgICAgICAgICAgICAgc2VsZi5fZGVmYXVsdE5hbWUgPSBOb25lCiAgICAgICAgICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5IHw9IG90aGVyLm1heVJldHVybkVtcHR5CiAgICAgICAgICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgfD0gb3RoZXIubWF5SW5kZXhFcnJvcgoKICAgICAgICAgICAgb3RoZXIgPSBzZWxmLmV4cHJzWy0xXQogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBpc2luc3RhbmNlKG90aGVyLCBzZWxmLl9fY2xhc3NfXykKICAgICAgICAgICAgICAgIGFuZCBub3Qgb3RoZXIucGFyc2VBY3Rpb24KICAgICAgICAgICAgICAgIGFuZCBvdGhlci5yZXN1bHRzTmFtZSBpcyBOb25lCiAgICAgICAgICAgICAgICBhbmQgbm90IG90aGVyLmRlYnVnCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBzZWxmLmV4cHJzID0gc2VsZi5leHByc1s6LTFdICsgb3RoZXIuZXhwcnNbOl0KICAgICAgICAgICAgICAgIHNlbGYuX2RlZmF1bHROYW1lID0gTm9uZQogICAgICAgICAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSB8PSBvdGhlci5tYXlSZXR1cm5FbXB0eQogICAgICAgICAgICAgICAgc2VsZi5tYXlJbmRleEVycm9yIHw9IG90aGVyLm1heUluZGV4RXJyb3IKCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIkV4cGVjdGVkIFwiICsgc3RyKHNlbGYpCgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHZhbGlkYXRlKHNlbGYsIHZhbGlkYXRlVHJhY2U9Tm9uZSkgLT4gTm9uZToKICAgICAgICB0bXAgPSAodmFsaWRhdGVUcmFjZSBpZiB2YWxpZGF0ZVRyYWNlIGlzIG5vdCBOb25lIGVsc2UgW10pWzpdICsgW3NlbGZdCiAgICAgICAgZm9yIGUgaW4gc2VsZi5leHByczoKICAgICAgICAgICAgZS52YWxpZGF0ZSh0bXApCiAgICAgICAgc2VsZi5fY2hlY2tSZWN1cnNpb24oW10pCgogICAgZGVmIGNvcHkoc2VsZikgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICByZXQgPSBzdXBlcigpLmNvcHkoKQogICAgICAgIHJldC5leHBycyA9IFtlLmNvcHkoKSBmb3IgZSBpbiBzZWxmLmV4cHJzXQogICAgICAgIHJldHVybiByZXQKCiAgICBkZWYgX3NldFJlc3VsdHNOYW1lKHNlbGYsIG5hbWUsIGxpc3RBbGxNYXRjaGVzPUZhbHNlKToKICAgICAgICBpZiAoCiAgICAgICAgICAgIF9fZGlhZ19fLndhcm5fdW5ncm91cGVkX25hbWVkX3Rva2Vuc19pbl9jb2xsZWN0aW9uCiAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbgogICAgICAgICAgICBub3QgaW4gc2VsZi5zdXBwcmVzc193YXJuaW5nc18KICAgICAgICApOgogICAgICAgICAgICBmb3IgZSBpbiBzZWxmLmV4cHJzOgogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoZSwgUGFyc2VyRWxlbWVudCkKICAgICAgICAgICAgICAgICAgICBhbmQgZS5yZXN1bHRzTmFtZQogICAgICAgICAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbgogICAgICAgICAgICAgICAgICAgIG5vdCBpbiBlLnN1cHByZXNzX3dhcm5pbmdzXwogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgICAgICAgICBcInt9OiBzZXR0aW5nIHJlc3VsdHMgbmFtZSB7IXJ9IG9uIHt9IGV4cHJlc3Npb24gXCIKICAgICAgICAgICAgICAgICAgICAgICAgXCJjb2xsaWRlcyB3aXRoIHshcn0gb24gY29udGFpbmVkIGV4cHJlc3Npb25cIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhcm5fdW5ncm91cGVkX25hbWVkX3Rva2Vuc19pbl9jb2xsZWN0aW9uXCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZShzZWxmKS5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucmVzdWx0c05hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrbGV2ZWw9MywKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgIHJldHVybiBzdXBlcigpLl9zZXRSZXN1bHRzTmFtZShuYW1lLCBsaXN0QWxsTWF0Y2hlcykKCiAgICBpZ25vcmVXaGl0ZXNwYWNlID0gaWdub3JlX3doaXRlc3BhY2UKICAgIGxlYXZlV2hpdGVzcGFjZSA9IGxlYXZlX3doaXRlc3BhY2UKCgpjbGFzcyBBbmQoUGFyc2VFeHByZXNzaW9uKToKICAgIFwiXCJcIgogICAgUmVxdWlyZXMgYWxsIGdpdmVuIDpjbGFzczpgUGFyc2VFeHByZXNzaW9uYCBzIHRvIGJlIGZvdW5kIGluIHRoZSBnaXZlbiBvcmRlci4KICAgIEV4cHJlc3Npb25zIG1heSBiZSBzZXBhcmF0ZWQgYnkgd2hpdGVzcGFjZS4KICAgIE1heSBiZSBjb25zdHJ1Y3RlZCB1c2luZyB0aGUgYGAnKydgYCBvcGVyYXRvci4KICAgIE1heSBhbHNvIGJlIGNvbnN0cnVjdGVkIHVzaW5nIHRoZSBgYCctJ2BgIG9wZXJhdG9yLCB3aGljaCB3aWxsCiAgICBzdXBwcmVzcyBiYWNrdHJhY2tpbmcuCgogICAgRXhhbXBsZTo6CgogICAgICAgIGludGVnZXIgPSBXb3JkKG51bXMpCiAgICAgICAgbmFtZV9leHByID0gV29yZChhbHBoYXMpWzEsIC4uLl0KCiAgICAgICAgZXhwciA9IEFuZChbaW50ZWdlcihcImlkXCIpLCBuYW1lX2V4cHIoXCJuYW1lXCIpLCBpbnRlZ2VyKFwiYWdlXCIpXSkKICAgICAgICAjIG1vcmUgZWFzaWx5IHdyaXR0ZW4gYXM6CiAgICAgICAgZXhwciA9IGludGVnZXIoXCJpZFwiKSArIG5hbWVfZXhwcihcIm5hbWVcIikgKyBpbnRlZ2VyKFwiYWdlXCIpCiAgICBcIlwiXCIKCiAgICBjbGFzcyBfRXJyb3JTdG9wKEVtcHR5KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYubGVhdmVfd2hpdGVzcGFjZSgpCgogICAgICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICAgICAgcmV0dXJuIFwiLVwiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsIGV4cHJzX2FyZzogdHlwaW5nLkl0ZXJhYmxlW1BhcnNlckVsZW1lbnRdLCBzYXZlbGlzdDogYm9vbCA9IFRydWUKICAgICk6CiAgICAgICAgZXhwcnM6IExpc3RbUGFyc2VyRWxlbWVudF0gPSBsaXN0KGV4cHJzX2FyZykKICAgICAgICBpZiBleHBycyBhbmQgRWxsaXBzaXMgaW4gZXhwcnM6CiAgICAgICAgICAgIHRtcCA9IFtdCiAgICAgICAgICAgIGZvciBpLCBleHByIGluIGVudW1lcmF0ZShleHBycyk6CiAgICAgICAgICAgICAgICBpZiBleHByIGlzIEVsbGlwc2lzOgogICAgICAgICAgICAgICAgICAgIGlmIGkgPCBsZW4oZXhwcnMpIC0gMToKICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHRvX2FyZzogUGFyc2VyRWxlbWVudCA9IChFbXB0eSgpICsgZXhwcnNbaSArIDFdKS5leHByc1stMV0KICAgICAgICAgICAgICAgICAgICAgICAgdG1wLmFwcGVuZChTa2lwVG8oc2tpcHRvX2FyZykoXCJfc2tpcHBlZCpcIikpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjYW5ub3QgY29uc3RydWN0IEFuZCB3aXRoIHNlcXVlbmNlIGVuZGluZyBpbiAuLi5cIgogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRtcC5hcHBlbmQoZXhwcikKICAgICAgICAgICAgZXhwcnNbOl0gPSB0bXAKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGV4cHJzLCBzYXZlbGlzdCkKICAgICAgICBpZiBzZWxmLmV4cHJzOgogICAgICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gYWxsKGUubWF5UmV0dXJuRW1wdHkgZm9yIGUgaW4gc2VsZi5leHBycykKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc2VsZi5leHByc1swXSwgV2hpdGUpOgogICAgICAgICAgICAgICAgc2VsZi5zZXRfd2hpdGVzcGFjZV9jaGFycygKICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cHJzWzBdLndoaXRlQ2hhcnMsCiAgICAgICAgICAgICAgICAgICAgY29weV9kZWZhdWx0cz1zZWxmLmV4cHJzWzBdLmNvcHlEZWZhdWx0V2hpdGVDaGFycywKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHNlbGYuc2tpcFdoaXRlc3BhY2UgPSBzZWxmLmV4cHJzWzBdLnNraXBXaGl0ZXNwYWNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gVHJ1ZQogICAgICAgIHNlbGYuY2FsbFByZXBhcnNlID0gVHJ1ZQoKICAgIGRlZiBzdHJlYW1saW5lKHNlbGYpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgIyBjb2xsYXBzZSBhbnkgX1BlbmRpbmdTa2lwJ3MKICAgICAgICBpZiBzZWxmLmV4cHJzOgogICAgICAgICAgICBpZiBhbnkoCiAgICAgICAgICAgICAgICBpc2luc3RhbmNlKGUsIFBhcnNlRXhwcmVzc2lvbikKICAgICAgICAgICAgICAgIGFuZCBlLmV4cHJzCiAgICAgICAgICAgICAgICBhbmQgaXNpbnN0YW5jZShlLmV4cHJzWy0xXSwgX1BlbmRpbmdTa2lwKQogICAgICAgICAgICAgICAgZm9yIGUgaW4gc2VsZi5leHByc1s6LTFdCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBmb3IgaSwgZSBpbiBlbnVtZXJhdGUoc2VsZi5leHByc1s6LTFdKToKICAgICAgICAgICAgICAgICAgICBpZiBlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICBpc2luc3RhbmNlKGUsIFBhcnNlRXhwcmVzc2lvbikKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGUuZXhwcnMKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGlzaW5zdGFuY2UoZS5leHByc1stMV0sIF9QZW5kaW5nU2tpcCkKICAgICAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICAgICBlLmV4cHJzWy0xXSA9IGUuZXhwcnNbLTFdICsgc2VsZi5leHByc1tpICsgMV0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5leHByc1tpICsgMV0gPSBOb25lCiAgICAgICAgICAgICAgICBzZWxmLmV4cHJzID0gW2UgZm9yIGUgaW4gc2VsZi5leHBycyBpZiBlIGlzIG5vdCBOb25lXQoKICAgICAgICBzdXBlcigpLnN0cmVhbWxpbmUoKQoKICAgICAgICAjIGxpbmsgYW55IEluZGVudGVkQmxvY2tzIHRvIHRoZSBwcmlvciBleHByZXNzaW9uCiAgICAgICAgZm9yIHByZXYsIGN1ciBpbiB6aXAoc2VsZi5leHBycywgc2VsZi5leHByc1sxOl0pOgogICAgICAgICAgICAjIHRyYXZlcnNlIGN1ciBvciBhbnkgZmlyc3QgZW1iZWRkZWQgZXhwciBvZiBjdXIgbG9va2luZyBmb3IgYW4gSW5kZW50ZWRCbG9jawogICAgICAgICAgICAjIChidXQgd2F0Y2ggb3V0IGZvciByZWN1cnNpdmUgZ3JhbW1hcikKICAgICAgICAgICAgc2VlbiA9IHNldCgpCiAgICAgICAgICAgIHdoaWxlIGN1cjoKICAgICAgICAgICAgICAgIGlmIGlkKGN1cikgaW4gc2VlbjoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgc2Vlbi5hZGQoaWQoY3VyKSkKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoY3VyLCBJbmRlbnRlZEJsb2NrKToKICAgICAgICAgICAgICAgICAgICBwcmV2LmFkZF9wYXJzZV9hY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgIGxhbWJkYSBzLCBsLCB0LCBjdXJfPWN1cjogc2V0YXR0cigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cl8sIFwicGFyZW50X2FuY2hvclwiLCBjb2wobCwgcykKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgc3VicyA9IGN1ci5yZWN1cnNlKCkKICAgICAgICAgICAgICAgIGN1ciA9IG5leHQoaXRlcihzdWJzKSwgTm9uZSkKCiAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IGFsbChlLm1heVJldHVybkVtcHR5IGZvciBlIGluIHNlbGYuZXhwcnMpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICAjIHBhc3MgRmFsc2UgYXMgY2FsbFByZVBhcnNlIGFyZyB0byBfcGFyc2UgZm9yIGZpcnN0IGVsZW1lbnQsIHNpbmNlIHdlIGFscmVhZHkKICAgICAgICAjIHByZS1wYXJzZWQgdGhlIHN0cmluZyBhcyBwYXJ0IG9mIG91ciBBbmQgcHJlLXBhcnNpbmcKICAgICAgICBsb2MsIHJlc3VsdGxpc3QgPSBzZWxmLmV4cHJzWzBdLl9wYXJzZSgKICAgICAgICAgICAgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zLCBjYWxsUHJlUGFyc2U9RmFsc2UKICAgICAgICApCiAgICAgICAgZXJyb3JTdG9wID0gRmFsc2UKICAgICAgICBmb3IgZSBpbiBzZWxmLmV4cHJzWzE6XToKICAgICAgICAgICAgIyBpZiBpc2luc3RhbmNlKGUsIEFuZC5fRXJyb3JTdG9wKToKICAgICAgICAgICAgaWYgdHlwZShlKSBpcyBBbmQuX0Vycm9yU3RvcDoKICAgICAgICAgICAgICAgIGVycm9yU3RvcCA9IFRydWUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGVycm9yU3RvcDoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBsb2MsIGV4cHJ0b2tlbnMgPSBlLl9wYXJzZShpbnN0cmluZywgbG9jLCBkb0FjdGlvbnMpCiAgICAgICAgICAgICAgICBleGNlcHQgUGFyc2VTeW50YXhFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUJhc2VFeGNlcHRpb24gYXMgcGU6CiAgICAgICAgICAgICAgICAgICAgcGUuX190cmFjZWJhY2tfXyA9IE5vbmUKICAgICAgICAgICAgICAgICAgICByYWlzZSBQYXJzZVN5bnRheEV4Y2VwdGlvbi5fZnJvbV9leGNlcHRpb24ocGUpCiAgICAgICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgICAgICAgICByYWlzZSBQYXJzZVN5bnRheEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHJpbmcsIGxlbihpbnN0cmluZyksIHNlbGYuZXJybXNnLCBzZWxmCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbG9jLCBleHBydG9rZW5zID0gZS5fcGFyc2UoaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zKQogICAgICAgICAgICBpZiBleHBydG9rZW5zIG9yIGV4cHJ0b2tlbnMuaGFza2V5cygpOgogICAgICAgICAgICAgICAgcmVzdWx0bGlzdCArPSBleHBydG9rZW5zCiAgICAgICAgcmV0dXJuIGxvYywgcmVzdWx0bGlzdAoKICAgIGRlZiBfX2lhZGRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvdGhlciA9IHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhvdGhlcikKICAgICAgICByZXR1cm4gc2VsZi5hcHBlbmQob3RoZXIpICAjIEFuZChbc2VsZiwgb3RoZXJdKQoKICAgIGRlZiBfY2hlY2tSZWN1cnNpb24oc2VsZiwgcGFyc2VFbGVtZW50TGlzdCk6CiAgICAgICAgc3ViUmVjQ2hlY2tMaXN0ID0gcGFyc2VFbGVtZW50TGlzdFs6XSArIFtzZWxmXQogICAgICAgIGZvciBlIGluIHNlbGYuZXhwcnM6CiAgICAgICAgICAgIGUuX2NoZWNrUmVjdXJzaW9uKHN1YlJlY0NoZWNrTGlzdCkKICAgICAgICAgICAgaWYgbm90IGUubWF5UmV0dXJuRW1wdHk6CiAgICAgICAgICAgICAgICBicmVhawoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICBpbm5lciA9IFwiIFwiLmpvaW4oc3RyKGUpIGZvciBlIGluIHNlbGYuZXhwcnMpCiAgICAgICAgIyBzdHJpcCBvZmYgcmVkdW5kYW50IGlubmVyIHt9J3MKICAgICAgICB3aGlsZSBsZW4oaW5uZXIpID4gMSBhbmQgaW5uZXJbMCA6OiBsZW4oaW5uZXIpIC0gMV0gPT0gXCJ7fVwiOgogICAgICAgICAgICBpbm5lciA9IGlubmVyWzE6LTFdCiAgICAgICAgcmV0dXJuIFwie1wiICsgaW5uZXIgKyBcIn1cIgoKCmNsYXNzIE9yKFBhcnNlRXhwcmVzc2lvbik6CiAgICBcIlwiXCJSZXF1aXJlcyB0aGF0IGF0IGxlYXN0IG9uZSA6Y2xhc3M6YFBhcnNlRXhwcmVzc2lvbmAgaXMgZm91bmQuIElmCiAgICB0d28gZXhwcmVzc2lvbnMgbWF0Y2gsIHRoZSBleHByZXNzaW9uIHRoYXQgbWF0Y2hlcyB0aGUgbG9uZ2VzdAogICAgc3RyaW5nIHdpbGwgYmUgdXNlZC4gTWF5IGJlIGNvbnN0cnVjdGVkIHVzaW5nIHRoZSBgYCdeJ2BgCiAgICBvcGVyYXRvci4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgIyBjb25zdHJ1Y3QgT3IgdXNpbmcgJ14nIG9wZXJhdG9yCgogICAgICAgIG51bWJlciA9IFdvcmQobnVtcykgXiBDb21iaW5lKFdvcmQobnVtcykgKyAnLicgKyBXb3JkKG51bXMpKQogICAgICAgIHByaW50KG51bWJlci5zZWFyY2hfc3RyaW5nKFwiMTIzIDMuMTQxNiA3ODlcIikpCgogICAgcHJpbnRzOjoKCiAgICAgICAgW1snMTIzJ10sIFsnMy4xNDE2J10sIFsnNzg5J11dCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwcnM6IHR5cGluZy5JdGVyYWJsZVtQYXJzZXJFbGVtZW50XSwgc2F2ZWxpc3Q6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHBycywgc2F2ZWxpc3QpCiAgICAgICAgaWYgc2VsZi5leHByczoKICAgICAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IGFueShlLm1heVJldHVybkVtcHR5IGZvciBlIGluIHNlbGYuZXhwcnMpCiAgICAgICAgICAgIHNlbGYuc2tpcFdoaXRlc3BhY2UgPSBhbGwoZS5za2lwV2hpdGVzcGFjZSBmb3IgZSBpbiBzZWxmLmV4cHJzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCgogICAgZGVmIHN0cmVhbWxpbmUoc2VsZikgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBzdXBlcigpLnN0cmVhbWxpbmUoKQogICAgICAgIGlmIHNlbGYuZXhwcnM6CiAgICAgICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBhbnkoZS5tYXlSZXR1cm5FbXB0eSBmb3IgZSBpbiBzZWxmLmV4cHJzKQogICAgICAgICAgICBzZWxmLnNhdmVBc0xpc3QgPSBhbnkoZS5zYXZlQXNMaXN0IGZvciBlIGluIHNlbGYuZXhwcnMpCiAgICAgICAgICAgIHNlbGYuc2tpcFdoaXRlc3BhY2UgPSBhbGwoCiAgICAgICAgICAgICAgICBlLnNraXBXaGl0ZXNwYWNlIGFuZCBub3QgaXNpbnN0YW5jZShlLCBXaGl0ZSkgZm9yIGUgaW4gc2VsZi5leHBycwogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zYXZlQXNMaXN0ID0gRmFsc2UKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIG1heEV4Y0xvYyA9IC0xCiAgICAgICAgbWF4RXhjZXB0aW9uID0gTm9uZQogICAgICAgIG1hdGNoZXMgPSBbXQogICAgICAgIGZhdGFscyA9IFtdCiAgICAgICAgaWYgYWxsKGUuY2FsbFByZXBhcnNlIGZvciBlIGluIHNlbGYuZXhwcnMpOgogICAgICAgICAgICBsb2MgPSBzZWxmLnByZVBhcnNlKGluc3RyaW5nLCBsb2MpCiAgICAgICAgZm9yIGUgaW4gc2VsZi5leHByczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbG9jMiA9IGUudHJ5X3BhcnNlKGluc3RyaW5nLCBsb2MsIHJhaXNlX2ZhdGFsPVRydWUpCiAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUZhdGFsRXhjZXB0aW9uIGFzIHBmZToKICAgICAgICAgICAgICAgIHBmZS5fX3RyYWNlYmFja19fID0gTm9uZQogICAgICAgICAgICAgICAgcGZlLnBhcnNlckVsZW1lbnQgPSBlCiAgICAgICAgICAgICAgICBmYXRhbHMuYXBwZW5kKHBmZSkKICAgICAgICAgICAgICAgIG1heEV4Y2VwdGlvbiA9IE5vbmUKICAgICAgICAgICAgICAgIG1heEV4Y0xvYyA9IC0xCiAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUV4Y2VwdGlvbiBhcyBlcnI6CiAgICAgICAgICAgICAgICBpZiBub3QgZmF0YWxzOgogICAgICAgICAgICAgICAgICAgIGVyci5fX3RyYWNlYmFja19fID0gTm9uZQogICAgICAgICAgICAgICAgICAgIGlmIGVyci5sb2MgPiBtYXhFeGNMb2M6CiAgICAgICAgICAgICAgICAgICAgICAgIG1heEV4Y2VwdGlvbiA9IGVycgogICAgICAgICAgICAgICAgICAgICAgICBtYXhFeGNMb2MgPSBlcnIubG9jCiAgICAgICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICAgICAgaWYgbGVuKGluc3RyaW5nKSA+IG1heEV4Y0xvYzoKICAgICAgICAgICAgICAgICAgICBtYXhFeGNlcHRpb24gPSBQYXJzZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHJpbmcsIGxlbihpbnN0cmluZyksIGUuZXJybXNnLCBzZWxmCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIG1heEV4Y0xvYyA9IGxlbihpbnN0cmluZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMgc2F2ZSBtYXRjaCBhbW9uZyBhbGwgbWF0Y2hlcywgdG8gcmV0cnkgbG9uZ2VzdCB0byBzaG9ydGVzdAogICAgICAgICAgICAgICAgbWF0Y2hlcy5hcHBlbmQoKGxvYzIsIGUpKQoKICAgICAgICBpZiBtYXRjaGVzOgogICAgICAgICAgICAjIHJlLWV2YWx1YXRlIGFsbCBtYXRjaGVzIGluIGRlc2NlbmRpbmcgb3JkZXIgb2YgbGVuZ3RoIG9mIG1hdGNoLCBpbiBjYXNlIGF0dGFjaGVkIGFjdGlvbnMKICAgICAgICAgICAgIyBtaWdodCBjaGFuZ2Ugd2hldGhlciBvciBob3cgbXVjaCB0aGV5IG1hdGNoIG9mIHRoZSBpbnB1dC4KICAgICAgICAgICAgbWF0Y2hlcy5zb3J0KGtleT1pdGVtZ2V0dGVyKDApLCByZXZlcnNlPVRydWUpCgogICAgICAgICAgICBpZiBub3QgZG9BY3Rpb25zOgogICAgICAgICAgICAgICAgIyBubyBmdXJ0aGVyIGNvbmRpdGlvbnMgb3IgcGFyc2UgYWN0aW9ucyB0byBjaGFuZ2UgdGhlIHNlbGVjdGlvbiBvZgogICAgICAgICAgICAgICAgIyBhbHRlcm5hdGl2ZSwgc28gdGhlIGZpcnN0IG1hdGNoIHdpbGwgYmUgdGhlIGJlc3QgbWF0Y2gKICAgICAgICAgICAgICAgIGJlc3RfZXhwciA9IG1hdGNoZXNbMF1bMV0KICAgICAgICAgICAgICAgIHJldHVybiBiZXN0X2V4cHIuX3BhcnNlKGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucykKCiAgICAgICAgICAgIGxvbmdlc3QgPSAtMSwgTm9uZQogICAgICAgICAgICBmb3IgbG9jMSwgZXhwcjEgaW4gbWF0Y2hlczoKICAgICAgICAgICAgICAgIGlmIGxvYzEgPD0gbG9uZ2VzdFswXToKICAgICAgICAgICAgICAgICAgICAjIGFscmVhZHkgaGF2ZSBhIGxvbmdlciBtYXRjaCB0aGFuIHRoaXMgb25lIHdpbGwgZGVsaXZlciwgd2UgYXJlIGRvbmUKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9uZ2VzdAoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBsb2MyLCB0b2tzID0gZXhwcjEuX3BhcnNlKGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucykKICAgICAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUV4Y2VwdGlvbiBhcyBlcnI6CiAgICAgICAgICAgICAgICAgICAgZXJyLl9fdHJhY2ViYWNrX18gPSBOb25lCiAgICAgICAgICAgICAgICAgICAgaWYgZXJyLmxvYyA+IG1heEV4Y0xvYzoKICAgICAgICAgICAgICAgICAgICAgICAgbWF4RXhjZXB0aW9uID0gZXJyCiAgICAgICAgICAgICAgICAgICAgICAgIG1heEV4Y0xvYyA9IGVyci5sb2MKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaWYgbG9jMiA+PSBsb2MxOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jMiwgdG9rcwogICAgICAgICAgICAgICAgICAgICMgZGlkbid0IG1hdGNoIGFzIG11Y2ggYXMgYmVmb3JlCiAgICAgICAgICAgICAgICAgICAgZWxpZiBsb2MyID4gbG9uZ2VzdFswXToKICAgICAgICAgICAgICAgICAgICAgICAgbG9uZ2VzdCA9IGxvYzIsIHRva3MKCiAgICAgICAgICAgIGlmIGxvbmdlc3QgIT0gKC0xLCBOb25lKToKICAgICAgICAgICAgICAgIHJldHVybiBsb25nZXN0CgogICAgICAgIGlmIGZhdGFsczoKICAgICAgICAgICAgaWYgbGVuKGZhdGFscykgPiAxOgogICAgICAgICAgICAgICAgZmF0YWxzLnNvcnQoa2V5PWxhbWJkYSBlOiAtZS5sb2MpCiAgICAgICAgICAgICAgICBpZiBmYXRhbHNbMF0ubG9jID09IGZhdGFsc1sxXS5sb2M6CiAgICAgICAgICAgICAgICAgICAgZmF0YWxzLnNvcnQoa2V5PWxhbWJkYSBlOiAoLWUubG9jLCAtbGVuKHN0cihlLnBhcnNlckVsZW1lbnQpKSkpCiAgICAgICAgICAgIG1heF9mYXRhbCA9IGZhdGFsc1swXQogICAgICAgICAgICByYWlzZSBtYXhfZmF0YWwKCiAgICAgICAgaWYgbWF4RXhjZXB0aW9uIGlzIG5vdCBOb25lOgogICAgICAgICAgICBtYXhFeGNlcHRpb24ubXNnID0gc2VsZi5lcnJtc2cKICAgICAgICAgICAgcmFpc2UgbWF4RXhjZXB0aW9uCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBpbnN0cmluZywgbG9jLCBcIm5vIGRlZmluZWQgYWx0ZXJuYXRpdmVzIHRvIG1hdGNoXCIsIHNlbGYKICAgICAgICAgICAgKQoKICAgIGRlZiBfX2l4b3JfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvdGhlciA9IHNlbGYuX2xpdGVyYWxTdHJpbmdDbGFzcyhvdGhlcikKICAgICAgICByZXR1cm4gc2VsZi5hcHBlbmQob3RoZXIpICAjIE9yKFtzZWxmLCBvdGhlcl0pCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBcIntcIiArIFwiIF4gXCIuam9pbihzdHIoZSkgZm9yIGUgaW4gc2VsZi5leHBycykgKyBcIn1cIgoKICAgIGRlZiBfc2V0UmVzdWx0c05hbWUoc2VsZiwgbmFtZSwgbGlzdEFsbE1hdGNoZXM9RmFsc2UpOgogICAgICAgIGlmICgKICAgICAgICAgICAgX19kaWFnX18ud2Fybl9tdWx0aXBsZV90b2tlbnNfaW5fbmFtZWRfYWx0ZXJuYXRpb24KICAgICAgICAgICAgYW5kIERpYWdub3N0aWNzLndhcm5fbXVsdGlwbGVfdG9rZW5zX2luX25hbWVkX2FsdGVybmF0aW9uCiAgICAgICAgICAgIG5vdCBpbiBzZWxmLnN1cHByZXNzX3dhcm5pbmdzXwogICAgICAgICk6CiAgICAgICAgICAgIGlmIGFueSgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoZSwgQW5kKQogICAgICAgICAgICAgICAgYW5kIERpYWdub3N0aWNzLndhcm5fbXVsdGlwbGVfdG9rZW5zX2luX25hbWVkX2FsdGVybmF0aW9uCiAgICAgICAgICAgICAgICBub3QgaW4gZS5zdXBwcmVzc193YXJuaW5nc18KICAgICAgICAgICAgICAgIGZvciBlIGluIHNlbGYuZXhwcnMKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIHdhcm5pbmdzLndhcm4oCiAgICAgICAgICAgICAgICAgICAgXCJ7fTogc2V0dGluZyByZXN1bHRzIG5hbWUgeyFyfSBvbiB7fSBleHByZXNzaW9uIFwiCiAgICAgICAgICAgICAgICAgICAgXCJ3aWxsIHJldHVybiBhIGxpc3Qgb2YgYWxsIHBhcnNlZCB0b2tlbnMgaW4gYW4gQW5kIGFsdGVybmF0aXZlLCBcIgogICAgICAgICAgICAgICAgICAgIFwiaW4gcHJpb3IgdmVyc2lvbnMgb25seSB0aGUgZmlyc3QgdG9rZW4gd2FzIHJldHVybmVkOyBlbmNsb3NlIFwiCiAgICAgICAgICAgICAgICAgICAgXCJjb250YWluZWQgYXJndW1lbnQgaW4gR3JvdXBcIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgIFwid2Fybl9tdWx0aXBsZV90b2tlbnNfaW5fbmFtZWRfYWx0ZXJuYXRpb25cIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZShzZWxmKS5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHN0YWNrbGV2ZWw9MywKICAgICAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkuX3NldFJlc3VsdHNOYW1lKG5hbWUsIGxpc3RBbGxNYXRjaGVzKQoKCmNsYXNzIE1hdGNoRmlyc3QoUGFyc2VFeHByZXNzaW9uKToKICAgIFwiXCJcIlJlcXVpcmVzIHRoYXQgYXQgbGVhc3Qgb25lIDpjbGFzczpgUGFyc2VFeHByZXNzaW9uYCBpcyBmb3VuZC4gSWYKICAgIG1vcmUgdGhhbiBvbmUgZXhwcmVzc2lvbiBtYXRjaGVzLCB0aGUgZmlyc3Qgb25lIGxpc3RlZCBpcyB0aGUgb25lIHRoYXQgd2lsbAogICAgbWF0Y2guIE1heSBiZSBjb25zdHJ1Y3RlZCB1c2luZyB0aGUgYGAnfCdgYCBvcGVyYXRvci4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgIyBjb25zdHJ1Y3QgTWF0Y2hGaXJzdCB1c2luZyAnfCcgb3BlcmF0b3IKCiAgICAgICAgIyB3YXRjaCB0aGUgb3JkZXIgb2YgZXhwcmVzc2lvbnMgdG8gbWF0Y2gKICAgICAgICBudW1iZXIgPSBXb3JkKG51bXMpIHwgQ29tYmluZShXb3JkKG51bXMpICsgJy4nICsgV29yZChudW1zKSkKICAgICAgICBwcmludChudW1iZXIuc2VhcmNoX3N0cmluZyhcIjEyMyAzLjE0MTYgNzg5XCIpKSAjICBGYWlsISAtPiBbWycxMjMnXSwgWyczJ10sIFsnMTQxNiddLCBbJzc4OSddXQoKICAgICAgICAjIHB1dCBtb3JlIHNlbGVjdGl2ZSBleHByZXNzaW9uIGZpcnN0CiAgICAgICAgbnVtYmVyID0gQ29tYmluZShXb3JkKG51bXMpICsgJy4nICsgV29yZChudW1zKSkgfCBXb3JkKG51bXMpCiAgICAgICAgcHJpbnQobnVtYmVyLnNlYXJjaF9zdHJpbmcoXCIxMjMgMy4xNDE2IDc4OVwiKSkgIyAgQmV0dGVyIC0+IFtbJzEyMyddLCBbJzMuMTQxNiddLCBbJzc4OSddXQogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4cHJzOiB0eXBpbmcuSXRlcmFibGVbUGFyc2VyRWxlbWVudF0sIHNhdmVsaXN0OiBib29sID0gRmFsc2UpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwcnMsIHNhdmVsaXN0KQogICAgICAgIGlmIHNlbGYuZXhwcnM6CiAgICAgICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBhbnkoZS5tYXlSZXR1cm5FbXB0eSBmb3IgZSBpbiBzZWxmLmV4cHJzKQogICAgICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gYWxsKGUuc2tpcFdoaXRlc3BhY2UgZm9yIGUgaW4gc2VsZi5leHBycykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gVHJ1ZQoKICAgIGRlZiBzdHJlYW1saW5lKHNlbGYpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgaWYgc2VsZi5zdHJlYW1saW5lZDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYKCiAgICAgICAgc3VwZXIoKS5zdHJlYW1saW5lKCkKICAgICAgICBpZiBzZWxmLmV4cHJzOgogICAgICAgICAgICBzZWxmLnNhdmVBc0xpc3QgPSBhbnkoZS5zYXZlQXNMaXN0IGZvciBlIGluIHNlbGYuZXhwcnMpCiAgICAgICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBhbnkoZS5tYXlSZXR1cm5FbXB0eSBmb3IgZSBpbiBzZWxmLmV4cHJzKQogICAgICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gYWxsKAogICAgICAgICAgICAgICAgZS5za2lwV2hpdGVzcGFjZSBhbmQgbm90IGlzaW5zdGFuY2UoZSwgV2hpdGUpIGZvciBlIGluIHNlbGYuZXhwcnMKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuc2F2ZUFzTGlzdCA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBtYXhFeGNMb2MgPSAtMQogICAgICAgIG1heEV4Y2VwdGlvbiA9IE5vbmUKCiAgICAgICAgZm9yIGUgaW4gc2VsZi5leHByczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGUuX3BhcnNlKAogICAgICAgICAgICAgICAgICAgIGluc3RyaW5nLAogICAgICAgICAgICAgICAgICAgIGxvYywKICAgICAgICAgICAgICAgICAgICBkb0FjdGlvbnMsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUZhdGFsRXhjZXB0aW9uIGFzIHBmZToKICAgICAgICAgICAgICAgIHBmZS5fX3RyYWNlYmFja19fID0gTm9uZQogICAgICAgICAgICAgICAgcGZlLnBhcnNlckVsZW1lbnQgPSBlCiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBleGNlcHQgUGFyc2VFeGNlcHRpb24gYXMgZXJyOgogICAgICAgICAgICAgICAgaWYgZXJyLmxvYyA+IG1heEV4Y0xvYzoKICAgICAgICAgICAgICAgICAgICBtYXhFeGNlcHRpb24gPSBlcnIKICAgICAgICAgICAgICAgICAgICBtYXhFeGNMb2MgPSBlcnIubG9jCiAgICAgICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICAgICAgaWYgbGVuKGluc3RyaW5nKSA+IG1heEV4Y0xvYzoKICAgICAgICAgICAgICAgICAgICBtYXhFeGNlcHRpb24gPSBQYXJzZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHJpbmcsIGxlbihpbnN0cmluZyksIGUuZXJybXNnLCBzZWxmCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIG1heEV4Y0xvYyA9IGxlbihpbnN0cmluZykKCiAgICAgICAgaWYgbWF4RXhjZXB0aW9uIGlzIG5vdCBOb25lOgogICAgICAgICAgICBtYXhFeGNlcHRpb24ubXNnID0gc2VsZi5lcnJtc2cKICAgICAgICAgICAgcmFpc2UgbWF4RXhjZXB0aW9uCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBpbnN0cmluZywgbG9jLCBcIm5vIGRlZmluZWQgYWx0ZXJuYXRpdmVzIHRvIG1hdGNoXCIsIHNlbGYKICAgICAgICAgICAgKQoKICAgIGRlZiBfX2lvcl9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKG90aGVyKQogICAgICAgIHJldHVybiBzZWxmLmFwcGVuZChvdGhlcikgICMgTWF0Y2hGaXJzdChbc2VsZiwgb3RoZXJdKQoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gXCJ7XCIgKyBcIiB8IFwiLmpvaW4oc3RyKGUpIGZvciBlIGluIHNlbGYuZXhwcnMpICsgXCJ9XCIKCiAgICBkZWYgX3NldFJlc3VsdHNOYW1lKHNlbGYsIG5hbWUsIGxpc3RBbGxNYXRjaGVzPUZhbHNlKToKICAgICAgICBpZiAoCiAgICAgICAgICAgIF9fZGlhZ19fLndhcm5fbXVsdGlwbGVfdG9rZW5zX2luX25hbWVkX2FsdGVybmF0aW9uCiAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX211bHRpcGxlX3Rva2Vuc19pbl9uYW1lZF9hbHRlcm5hdGlvbgogICAgICAgICAgICBub3QgaW4gc2VsZi5zdXBwcmVzc193YXJuaW5nc18KICAgICAgICApOgogICAgICAgICAgICBpZiBhbnkoCiAgICAgICAgICAgICAgICBpc2luc3RhbmNlKGUsIEFuZCkKICAgICAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX211bHRpcGxlX3Rva2Vuc19pbl9uYW1lZF9hbHRlcm5hdGlvbgogICAgICAgICAgICAgICAgbm90IGluIGUuc3VwcHJlc3Nfd2FybmluZ3NfCiAgICAgICAgICAgICAgICBmb3IgZSBpbiBzZWxmLmV4cHJzCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgICAgIFwie306IHNldHRpbmcgcmVzdWx0cyBuYW1lIHshcn0gb24ge30gZXhwcmVzc2lvbiBcIgogICAgICAgICAgICAgICAgICAgIFwid2lsbCByZXR1cm4gYSBsaXN0IG9mIGFsbCBwYXJzZWQgdG9rZW5zIGluIGFuIEFuZCBhbHRlcm5hdGl2ZSwgXCIKICAgICAgICAgICAgICAgICAgICBcImluIHByaW9yIHZlcnNpb25zIG9ubHkgdGhlIGZpcnN0IHRva2VuIHdhcyByZXR1cm5lZDsgZW5jbG9zZSBcIgogICAgICAgICAgICAgICAgICAgIFwiY29udGFpbmVkIGFyZ3VtZW50IGluIEdyb3VwXCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICBcIndhcm5fbXVsdGlwbGVfdG9rZW5zX2luX25hbWVkX2FsdGVybmF0aW9uXCIsCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUoc2VsZikuX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBzdGFja2xldmVsPTMsCiAgICAgICAgICAgICAgICApCgogICAgICAgIHJldHVybiBzdXBlcigpLl9zZXRSZXN1bHRzTmFtZShuYW1lLCBsaXN0QWxsTWF0Y2hlcykKCgpjbGFzcyBFYWNoKFBhcnNlRXhwcmVzc2lvbik6CiAgICBcIlwiXCJSZXF1aXJlcyBhbGwgZ2l2ZW4gOmNsYXNzOmBQYXJzZUV4cHJlc3Npb25gIHMgdG8gYmUgZm91bmQsIGJ1dCBpbgogICAgYW55IG9yZGVyLiBFeHByZXNzaW9ucyBtYXkgYmUgc2VwYXJhdGVkIGJ5IHdoaXRlc3BhY2UuCgogICAgTWF5IGJlIGNvbnN0cnVjdGVkIHVzaW5nIHRoZSBgYCcmJ2BgIG9wZXJhdG9yLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBjb2xvciA9IG9uZV9vZihcIlJFRCBPUkFOR0UgWUVMTE9XIEdSRUVOIEJMVUUgUFVSUExFIEJMQUNLIFdISVRFIEJST1dOXCIpCiAgICAgICAgc2hhcGVfdHlwZSA9IG9uZV9vZihcIlNRVUFSRSBDSVJDTEUgVFJJQU5HTEUgU1RBUiBIRVhBR09OIE9DVEFHT05cIikKICAgICAgICBpbnRlZ2VyID0gV29yZChudW1zKQogICAgICAgIHNoYXBlX2F0dHIgPSBcInNoYXBlOlwiICsgc2hhcGVfdHlwZShcInNoYXBlXCIpCiAgICAgICAgcG9zbl9hdHRyID0gXCJwb3NuOlwiICsgR3JvdXAoaW50ZWdlcihcInhcIikgKyAnLCcgKyBpbnRlZ2VyKFwieVwiKSkoXCJwb3NuXCIpCiAgICAgICAgY29sb3JfYXR0ciA9IFwiY29sb3I6XCIgKyBjb2xvcihcImNvbG9yXCIpCiAgICAgICAgc2l6ZV9hdHRyID0gXCJzaXplOlwiICsgaW50ZWdlcihcInNpemVcIikKCiAgICAgICAgIyB1c2UgRWFjaCAodXNpbmcgb3BlcmF0b3IgJyYnKSB0byBhY2NlcHQgYXR0cmlidXRlcyBpbiBhbnkgb3JkZXIKICAgICAgICAjIChzaGFwZSBhbmQgcG9zbiBhcmUgcmVxdWlyZWQsIGNvbG9yIGFuZCBzaXplIGFyZSBvcHRpb25hbCkKICAgICAgICBzaGFwZV9zcGVjID0gc2hhcGVfYXR0ciAmIHBvc25fYXR0ciAmIE9wdChjb2xvcl9hdHRyKSAmIE9wdChzaXplX2F0dHIpCgogICAgICAgIHNoYXBlX3NwZWMucnVuX3Rlc3RzKCcnJwogICAgICAgICAgICBzaGFwZTogU1FVQVJFIGNvbG9yOiBCTEFDSyBwb3NuOiAxMDAsIDEyMAogICAgICAgICAgICBzaGFwZTogQ0lSQ0xFIHNpemU6IDUwIGNvbG9yOiBCTFVFIHBvc246IDUwLDgwCiAgICAgICAgICAgIGNvbG9yOkdSRUVOIHNpemU6MjAgc2hhcGU6VFJJQU5HTEUgcG9zbjoyMCw0MAogICAgICAgICAgICAnJycKICAgICAgICAgICAgKQoKICAgIHByaW50czo6CgogICAgICAgIHNoYXBlOiBTUVVBUkUgY29sb3I6IEJMQUNLIHBvc246IDEwMCwgMTIwCiAgICAgICAgWydzaGFwZTonLCAnU1FVQVJFJywgJ2NvbG9yOicsICdCTEFDSycsICdwb3NuOicsIFsnMTAwJywgJywnLCAnMTIwJ11dCiAgICAgICAgLSBjb2xvcjogQkxBQ0sKICAgICAgICAtIHBvc246IFsnMTAwJywgJywnLCAnMTIwJ10KICAgICAgICAgIC0geDogMTAwCiAgICAgICAgICAtIHk6IDEyMAogICAgICAgIC0gc2hhcGU6IFNRVUFSRQoKCiAgICAgICAgc2hhcGU6IENJUkNMRSBzaXplOiA1MCBjb2xvcjogQkxVRSBwb3NuOiA1MCw4MAogICAgICAgIFsnc2hhcGU6JywgJ0NJUkNMRScsICdzaXplOicsICc1MCcsICdjb2xvcjonLCAnQkxVRScsICdwb3NuOicsIFsnNTAnLCAnLCcsICc4MCddXQogICAgICAgIC0gY29sb3I6IEJMVUUKICAgICAgICAtIHBvc246IFsnNTAnLCAnLCcsICc4MCddCiAgICAgICAgICAtIHg6IDUwCiAgICAgICAgICAtIHk6IDgwCiAgICAgICAgLSBzaGFwZTogQ0lSQ0xFCiAgICAgICAgLSBzaXplOiA1MAoKCiAgICAgICAgY29sb3I6IEdSRUVOIHNpemU6IDIwIHNoYXBlOiBUUklBTkdMRSBwb3NuOiAyMCw0MAogICAgICAgIFsnY29sb3I6JywgJ0dSRUVOJywgJ3NpemU6JywgJzIwJywgJ3NoYXBlOicsICdUUklBTkdMRScsICdwb3NuOicsIFsnMjAnLCAnLCcsICc0MCddXQogICAgICAgIC0gY29sb3I6IEdSRUVOCiAgICAgICAgLSBwb3NuOiBbJzIwJywgJywnLCAnNDAnXQogICAgICAgICAgLSB4OiAyMAogICAgICAgICAgLSB5OiA0MAogICAgICAgIC0gc2hhcGU6IFRSSUFOR0xFCiAgICAgICAgLSBzaXplOiAyMAogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4cHJzOiB0eXBpbmcuSXRlcmFibGVbUGFyc2VyRWxlbWVudF0sIHNhdmVsaXN0OiBib29sID0gVHJ1ZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHBycywgc2F2ZWxpc3QpCiAgICAgICAgaWYgc2VsZi5leHByczoKICAgICAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IGFsbChlLm1heVJldHVybkVtcHR5IGZvciBlIGluIHNlbGYuZXhwcnMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IFRydWUKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gVHJ1ZQogICAgICAgIHNlbGYuaW5pdEV4cHJHcm91cHMgPSBUcnVlCiAgICAgICAgc2VsZi5zYXZlQXNMaXN0ID0gVHJ1ZQoKICAgIGRlZiBzdHJlYW1saW5lKHNlbGYpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgc3VwZXIoKS5zdHJlYW1saW5lKCkKICAgICAgICBpZiBzZWxmLmV4cHJzOgogICAgICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gYWxsKGUubWF5UmV0dXJuRW1wdHkgZm9yIGUgaW4gc2VsZi5leHBycykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gVHJ1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgc2VsZi5pbml0RXhwckdyb3VwczoKICAgICAgICAgICAgc2VsZi5vcHQxbWFwID0gZGljdCgKICAgICAgICAgICAgICAgIChpZChlLmV4cHIpLCBlKSBmb3IgZSBpbiBzZWxmLmV4cHJzIGlmIGlzaW5zdGFuY2UoZSwgT3B0KQogICAgICAgICAgICApCiAgICAgICAgICAgIG9wdDEgPSBbZS5leHByIGZvciBlIGluIHNlbGYuZXhwcnMgaWYgaXNpbnN0YW5jZShlLCBPcHQpXQogICAgICAgICAgICBvcHQyID0gWwogICAgICAgICAgICAgICAgZQogICAgICAgICAgICAgICAgZm9yIGUgaW4gc2VsZi5leHBycwogICAgICAgICAgICAgICAgaWYgZS5tYXlSZXR1cm5FbXB0eSBhbmQgbm90IGlzaW5zdGFuY2UoZSwgKE9wdCwgUmVnZXgsIFplcm9Pck1vcmUpKQogICAgICAgICAgICBdCiAgICAgICAgICAgIHNlbGYub3B0aW9uYWxzID0gb3B0MSArIG9wdDIKICAgICAgICAgICAgc2VsZi5tdWx0aW9wdGlvbmFscyA9IFsKICAgICAgICAgICAgICAgIGUuZXhwci5zZXRfcmVzdWx0c19uYW1lKGUucmVzdWx0c05hbWUsIGxpc3RfYWxsX21hdGNoZXM9VHJ1ZSkKICAgICAgICAgICAgICAgIGZvciBlIGluIHNlbGYuZXhwcnMKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoZSwgX011bHRpcGxlTWF0Y2gpCiAgICAgICAgICAgIF0KICAgICAgICAgICAgc2VsZi5tdWx0aXJlcXVpcmVkID0gWwogICAgICAgICAgICAgICAgZS5leHByLnNldF9yZXN1bHRzX25hbWUoZS5yZXN1bHRzTmFtZSwgbGlzdF9hbGxfbWF0Y2hlcz1UcnVlKQogICAgICAgICAgICAgICAgZm9yIGUgaW4gc2VsZi5leHBycwogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShlLCBPbmVPck1vcmUpCiAgICAgICAgICAgIF0KICAgICAgICAgICAgc2VsZi5yZXF1aXJlZCA9IFsKICAgICAgICAgICAgICAgIGUgZm9yIGUgaW4gc2VsZi5leHBycyBpZiBub3QgaXNpbnN0YW5jZShlLCAoT3B0LCBaZXJvT3JNb3JlLCBPbmVPck1vcmUpKQogICAgICAgICAgICBdCiAgICAgICAgICAgIHNlbGYucmVxdWlyZWQgKz0gc2VsZi5tdWx0aXJlcXVpcmVkCiAgICAgICAgICAgIHNlbGYuaW5pdEV4cHJHcm91cHMgPSBGYWxzZQoKICAgICAgICB0bXBMb2MgPSBsb2MKICAgICAgICB0bXBSZXFkID0gc2VsZi5yZXF1aXJlZFs6XQogICAgICAgIHRtcE9wdCA9IHNlbGYub3B0aW9uYWxzWzpdCiAgICAgICAgbXVsdGlzID0gc2VsZi5tdWx0aW9wdGlvbmFsc1s6XQogICAgICAgIG1hdGNoT3JkZXIgPSBbXQoKICAgICAgICBrZWVwTWF0Y2hpbmcgPSBUcnVlCiAgICAgICAgZmFpbGVkID0gW10KICAgICAgICBmYXRhbHMgPSBbXQogICAgICAgIHdoaWxlIGtlZXBNYXRjaGluZzoKICAgICAgICAgICAgdG1wRXhwcnMgPSB0bXBSZXFkICsgdG1wT3B0ICsgbXVsdGlzCiAgICAgICAgICAgIGZhaWxlZC5jbGVhcigpCiAgICAgICAgICAgIGZhdGFscy5jbGVhcigpCiAgICAgICAgICAgIGZvciBlIGluIHRtcEV4cHJzOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHRtcExvYyA9IGUudHJ5X3BhcnNlKGluc3RyaW5nLCB0bXBMb2MsIHJhaXNlX2ZhdGFsPVRydWUpCiAgICAgICAgICAgICAgICBleGNlcHQgUGFyc2VGYXRhbEV4Y2VwdGlvbiBhcyBwZmU6CiAgICAgICAgICAgICAgICAgICAgcGZlLl9fdHJhY2ViYWNrX18gPSBOb25lCiAgICAgICAgICAgICAgICAgICAgcGZlLnBhcnNlckVsZW1lbnQgPSBlCiAgICAgICAgICAgICAgICAgICAgZmF0YWxzLmFwcGVuZChwZmUpCiAgICAgICAgICAgICAgICAgICAgZmFpbGVkLmFwcGVuZChlKQogICAgICAgICAgICAgICAgZXhjZXB0IFBhcnNlRXhjZXB0aW9uOgogICAgICAgICAgICAgICAgICAgIGZhaWxlZC5hcHBlbmQoZSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbWF0Y2hPcmRlci5hcHBlbmQoc2VsZi5vcHQxbWFwLmdldChpZChlKSwgZSkpCiAgICAgICAgICAgICAgICAgICAgaWYgZSBpbiB0bXBSZXFkOgogICAgICAgICAgICAgICAgICAgICAgICB0bXBSZXFkLnJlbW92ZShlKQogICAgICAgICAgICAgICAgICAgIGVsaWYgZSBpbiB0bXBPcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcE9wdC5yZW1vdmUoZSkKICAgICAgICAgICAgaWYgbGVuKGZhaWxlZCkgPT0gbGVuKHRtcEV4cHJzKToKICAgICAgICAgICAgICAgIGtlZXBNYXRjaGluZyA9IEZhbHNlCgogICAgICAgICMgbG9vayBmb3IgYW55IFBhcnNlRmF0YWxFeGNlcHRpb25zCiAgICAgICAgaWYgZmF0YWxzOgogICAgICAgICAgICBpZiBsZW4oZmF0YWxzKSA+IDE6CiAgICAgICAgICAgICAgICBmYXRhbHMuc29ydChrZXk9bGFtYmRhIGU6IC1lLmxvYykKICAgICAgICAgICAgICAgIGlmIGZhdGFsc1swXS5sb2MgPT0gZmF0YWxzWzFdLmxvYzoKICAgICAgICAgICAgICAgICAgICBmYXRhbHMuc29ydChrZXk9bGFtYmRhIGU6ICgtZS5sb2MsIC1sZW4oc3RyKGUucGFyc2VyRWxlbWVudCkpKSkKICAgICAgICAgICAgbWF4X2ZhdGFsID0gZmF0YWxzWzBdCiAgICAgICAgICAgIHJhaXNlIG1heF9mYXRhbAoKICAgICAgICBpZiB0bXBSZXFkOgogICAgICAgICAgICBtaXNzaW5nID0gXCIsIFwiLmpvaW4oW3N0cihlKSBmb3IgZSBpbiB0bXBSZXFkXSkKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBpbnN0cmluZywKICAgICAgICAgICAgICAgIGxvYywKICAgICAgICAgICAgICAgIFwiTWlzc2luZyBvbmUgb3IgbW9yZSByZXF1aXJlZCBlbGVtZW50cyAoe30pXCIuZm9ybWF0KG1pc3NpbmcpLAogICAgICAgICAgICApCgogICAgICAgICMgYWRkIGFueSB1bm1hdGNoZWQgT3B0cywgaW4gY2FzZSB0aGV5IGhhdmUgZGVmYXVsdCB2YWx1ZXMgZGVmaW5lZAogICAgICAgIG1hdGNoT3JkZXIgKz0gW2UgZm9yIGUgaW4gc2VsZi5leHBycyBpZiBpc2luc3RhbmNlKGUsIE9wdCkgYW5kIGUuZXhwciBpbiB0bXBPcHRdCgogICAgICAgIHRvdGFsX3Jlc3VsdHMgPSBQYXJzZVJlc3VsdHMoW10pCiAgICAgICAgZm9yIGUgaW4gbWF0Y2hPcmRlcjoKICAgICAgICAgICAgbG9jLCByZXN1bHRzID0gZS5fcGFyc2UoaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zKQogICAgICAgICAgICB0b3RhbF9yZXN1bHRzICs9IHJlc3VsdHMKCiAgICAgICAgcmV0dXJuIGxvYywgdG90YWxfcmVzdWx0cwoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gXCJ7XCIgKyBcIiAmIFwiLmpvaW4oc3RyKGUpIGZvciBlIGluIHNlbGYuZXhwcnMpICsgXCJ9XCIKCgpjbGFzcyBQYXJzZUVsZW1lbnRFbmhhbmNlKFBhcnNlckVsZW1lbnQpOgogICAgXCJcIlwiQWJzdHJhY3Qgc3ViY2xhc3Mgb2YgOmNsYXNzOmBQYXJzZXJFbGVtZW50YCwgZm9yIGNvbWJpbmluZyBhbmQKICAgIHBvc3QtcHJvY2Vzc2luZyBwYXJzZWQgdG9rZW5zLgogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4cHI6IFVuaW9uW1BhcnNlckVsZW1lbnQsIHN0cl0sIHNhdmVsaXN0OiBib29sID0gRmFsc2UpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oc2F2ZWxpc3QpCiAgICAgICAgaWYgaXNpbnN0YW5jZShleHByLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIGlmIGlzc3ViY2xhc3Moc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzLCBUb2tlbik6CiAgICAgICAgICAgICAgICBleHByID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKGV4cHIpCiAgICAgICAgICAgIGVsaWYgaXNzdWJjbGFzcyh0eXBlKHNlbGYpLCBzZWxmLl9saXRlcmFsU3RyaW5nQ2xhc3MpOgogICAgICAgICAgICAgICAgZXhwciA9IExpdGVyYWwoZXhwcikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGV4cHIgPSBzZWxmLl9saXRlcmFsU3RyaW5nQ2xhc3MoTGl0ZXJhbChleHByKSkKICAgICAgICBzZWxmLmV4cHIgPSBleHByCiAgICAgICAgaWYgZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5tYXlJbmRleEVycm9yID0gZXhwci5tYXlJbmRleEVycm9yCiAgICAgICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBleHByLm1heVJldHVybkVtcHR5CiAgICAgICAgICAgIHNlbGYuc2V0X3doaXRlc3BhY2VfY2hhcnMoCiAgICAgICAgICAgICAgICBleHByLndoaXRlQ2hhcnMsIGNvcHlfZGVmYXVsdHM9ZXhwci5jb3B5RGVmYXVsdFdoaXRlQ2hhcnMKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gZXhwci5za2lwV2hpdGVzcGFjZQogICAgICAgICAgICBzZWxmLnNhdmVBc0xpc3QgPSBleHByLnNhdmVBc0xpc3QKICAgICAgICAgICAgc2VsZi5jYWxsUHJlcGFyc2UgPSBleHByLmNhbGxQcmVwYXJzZQogICAgICAgICAgICBzZWxmLmlnbm9yZUV4cHJzLmV4dGVuZChleHByLmlnbm9yZUV4cHJzKQoKICAgIGRlZiByZWN1cnNlKHNlbGYpIC0+IFNlcXVlbmNlW1BhcnNlckVsZW1lbnRdOgogICAgICAgIHJldHVybiBbc2VsZi5leHByXSBpZiBzZWxmLmV4cHIgaXMgbm90IE5vbmUgZWxzZSBbXQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIGlmIHNlbGYuZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZXhwci5fcGFyc2UoaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zLCBjYWxsUHJlUGFyc2U9RmFsc2UpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgXCJObyBleHByZXNzaW9uIGRlZmluZWRcIiwgc2VsZikKCiAgICBkZWYgbGVhdmVfd2hpdGVzcGFjZShzZWxmLCByZWN1cnNpdmU6IGJvb2wgPSBUcnVlKSAtPiBQYXJzZXJFbGVtZW50OgogICAgICAgIHN1cGVyKCkubGVhdmVfd2hpdGVzcGFjZShyZWN1cnNpdmUpCgogICAgICAgIGlmIHJlY3Vyc2l2ZToKICAgICAgICAgICAgc2VsZi5leHByID0gc2VsZi5leHByLmNvcHkoKQogICAgICAgICAgICBpZiBzZWxmLmV4cHIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmV4cHIubGVhdmVfd2hpdGVzcGFjZShyZWN1cnNpdmUpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgaWdub3JlX3doaXRlc3BhY2Uoc2VsZiwgcmVjdXJzaXZlOiBib29sID0gVHJ1ZSkgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBzdXBlcigpLmlnbm9yZV93aGl0ZXNwYWNlKHJlY3Vyc2l2ZSkKCiAgICAgICAgaWYgcmVjdXJzaXZlOgogICAgICAgICAgICBzZWxmLmV4cHIgPSBzZWxmLmV4cHIuY29weSgpCiAgICAgICAgICAgIGlmIHNlbGYuZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuZXhwci5pZ25vcmVfd2hpdGVzcGFjZShyZWN1cnNpdmUpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgaWdub3JlKHNlbGYsIG90aGVyKSAtPiBQYXJzZXJFbGVtZW50OgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIFN1cHByZXNzKToKICAgICAgICAgICAgaWYgb3RoZXIgbm90IGluIHNlbGYuaWdub3JlRXhwcnM6CiAgICAgICAgICAgICAgICBzdXBlcigpLmlnbm9yZShvdGhlcikKICAgICAgICAgICAgICAgIGlmIHNlbGYuZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cHIuaWdub3JlKHNlbGYuaWdub3JlRXhwcnNbLTFdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN1cGVyKCkuaWdub3JlKG90aGVyKQogICAgICAgICAgICBpZiBzZWxmLmV4cHIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmV4cHIuaWdub3JlKHNlbGYuaWdub3JlRXhwcnNbLTFdKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHN0cmVhbWxpbmUoc2VsZikgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBzdXBlcigpLnN0cmVhbWxpbmUoKQogICAgICAgIGlmIHNlbGYuZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5leHByLnN0cmVhbWxpbmUoKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9jaGVja1JlY3Vyc2lvbihzZWxmLCBwYXJzZUVsZW1lbnRMaXN0KToKICAgICAgICBpZiBzZWxmIGluIHBhcnNlRWxlbWVudExpc3Q6CiAgICAgICAgICAgIHJhaXNlIFJlY3Vyc2l2ZUdyYW1tYXJFeGNlcHRpb24ocGFyc2VFbGVtZW50TGlzdCArIFtzZWxmXSkKICAgICAgICBzdWJSZWNDaGVja0xpc3QgPSBwYXJzZUVsZW1lbnRMaXN0WzpdICsgW3NlbGZdCiAgICAgICAgaWYgc2VsZi5leHByIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLmV4cHIuX2NoZWNrUmVjdXJzaW9uKHN1YlJlY0NoZWNrTGlzdCkKCiAgICBkZWYgdmFsaWRhdGUoc2VsZiwgdmFsaWRhdGVUcmFjZT1Ob25lKSAtPiBOb25lOgogICAgICAgIGlmIHZhbGlkYXRlVHJhY2UgaXMgTm9uZToKICAgICAgICAgICAgdmFsaWRhdGVUcmFjZSA9IFtdCiAgICAgICAgdG1wID0gdmFsaWRhdGVUcmFjZVs6XSArIFtzZWxmXQogICAgICAgIGlmIHNlbGYuZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5leHByLnZhbGlkYXRlKHRtcCkKICAgICAgICBzZWxmLl9jaGVja1JlY3Vyc2lvbihbXSkKCiAgICBkZWYgX2dlbmVyYXRlRGVmYXVsdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIFwie306KHt9KVwiLmZvcm1hdChzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywgc3RyKHNlbGYuZXhwcikpCgogICAgaWdub3JlV2hpdGVzcGFjZSA9IGlnbm9yZV93aGl0ZXNwYWNlCiAgICBsZWF2ZVdoaXRlc3BhY2UgPSBsZWF2ZV93aGl0ZXNwYWNlCgoKY2xhc3MgSW5kZW50ZWRCbG9jayhQYXJzZUVsZW1lbnRFbmhhbmNlKToKICAgIFwiXCJcIgogICAgRXhwcmVzc2lvbiB0byBtYXRjaCBvbmUgb3IgbW9yZSBleHByZXNzaW9ucyBhdCBhIGdpdmVuIGluZGVudGF0aW9uIGxldmVsLgogICAgVXNlZnVsIGZvciBwYXJzaW5nIHRleHQgd2hlcmUgc3RydWN0dXJlIGlzIGltcGxpZWQgYnkgaW5kZW50YXRpb24gKGxpa2UgUHl0aG9uIHNvdXJjZSBjb2RlKS4KICAgIFwiXCJcIgoKICAgIGNsYXNzIF9JbmRlbnQoRW1wdHkpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCByZWZfY29sOiBpbnQpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5lcnJtc2cgPSBcImV4cGVjdGVkIGluZGVudCBhdCBjb2x1bW4ge31cIi5mb3JtYXQocmVmX2NvbCkKICAgICAgICAgICAgc2VsZi5hZGRfY29uZGl0aW9uKGxhbWJkYSBzLCBsLCB0OiBjb2wobCwgcykgPT0gcmVmX2NvbCkKCiAgICBjbGFzcyBfSW5kZW50R3JlYXRlcihFbXB0eSk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHJlZl9jb2w6IGludCk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLmVycm1zZyA9IFwiZXhwZWN0ZWQgaW5kZW50IGF0IGNvbHVtbiBncmVhdGVyIHRoYW4ge31cIi5mb3JtYXQocmVmX2NvbCkKICAgICAgICAgICAgc2VsZi5hZGRfY29uZGl0aW9uKGxhbWJkYSBzLCBsLCB0OiBjb2wobCwgcykgPiByZWZfY29sKQoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLCBleHByOiBQYXJzZXJFbGVtZW50LCAqLCByZWN1cnNpdmU6IGJvb2wgPSBGYWxzZSwgZ3JvdXBlZDogYm9vbCA9IFRydWUKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHByLCBzYXZlbGlzdD1UcnVlKQogICAgICAgICMgaWYgcmVjdXJzaXZlOgogICAgICAgICMgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoXCJJbmRlbnRlZEJsb2NrIHdpdGggcmVjdXJzaXZlIGlzIG5vdCBpbXBsZW1lbnRlZFwiKQogICAgICAgIHNlbGYuX3JlY3Vyc2l2ZSA9IHJlY3Vyc2l2ZQogICAgICAgIHNlbGYuX2dyb3VwZWQgPSBncm91cGVkCiAgICAgICAgc2VsZi5wYXJlbnRfYW5jaG9yID0gMQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgICMgYWR2YW5jZSBwYXJzZSBwb3NpdGlvbiB0byBub24td2hpdGVzcGFjZSBieSB1c2luZyBhbiBFbXB0eSgpCiAgICAgICAgIyB0aGlzIHNob3VsZCBiZSB0aGUgY29sdW1uIHRvIGJlIHVzZWQgZm9yIGFsbCBzdWJzZXF1ZW50IGluZGVudGVkIGxpbmVzCiAgICAgICAgYW5jaG9yX2xvYyA9IEVtcHR5KCkucHJlUGFyc2UoaW5zdHJpbmcsIGxvYykKCiAgICAgICAgIyBzZWUgaWYgc2VsZi5leHByIG1hdGNoZXMgYXQgdGhlIGN1cnJlbnQgbG9jYXRpb24gLSBpZiBub3QgaXQgd2lsbCByYWlzZSBhbiBleGNlcHRpb24KICAgICAgICAjIGFuZCBubyBmdXJ0aGVyIHdvcmsgaXMgbmVjZXNzYXJ5CiAgICAgICAgc2VsZi5leHByLnRyeV9wYXJzZShpbnN0cmluZywgYW5jaG9yX2xvYywgZG9BY3Rpb25zKQoKICAgICAgICBpbmRlbnRfY29sID0gY29sKGFuY2hvcl9sb2MsIGluc3RyaW5nKQogICAgICAgIHBlZXJfZGV0ZWN0X2V4cHIgPSBzZWxmLl9JbmRlbnQoaW5kZW50X2NvbCkKCiAgICAgICAgaW5uZXJfZXhwciA9IEVtcHR5KCkgKyBwZWVyX2RldGVjdF9leHByICsgc2VsZi5leHByCiAgICAgICAgaWYgc2VsZi5fcmVjdXJzaXZlOgogICAgICAgICAgICBzdWJfaW5kZW50ID0gc2VsZi5fSW5kZW50R3JlYXRlcihpbmRlbnRfY29sKQogICAgICAgICAgICBuZXN0ZWRfYmxvY2sgPSBJbmRlbnRlZEJsb2NrKAogICAgICAgICAgICAgICAgc2VsZi5leHByLCByZWN1cnNpdmU9c2VsZi5fcmVjdXJzaXZlLCBncm91cGVkPXNlbGYuX2dyb3VwZWQKICAgICAgICAgICAgKQogICAgICAgICAgICBuZXN0ZWRfYmxvY2suc2V0X2RlYnVnKHNlbGYuZGVidWcpCiAgICAgICAgICAgIG5lc3RlZF9ibG9jay5wYXJlbnRfYW5jaG9yID0gaW5kZW50X2NvbAogICAgICAgICAgICBpbm5lcl9leHByICs9IE9wdChzdWJfaW5kZW50ICsgbmVzdGVkX2Jsb2NrKQoKICAgICAgICBpbm5lcl9leHByLnNldF9uYW1lKGZcImlubmVyIHtoZXgoaWQoaW5uZXJfZXhwcikpWy00Ol0udXBwZXIoKX1Ae2luZGVudF9jb2x9XCIpCiAgICAgICAgYmxvY2sgPSBPbmVPck1vcmUoaW5uZXJfZXhwcikKCiAgICAgICAgdHJhaWxpbmdfdW5kZW50ID0gc2VsZi5fSW5kZW50KHNlbGYucGFyZW50X2FuY2hvcikgfCBTdHJpbmdFbmQoKQoKICAgICAgICBpZiBzZWxmLl9ncm91cGVkOgogICAgICAgICAgICB3cmFwcGVyID0gR3JvdXAKICAgICAgICBlbHNlOgogICAgICAgICAgICB3cmFwcGVyID0gbGFtYmRhIGV4cHI6IGV4cHIKICAgICAgICByZXR1cm4gKHdyYXBwZXIoYmxvY2spICsgT3B0aW9uYWwodHJhaWxpbmdfdW5kZW50KSkucGFyc2VJbXBsKAogICAgICAgICAgICBpbnN0cmluZywgYW5jaG9yX2xvYywgZG9BY3Rpb25zCiAgICAgICAgKQoKCmNsYXNzIEF0U3RyaW5nU3RhcnQoUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBcIlwiXCJNYXRjaGVzIGlmIGV4cHJlc3Npb24gbWF0Y2hlcyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBwYXJzZQogICAgc3RyaW5nOjoKCiAgICAgICAgQXRTdHJpbmdTdGFydChXb3JkKG51bXMpKS5wYXJzZV9zdHJpbmcoXCIxMjNcIikKICAgICAgICAjIHByaW50cyBbXCIxMjNcIl0KCiAgICAgICAgQXRTdHJpbmdTdGFydChXb3JkKG51bXMpKS5wYXJzZV9zdHJpbmcoXCIgICAgMTIzXCIpCiAgICAgICAgIyByYWlzZXMgUGFyc2VFeGNlcHRpb24KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBleHByOiBVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGV4cHIpCiAgICAgICAgc2VsZi5jYWxsUHJlcGFyc2UgPSBGYWxzZQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIGlmIGxvYyAhPSAwOgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihpbnN0cmluZywgbG9jLCBcIm5vdCBmb3VuZCBhdCBzdHJpbmcgc3RhcnRcIikKICAgICAgICByZXR1cm4gc3VwZXIoKS5wYXJzZUltcGwoaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zKQoKCmNsYXNzIEF0TGluZVN0YXJ0KFBhcnNlRWxlbWVudEVuaGFuY2UpOgogICAgclwiXCJcIk1hdGNoZXMgaWYgYW4gZXhwcmVzc2lvbiBtYXRjaGVzIGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBsaW5lIHdpdGhpbgogICAgdGhlIHBhcnNlIHN0cmluZwoKICAgIEV4YW1wbGU6OgoKICAgICAgICB0ZXN0ID0gJycnXFwKICAgICAgICBBQUEgdGhpcyBsaW5lCiAgICAgICAgQUFBIGFuZCB0aGlzIGxpbmUKICAgICAgICAgIEFBQSBidXQgbm90IHRoaXMgb25lCiAgICAgICAgQiBBQUEgYW5kIGRlZmluaXRlbHkgbm90IHRoaXMgb25lCiAgICAgICAgJycnCgogICAgICAgIGZvciB0IGluIChBdExpbmVTdGFydCgnQUFBJykgKyByZXN0T2ZMaW5lKS5zZWFyY2hfc3RyaW5nKHRlc3QpOgogICAgICAgICAgICBwcmludCh0KQoKICAgIHByaW50czo6CgogICAgICAgIFsnQUFBJywgJyB0aGlzIGxpbmUnXQogICAgICAgIFsnQUFBJywgJyBhbmQgdGhpcyBsaW5lJ10KCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwcjogVW5pb25bUGFyc2VyRWxlbWVudCwgc3RyXSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHByKQogICAgICAgIHNlbGYuY2FsbFByZXBhcnNlID0gRmFsc2UKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBpZiBjb2wobG9jLCBpbnN0cmluZykgIT0gMToKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgXCJub3QgZm91bmQgYXQgbGluZSBzdGFydFwiKQogICAgICAgIHJldHVybiBzdXBlcigpLnBhcnNlSW1wbChpbnN0cmluZywgbG9jLCBkb0FjdGlvbnMpCgoKY2xhc3MgRm9sbG93ZWRCeShQYXJzZUVsZW1lbnRFbmhhbmNlKToKICAgIFwiXCJcIkxvb2thaGVhZCBtYXRjaGluZyBvZiB0aGUgZ2l2ZW4gcGFyc2UgZXhwcmVzc2lvbi4KICAgIGBgRm9sbG93ZWRCeWBgIGRvZXMgKm5vdCogYWR2YW5jZSB0aGUgcGFyc2luZyBwb3NpdGlvbiB3aXRoaW4KICAgIHRoZSBpbnB1dCBzdHJpbmcsIGl0IG9ubHkgdmVyaWZpZXMgdGhhdCB0aGUgc3BlY2lmaWVkIHBhcnNlCiAgICBleHByZXNzaW9uIG1hdGNoZXMgYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24uICBgYEZvbGxvd2VkQnlgYAogICAgYWx3YXlzIHJldHVybnMgYSBudWxsIHRva2VuIGxpc3QuIElmIGFueSByZXN1bHRzIG5hbWVzIGFyZSBkZWZpbmVkCiAgICBpbiB0aGUgbG9va2FoZWFkIGV4cHJlc3Npb24sIHRob3NlICp3aWxsKiBiZSByZXR1cm5lZCBmb3IgYWNjZXNzIGJ5CiAgICBuYW1lLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICAjIHVzZSBGb2xsb3dlZEJ5IHRvIG1hdGNoIGEgbGFiZWwgb25seSBpZiBpdCBpcyBmb2xsb3dlZCBieSBhICc6JwogICAgICAgIGRhdGFfd29yZCA9IFdvcmQoYWxwaGFzKQogICAgICAgIGxhYmVsID0gZGF0YV93b3JkICsgRm9sbG93ZWRCeSgnOicpCiAgICAgICAgYXR0cl9leHByID0gR3JvdXAobGFiZWwgKyBTdXBwcmVzcygnOicpICsgT25lT3JNb3JlKGRhdGFfd29yZCwgc3RvcF9vbj1sYWJlbCkuc2V0X3BhcnNlX2FjdGlvbignICcuam9pbikpCgogICAgICAgIGF0dHJfZXhwclsxLCAuLi5dLnBhcnNlX3N0cmluZyhcInNoYXBlOiBTUVVBUkUgY29sb3I6IEJMQUNLIHBvc246IHVwcGVyIGxlZnRcIikucHByaW50KCkKCiAgICBwcmludHM6OgoKICAgICAgICBbWydzaGFwZScsICdTUVVBUkUnXSwgWydjb2xvcicsICdCTEFDSyddLCBbJ3Bvc24nLCAndXBwZXIgbGVmdCddXQogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4cHI6IFVuaW9uW1BhcnNlckVsZW1lbnQsIHN0cl0pOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwcikKICAgICAgICBzZWxmLm1heVJldHVybkVtcHR5ID0gVHJ1ZQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgICMgYnkgdXNpbmcgc2VsZi5fZXhwci5wYXJzZSBhbmQgZGVsZXRpbmcgdGhlIGNvbnRlbnRzIG9mIHRoZSByZXR1cm5lZCBQYXJzZVJlc3VsdHMgbGlzdAogICAgICAgICMgd2Uga2VlcCBhbnkgbmFtZWQgcmVzdWx0cyB0aGF0IHdlcmUgZGVmaW5lZCBpbiB0aGUgRm9sbG93ZWRCeSBleHByZXNzaW9uCiAgICAgICAgXywgcmV0ID0gc2VsZi5leHByLl9wYXJzZShpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9ZG9BY3Rpb25zKQogICAgICAgIGRlbCByZXRbOl0KCiAgICAgICAgcmV0dXJuIGxvYywgcmV0CgoKY2xhc3MgUHJlY2VkZWRCeShQYXJzZUVsZW1lbnRFbmhhbmNlKToKICAgIFwiXCJcIkxvb2tiZWhpbmQgbWF0Y2hpbmcgb2YgdGhlIGdpdmVuIHBhcnNlIGV4cHJlc3Npb24uCiAgICBgYFByZWNlZGVkQnlgYCBkb2VzIG5vdCBhZHZhbmNlIHRoZSBwYXJzaW5nIHBvc2l0aW9uIHdpdGhpbiB0aGUKICAgIGlucHV0IHN0cmluZywgaXQgb25seSB2ZXJpZmllcyB0aGF0IHRoZSBzcGVjaWZpZWQgcGFyc2UgZXhwcmVzc2lvbgogICAgbWF0Y2hlcyBwcmlvciB0byB0aGUgY3VycmVudCBwb3NpdGlvbi4gIGBgUHJlY2VkZWRCeWBgIGFsd2F5cwogICAgcmV0dXJucyBhIG51bGwgdG9rZW4gbGlzdCwgYnV0IGlmIGEgcmVzdWx0cyBuYW1lIGlzIGRlZmluZWQgb24gdGhlCiAgICBnaXZlbiBleHByZXNzaW9uLCBpdCBpcyByZXR1cm5lZC4KCiAgICBQYXJhbWV0ZXJzOgoKICAgIC0gZXhwciAtIGV4cHJlc3Npb24gdGhhdCBtdXN0IG1hdGNoIHByaW9yIHRvIHRoZSBjdXJyZW50IHBhcnNlCiAgICAgIGxvY2F0aW9uCiAgICAtIHJldHJlYXQgLSAoZGVmYXVsdD0gYGBOb25lYGApIC0gKGludCkgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycwogICAgICB0byBsb29rYmVoaW5kIHByaW9yIHRvIHRoZSBjdXJyZW50IHBhcnNlIGxvY2F0aW9uCgogICAgSWYgdGhlIGxvb2tiZWhpbmQgZXhwcmVzc2lvbiBpcyBhIHN0cmluZywgOmNsYXNzOmBMaXRlcmFsYCwKICAgIDpjbGFzczpgS2V5d29yZGAsIG9yIGEgOmNsYXNzOmBXb3JkYCBvciA6Y2xhc3M6YENoYXJzTm90SW5gCiAgICB3aXRoIGEgc3BlY2lmaWVkIGV4YWN0IG9yIG1heGltdW0gbGVuZ3RoLCB0aGVuIHRoZSByZXRyZWF0CiAgICBwYXJhbWV0ZXIgaXMgbm90IHJlcXVpcmVkLiBPdGhlcndpc2UsIHJldHJlYXQgbXVzdCBiZSBzcGVjaWZpZWQgdG8KICAgIGdpdmUgYSBtYXhpbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIHRvIGxvb2sgYmFjayBmcm9tCiAgICB0aGUgY3VycmVudCBwYXJzZSBwb3NpdGlvbiBmb3IgYSBsb29rYmVoaW5kIG1hdGNoLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICAjIFZCLXN0eWxlIHZhcmlhYmxlIG5hbWVzIHdpdGggdHlwZSBwcmVmaXhlcwogICAgICAgIGludF92YXIgPSBQcmVjZWRlZEJ5KFwiI1wiKSArIHB5cGFyc2luZ19jb21tb24uaWRlbnRpZmllcgogICAgICAgIHN0cl92YXIgPSBQcmVjZWRlZEJ5KFwiJFwiKSArIHB5cGFyc2luZ19jb21tb24uaWRlbnRpZmllcgoKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLCBleHByOiBVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdLCByZXRyZWF0OiB0eXBpbmcuT3B0aW9uYWxbaW50XSA9IE5vbmUKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHByKQogICAgICAgIHNlbGYuZXhwciA9IHNlbGYuZXhwcigpLmxlYXZlX3doaXRlc3BhY2UoKQogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCiAgICAgICAgc2VsZi5tYXlJbmRleEVycm9yID0gRmFsc2UKICAgICAgICBzZWxmLmV4YWN0ID0gRmFsc2UKICAgICAgICBpZiBpc2luc3RhbmNlKGV4cHIsIHN0cl90eXBlKToKICAgICAgICAgICAgcmV0cmVhdCA9IGxlbihleHByKQogICAgICAgICAgICBzZWxmLmV4YWN0ID0gVHJ1ZQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShleHByLCAoTGl0ZXJhbCwgS2V5d29yZCkpOgogICAgICAgICAgICByZXRyZWF0ID0gZXhwci5tYXRjaExlbgogICAgICAgICAgICBzZWxmLmV4YWN0ID0gVHJ1ZQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShleHByLCAoV29yZCwgQ2hhcnNOb3RJbikpIGFuZCBleHByLm1heExlbiAhPSBfTUFYX0lOVDoKICAgICAgICAgICAgcmV0cmVhdCA9IGV4cHIubWF4TGVuCiAgICAgICAgICAgIHNlbGYuZXhhY3QgPSBUcnVlCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKGV4cHIsIFBvc2l0aW9uVG9rZW4pOgogICAgICAgICAgICByZXRyZWF0ID0gMAogICAgICAgICAgICBzZWxmLmV4YWN0ID0gVHJ1ZQogICAgICAgIHNlbGYucmV0cmVhdCA9IHJldHJlYXQKICAgICAgICBzZWxmLmVycm1zZyA9IFwibm90IHByZWNlZGVkIGJ5IFwiICsgc3RyKGV4cHIpCiAgICAgICAgc2VsZi5za2lwV2hpdGVzcGFjZSA9IEZhbHNlCiAgICAgICAgc2VsZi5wYXJzZUFjdGlvbi5hcHBlbmQobGFtYmRhIHMsIGwsIHQ6IHQuX19kZWxpdGVtX18oc2xpY2UoTm9uZSwgTm9uZSkpKQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYz0wLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgaWYgc2VsZi5leGFjdDoKICAgICAgICAgICAgaWYgbG9jIDwgc2VsZi5yZXRyZWF0OgogICAgICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2cpCiAgICAgICAgICAgIHN0YXJ0ID0gbG9jIC0gc2VsZi5yZXRyZWF0CiAgICAgICAgICAgIF8sIHJldCA9IHNlbGYuZXhwci5fcGFyc2UoaW5zdHJpbmcsIHN0YXJ0KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgcmV0cmVhdCBzcGVjaWZpZWQgYSBtYXhpbXVtIGxvb2tiZWhpbmQgd2luZG93LCBpdGVyYXRlCiAgICAgICAgICAgIHRlc3RfZXhwciA9IHNlbGYuZXhwciArIFN0cmluZ0VuZCgpCiAgICAgICAgICAgIGluc3RyaW5nX3NsaWNlID0gaW5zdHJpbmdbbWF4KDAsIGxvYyAtIHNlbGYucmV0cmVhdCkgOiBsb2NdCiAgICAgICAgICAgIGxhc3RfZXhwciA9IFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnKQogICAgICAgICAgICBmb3Igb2Zmc2V0IGluIHJhbmdlKDEsIG1pbihsb2MsIHNlbGYucmV0cmVhdCArIDEpICsgMSk6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgIyBwcmludCgndHJ5aW5nJywgb2Zmc2V0LCBpbnN0cmluZ19zbGljZSwgcmVwcihpbnN0cmluZ19zbGljZVtsb2MgLSBvZmZzZXQ6XSkpCiAgICAgICAgICAgICAgICAgICAgXywgcmV0ID0gdGVzdF9leHByLl9wYXJzZSgKICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHJpbmdfc2xpY2UsIGxlbihpbnN0cmluZ19zbGljZSkgLSBvZmZzZXQKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBleGNlcHQgUGFyc2VCYXNlRXhjZXB0aW9uIGFzIHBiZToKICAgICAgICAgICAgICAgICAgICBsYXN0X2V4cHIgPSBwYmUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIGxhc3RfZXhwcgogICAgICAgIHJldHVybiBsb2MsIHJldAoKCmNsYXNzIExvY2F0ZWQoUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBcIlwiXCIKICAgIERlY29yYXRlcyBhIHJldHVybmVkIHRva2VuIHdpdGggaXRzIHN0YXJ0aW5nIGFuZCBlbmRpbmcKICAgIGxvY2F0aW9ucyBpbiB0aGUgaW5wdXQgc3RyaW5nLgoKICAgIFRoaXMgaGVscGVyIGFkZHMgdGhlIGZvbGxvd2luZyByZXN1bHRzIG5hbWVzOgoKICAgIC0gYGBsb2NuX3N0YXJ0YGAgLSBsb2NhdGlvbiB3aGVyZSBtYXRjaGVkIGV4cHJlc3Npb24gYmVnaW5zCiAgICAtIGBgbG9jbl9lbmRgYCAtIGxvY2F0aW9uIHdoZXJlIG1hdGNoZWQgZXhwcmVzc2lvbiBlbmRzCiAgICAtIGBgdmFsdWVgYCAtIHRoZSBhY3R1YWwgcGFyc2VkIHJlc3VsdHMKCiAgICBCZSBjYXJlZnVsIGlmIHRoZSBpbnB1dCB0ZXh0IGNvbnRhaW5zIGBgPFRBQj5gYCBjaGFyYWN0ZXJzLCB5b3UKICAgIG1heSB3YW50IHRvIGNhbGwgOmNsYXNzOmBQYXJzZXJFbGVtZW50LnBhcnNlX3dpdGhfdGFic2AKCiAgICBFeGFtcGxlOjoKCiAgICAgICAgd2QgPSBXb3JkKGFscGhhcykKICAgICAgICBmb3IgbWF0Y2ggaW4gTG9jYXRlZCh3ZCkuc2VhcmNoX3N0cmluZyhcImxqc2RmMTIzbGtzZGpqZjEyM2xra2pqMTIyMlwiKToKICAgICAgICAgICAgcHJpbnQobWF0Y2gpCgogICAgcHJpbnRzOjoKCiAgICAgICAgWzAsIFsnbGpzZGYnXSwgNV0KICAgICAgICBbOCwgWydsa3NkampmJ10sIDE1XQogICAgICAgIFsxOCwgWydsa2tqaiddLCAyM10KCiAgICBcIlwiXCIKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBzdGFydCA9IGxvYwogICAgICAgIGxvYywgdG9rZW5zID0gc2VsZi5leHByLl9wYXJzZShpbnN0cmluZywgc3RhcnQsIGRvQWN0aW9ucywgY2FsbFByZVBhcnNlPUZhbHNlKQogICAgICAgIHJldF90b2tlbnMgPSBQYXJzZVJlc3VsdHMoW3N0YXJ0LCB0b2tlbnMsIGxvY10pCiAgICAgICAgcmV0X3Rva2Vuc1tcImxvY25fc3RhcnRcIl0gPSBzdGFydAogICAgICAgIHJldF90b2tlbnNbXCJ2YWx1ZVwiXSA9IHRva2VucwogICAgICAgIHJldF90b2tlbnNbXCJsb2NuX2VuZFwiXSA9IGxvYwogICAgICAgIGlmIHNlbGYucmVzdWx0c05hbWU6CiAgICAgICAgICAgICMgbXVzdCByZXR1cm4gYXMgYSBsaXN0LCBzbyB0aGF0IHRoZSBuYW1lIHdpbGwgYmUgYXR0YWNoZWQgdG8gdGhlIGNvbXBsZXRlIGdyb3VwCiAgICAgICAgICAgIHJldHVybiBsb2MsIFtyZXRfdG9rZW5zXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBsb2MsIHJldF90b2tlbnMKCgpjbGFzcyBOb3RBbnkoUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBcIlwiXCIKICAgIExvb2thaGVhZCB0byBkaXNhbGxvdyBtYXRjaGluZyB3aXRoIHRoZSBnaXZlbiBwYXJzZSBleHByZXNzaW9uLgogICAgYGBOb3RBbnlgYCBkb2VzICpub3QqIGFkdmFuY2UgdGhlIHBhcnNpbmcgcG9zaXRpb24gd2l0aGluIHRoZQogICAgaW5wdXQgc3RyaW5nLCBpdCBvbmx5IHZlcmlmaWVzIHRoYXQgdGhlIHNwZWNpZmllZCBwYXJzZSBleHByZXNzaW9uCiAgICBkb2VzICpub3QqIG1hdGNoIGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uLiAgQWxzbywgYGBOb3RBbnlgYCBkb2VzCiAgICAqbm90KiBza2lwIG92ZXIgbGVhZGluZyB3aGl0ZXNwYWNlLiBgYE5vdEFueWBgIGFsd2F5cyByZXR1cm5zCiAgICBhIG51bGwgdG9rZW4gbGlzdC4gIE1heSBiZSBjb25zdHJ1Y3RlZCB1c2luZyB0aGUgYGAnfidgYCBvcGVyYXRvci4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgQU5ELCBPUiwgTk9UID0gbWFwKENhc2VsZXNzS2V5d29yZCwgXCJBTkQgT1IgTk9UXCIuc3BsaXQoKSkKCiAgICAgICAgIyB0YWtlIGNhcmUgbm90IHRvIG1pc3Rha2Uga2V5d29yZHMgZm9yIGlkZW50aWZpZXJzCiAgICAgICAgaWRlbnQgPSB+KEFORCB8IE9SIHwgTk9UKSArIFdvcmQoYWxwaGFzKQogICAgICAgIGJvb2xlYW5fdGVybSA9IE9wdChOT1QpICsgaWRlbnQKCiAgICAgICAgIyB2ZXJ5IGNydWRlIGJvb2xlYW4gZXhwcmVzc2lvbiAtIHRvIHN1cHBvcnQgcGFyZW50aGVzaXMgZ3JvdXBzIGFuZAogICAgICAgICMgb3BlcmF0aW9uIGhpZXJhcmNoeSwgdXNlIGluZml4X25vdGF0aW9uCiAgICAgICAgYm9vbGVhbl9leHByID0gYm9vbGVhbl90ZXJtICsgKChBTkQgfCBPUikgKyBib29sZWFuX3Rlcm0pWy4uLl0KCiAgICAgICAgIyBpbnRlZ2VycyB0aGF0IGFyZSBmb2xsb3dlZCBieSBcIi5cIiBhcmUgYWN0dWFsbHkgZmxvYXRzCiAgICAgICAgaW50ZWdlciA9IFdvcmQobnVtcykgKyB+Q2hhcihcIi5cIikKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBleHByOiBVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGV4cHIpCiAgICAgICAgIyBkbyBOT1QgdXNlIHNlbGYubGVhdmVfd2hpdGVzcGFjZSgpLCBkb24ndCB3YW50IHRvIHByb3BhZ2F0ZSB0byBleHBycwogICAgICAgICMgc2VsZi5sZWF2ZV93aGl0ZXNwYWNlKCkKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gRmFsc2UKCiAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IFRydWUKICAgICAgICBzZWxmLmVycm1zZyA9IFwiRm91bmQgdW53YW50ZWQgdG9rZW4sIFwiICsgc3RyKHNlbGYuZXhwcikKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBpZiBzZWxmLmV4cHIuY2FuX3BhcnNlX25leHQoaW5zdHJpbmcsIGxvYyk6CiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKGluc3RyaW5nLCBsb2MsIHNlbGYuZXJybXNnLCBzZWxmKQogICAgICAgIHJldHVybiBsb2MsIFtdCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBcIn57XCIgKyBzdHIoc2VsZi5leHByKSArIFwifVwiCgoKY2xhc3MgX011bHRpcGxlTWF0Y2goUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBleHByOiBQYXJzZXJFbGVtZW50LAogICAgICAgIHN0b3Bfb246IHR5cGluZy5PcHRpb25hbFtVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdXSA9IE5vbmUsCiAgICAgICAgKiwKICAgICAgICBzdG9wT246IHR5cGluZy5PcHRpb25hbFtVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdXSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwcikKICAgICAgICBzdG9wT24gPSBzdG9wT24gb3Igc3RvcF9vbgogICAgICAgIHNlbGYuc2F2ZUFzTGlzdCA9IFRydWUKICAgICAgICBlbmRlciA9IHN0b3BPbgogICAgICAgIGlmIGlzaW5zdGFuY2UoZW5kZXIsIHN0cl90eXBlKToKICAgICAgICAgICAgZW5kZXIgPSBzZWxmLl9saXRlcmFsU3RyaW5nQ2xhc3MoZW5kZXIpCiAgICAgICAgc2VsZi5zdG9wT24oZW5kZXIpCgogICAgZGVmIHN0b3BPbihzZWxmLCBlbmRlcikgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBpZiBpc2luc3RhbmNlKGVuZGVyLCBzdHJfdHlwZSk6CiAgICAgICAgICAgIGVuZGVyID0gc2VsZi5fbGl0ZXJhbFN0cmluZ0NsYXNzKGVuZGVyKQogICAgICAgIHNlbGYubm90X2VuZGVyID0gfmVuZGVyIGlmIGVuZGVyIGlzIG5vdCBOb25lIGVsc2UgTm9uZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgc2VsZl9leHByX3BhcnNlID0gc2VsZi5leHByLl9wYXJzZQogICAgICAgIHNlbGZfc2tpcF9pZ25vcmFibGVzID0gc2VsZi5fc2tpcElnbm9yYWJsZXMKICAgICAgICBjaGVja19lbmRlciA9IHNlbGYubm90X2VuZGVyIGlzIG5vdCBOb25lCiAgICAgICAgaWYgY2hlY2tfZW5kZXI6CiAgICAgICAgICAgIHRyeV9ub3RfZW5kZXIgPSBzZWxmLm5vdF9lbmRlci50cnlQYXJzZQoKICAgICAgICAjIG11c3QgYmUgYXQgbGVhc3Qgb25lIChidXQgZmlyc3Qgc2VlIGlmIHdlIGFyZSB0aGUgc3RvcE9uIHNlbnRpbmVsOwogICAgICAgICMgaWYgc28sIGZhaWwpCiAgICAgICAgaWYgY2hlY2tfZW5kZXI6CiAgICAgICAgICAgIHRyeV9ub3RfZW5kZXIoaW5zdHJpbmcsIGxvYykKICAgICAgICBsb2MsIHRva2VucyA9IHNlbGZfZXhwcl9wYXJzZShpbnN0cmluZywgbG9jLCBkb0FjdGlvbnMpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoYXNJZ25vcmVFeHBycyA9IG5vdCBub3Qgc2VsZi5pZ25vcmVFeHBycwogICAgICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICAgICAgaWYgY2hlY2tfZW5kZXI6CiAgICAgICAgICAgICAgICAgICAgdHJ5X25vdF9lbmRlcihpbnN0cmluZywgbG9jKQogICAgICAgICAgICAgICAgaWYgaGFzSWdub3JlRXhwcnM6CiAgICAgICAgICAgICAgICAgICAgcHJlbG9jID0gc2VsZl9za2lwX2lnbm9yYWJsZXMoaW5zdHJpbmcsIGxvYykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJlbG9jID0gbG9jCiAgICAgICAgICAgICAgICBsb2MsIHRtcHRva2VucyA9IHNlbGZfZXhwcl9wYXJzZShpbnN0cmluZywgcHJlbG9jLCBkb0FjdGlvbnMpCiAgICAgICAgICAgICAgICBpZiB0bXB0b2tlbnMgb3IgdG1wdG9rZW5zLmhhc2tleXMoKToKICAgICAgICAgICAgICAgICAgICB0b2tlbnMgKz0gdG1wdG9rZW5zCiAgICAgICAgZXhjZXB0IChQYXJzZUV4Y2VwdGlvbiwgSW5kZXhFcnJvcik6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmV0dXJuIGxvYywgdG9rZW5zCgogICAgZGVmIF9zZXRSZXN1bHRzTmFtZShzZWxmLCBuYW1lLCBsaXN0QWxsTWF0Y2hlcz1GYWxzZSk6CiAgICAgICAgaWYgKAogICAgICAgICAgICBfX2RpYWdfXy53YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbgogICAgICAgICAgICBhbmQgRGlhZ25vc3RpY3Mud2Fybl91bmdyb3VwZWRfbmFtZWRfdG9rZW5zX2luX2NvbGxlY3Rpb24KICAgICAgICAgICAgbm90IGluIHNlbGYuc3VwcHJlc3Nfd2FybmluZ3NfCiAgICAgICAgKToKICAgICAgICAgICAgZm9yIGUgaW4gW3NlbGYuZXhwcl0gKyBzZWxmLmV4cHIucmVjdXJzZSgpOgogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoZSwgUGFyc2VyRWxlbWVudCkKICAgICAgICAgICAgICAgICAgICBhbmQgZS5yZXN1bHRzTmFtZQogICAgICAgICAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbgogICAgICAgICAgICAgICAgICAgIG5vdCBpbiBlLnN1cHByZXNzX3dhcm5pbmdzXwogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgICAgICAgICBcInt9OiBzZXR0aW5nIHJlc3VsdHMgbmFtZSB7IXJ9IG9uIHt9IGV4cHJlc3Npb24gXCIKICAgICAgICAgICAgICAgICAgICAgICAgXCJjb2xsaWRlcyB3aXRoIHshcn0gb24gY29udGFpbmVkIGV4cHJlc3Npb25cIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhcm5fdW5ncm91cGVkX25hbWVkX3Rva2Vuc19pbl9jb2xsZWN0aW9uXCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZShzZWxmKS5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucmVzdWx0c05hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrbGV2ZWw9MywKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgIHJldHVybiBzdXBlcigpLl9zZXRSZXN1bHRzTmFtZShuYW1lLCBsaXN0QWxsTWF0Y2hlcykKCgpjbGFzcyBPbmVPck1vcmUoX011bHRpcGxlTWF0Y2gpOgogICAgXCJcIlwiCiAgICBSZXBldGl0aW9uIG9mIG9uZSBvciBtb3JlIG9mIHRoZSBnaXZlbiBleHByZXNzaW9uLgoKICAgIFBhcmFtZXRlcnM6CiAgICAtIGV4cHIgLSBleHByZXNzaW9uIHRoYXQgbXVzdCBtYXRjaCBvbmUgb3IgbW9yZSB0aW1lcwogICAgLSBzdG9wX29uIC0gKGRlZmF1bHQ9IGBgTm9uZWBgKSAtIGV4cHJlc3Npb24gZm9yIGEgdGVybWluYXRpbmcgc2VudGluZWwKICAgICAgICAgKG9ubHkgcmVxdWlyZWQgaWYgdGhlIHNlbnRpbmVsIHdvdWxkIG9yZGluYXJpbHkgbWF0Y2ggdGhlIHJlcGV0aXRpb24KICAgICAgICAgZXhwcmVzc2lvbikKCiAgICBFeGFtcGxlOjoKCiAgICAgICAgZGF0YV93b3JkID0gV29yZChhbHBoYXMpCiAgICAgICAgbGFiZWwgPSBkYXRhX3dvcmQgKyBGb2xsb3dlZEJ5KCc6JykKICAgICAgICBhdHRyX2V4cHIgPSBHcm91cChsYWJlbCArIFN1cHByZXNzKCc6JykgKyBPbmVPck1vcmUoZGF0YV93b3JkKS5zZXRfcGFyc2VfYWN0aW9uKCcgJy5qb2luKSkKCiAgICAgICAgdGV4dCA9IFwic2hhcGU6IFNRVUFSRSBwb3NuOiB1cHBlciBsZWZ0IGNvbG9yOiBCTEFDS1wiCiAgICAgICAgYXR0cl9leHByWzEsIC4uLl0ucGFyc2Vfc3RyaW5nKHRleHQpLnBwcmludCgpICAjIEZhaWwhIHJlYWQgJ2NvbG9yJyBhcyBkYXRhIGluc3RlYWQgb2YgbmV4dCBsYWJlbCAtPiBbWydzaGFwZScsICdTUVVBUkUgY29sb3InXV0KCiAgICAgICAgIyB1c2Ugc3RvcF9vbiBhdHRyaWJ1dGUgZm9yIE9uZU9yTW9yZSB0byBhdm9pZCByZWFkaW5nIGxhYmVsIHN0cmluZyBhcyBwYXJ0IG9mIHRoZSBkYXRhCiAgICAgICAgYXR0cl9leHByID0gR3JvdXAobGFiZWwgKyBTdXBwcmVzcygnOicpICsgT25lT3JNb3JlKGRhdGFfd29yZCwgc3RvcF9vbj1sYWJlbCkuc2V0X3BhcnNlX2FjdGlvbignICcuam9pbikpCiAgICAgICAgT25lT3JNb3JlKGF0dHJfZXhwcikucGFyc2Vfc3RyaW5nKHRleHQpLnBwcmludCgpICMgQmV0dGVyIC0+IFtbJ3NoYXBlJywgJ1NRVUFSRSddLCBbJ3Bvc24nLCAndXBwZXIgbGVmdCddLCBbJ2NvbG9yJywgJ0JMQUNLJ11dCgogICAgICAgICMgY291bGQgYWxzbyBiZSB3cml0dGVuIGFzCiAgICAgICAgKGF0dHJfZXhwciAqICgxLCkpLnBhcnNlX3N0cmluZyh0ZXh0KS5wcHJpbnQoKQogICAgXCJcIlwiCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBcIntcIiArIHN0cihzZWxmLmV4cHIpICsgXCJ9Li4uXCIKCgpjbGFzcyBaZXJvT3JNb3JlKF9NdWx0aXBsZU1hdGNoKToKICAgIFwiXCJcIgogICAgT3B0aW9uYWwgcmVwZXRpdGlvbiBvZiB6ZXJvIG9yIG1vcmUgb2YgdGhlIGdpdmVuIGV4cHJlc3Npb24uCgogICAgUGFyYW1ldGVyczoKICAgIC0gYGBleHByYGAgLSBleHByZXNzaW9uIHRoYXQgbXVzdCBtYXRjaCB6ZXJvIG9yIG1vcmUgdGltZXMKICAgIC0gYGBzdG9wX29uYGAgLSBleHByZXNzaW9uIGZvciBhIHRlcm1pbmF0aW5nIHNlbnRpbmVsCiAgICAgIChvbmx5IHJlcXVpcmVkIGlmIHRoZSBzZW50aW5lbCB3b3VsZCBvcmRpbmFyaWx5IG1hdGNoIHRoZSByZXBldGl0aW9uCiAgICAgIGV4cHJlc3Npb24pIC0gKGRlZmF1bHQ9IGBgTm9uZWBgKQoKICAgIEV4YW1wbGU6IHNpbWlsYXIgdG8gOmNsYXNzOmBPbmVPck1vcmVgCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBleHByOiBQYXJzZXJFbGVtZW50LAogICAgICAgIHN0b3Bfb246IHR5cGluZy5PcHRpb25hbFtVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdXSA9IE5vbmUsCiAgICAgICAgKiwKICAgICAgICBzdG9wT246IHR5cGluZy5PcHRpb25hbFtVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdXSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwciwgc3RvcE9uPXN0b3BPbiBvciBzdG9wX29uKQogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBUcnVlCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc3VwZXIoKS5wYXJzZUltcGwoaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zKQogICAgICAgIGV4Y2VwdCAoUGFyc2VFeGNlcHRpb24sIEluZGV4RXJyb3IpOgogICAgICAgICAgICByZXR1cm4gbG9jLCBQYXJzZVJlc3VsdHMoW10sIG5hbWU9c2VsZi5yZXN1bHRzTmFtZSkKCiAgICBkZWYgX2dlbmVyYXRlRGVmYXVsdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIFwiW1wiICsgc3RyKHNlbGYuZXhwcikgKyBcIl0uLi5cIgoKCmNsYXNzIF9OdWxsVG9rZW46CiAgICBkZWYgX19ib29sX18oc2VsZik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIFwiXCIKCgpjbGFzcyBPcHQoUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBcIlwiXCIKICAgIE9wdGlvbmFsIG1hdGNoaW5nIG9mIHRoZSBnaXZlbiBleHByZXNzaW9uLgoKICAgIFBhcmFtZXRlcnM6CiAgICAtIGBgZXhwcmBgIC0gZXhwcmVzc2lvbiB0aGF0IG11c3QgbWF0Y2ggemVybyBvciBtb3JlIHRpbWVzCiAgICAtIGBgZGVmYXVsdGBgIChvcHRpb25hbCkgLSB2YWx1ZSB0byBiZSByZXR1cm5lZCBpZiB0aGUgb3B0aW9uYWwgZXhwcmVzc2lvbiBpcyBub3QgZm91bmQuCgogICAgRXhhbXBsZTo6CgogICAgICAgICMgVVMgcG9zdGFsIGNvZGUgY2FuIGJlIGEgNS1kaWdpdCB6aXAsIHBsdXMgb3B0aW9uYWwgNC1kaWdpdCBxdWFsaWZpZXIKICAgICAgICB6aXAgPSBDb21iaW5lKFdvcmQobnVtcywgZXhhY3Q9NSkgKyBPcHQoJy0nICsgV29yZChudW1zLCBleGFjdD00KSkpCiAgICAgICAgemlwLnJ1bl90ZXN0cygnJycKICAgICAgICAgICAgIyB0cmFkaXRpb25hbCBaSVAgY29kZQogICAgICAgICAgICAxMjM0NQoKICAgICAgICAgICAgIyBaSVArNCBmb3JtCiAgICAgICAgICAgIDEyMTAxLTAwMDEKCiAgICAgICAgICAgICMgaW52YWxpZCBaSVAKICAgICAgICAgICAgOTg3NjUtCiAgICAgICAgICAgICcnJykKCiAgICBwcmludHM6OgoKICAgICAgICAjIHRyYWRpdGlvbmFsIFpJUCBjb2RlCiAgICAgICAgMTIzNDUKICAgICAgICBbJzEyMzQ1J10KCiAgICAgICAgIyBaSVArNCBmb3JtCiAgICAgICAgMTIxMDEtMDAwMQogICAgICAgIFsnMTIxMDEtMDAwMSddCgogICAgICAgICMgaW52YWxpZCBaSVAKICAgICAgICA5ODc2NS0KICAgICAgICAgICAgIF4KICAgICAgICBGQUlMOiBFeHBlY3RlZCBlbmQgb2YgdGV4dCAoYXQgY2hhciA1KSwgKGxpbmU6MSwgY29sOjYpCiAgICBcIlwiXCIKCiAgICBfX29wdGlvbmFsTm90TWF0Y2hlZCA9IF9OdWxsVG9rZW4oKQoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLCBleHByOiBVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdLCBkZWZhdWx0OiBBbnkgPSBfX29wdGlvbmFsTm90TWF0Y2hlZAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGV4cHIsIHNhdmVsaXN0PUZhbHNlKQogICAgICAgIHNlbGYuc2F2ZUFzTGlzdCA9IHNlbGYuZXhwci5zYXZlQXNMaXN0CiAgICAgICAgc2VsZi5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0CiAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IFRydWUKCiAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICBzZWxmX2V4cHIgPSBzZWxmLmV4cHIKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYywgdG9rZW5zID0gc2VsZl9leHByLl9wYXJzZShpbnN0cmluZywgbG9jLCBkb0FjdGlvbnMsIGNhbGxQcmVQYXJzZT1GYWxzZSkKICAgICAgICBleGNlcHQgKFBhcnNlRXhjZXB0aW9uLCBJbmRleEVycm9yKToKICAgICAgICAgICAgZGVmYXVsdF92YWx1ZSA9IHNlbGYuZGVmYXVsdFZhbHVlCiAgICAgICAgICAgIGlmIGRlZmF1bHRfdmFsdWUgaXMgbm90IHNlbGYuX19vcHRpb25hbE5vdE1hdGNoZWQ6CiAgICAgICAgICAgICAgICBpZiBzZWxmX2V4cHIucmVzdWx0c05hbWU6CiAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gUGFyc2VSZXN1bHRzKFtkZWZhdWx0X3ZhbHVlXSkKICAgICAgICAgICAgICAgICAgICB0b2tlbnNbc2VsZl9leHByLnJlc3VsdHNOYW1lXSA9IGRlZmF1bHRfdmFsdWUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gW2RlZmF1bHRfdmFsdWVdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0b2tlbnMgPSBbXQogICAgICAgIHJldHVybiBsb2MsIHRva2VucwoKICAgIGRlZiBfZ2VuZXJhdGVEZWZhdWx0TmFtZShzZWxmKToKICAgICAgICBpbm5lciA9IHN0cihzZWxmLmV4cHIpCiAgICAgICAgIyBzdHJpcCBvZmYgcmVkdW5kYW50IGlubmVyIHt9J3MKICAgICAgICB3aGlsZSBsZW4oaW5uZXIpID4gMSBhbmQgaW5uZXJbMCA6OiBsZW4oaW5uZXIpIC0gMV0gPT0gXCJ7fVwiOgogICAgICAgICAgICBpbm5lciA9IGlubmVyWzE6LTFdCiAgICAgICAgcmV0dXJuIFwiW1wiICsgaW5uZXIgKyBcIl1cIgoKCk9wdGlvbmFsID0gT3B0CgoKY2xhc3MgU2tpcFRvKFBhcnNlRWxlbWVudEVuaGFuY2UpOgogICAgXCJcIlwiCiAgICBUb2tlbiBmb3Igc2tpcHBpbmcgb3ZlciBhbGwgdW5kZWZpbmVkIHRleHQgdW50aWwgdGhlIG1hdGNoZWQKICAgIGV4cHJlc3Npb24gaXMgZm91bmQuCgogICAgUGFyYW1ldGVyczoKICAgIC0gYGBleHByYGAgLSB0YXJnZXQgZXhwcmVzc2lvbiBtYXJraW5nIHRoZSBlbmQgb2YgdGhlIGRhdGEgdG8gYmUgc2tpcHBlZAogICAgLSBgYGluY2x1ZGVgYCAtIGlmIGBgVHJ1ZWBgLCB0aGUgdGFyZ2V0IGV4cHJlc3Npb24gaXMgYWxzbyBwYXJzZWQKICAgICAgKHRoZSBza2lwcGVkIHRleHQgYW5kIHRhcmdldCBleHByZXNzaW9uIGFyZSByZXR1cm5lZCBhcyBhIDItZWxlbWVudAogICAgICBsaXN0KSAoZGVmYXVsdD0gYGBGYWxzZWBgKS4KICAgIC0gYGBpZ25vcmVgYCAtIChkZWZhdWx0PSBgYE5vbmVgYCkgdXNlZCB0byBkZWZpbmUgZ3JhbW1hcnMgKHR5cGljYWxseSBxdW90ZWQgc3RyaW5ncyBhbmQKICAgICAgY29tbWVudHMpIHRoYXQgbWlnaHQgY29udGFpbiBmYWxzZSBtYXRjaGVzIHRvIHRoZSB0YXJnZXQgZXhwcmVzc2lvbgogICAgLSBgYGZhaWxfb25gYCAtIChkZWZhdWx0PSBgYE5vbmVgYCkgZGVmaW5lIGV4cHJlc3Npb25zIHRoYXQgYXJlIG5vdCBhbGxvd2VkIHRvIGJlCiAgICAgIGluY2x1ZGVkIGluIHRoZSBza2lwcGVkIHRlc3Q7IGlmIGZvdW5kIGJlZm9yZSB0aGUgdGFyZ2V0IGV4cHJlc3Npb24gaXMgZm91bmQsCiAgICAgIHRoZSA6Y2xhc3M6YFNraXBUb2AgaXMgbm90IGEgbWF0Y2gKCiAgICBFeGFtcGxlOjoKCiAgICAgICAgcmVwb3J0ID0gJycnCiAgICAgICAgICAgIE91dHN0YW5kaW5nIElzc3VlcyBSZXBvcnQgLSAxIEphbiAyMDAwCgogICAgICAgICAgICAgICAjIHwgU2V2ZXJpdHkgfCBEZXNjcmlwdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICBEYXlzIE9wZW4KICAgICAgICAgICAgLS0tLS0rLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tCiAgICAgICAgICAgICAxMDEgfCBDcml0aWNhbCB8IEludGVybWl0dGVudCBzeXN0ZW0gY3Jhc2ggICAgICAgICAgICAgICAgIHwgICAgICAgICAgNgogICAgICAgICAgICAgIDk0IHwgQ29zbWV0aWMgfCBTcGVsbGluZyBlcnJvciBvbiBMb2dpbiAoJ2xvZ3xuJykgICAgICAgICB8ICAgICAgICAgMTQKICAgICAgICAgICAgICA3OSB8IE1pbm9yICAgIHwgU3lzdGVtIHNsb3cgd2hlbiBydW5uaW5nIHRvbyBtYW55IHJlcG9ydHMgfCAgICAgICAgIDQ3CiAgICAgICAgICAgICcnJwogICAgICAgIGludGVnZXIgPSBXb3JkKG51bXMpCiAgICAgICAgU0VQID0gU3VwcHJlc3MoJ3wnKQogICAgICAgICMgdXNlIFNraXBUbyB0byBzaW1wbHkgbWF0Y2ggZXZlcnl0aGluZyB1cCB1bnRpbCB0aGUgbmV4dCBTRVAKICAgICAgICAjIC0gaWdub3JlIHF1b3RlZCBzdHJpbmdzLCBzbyB0aGF0IGEgJ3wnIGNoYXJhY3RlciBpbnNpZGUgYSBxdW90ZWQgc3RyaW5nIGRvZXMgbm90IG1hdGNoCiAgICAgICAgIyAtIHBhcnNlIGFjdGlvbiB3aWxsIGNhbGwgdG9rZW4uc3RyaXAoKSBmb3IgZWFjaCBtYXRjaGVkIHRva2VuLCBpLmUuLCB0aGUgZGVzY3JpcHRpb24gYm9keQogICAgICAgIHN0cmluZ19kYXRhID0gU2tpcFRvKFNFUCwgaWdub3JlPXF1b3RlZF9zdHJpbmcpCiAgICAgICAgc3RyaW5nX2RhdGEuc2V0X3BhcnNlX2FjdGlvbih0b2tlbl9tYXAoc3RyLnN0cmlwKSkKICAgICAgICB0aWNrZXRfZXhwciA9IChpbnRlZ2VyKFwiaXNzdWVfbnVtXCIpICsgU0VQCiAgICAgICAgICAgICAgICAgICAgICArIHN0cmluZ19kYXRhKFwic2V2XCIpICsgU0VQCiAgICAgICAgICAgICAgICAgICAgICArIHN0cmluZ19kYXRhKFwiZGVzY1wiKSArIFNFUAogICAgICAgICAgICAgICAgICAgICAgKyBpbnRlZ2VyKFwiZGF5c19vcGVuXCIpKQoKICAgICAgICBmb3IgdGt0IGluIHRpY2tldF9leHByLnNlYXJjaF9zdHJpbmcocmVwb3J0KToKICAgICAgICAgICAgcHJpbnQgdGt0LmR1bXAoKQoKICAgIHByaW50czo6CgogICAgICAgIFsnMTAxJywgJ0NyaXRpY2FsJywgJ0ludGVybWl0dGVudCBzeXN0ZW0gY3Jhc2gnLCAnNiddCiAgICAgICAgLSBkYXlzX29wZW46ICc2JwogICAgICAgIC0gZGVzYzogJ0ludGVybWl0dGVudCBzeXN0ZW0gY3Jhc2gnCiAgICAgICAgLSBpc3N1ZV9udW06ICcxMDEnCiAgICAgICAgLSBzZXY6ICdDcml0aWNhbCcKICAgICAgICBbJzk0JywgJ0Nvc21ldGljJywgXCJTcGVsbGluZyBlcnJvciBvbiBMb2dpbiAoJ2xvZ3xuJylcIiwgJzE0J10KICAgICAgICAtIGRheXNfb3BlbjogJzE0JwogICAgICAgIC0gZGVzYzogXCJTcGVsbGluZyBlcnJvciBvbiBMb2dpbiAoJ2xvZ3xuJylcIgogICAgICAgIC0gaXNzdWVfbnVtOiAnOTQnCiAgICAgICAgLSBzZXY6ICdDb3NtZXRpYycKICAgICAgICBbJzc5JywgJ01pbm9yJywgJ1N5c3RlbSBzbG93IHdoZW4gcnVubmluZyB0b28gbWFueSByZXBvcnRzJywgJzQ3J10KICAgICAgICAtIGRheXNfb3BlbjogJzQ3JwogICAgICAgIC0gZGVzYzogJ1N5c3RlbSBzbG93IHdoZW4gcnVubmluZyB0b28gbWFueSByZXBvcnRzJwogICAgICAgIC0gaXNzdWVfbnVtOiAnNzknCiAgICAgICAgLSBzZXY6ICdNaW5vcicKICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIG90aGVyOiBVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdLAogICAgICAgIGluY2x1ZGU6IGJvb2wgPSBGYWxzZSwKICAgICAgICBpZ25vcmU6IGJvb2wgPSBOb25lLAogICAgICAgIGZhaWxfb246IHR5cGluZy5PcHRpb25hbFtVbmlvbltQYXJzZXJFbGVtZW50LCBzdHJdXSA9IE5vbmUsCiAgICAgICAgKiwKICAgICAgICBmYWlsT246IFVuaW9uW1BhcnNlckVsZW1lbnQsIHN0cl0gPSBOb25lLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKG90aGVyKQogICAgICAgIGZhaWxPbiA9IGZhaWxPbiBvciBmYWlsX29uCiAgICAgICAgc2VsZi5pZ25vcmVFeHByID0gaWdub3JlCiAgICAgICAgc2VsZi5tYXlSZXR1cm5FbXB0eSA9IFRydWUKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBGYWxzZQogICAgICAgIHNlbGYuaW5jbHVkZU1hdGNoID0gaW5jbHVkZQogICAgICAgIHNlbGYuc2F2ZUFzTGlzdCA9IEZhbHNlCiAgICAgICAgaWYgaXNpbnN0YW5jZShmYWlsT24sIHN0cl90eXBlKToKICAgICAgICAgICAgc2VsZi5mYWlsT24gPSBzZWxmLl9saXRlcmFsU3RyaW5nQ2xhc3MoZmFpbE9uKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbE9uID0gZmFpbE9uCiAgICAgICAgc2VsZi5lcnJtc2cgPSBcIk5vIG1hdGNoIGZvdW5kIGZvciBcIiArIHN0cihzZWxmLmV4cHIpCgogICAgZGVmIHBhcnNlSW1wbChzZWxmLCBpbnN0cmluZywgbG9jLCBkb0FjdGlvbnM9VHJ1ZSk6CiAgICAgICAgc3RhcnRsb2MgPSBsb2MKICAgICAgICBpbnN0cmxlbiA9IGxlbihpbnN0cmluZykKICAgICAgICBzZWxmX2V4cHJfcGFyc2UgPSBzZWxmLmV4cHIuX3BhcnNlCiAgICAgICAgc2VsZl9mYWlsT25fY2FuUGFyc2VOZXh0ID0gKAogICAgICAgICAgICBzZWxmLmZhaWxPbi5jYW5QYXJzZU5leHQgaWYgc2VsZi5mYWlsT24gaXMgbm90IE5vbmUgZWxzZSBOb25lCiAgICAgICAgKQogICAgICAgIHNlbGZfaWdub3JlRXhwcl90cnlQYXJzZSA9ICgKICAgICAgICAgICAgc2VsZi5pZ25vcmVFeHByLnRyeVBhcnNlIGlmIHNlbGYuaWdub3JlRXhwciBpcyBub3QgTm9uZSBlbHNlIE5vbmUKICAgICAgICApCgogICAgICAgIHRtcGxvYyA9IGxvYwogICAgICAgIHdoaWxlIHRtcGxvYyA8PSBpbnN0cmxlbjoKICAgICAgICAgICAgaWYgc2VsZl9mYWlsT25fY2FuUGFyc2VOZXh0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgIyBicmVhayBpZiBmYWlsT24gZXhwcmVzc2lvbiBtYXRjaGVzCiAgICAgICAgICAgICAgICBpZiBzZWxmX2ZhaWxPbl9jYW5QYXJzZU5leHQoaW5zdHJpbmcsIHRtcGxvYyk6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgIGlmIHNlbGZfaWdub3JlRXhwcl90cnlQYXJzZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICMgYWR2YW5jZSBwYXN0IGlnbm9yZSBleHByZXNzaW9ucwogICAgICAgICAgICAgICAgd2hpbGUgMToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcGxvYyA9IHNlbGZfaWdub3JlRXhwcl90cnlQYXJzZShpbnN0cmluZywgdG1wbG9jKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBQYXJzZUJhc2VFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmX2V4cHJfcGFyc2UoaW5zdHJpbmcsIHRtcGxvYywgZG9BY3Rpb25zPUZhbHNlLCBjYWxsUHJlUGFyc2U9RmFsc2UpCiAgICAgICAgICAgIGV4Y2VwdCAoUGFyc2VFeGNlcHRpb24sIEluZGV4RXJyb3IpOgogICAgICAgICAgICAgICAgIyBubyBtYXRjaCwgYWR2YW5jZSBsb2MgaW4gc3RyaW5nCiAgICAgICAgICAgICAgICB0bXBsb2MgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBtYXRjaGVkIHNraXB0byBleHByLCBkb25lCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIHJhbiBvZmYgdGhlIGVuZCBvZiB0aGUgaW5wdXQgc3RyaW5nIHdpdGhvdXQgbWF0Y2hpbmcgc2tpcHRvIGV4cHIsIGZhaWwKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oaW5zdHJpbmcsIGxvYywgc2VsZi5lcnJtc2csIHNlbGYpCgogICAgICAgICMgYnVpbGQgdXAgcmV0dXJuIHZhbHVlcwogICAgICAgIGxvYyA9IHRtcGxvYwogICAgICAgIHNraXB0ZXh0ID0gaW5zdHJpbmdbc3RhcnRsb2M6bG9jXQogICAgICAgIHNraXByZXN1bHQgPSBQYXJzZVJlc3VsdHMoc2tpcHRleHQpCgogICAgICAgIGlmIHNlbGYuaW5jbHVkZU1hdGNoOgogICAgICAgICAgICBsb2MsIG1hdCA9IHNlbGZfZXhwcl9wYXJzZShpbnN0cmluZywgbG9jLCBkb0FjdGlvbnMsIGNhbGxQcmVQYXJzZT1GYWxzZSkKICAgICAgICAgICAgc2tpcHJlc3VsdCArPSBtYXQKCiAgICAgICAgcmV0dXJuIGxvYywgc2tpcHJlc3VsdAoKCmNsYXNzIEZvcndhcmQoUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBcIlwiXCIKICAgIEZvcndhcmQgZGVjbGFyYXRpb24gb2YgYW4gZXhwcmVzc2lvbiB0byBiZSBkZWZpbmVkIGxhdGVyIC0KICAgIHVzZWQgZm9yIHJlY3Vyc2l2ZSBncmFtbWFycywgc3VjaCBhcyBhbGdlYnJhaWMgaW5maXggbm90YXRpb24uCiAgICBXaGVuIHRoZSBleHByZXNzaW9uIGlzIGtub3duLCBpdCBpcyBhc3NpZ25lZCB0byB0aGUgYGBGb3J3YXJkYGAKICAgIHZhcmlhYmxlIHVzaW5nIHRoZSBgYCc8PCdgYCBvcGVyYXRvci4KCiAgICBOb3RlOiB0YWtlIGNhcmUgd2hlbiBhc3NpZ25pbmcgdG8gYGBGb3J3YXJkYGAgbm90IHRvIG92ZXJsb29rCiAgICBwcmVjZWRlbmNlIG9mIG9wZXJhdG9ycy4KCiAgICBTcGVjaWZpY2FsbHksIGBgJ3wnYGAgaGFzIGEgbG93ZXIgcHJlY2VkZW5jZSB0aGFuIGBgJzw8J2BgLCBzbyB0aGF0OjoKCiAgICAgICAgZndkX2V4cHIgPDwgYSB8IGIgfCBjCgogICAgd2lsbCBhY3R1YWxseSBiZSBldmFsdWF0ZWQgYXM6OgoKICAgICAgICAoZndkX2V4cHIgPDwgYSkgfCBiIHwgYwoKICAgIHRoZXJlYnkgbGVhdmluZyBiIGFuZCBjIG91dCBhcyBwYXJzZWFibGUgYWx0ZXJuYXRpdmVzLiAgSXQgaXMgcmVjb21tZW5kZWQgdGhhdCB5b3UKICAgIGV4cGxpY2l0bHkgZ3JvdXAgdGhlIHZhbHVlcyBpbnNlcnRlZCBpbnRvIHRoZSBgYEZvcndhcmRgYDo6CgogICAgICAgIGZ3ZF9leHByIDw8IChhIHwgYiB8IGMpCgogICAgQ29udmVydGluZyB0byB1c2UgdGhlIGBgJzw8PSdgYCBvcGVyYXRvciBpbnN0ZWFkIHdpbGwgYXZvaWQgdGhpcyBwcm9ibGVtLgoKICAgIFNlZSA6Y2xhc3M6YFBhcnNlUmVzdWx0cy5wcHJpbnRgIGZvciBhbiBleGFtcGxlIG9mIGEgcmVjdXJzaXZlCiAgICBwYXJzZXIgY3JlYXRlZCB1c2luZyBgYEZvcndhcmRgYC4KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvdGhlcjogdHlwaW5nLk9wdGlvbmFsW1VuaW9uW1BhcnNlckVsZW1lbnQsIHN0cl1dID0gTm9uZSk6CiAgICAgICAgc2VsZi5jYWxsZXJfZnJhbWUgPSB0cmFjZWJhY2suZXh0cmFjdF9zdGFjayhsaW1pdD0yKVswXQogICAgICAgIHN1cGVyKCkuX19pbml0X18ob3RoZXIsIHNhdmVsaXN0PUZhbHNlKQogICAgICAgIHNlbGYubHNoaWZ0X2xpbmUgPSBOb25lCgogICAgZGVmIF9fbHNoaWZ0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgXCJjYWxsZXJfZnJhbWVcIik6CiAgICAgICAgICAgIGRlbCBzZWxmLmNhbGxlcl9mcmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHN0cl90eXBlKToKICAgICAgICAgICAgb3RoZXIgPSBzZWxmLl9saXRlcmFsU3RyaW5nQ2xhc3Mob3RoZXIpCiAgICAgICAgc2VsZi5leHByID0gb3RoZXIKICAgICAgICBzZWxmLm1heUluZGV4RXJyb3IgPSBzZWxmLmV4cHIubWF5SW5kZXhFcnJvcgogICAgICAgIHNlbGYubWF5UmV0dXJuRW1wdHkgPSBzZWxmLmV4cHIubWF5UmV0dXJuRW1wdHkKICAgICAgICBzZWxmLnNldF93aGl0ZXNwYWNlX2NoYXJzKAogICAgICAgICAgICBzZWxmLmV4cHIud2hpdGVDaGFycywgY29weV9kZWZhdWx0cz1zZWxmLmV4cHIuY29weURlZmF1bHRXaGl0ZUNoYXJzCiAgICAgICAgKQogICAgICAgIHNlbGYuc2tpcFdoaXRlc3BhY2UgPSBzZWxmLmV4cHIuc2tpcFdoaXRlc3BhY2UKICAgICAgICBzZWxmLnNhdmVBc0xpc3QgPSBzZWxmLmV4cHIuc2F2ZUFzTGlzdAogICAgICAgIHNlbGYuaWdub3JlRXhwcnMuZXh0ZW5kKHNlbGYuZXhwci5pZ25vcmVFeHBycykKICAgICAgICBzZWxmLmxzaGlmdF9saW5lID0gdHJhY2ViYWNrLmV4dHJhY3Rfc3RhY2sobGltaXQ9MilbLTJdCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19pbHNoaWZ0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBzZWxmIDw8IG90aGVyCgogICAgZGVmIF9fb3JfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgY2FsbGVyX2xpbmUgPSB0cmFjZWJhY2suZXh0cmFjdF9zdGFjayhsaW1pdD0yKVstMl0KICAgICAgICBpZiAoCiAgICAgICAgICAgIF9fZGlhZ19fLndhcm5fb25fbWF0Y2hfZmlyc3Rfd2l0aF9sc2hpZnRfb3BlcmF0b3IKICAgICAgICAgICAgYW5kIGNhbGxlcl9saW5lID09IHNlbGYubHNoaWZ0X2xpbmUKICAgICAgICAgICAgYW5kIERpYWdub3N0aWNzLndhcm5fb25fbWF0Y2hfZmlyc3Rfd2l0aF9sc2hpZnRfb3BlcmF0b3IKICAgICAgICAgICAgbm90IGluIHNlbGYuc3VwcHJlc3Nfd2FybmluZ3NfCiAgICAgICAgKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigKICAgICAgICAgICAgICAgIFwidXNpbmcgJzw8JyBvcGVyYXRvciB3aXRoICd8JyBpcyBwcm9iYWJseSBhbiBlcnJvciwgdXNlICc8PD0nXCIsCiAgICAgICAgICAgICAgICBzdGFja2xldmVsPTIsCiAgICAgICAgICAgICkKICAgICAgICByZXQgPSBzdXBlcigpLl9fb3JfXyhvdGhlcikKICAgICAgICByZXR1cm4gcmV0CgogICAgZGVmIF9fZGVsX18oc2VsZik6CiAgICAgICAgIyBzZWUgaWYgd2UgYXJlIGdldHRpbmcgZHJvcHBlZCBiZWNhdXNlIG9mICc9JyByZWFzc2lnbm1lbnQgb2YgdmFyIGluc3RlYWQgb2YgJzw8PScgb3IgJzw8JwogICAgICAgIGlmICgKICAgICAgICAgICAgc2VsZi5leHByIGlzIE5vbmUKICAgICAgICAgICAgYW5kIF9fZGlhZ19fLndhcm5fb25fYXNzaWdubWVudF90b19Gb3J3YXJkCiAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX29uX2Fzc2lnbm1lbnRfdG9fRm9yd2FyZCBub3QgaW4gc2VsZi5zdXBwcmVzc193YXJuaW5nc18KICAgICAgICApOgogICAgICAgICAgICB3YXJuaW5ncy53YXJuX2V4cGxpY2l0KAogICAgICAgICAgICAgICAgXCJGb3J3YXJkIGRlZmluZWQgaGVyZSBidXQgbm8gZXhwcmVzc2lvbiBhdHRhY2hlZCBsYXRlciB1c2luZyAnPDw9JyBvciAnPDwnXCIsCiAgICAgICAgICAgICAgICBVc2VyV2FybmluZywKICAgICAgICAgICAgICAgIGZpbGVuYW1lPXNlbGYuY2FsbGVyX2ZyYW1lLmZpbGVuYW1lLAogICAgICAgICAgICAgICAgbGluZW5vPXNlbGYuY2FsbGVyX2ZyYW1lLmxpbmVubywKICAgICAgICAgICAgKQoKICAgIGRlZiBwYXJzZUltcGwoc2VsZiwgaW5zdHJpbmcsIGxvYywgZG9BY3Rpb25zPVRydWUpOgogICAgICAgIGlmICgKICAgICAgICAgICAgc2VsZi5leHByIGlzIE5vbmUKICAgICAgICAgICAgYW5kIF9fZGlhZ19fLndhcm5fb25fcGFyc2VfdXNpbmdfZW1wdHlfRm9yd2FyZAogICAgICAgICAgICBhbmQgRGlhZ25vc3RpY3Mud2Fybl9vbl9wYXJzZV91c2luZ19lbXB0eV9Gb3J3YXJkCiAgICAgICAgICAgIG5vdCBpbiBzZWxmLnN1cHByZXNzX3dhcm5pbmdzXwogICAgICAgICk6CiAgICAgICAgICAgICMgd2FsayBzdGFjayB1bnRpbCBwYXJzZV9zdHJpbmcsIHNjYW5fc3RyaW5nLCBzZWFyY2hfc3RyaW5nLCBvciB0cmFuc2Zvcm1fc3RyaW5nIGlzIGZvdW5kCiAgICAgICAgICAgIHBhcnNlX2ZucyA9IFsKICAgICAgICAgICAgICAgIFwicGFyc2Vfc3RyaW5nXCIsCiAgICAgICAgICAgICAgICBcInNjYW5fc3RyaW5nXCIsCiAgICAgICAgICAgICAgICBcInNlYXJjaF9zdHJpbmdcIiwKICAgICAgICAgICAgICAgIFwidHJhbnNmb3JtX3N0cmluZ1wiLAogICAgICAgICAgICBdCiAgICAgICAgICAgIHRiID0gdHJhY2ViYWNrLmV4dHJhY3Rfc3RhY2sobGltaXQ9MjAwKQogICAgICAgICAgICBmb3IgaSwgZnJtIGluIGVudW1lcmF0ZShyZXZlcnNlZCh0YiksIHN0YXJ0PTEpOgogICAgICAgICAgICAgICAgaWYgZnJtLm5hbWUgaW4gcGFyc2VfZm5zOgogICAgICAgICAgICAgICAgICAgIHN0YWNrbGV2ZWwgPSBpICsgMQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzdGFja2xldmVsID0gMgogICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgXCJGb3J3YXJkIGV4cHJlc3Npb24gd2FzIG5ldmVyIGFzc2lnbmVkIGEgdmFsdWUsIHdpbGwgbm90IHBhcnNlIGFueSBpbnB1dFwiLAogICAgICAgICAgICAgICAgc3RhY2tsZXZlbD1zdGFja2xldmVsLAogICAgICAgICAgICApCiAgICAgICAgaWYgbm90IFBhcnNlckVsZW1lbnQuX2xlZnRfcmVjdXJzaW9uX2VuYWJsZWQ6CiAgICAgICAgICAgIHJldHVybiBzdXBlcigpLnBhcnNlSW1wbChpbnN0cmluZywgbG9jLCBkb0FjdGlvbnMpCiAgICAgICAgIyAjIyBCb3VuZGVkIFJlY3Vyc2lvbiBhbGdvcml0aG0gIyMKICAgICAgICAjIFJlY3Vyc2lvbiBvbmx5IG5lZWRzIHRvIGJlIHByb2Nlc3NlZCBhdCBgYEZvcndhcmRgYCBlbGVtZW50cywgc2luY2UgdGhleSBhcmUKICAgICAgICAjIHRoZSBvbmx5IG9uZXMgdGhhdCBjYW4gYWN0dWFsbHkgcmVmZXIgdG8gdGhlbXNlbHZlcy4gVGhlIGdlbmVyYWwgaWRlYSBpcwogICAgICAgICMgdG8gaGFuZGxlIHJlY3Vyc2lvbiBzdGVwd2lzZTogV2Ugc3RhcnQgYXQgbm8gcmVjdXJzaW9uLCB0aGVuIHJlY3Vyc2Ugb25jZSwKICAgICAgICAjIHJlY3Vyc2UgdHdpY2UsIC4uLiwgdW50aWwgbW9yZSByZWN1cnNpb24gb2ZmZXJzIG5vIGJlbmVmaXQgKHdlIGhpdCB0aGUgYm91bmQpLgogICAgICAgICMKICAgICAgICAjIFRoZSBcInRyaWNrXCIgaGVyZSBpcyB0aGF0IGVhY2ggYGBGb3J3YXJkYGAgZ2V0cyBldmFsdWF0ZWQgaW4gdHdvIGNvbnRleHRzCiAgICAgICAgIyAtIHRvICptYXRjaCogYSBzcGVjaWZpYyByZWN1cnNpb24gbGV2ZWwsIGFuZAogICAgICAgICMgLSB0byAqc2VhcmNoKiB0aGUgYm91bmRlZCByZWN1cnNpb24gbGV2ZWwKICAgICAgICAjIGFuZCB0aGUgdHdvIHJ1biBjb25jdXJyZW50bHkuIFRoZSAqc2VhcmNoKiBtdXN0ICptYXRjaCogZWFjaCByZWN1cnNpb24gbGV2ZWwKICAgICAgICAjIHRvIGZpbmQgdGhlIGJlc3QgcG9zc2libGUgbWF0Y2guIFRoaXMgaXMgaGFuZGxlZCBieSBhIG1lbW8gdGFibGUsIHdoaWNoCiAgICAgICAgIyBwcm92aWRlcyB0aGUgcHJldmlvdXMgbWF0Y2ggdG8gdGhlIG5leHQgbGV2ZWwgbWF0Y2ggYXR0ZW1wdC4KICAgICAgICAjCiAgICAgICAgIyBTZWUgYWxzbyBcIkxlZnQgUmVjdXJzaW9uIGluIFBhcnNpbmcgRXhwcmVzc2lvbiBHcmFtbWFyc1wiLCBNZWRlaXJvcyBldCBhbC4KICAgICAgICAjCiAgICAgICAgIyBUaGVyZSBpcyBhIGNvbXBsaWNhdGlvbiBzaW5jZSB3ZSBub3Qgb25seSAqcGFyc2UqIGJ1dCBhbHNvICp0cmFuc2Zvcm0qIHZpYQogICAgICAgICMgYWN0aW9uczogV2UgZG8gbm90IHdhbnQgdG8gcnVuIHRoZSBhY3Rpb25zIHRvbyBvZnRlbiB3aGlsZSBleHBhbmRpbmcuIFRodXMsCiAgICAgICAgIyB3ZSBleHBhbmQgdXNpbmcgYGRvQWN0aW9ucz1GYWxzZWAgYW5kIG9ubHkgcnVuIGBkb0FjdGlvbnM9VHJ1ZWAgaWYgdGhlIG5leHQKICAgICAgICAjIHJlY3Vyc2lvbiBsZXZlbCBpcyBhY2NlcHRhYmxlLgogICAgICAgIHdpdGggUGFyc2VyRWxlbWVudC5yZWN1cnNpb25fbG9jazoKICAgICAgICAgICAgbWVtbyA9IFBhcnNlckVsZW1lbnQucmVjdXJzaW9uX21lbW9zCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICMgd2UgYXJlIHBhcnNpbmcgYXQgYSBzcGVjaWZpYyByZWN1cnNpb24gZXhwYW5zaW9uIC0gdXNlIGl0IGFzLWlzCiAgICAgICAgICAgICAgICBwcmV2X2xvYywgcHJldl9yZXN1bHQgPSBtZW1vW2xvYywgc2VsZiwgZG9BY3Rpb25zXQogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShwcmV2X3Jlc3VsdCwgRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgICAgICByYWlzZSBwcmV2X3Jlc3VsdAogICAgICAgICAgICAgICAgcmV0dXJuIHByZXZfbG9jLCBwcmV2X3Jlc3VsdC5jb3B5KCkKICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgYWN0X2tleSA9IChsb2MsIHNlbGYsIFRydWUpCiAgICAgICAgICAgICAgICBwZWVrX2tleSA9IChsb2MsIHNlbGYsIEZhbHNlKQogICAgICAgICAgICAgICAgIyB3ZSBhcmUgc2VhcmNoaW5nIGZvciB0aGUgYmVzdCByZWN1cnNpb24gZXhwYW5zaW9uIC0ga2VlcCBvbiBpbXByb3ZpbmcKICAgICAgICAgICAgICAgICMgYm90aCBgZG9BY3Rpb25zYCBjYXNlcyBtdXN0IGJlIHRyYWNrZWQgc2VwYXJhdGVseSBoZXJlIQogICAgICAgICAgICAgICAgcHJldl9sb2MsIHByZXZfcGVlayA9IG1lbW9bcGVla19rZXldID0gKAogICAgICAgICAgICAgICAgICAgIGxvYyAtIDEsCiAgICAgICAgICAgICAgICAgICAgUGFyc2VFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RyaW5nLCBsb2MsIFwiRm9yd2FyZCByZWN1cnNpb24gd2l0aG91dCBiYXNlIGNhc2VcIiwgc2VsZgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiBkb0FjdGlvbnM6CiAgICAgICAgICAgICAgICAgICAgbWVtb1thY3Rfa2V5XSA9IG1lbW9bcGVla19rZXldCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgbmV3X2xvYywgbmV3X3BlZWsgPSBzdXBlcigpLnBhcnNlSW1wbChpbnN0cmluZywgbG9jLCBGYWxzZSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgUGFyc2VFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgICAgICMgd2UgZmFpbGVkIGJlZm9yZSBnZXR0aW5nIGFueSBtYXRjaCDigJMgZG8gbm90IGhpZGUgdGhlIGVycm9yCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocHJldl9wZWVrLCBFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgICAgICAgICAgbmV3X2xvYywgbmV3X3BlZWsgPSBwcmV2X2xvYywgcHJldl9wZWVrCiAgICAgICAgICAgICAgICAgICAgIyB0aGUgbWF0Y2ggZGlkIG5vdCBnZXQgYmV0dGVyOiB3ZSBhcmUgZG9uZQogICAgICAgICAgICAgICAgICAgIGlmIG5ld19sb2MgPD0gcHJldl9sb2M6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRvQWN0aW9uczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgcmVwbGFjZSB0aGUgbWF0Y2ggZm9yIGRvQWN0aW9ucz1GYWxzZSBhcyB3ZWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBpbiBjYXNlIHRoZSBhY3Rpb24gZGlkIGJhY2t0cmFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldl9sb2MsIHByZXZfcmVzdWx0ID0gbWVtb1twZWVrX2tleV0gPSBtZW1vW2FjdF9rZXldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWwgbWVtb1twZWVrX2tleV0sIG1lbW9bYWN0X2tleV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmV2X2xvYywgcHJldl9yZXN1bHQuY29weSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbCBtZW1vW3BlZWtfa2V5XQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJldl9sb2MsIHByZXZfcGVlay5jb3B5KCkKICAgICAgICAgICAgICAgICAgICAjIHRoZSBtYXRjaCBkaWQgZ2V0IGJldHRlcjogc2VlIGlmIHdlIGNhbiBpbXByb3ZlIGZ1cnRoZXIKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBkb0FjdGlvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtb1thY3Rfa2V5XSA9IHN1cGVyKCkucGFyc2VJbXBsKGluc3RyaW5nLCBsb2MsIFRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgUGFyc2VFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vW3BlZWtfa2V5XSA9IG1lbW9bYWN0X2tleV0gPSAobmV3X2xvYywgZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICAgICAgICAgICAgICBwcmV2X2xvYywgcHJldl9wZWVrID0gbWVtb1twZWVrX2tleV0gPSBuZXdfbG9jLCBuZXdfcGVlawoKICAgIGRlZiBsZWF2ZV93aGl0ZXNwYWNlKHNlbGYsIHJlY3Vyc2l2ZTogYm9vbCA9IFRydWUpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgc2VsZi5za2lwV2hpdGVzcGFjZSA9IEZhbHNlCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgaWdub3JlX3doaXRlc3BhY2Uoc2VsZiwgcmVjdXJzaXZlOiBib29sID0gVHJ1ZSkgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gVHJ1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHN0cmVhbWxpbmUoc2VsZikgLT4gUGFyc2VyRWxlbWVudDoKICAgICAgICBpZiBub3Qgc2VsZi5zdHJlYW1saW5lZDoKICAgICAgICAgICAgc2VsZi5zdHJlYW1saW5lZCA9IFRydWUKICAgICAgICAgICAgaWYgc2VsZi5leHByIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5leHByLnN0cmVhbWxpbmUoKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHZhbGlkYXRlKHNlbGYsIHZhbGlkYXRlVHJhY2U9Tm9uZSkgLT4gTm9uZToKICAgICAgICBpZiB2YWxpZGF0ZVRyYWNlIGlzIE5vbmU6CiAgICAgICAgICAgIHZhbGlkYXRlVHJhY2UgPSBbXQoKICAgICAgICBpZiBzZWxmIG5vdCBpbiB2YWxpZGF0ZVRyYWNlOgogICAgICAgICAgICB0bXAgPSB2YWxpZGF0ZVRyYWNlWzpdICsgW3NlbGZdCiAgICAgICAgICAgIGlmIHNlbGYuZXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuZXhwci52YWxpZGF0ZSh0bXApCiAgICAgICAgc2VsZi5fY2hlY2tSZWN1cnNpb24oW10pCgogICAgZGVmIF9nZW5lcmF0ZURlZmF1bHROYW1lKHNlbGYpOgogICAgICAgICMgQXZvaWQgaW5maW5pdGUgcmVjdXJzaW9uIGJ5IHNldHRpbmcgYSB0ZW1wb3JhcnkgX2RlZmF1bHROYW1lCiAgICAgICAgc2VsZi5fZGVmYXVsdE5hbWUgPSBcIjogLi4uXCIKCiAgICAgICAgIyBVc2UgdGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBtYWluIGV4cHJlc3Npb24uCiAgICAgICAgcmV0U3RyaW5nID0gXCIuLi5cIgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgc2VsZi5leHByIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcmV0U3RyaW5nID0gc3RyKHNlbGYuZXhwcilbOjEwMDBdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXRTdHJpbmcgPSBcIk5vbmVcIgogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXy5fX25hbWVfXyArIFwiOiBcIiArIHJldFN0cmluZwoKICAgIGRlZiBjb3B5KHNlbGYpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgaWYgc2VsZi5leHByIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gc3VwZXIoKS5jb3B5KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXQgPSBGb3J3YXJkKCkKICAgICAgICAgICAgcmV0IDw8PSBzZWxmCiAgICAgICAgICAgIHJldHVybiByZXQKCiAgICBkZWYgX3NldFJlc3VsdHNOYW1lKHNlbGYsIG5hbWUsIGxpc3RfYWxsX21hdGNoZXM9RmFsc2UpOgogICAgICAgIGlmICgKICAgICAgICAgICAgX19kaWFnX18ud2Fybl9uYW1lX3NldF9vbl9lbXB0eV9Gb3J3YXJkCiAgICAgICAgICAgIGFuZCBEaWFnbm9zdGljcy53YXJuX25hbWVfc2V0X29uX2VtcHR5X0ZvcndhcmQKICAgICAgICAgICAgbm90IGluIHNlbGYuc3VwcHJlc3Nfd2FybmluZ3NfCiAgICAgICAgKToKICAgICAgICAgICAgaWYgc2VsZi5leHByIGlzIE5vbmU6CiAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgICAgIFwie306IHNldHRpbmcgcmVzdWx0cyBuYW1lIHshcn0gb24ge30gZXhwcmVzc2lvbiBcIgogICAgICAgICAgICAgICAgICAgIFwidGhhdCBoYXMgbm8gY29udGFpbmVkIGV4cHJlc3Npb25cIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgIFwid2Fybl9uYW1lX3NldF9vbl9lbXB0eV9Gb3J3YXJkXCIsIG5hbWUsIHR5cGUoc2VsZikuX19uYW1lX18KICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHN0YWNrbGV2ZWw9MywKICAgICAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHN1cGVyKCkuX3NldFJlc3VsdHNOYW1lKG5hbWUsIGxpc3RfYWxsX21hdGNoZXMpCgogICAgaWdub3JlV2hpdGVzcGFjZSA9IGlnbm9yZV93aGl0ZXNwYWNlCiAgICBsZWF2ZVdoaXRlc3BhY2UgPSBsZWF2ZV93aGl0ZXNwYWNlCgoKY2xhc3MgVG9rZW5Db252ZXJ0ZXIoUGFyc2VFbGVtZW50RW5oYW5jZSk6CiAgICBcIlwiXCIKICAgIEFic3RyYWN0IHN1YmNsYXNzIG9mIDpjbGFzczpgUGFyc2VFeHByZXNzaW9uYCwgZm9yIGNvbnZlcnRpbmcgcGFyc2VkIHJlc3VsdHMuCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwcjogVW5pb25bUGFyc2VyRWxlbWVudCwgc3RyXSwgc2F2ZWxpc3Q9RmFsc2UpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwcikgICMgLCBzYXZlbGlzdCkKICAgICAgICBzZWxmLnNhdmVBc0xpc3QgPSBGYWxzZQoKCmNsYXNzIENvbWJpbmUoVG9rZW5Db252ZXJ0ZXIpOgogICAgXCJcIlwiQ29udmVydGVyIHRvIGNvbmNhdGVuYXRlIGFsbCBtYXRjaGluZyB0b2tlbnMgdG8gYSBzaW5nbGUgc3RyaW5nLgogICAgQnkgZGVmYXVsdCwgdGhlIG1hdGNoaW5nIHBhdHRlcm5zIG11c3QgYWxzbyBiZSBjb250aWd1b3VzIGluIHRoZQogICAgaW5wdXQgc3RyaW5nOyB0aGlzIGNhbiBiZSBkaXNhYmxlZCBieSBzcGVjaWZ5aW5nCiAgICBgYCdhZGphY2VudD1GYWxzZSdgYCBpbiB0aGUgY29uc3RydWN0b3IuCgogICAgRXhhbXBsZTo6CgogICAgICAgIHJlYWwgPSBXb3JkKG51bXMpICsgJy4nICsgV29yZChudW1zKQogICAgICAgIHByaW50KHJlYWwucGFyc2Vfc3RyaW5nKCczLjE0MTYnKSkgIyAtPiBbJzMnLCAnLicsICcxNDE2J10KICAgICAgICAjIHdpbGwgYWxzbyBlcnJvbmVvdXNseSBtYXRjaCB0aGUgZm9sbG93aW5nCiAgICAgICAgcHJpbnQocmVhbC5wYXJzZV9zdHJpbmcoJzMuIDE0MTYnKSkgIyAtPiBbJzMnLCAnLicsICcxNDE2J10KCiAgICAgICAgcmVhbCA9IENvbWJpbmUoV29yZChudW1zKSArICcuJyArIFdvcmQobnVtcykpCiAgICAgICAgcHJpbnQocmVhbC5wYXJzZV9zdHJpbmcoJzMuMTQxNicpKSAjIC0+IFsnMy4xNDE2J10KICAgICAgICAjIG5vIG1hdGNoIHdoZW4gdGhlcmUgYXJlIGludGVybmFsIHNwYWNlcwogICAgICAgIHByaW50KHJlYWwucGFyc2Vfc3RyaW5nKCczLiAxNDE2JykpICMgLT4gRXhjZXB0aW9uOiBFeHBlY3RlZCBXOigwMTIzLi4uKQogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgZXhwcjogUGFyc2VyRWxlbWVudCwKICAgICAgICBqb2luX3N0cmluZzogc3RyID0gXCJcIiwKICAgICAgICBhZGphY2VudDogYm9vbCA9IFRydWUsCiAgICAgICAgKiwKICAgICAgICBqb2luU3RyaW5nOiB0eXBpbmcuT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICApOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwcikKICAgICAgICBqb2luU3RyaW5nID0gam9pblN0cmluZyBpZiBqb2luU3RyaW5nIGlzIG5vdCBOb25lIGVsc2Ugam9pbl9zdHJpbmcKICAgICAgICAjIHN1cHByZXNzIHdoaXRlc3BhY2Utc3RyaXBwaW5nIGluIGNvbnRhaW5lZCBwYXJzZSBleHByZXNzaW9ucywgYnV0IHJlLWVuYWJsZSBpdCBvbiB0aGUgQ29tYmluZSBpdHNlbGYKICAgICAgICBpZiBhZGphY2VudDoKICAgICAgICAgICAgc2VsZi5sZWF2ZV93aGl0ZXNwYWNlKCkKICAgICAgICBzZWxmLmFkamFjZW50ID0gYWRqYWNlbnQKICAgICAgICBzZWxmLnNraXBXaGl0ZXNwYWNlID0gVHJ1ZQogICAgICAgIHNlbGYuam9pblN0cmluZyA9IGpvaW5TdHJpbmcKICAgICAgICBzZWxmLmNhbGxQcmVwYXJzZSA9IFRydWUKCiAgICBkZWYgaWdub3JlKHNlbGYsIG90aGVyKSAtPiBQYXJzZXJFbGVtZW50OgogICAgICAgIGlmIHNlbGYuYWRqYWNlbnQ6CiAgICAgICAgICAgIFBhcnNlckVsZW1lbnQuaWdub3JlKHNlbGYsIG90aGVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN1cGVyKCkuaWdub3JlKG90aGVyKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHBvc3RQYXJzZShzZWxmLCBpbnN0cmluZywgbG9jLCB0b2tlbmxpc3QpOgogICAgICAgIHJldFRva3MgPSB0b2tlbmxpc3QuY29weSgpCiAgICAgICAgZGVsIHJldFRva3NbOl0KICAgICAgICByZXRUb2tzICs9IFBhcnNlUmVzdWx0cygKICAgICAgICAgICAgW1wiXCIuam9pbih0b2tlbmxpc3QuX2FzU3RyaW5nTGlzdChzZWxmLmpvaW5TdHJpbmcpKV0sIG1vZGFsPXNlbGYubW9kYWxSZXN1bHRzCiAgICAgICAgKQoKICAgICAgICBpZiBzZWxmLnJlc3VsdHNOYW1lIGFuZCByZXRUb2tzLmhhc2tleXMoKToKICAgICAgICAgICAgcmV0dXJuIFtyZXRUb2tzXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiByZXRUb2tzCgoKY2xhc3MgR3JvdXAoVG9rZW5Db252ZXJ0ZXIpOgogICAgXCJcIlwiQ29udmVydGVyIHRvIHJldHVybiB0aGUgbWF0Y2hlZCB0b2tlbnMgYXMgYSBsaXN0IC0gdXNlZnVsIGZvcgogICAgcmV0dXJuaW5nIHRva2VucyBvZiA6Y2xhc3M6YFplcm9Pck1vcmVgIGFuZCA6Y2xhc3M6YE9uZU9yTW9yZWAgZXhwcmVzc2lvbnMuCgogICAgVGhlIG9wdGlvbmFsIGBgYXNsaXN0YGAgYXJndW1lbnQgd2hlbiBzZXQgdG8gVHJ1ZSB3aWxsIHJldHVybiB0aGUKICAgIHBhcnNlZCB0b2tlbnMgYXMgYSBQeXRob24gbGlzdCBpbnN0ZWFkIG9mIGEgcHlwYXJzaW5nIFBhcnNlUmVzdWx0cy4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgaWRlbnQgPSBXb3JkKGFscGhhcykKICAgICAgICBudW0gPSBXb3JkKG51bXMpCiAgICAgICAgdGVybSA9IGlkZW50IHwgbnVtCiAgICAgICAgZnVuYyA9IGlkZW50ICsgT3B0KGRlbGltaXRlZF9saXN0KHRlcm0pKQogICAgICAgIHByaW50KGZ1bmMucGFyc2Vfc3RyaW5nKFwiZm4gYSwgYiwgMTAwXCIpKQogICAgICAgICMgLT4gWydmbicsICdhJywgJ2InLCAnMTAwJ10KCiAgICAgICAgZnVuYyA9IGlkZW50ICsgR3JvdXAoT3B0KGRlbGltaXRlZF9saXN0KHRlcm0pKSkKICAgICAgICBwcmludChmdW5jLnBhcnNlX3N0cmluZyhcImZuIGEsIGIsIDEwMFwiKSkKICAgICAgICAjIC0+IFsnZm4nLCBbJ2EnLCAnYicsICcxMDAnXV0KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBleHByOiBQYXJzZXJFbGVtZW50LCBhc2xpc3Q6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHByKQogICAgICAgIHNlbGYuc2F2ZUFzTGlzdCA9IFRydWUKICAgICAgICBzZWxmLl9hc1B5dGhvbkxpc3QgPSBhc2xpc3QKCiAgICBkZWYgcG9zdFBhcnNlKHNlbGYsIGluc3RyaW5nLCBsb2MsIHRva2VubGlzdCk6CiAgICAgICAgaWYgc2VsZi5fYXNQeXRob25MaXN0OgogICAgICAgICAgICByZXR1cm4gUGFyc2VSZXN1bHRzLkxpc3QoCiAgICAgICAgICAgICAgICB0b2tlbmxpc3QuYXNMaXN0KCkKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodG9rZW5saXN0LCBQYXJzZVJlc3VsdHMpCiAgICAgICAgICAgICAgICBlbHNlIGxpc3QodG9rZW5saXN0KQogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFt0b2tlbmxpc3RdCgoKY2xhc3MgRGljdChUb2tlbkNvbnZlcnRlcik6CiAgICBcIlwiXCJDb252ZXJ0ZXIgdG8gcmV0dXJuIGEgcmVwZXRpdGl2ZSBleHByZXNzaW9uIGFzIGEgbGlzdCwgYnV0IGFsc28KICAgIGFzIGEgZGljdGlvbmFyeS4gRWFjaCBlbGVtZW50IGNhbiBhbHNvIGJlIHJlZmVyZW5jZWQgdXNpbmcgdGhlIGZpcnN0CiAgICB0b2tlbiBpbiB0aGUgZXhwcmVzc2lvbiBhcyBpdHMga2V5LiBVc2VmdWwgZm9yIHRhYnVsYXIgcmVwb3J0CiAgICBzY3JhcGluZyB3aGVuIHRoZSBmaXJzdCBjb2x1bW4gY2FuIGJlIHVzZWQgYXMgYSBpdGVtIGtleS4KCiAgICBUaGUgb3B0aW9uYWwgYGBhc2RpY3RgYCBhcmd1bWVudCB3aGVuIHNldCB0byBUcnVlIHdpbGwgcmV0dXJuIHRoZQogICAgcGFyc2VkIHRva2VucyBhcyBhIFB5dGhvbiBkaWN0IGluc3RlYWQgb2YgYSBweXBhcnNpbmcgUGFyc2VSZXN1bHRzLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBkYXRhX3dvcmQgPSBXb3JkKGFscGhhcykKICAgICAgICBsYWJlbCA9IGRhdGFfd29yZCArIEZvbGxvd2VkQnkoJzonKQoKICAgICAgICB0ZXh0ID0gXCJzaGFwZTogU1FVQVJFIHBvc246IHVwcGVyIGxlZnQgY29sb3I6IGxpZ2h0IGJsdWUgdGV4dHVyZTogYnVybGFwXCIKICAgICAgICBhdHRyX2V4cHIgPSAobGFiZWwgKyBTdXBwcmVzcygnOicpICsgT25lT3JNb3JlKGRhdGFfd29yZCwgc3RvcF9vbj1sYWJlbCkuc2V0X3BhcnNlX2FjdGlvbignICcuam9pbikpCgogICAgICAgICMgcHJpbnQgYXR0cmlidXRlcyBhcyBwbGFpbiBncm91cHMKICAgICAgICBwcmludChhdHRyX2V4cHJbMSwgLi4uXS5wYXJzZV9zdHJpbmcodGV4dCkuZHVtcCgpKQoKICAgICAgICAjIGluc3RlYWQgb2YgT25lT3JNb3JlKGV4cHIpLCBwYXJzZSB1c2luZyBEaWN0KEdyb3VwKGV4cHIpWzEsIC4uLl0pIC0gRGljdCB3aWxsIGF1dG8tYXNzaWduIG5hbWVzCiAgICAgICAgcmVzdWx0ID0gRGljdChHcm91cChhdHRyX2V4cHIpWzEsIC4uLl0pLnBhcnNlX3N0cmluZyh0ZXh0KQogICAgICAgIHByaW50KHJlc3VsdC5kdW1wKCkpCgogICAgICAgICMgYWNjZXNzIG5hbWVkIGZpZWxkcyBhcyBkaWN0IGVudHJpZXMsIG9yIG91dHB1dCBhcyBkaWN0CiAgICAgICAgcHJpbnQocmVzdWx0WydzaGFwZSddKQogICAgICAgIHByaW50KHJlc3VsdC5hc19kaWN0KCkpCgogICAgcHJpbnRzOjoKCiAgICAgICAgWydzaGFwZScsICdTUVVBUkUnLCAncG9zbicsICd1cHBlciBsZWZ0JywgJ2NvbG9yJywgJ2xpZ2h0IGJsdWUnLCAndGV4dHVyZScsICdidXJsYXAnXQogICAgICAgIFtbJ3NoYXBlJywgJ1NRVUFSRSddLCBbJ3Bvc24nLCAndXBwZXIgbGVmdCddLCBbJ2NvbG9yJywgJ2xpZ2h0IGJsdWUnXSwgWyd0ZXh0dXJlJywgJ2J1cmxhcCddXQogICAgICAgIC0gY29sb3I6ICdsaWdodCBibHVlJwogICAgICAgIC0gcG9zbjogJ3VwcGVyIGxlZnQnCiAgICAgICAgLSBzaGFwZTogJ1NRVUFSRScKICAgICAgICAtIHRleHR1cmU6ICdidXJsYXAnCiAgICAgICAgU1FVQVJFCiAgICAgICAgeydjb2xvcic6ICdsaWdodCBibHVlJywgJ3Bvc24nOiAndXBwZXIgbGVmdCcsICd0ZXh0dXJlJzogJ2J1cmxhcCcsICdzaGFwZSc6ICdTUVVBUkUnfQoKICAgIFNlZSBtb3JlIGV4YW1wbGVzIGF0IDpjbGFzczpgUGFyc2VSZXN1bHRzYCBvZiBhY2Nlc3NpbmcgZmllbGRzIGJ5IHJlc3VsdHMgbmFtZS4KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBleHByOiBQYXJzZXJFbGVtZW50LCBhc2RpY3Q6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhleHByKQogICAgICAgIHNlbGYuc2F2ZUFzTGlzdCA9IFRydWUKICAgICAgICBzZWxmLl9hc1B5dGhvbkRpY3QgPSBhc2RpY3QKCiAgICBkZWYgcG9zdFBhcnNlKHNlbGYsIGluc3RyaW5nLCBsb2MsIHRva2VubGlzdCk6CiAgICAgICAgZm9yIGksIHRvayBpbiBlbnVtZXJhdGUodG9rZW5saXN0KToKICAgICAgICAgICAgaWYgbGVuKHRvaykgPT0gMDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBpa2V5ID0gdG9rWzBdCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaWtleSwgaW50KToKICAgICAgICAgICAgICAgIGlrZXkgPSBzdHIoaWtleSkuc3RyaXAoKQoKICAgICAgICAgICAgaWYgbGVuKHRvaykgPT0gMToKICAgICAgICAgICAgICAgIHRva2VubGlzdFtpa2V5XSA9IF9QYXJzZVJlc3VsdHNXaXRoT2Zmc2V0KFwiXCIsIGkpCgogICAgICAgICAgICBlbGlmIGxlbih0b2spID09IDIgYW5kIG5vdCBpc2luc3RhbmNlKHRva1sxXSwgUGFyc2VSZXN1bHRzKToKICAgICAgICAgICAgICAgIHRva2VubGlzdFtpa2V5XSA9IF9QYXJzZVJlc3VsdHNXaXRoT2Zmc2V0KHRva1sxXSwgaSkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZGljdHZhbHVlID0gdG9rLmNvcHkoKSAgIyBQYXJzZVJlc3VsdHMoaSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgZXhjID0gVHlwZUVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICBcImNvdWxkIG5vdCBleHRyYWN0IGRpY3QgdmFsdWVzIGZyb20gcGFyc2VkIHJlc3VsdHNcIgogICAgICAgICAgICAgICAgICAgICAgICBcIiAtIERpY3QgZXhwcmVzc2lvbiBtdXN0IGNvbnRhaW4gR3JvdXBlZCBleHByZXNzaW9uc1wiCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHJhaXNlIGV4YyBmcm9tIE5vbmUKCiAgICAgICAgICAgICAgICBkZWwgZGljdHZhbHVlWzBdCgogICAgICAgICAgICAgICAgaWYgbGVuKGRpY3R2YWx1ZSkgIT0gMSBvciAoCiAgICAgICAgICAgICAgICAgICAgaXNpbnN0YW5jZShkaWN0dmFsdWUsIFBhcnNlUmVzdWx0cykgYW5kIGRpY3R2YWx1ZS5oYXNrZXlzKCkKICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgdG9rZW5saXN0W2lrZXldID0gX1BhcnNlUmVzdWx0c1dpdGhPZmZzZXQoZGljdHZhbHVlLCBpKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0b2tlbmxpc3RbaWtleV0gPSBfUGFyc2VSZXN1bHRzV2l0aE9mZnNldChkaWN0dmFsdWVbMF0sIGkpCgogICAgICAgIGlmIHNlbGYuX2FzUHl0aG9uRGljdDoKICAgICAgICAgICAgcmV0dXJuIFt0b2tlbmxpc3QuYXNfZGljdCgpXSBpZiBzZWxmLnJlc3VsdHNOYW1lIGVsc2UgdG9rZW5saXN0LmFzX2RpY3QoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBbdG9rZW5saXN0XSBpZiBzZWxmLnJlc3VsdHNOYW1lIGVsc2UgdG9rZW5saXN0CgoKY2xhc3MgU3VwcHJlc3MoVG9rZW5Db252ZXJ0ZXIpOgogICAgXCJcIlwiQ29udmVydGVyIGZvciBpZ25vcmluZyB0aGUgcmVzdWx0cyBvZiBhIHBhcnNlZCBleHByZXNzaW9uLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBzb3VyY2UgPSBcImEsIGIsIGMsZFwiCiAgICAgICAgd2QgPSBXb3JkKGFscGhhcykKICAgICAgICB3ZF9saXN0MSA9IHdkICsgKCcsJyArIHdkKVsuLi5dCiAgICAgICAgcHJpbnQod2RfbGlzdDEucGFyc2Vfc3RyaW5nKHNvdXJjZSkpCgogICAgICAgICMgb2Z0ZW4sIGRlbGltaXRlcnMgdGhhdCBhcmUgdXNlZnVsIGR1cmluZyBwYXJzaW5nIGFyZSBqdXN0IGluIHRoZQogICAgICAgICMgd2F5IGFmdGVyd2FyZCAtIHVzZSBTdXBwcmVzcyB0byBrZWVwIHRoZW0gb3V0IG9mIHRoZSBwYXJzZWQgb3V0cHV0CiAgICAgICAgd2RfbGlzdDIgPSB3ZCArIChTdXBwcmVzcygnLCcpICsgd2QpWy4uLl0KICAgICAgICBwcmludCh3ZF9saXN0Mi5wYXJzZV9zdHJpbmcoc291cmNlKSkKCiAgICAgICAgIyBTa2lwcGVkIHRleHQgKHVzaW5nICcuLi4nKSBjYW4gYmUgc3VwcHJlc3NlZCBhcyB3ZWxsCiAgICAgICAgc291cmNlID0gXCJsZWFkIGluIFNUQVJUIHJlbGV2YW50IHRleHQgRU5EIHRyYWlsaW5nIHRleHRcIgogICAgICAgIHN0YXJ0X21hcmtlciA9IEtleXdvcmQoXCJTVEFSVFwiKQogICAgICAgIGVuZF9tYXJrZXIgPSBLZXl3b3JkKFwiRU5EXCIpCiAgICAgICAgZmluZF9ib2R5ID0gU3VwcHJlc3MoLi4uKSArIHN0YXJ0X21hcmtlciArIC4uLiArIGVuZF9tYXJrZXIKICAgICAgICBwcmludChmaW5kX2JvZHkucGFyc2Vfc3RyaW5nKHNvdXJjZSkKCiAgICBwcmludHM6OgoKICAgICAgICBbJ2EnLCAnLCcsICdiJywgJywnLCAnYycsICcsJywgJ2QnXQogICAgICAgIFsnYScsICdiJywgJ2MnLCAnZCddCiAgICAgICAgWydTVEFSVCcsICdyZWxldmFudCB0ZXh0ICcsICdFTkQnXQoKICAgIChTZWUgYWxzbyA6Y2xhc3M6YGRlbGltaXRlZF9saXN0YC4pCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwcjogVW5pb25bUGFyc2VyRWxlbWVudCwgc3RyXSwgc2F2ZWxpc3Q6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgaWYgZXhwciBpcyAuLi46CiAgICAgICAgICAgIGV4cHIgPSBfUGVuZGluZ1NraXAoTm9NYXRjaCgpKQogICAgICAgIHN1cGVyKCkuX19pbml0X18oZXhwcikKCiAgICBkZWYgX19hZGRfXyhzZWxmLCBvdGhlcikgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxmLmV4cHIsIF9QZW5kaW5nU2tpcCk6CiAgICAgICAgICAgIHJldHVybiBTdXBwcmVzcyhTa2lwVG8ob3RoZXIpKSArIG90aGVyCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHN1cGVyKCkuX19hZGRfXyhvdGhlcikKCiAgICBkZWYgX19zdWJfXyhzZWxmLCBvdGhlcikgLT4gXCJQYXJzZXJFbGVtZW50XCI6CiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxmLmV4cHIsIF9QZW5kaW5nU2tpcCk6CiAgICAgICAgICAgIHJldHVybiBTdXBwcmVzcyhTa2lwVG8ob3RoZXIpKSAtIG90aGVyCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHN1cGVyKCkuX19zdWJfXyhvdGhlcikKCiAgICBkZWYgcG9zdFBhcnNlKHNlbGYsIGluc3RyaW5nLCBsb2MsIHRva2VubGlzdCk6CiAgICAgICAgcmV0dXJuIFtdCgogICAgZGVmIHN1cHByZXNzKHNlbGYpIC0+IFBhcnNlckVsZW1lbnQ6CiAgICAgICAgcmV0dXJuIHNlbGYKCgpkZWYgdHJhY2VfcGFyc2VfYWN0aW9uKGY6IFBhcnNlQWN0aW9uKSAtPiBQYXJzZUFjdGlvbjoKICAgIFwiXCJcIkRlY29yYXRvciBmb3IgZGVidWdnaW5nIHBhcnNlIGFjdGlvbnMuCgogICAgV2hlbiB0aGUgcGFyc2UgYWN0aW9uIGlzIGNhbGxlZCwgdGhpcyBkZWNvcmF0b3Igd2lsbCBwcmludAogICAgYGBcIj4+IGVudGVyaW5nIG1ldGhvZC1uYW1lKGxpbmU6PGN1cnJlbnRfc291cmNlX2xpbmU+LCA8cGFyc2VfbG9jYXRpb24+LCA8bWF0Y2hlZF90b2tlbnM+KVwiYGAuCiAgICBXaGVuIHRoZSBwYXJzZSBhY3Rpb24gY29tcGxldGVzLCB0aGUgZGVjb3JhdG9yIHdpbGwgcHJpbnQKICAgIGBgXCI8PFwiYGAgZm9sbG93ZWQgYnkgdGhlIHJldHVybmVkIHZhbHVlLCBvciBhbnkgZXhjZXB0aW9uIHRoYXQgdGhlIHBhcnNlIGFjdGlvbiByYWlzZWQuCgogICAgRXhhbXBsZTo6CgogICAgICAgIHdkID0gV29yZChhbHBoYXMpCgogICAgICAgIEB0cmFjZV9wYXJzZV9hY3Rpb24KICAgICAgICBkZWYgcmVtb3ZlX2R1cGxpY2F0ZV9jaGFycyh0b2tlbnMpOgogICAgICAgICAgICByZXR1cm4gJycuam9pbihzb3J0ZWQoc2V0KCcnLmpvaW4odG9rZW5zKSkpKQoKICAgICAgICB3ZHMgPSB3ZFsxLCAuLi5dLnNldF9wYXJzZV9hY3Rpb24ocmVtb3ZlX2R1cGxpY2F0ZV9jaGFycykKICAgICAgICBwcmludCh3ZHMucGFyc2Vfc3RyaW5nKFwic2xrZGpzIHNsZCBzbGRkIHNkbGYgc2RsamZcIikpCgogICAgcHJpbnRzOjoKCiAgICAgICAgPj5lbnRlcmluZyByZW1vdmVfZHVwbGljYXRlX2NoYXJzKGxpbmU6ICdzbGtkanMgc2xkIHNsZGQgc2RsZiBzZGxqZicsIDAsIChbJ3Nsa2RqcycsICdzbGQnLCAnc2xkZCcsICdzZGxmJywgJ3NkbGpmJ10sIHt9KSkKICAgICAgICA8PGxlYXZpbmcgcmVtb3ZlX2R1cGxpY2F0ZV9jaGFycyAocmV0OiAnZGZqa2xzJykKICAgICAgICBbJ2RmamtscyddCiAgICBcIlwiXCIKICAgIGYgPSBfdHJpbV9hcml0eShmKQoKICAgIGRlZiB6KCpwYUFyZ3MpOgogICAgICAgIHRoaXNGdW5jID0gZi5fX25hbWVfXwogICAgICAgIHMsIGwsIHQgPSBwYUFyZ3NbLTM6XQogICAgICAgIGlmIGxlbihwYUFyZ3MpID4gMzoKICAgICAgICAgICAgdGhpc0Z1bmMgPSBwYUFyZ3NbMF0uX19jbGFzc19fLl9fbmFtZV9fICsgXCIuXCIgKyB0aGlzRnVuYwogICAgICAgIHN5cy5zdGRlcnIud3JpdGUoCiAgICAgICAgICAgIFwiPj5lbnRlcmluZyB7fShsaW5lOiB7IXJ9LCB7fSwgeyFyfSlcXG5cIi5mb3JtYXQodGhpc0Z1bmMsIGxpbmUobCwgcyksIGwsIHQpCiAgICAgICAgKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0ID0gZigqcGFBcmdzKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICBzeXMuc3RkZXJyLndyaXRlKFwiPDxsZWF2aW5nIHt9IChleGNlcHRpb246IHt9KVxcblwiLmZvcm1hdCh0aGlzRnVuYywgZXhjKSkKICAgICAgICAgICAgcmFpc2UKICAgICAgICBzeXMuc3RkZXJyLndyaXRlKFwiPDxsZWF2aW5nIHt9IChyZXQ6IHshcn0pXFxuXCIuZm9ybWF0KHRoaXNGdW5jLCByZXQpKQogICAgICAgIHJldHVybiByZXQKCiAgICB6Ll9fbmFtZV9fID0gZi5fX25hbWVfXwogICAgcmV0dXJuIHoKCgojIGNvbnZlbmllbmNlIGNvbnN0YW50cyBmb3IgcG9zaXRpb25hbCBleHByZXNzaW9ucwplbXB0eSA9IEVtcHR5KCkuc2V0X25hbWUoXCJlbXB0eVwiKQpsaW5lX3N0YXJ0ID0gTGluZVN0YXJ0KCkuc2V0X25hbWUoXCJsaW5lX3N0YXJ0XCIpCmxpbmVfZW5kID0gTGluZUVuZCgpLnNldF9uYW1lKFwibGluZV9lbmRcIikKc3RyaW5nX3N0YXJ0ID0gU3RyaW5nU3RhcnQoKS5zZXRfbmFtZShcInN0cmluZ19zdGFydFwiKQpzdHJpbmdfZW5kID0gU3RyaW5nRW5kKCkuc2V0X25hbWUoXCJzdHJpbmdfZW5kXCIpCgpfZXNjYXBlZFB1bmMgPSBXb3JkKF9ic2xhc2gsIHJcIlxcW10tKi4kK14/KCl+IFwiLCBleGFjdD0yKS5zZXRfcGFyc2VfYWN0aW9uKAogICAgbGFtYmRhIHMsIGwsIHQ6IHRbMF1bMV0KKQpfZXNjYXBlZEhleENoYXIgPSBSZWdleChyXCJcXFxcMD9beFhdWzAtOWEtZkEtRl0rXCIpLnNldF9wYXJzZV9hY3Rpb24oCiAgICBsYW1iZGEgcywgbCwgdDogY2hyKGludCh0WzBdLmxzdHJpcChyXCJcXDB4XCIpLCAxNikpCikKX2VzY2FwZWRPY3RDaGFyID0gUmVnZXgoclwiXFxcXDBbMC03XStcIikuc2V0X3BhcnNlX2FjdGlvbigKICAgIGxhbWJkYSBzLCBsLCB0OiBjaHIoaW50KHRbMF1bMTpdLCA4KSkKKQpfc2luZ2xlQ2hhciA9ICgKICAgIF9lc2NhcGVkUHVuYyB8IF9lc2NhcGVkSGV4Q2hhciB8IF9lc2NhcGVkT2N0Q2hhciB8IENoYXJzTm90SW4oclwiXFxdXCIsIGV4YWN0PTEpCikKX2NoYXJSYW5nZSA9IEdyb3VwKF9zaW5nbGVDaGFyICsgU3VwcHJlc3MoXCItXCIpICsgX3NpbmdsZUNoYXIpCl9yZUJyYWNrZXRFeHByID0gKAogICAgTGl0ZXJhbChcIltcIikKICAgICsgT3B0KFwiXlwiKS5zZXRfcmVzdWx0c19uYW1lKFwibmVnYXRlXCIpCiAgICArIEdyb3VwKE9uZU9yTW9yZShfY2hhclJhbmdlIHwgX3NpbmdsZUNoYXIpKS5zZXRfcmVzdWx0c19uYW1lKFwiYm9keVwiKQogICAgKyBcIl1cIgopCgoKZGVmIHNyYW5nZShzOiBzdHIpIC0+IHN0cjoKICAgIHJcIlwiXCJIZWxwZXIgdG8gZWFzaWx5IGRlZmluZSBzdHJpbmcgcmFuZ2VzIGZvciB1c2UgaW4gOmNsYXNzOmBXb3JkYAogICAgY29uc3RydWN0aW9uLiBCb3Jyb3dzIHN5bnRheCBmcm9tIHJlZ2V4cCBgYCdbXSdgYCBzdHJpbmcgcmFuZ2UKICAgIGRlZmluaXRpb25zOjoKCiAgICAgICAgc3JhbmdlKFwiWzAtOV1cIikgICAtPiBcIjAxMjM0NTY3ODlcIgogICAgICAgIHNyYW5nZShcIlthLXpdXCIpICAgLT4gXCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5elwiCiAgICAgICAgc3JhbmdlKFwiW2EteiRfXVwiKSAtPiBcImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JF9cIgoKICAgIFRoZSBpbnB1dCBzdHJpbmcgbXVzdCBiZSBlbmNsb3NlZCBpbiBbXSdzLCBhbmQgdGhlIHJldHVybmVkIHN0cmluZwogICAgaXMgdGhlIGV4cGFuZGVkIGNoYXJhY3RlciBzZXQgam9pbmVkIGludG8gYSBzaW5nbGUgc3RyaW5nLiBUaGUKICAgIHZhbHVlcyBlbmNsb3NlZCBpbiB0aGUgW10ncyBtYXkgYmU6CgogICAgLSBhIHNpbmdsZSBjaGFyYWN0ZXIKICAgIC0gYW4gZXNjYXBlZCBjaGFyYWN0ZXIgd2l0aCBhIGxlYWRpbmcgYmFja3NsYXNoIChzdWNoIGFzIGBgXFwtYGAKICAgICAgb3IgYGBcXF1gYCkKICAgIC0gYW4gZXNjYXBlZCBoZXggY2hhcmFjdGVyIHdpdGggYSBsZWFkaW5nIGBgJ1xceCdgYAogICAgICAoYGBcXHgyMWBgLCB3aGljaCBpcyBhIGBgJyEnYGAgY2hhcmFjdGVyKSAoYGBcXDB4IyNgYAogICAgICBpcyBhbHNvIHN1cHBvcnRlZCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkpCiAgICAtIGFuIGVzY2FwZWQgb2N0YWwgY2hhcmFjdGVyIHdpdGggYSBsZWFkaW5nIGBgJ1xcMCdgYAogICAgICAoYGBcXDA0MWBgLCB3aGljaCBpcyBhIGBgJyEnYGAgY2hhcmFjdGVyKQogICAgLSBhIHJhbmdlIG9mIGFueSBvZiB0aGUgYWJvdmUsIHNlcGFyYXRlZCBieSBhIGRhc2ggKGBgJ2EteidgYCwKICAgICAgZXRjLikKICAgIC0gYW55IGNvbWJpbmF0aW9uIG9mIHRoZSBhYm92ZSAoYGAnYWVpb3V5J2BgLAogICAgICBgYCdhLXpBLVowLTlfJCdgYCwgZXRjLikKICAgIFwiXCJcIgogICAgX2V4cGFuZGVkID0gKAogICAgICAgIGxhbWJkYSBwOiBwCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UocCwgUGFyc2VSZXN1bHRzKQogICAgICAgIGVsc2UgXCJcIi5qb2luKGNocihjKSBmb3IgYyBpbiByYW5nZShvcmQocFswXSksIG9yZChwWzFdKSArIDEpKQogICAgKQogICAgdHJ5OgogICAgICAgIHJldHVybiBcIlwiLmpvaW4oX2V4cGFuZGVkKHBhcnQpIGZvciBwYXJ0IGluIF9yZUJyYWNrZXRFeHByLnBhcnNlX3N0cmluZyhzKS5ib2R5KQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gXCJcIgoKCmRlZiB0b2tlbl9tYXAoZnVuYywgKmFyZ3MpIC0+IFBhcnNlQWN0aW9uOgogICAgXCJcIlwiSGVscGVyIHRvIGRlZmluZSBhIHBhcnNlIGFjdGlvbiBieSBtYXBwaW5nIGEgZnVuY3Rpb24gdG8gYWxsCiAgICBlbGVtZW50cyBvZiBhIDpjbGFzczpgUGFyc2VSZXN1bHRzYCBsaXN0LiBJZiBhbnkgYWRkaXRpb25hbCBhcmdzIGFyZSBwYXNzZWQsCiAgICB0aGV5IGFyZSBmb3J3YXJkZWQgdG8gdGhlIGdpdmVuIGZ1bmN0aW9uIGFzIGFkZGl0aW9uYWwgYXJndW1lbnRzCiAgICBhZnRlciB0aGUgdG9rZW4sIGFzIGluCiAgICBgYGhleF9pbnRlZ2VyID0gV29yZChoZXhudW1zKS5zZXRfcGFyc2VfYWN0aW9uKHRva2VuX21hcChpbnQsIDE2KSlgYCwKICAgIHdoaWNoIHdpbGwgY29udmVydCB0aGUgcGFyc2VkIGRhdGEgdG8gYW4gaW50ZWdlciB1c2luZyBiYXNlIDE2LgoKICAgIEV4YW1wbGUgKGNvbXBhcmUgdGhlIGxhc3QgdG8gZXhhbXBsZSBpbiA6Y2xhc3M6YFBhcnNlckVsZW1lbnQudHJhbnNmb3JtX3N0cmluZ2A6OgoKICAgICAgICBoZXhfaW50cyA9IFdvcmQoaGV4bnVtcylbMSwgLi4uXS5zZXRfcGFyc2VfYWN0aW9uKHRva2VuX21hcChpbnQsIDE2KSkKICAgICAgICBoZXhfaW50cy5ydW5fdGVzdHMoJycnCiAgICAgICAgICAgIDAwIDExIDIyIGFhIEZGIDBhIDBkIDFhCiAgICAgICAgICAgICcnJykKCiAgICAgICAgdXBwZXJ3b3JkID0gV29yZChhbHBoYXMpLnNldF9wYXJzZV9hY3Rpb24odG9rZW5fbWFwKHN0ci51cHBlcikpCiAgICAgICAgdXBwZXJ3b3JkWzEsIC4uLl0ucnVuX3Rlc3RzKCcnJwogICAgICAgICAgICBteSBraW5nZG9tIGZvciBhIGhvcnNlCiAgICAgICAgICAgICcnJykKCiAgICAgICAgd2QgPSBXb3JkKGFscGhhcykuc2V0X3BhcnNlX2FjdGlvbih0b2tlbl9tYXAoc3RyLnRpdGxlKSkKICAgICAgICB3ZFsxLCAuLi5dLnNldF9wYXJzZV9hY3Rpb24oJyAnLmpvaW4pLnJ1bl90ZXN0cygnJycKICAgICAgICAgICAgbm93IGlzIHRoZSB3aW50ZXIgb2Ygb3VyIGRpc2NvbnRlbnQgbWFkZSBnbG9yaW91cyBzdW1tZXIgYnkgdGhpcyBzdW4gb2YgeW9yawogICAgICAgICAgICAnJycpCgogICAgcHJpbnRzOjoKCiAgICAgICAgMDAgMTEgMjIgYWEgRkYgMGEgMGQgMWEKICAgICAgICBbMCwgMTcsIDM0LCAxNzAsIDI1NSwgMTAsIDEzLCAyNl0KCiAgICAgICAgbXkga2luZ2RvbSBmb3IgYSBob3JzZQogICAgICAgIFsnTVknLCAnS0lOR0RPTScsICdGT1InLCAnQScsICdIT1JTRSddCgogICAgICAgIG5vdyBpcyB0aGUgd2ludGVyIG9mIG91ciBkaXNjb250ZW50IG1hZGUgZ2xvcmlvdXMgc3VtbWVyIGJ5IHRoaXMgc3VuIG9mIHlvcmsKICAgICAgICBbJ05vdyBJcyBUaGUgV2ludGVyIE9mIE91ciBEaXNjb250ZW50IE1hZGUgR2xvcmlvdXMgU3VtbWVyIEJ5IFRoaXMgU3VuIE9mIFlvcmsnXQogICAgXCJcIlwiCgogICAgZGVmIHBhKHMsIGwsIHQpOgogICAgICAgIHJldHVybiBbZnVuYyh0b2tuLCAqYXJncykgZm9yIHRva24gaW4gdF0KCiAgICBmdW5jX25hbWUgPSBnZXRhdHRyKGZ1bmMsIFwiX19uYW1lX19cIiwgZ2V0YXR0cihmdW5jLCBcIl9fY2xhc3NfX1wiKS5fX25hbWVfXykKICAgIHBhLl9fbmFtZV9fID0gZnVuY19uYW1lCgogICAgcmV0dXJuIHBhCgoKZGVmIGF1dG9uYW1lX2VsZW1lbnRzKCkgLT4gTm9uZToKICAgIFwiXCJcIgogICAgVXRpbGl0eSB0byBzaW1wbGlmeSBtYXNzLW5hbWluZyBvZiBwYXJzZXIgZWxlbWVudHMsIGZvcgogICAgZ2VuZXJhdGluZyByYWlscm9hZCBkaWFncmFtIHdpdGggbmFtZWQgc3ViZGlhZ3JhbXMuCiAgICBcIlwiXCIKICAgIGZvciBuYW1lLCB2YXIgaW4gc3lzLl9nZXRmcmFtZSgpLmZfYmFjay5mX2xvY2Fscy5pdGVtcygpOgogICAgICAgIGlmIGlzaW5zdGFuY2UodmFyLCBQYXJzZXJFbGVtZW50KSBhbmQgbm90IHZhci5jdXN0b21OYW1lOgogICAgICAgICAgICB2YXIuc2V0X25hbWUobmFtZSkKCgpkYmxfcXVvdGVkX3N0cmluZyA9IENvbWJpbmUoCiAgICBSZWdleChyJ1wiKD86W15cIlxcblxcclxcXFxdfCg/OlwiXCIpfCg/OlxcXFwoPzpbXnhdfHhbMC05YS1mQS1GXSspKSkqJykgKyAnXCInCikuc2V0X25hbWUoXCJzdHJpbmcgZW5jbG9zZWQgaW4gZG91YmxlIHF1b3Rlc1wiKQoKc2dsX3F1b3RlZF9zdHJpbmcgPSBDb21iaW5lKAogICAgUmVnZXgoclwiJyg/OlteJ1xcblxcclxcXFxdfCg/OicnKXwoPzpcXFxcKD86W154XXx4WzAtOWEtZkEtRl0rKSkpKlwiKSArIFwiJ1wiCikuc2V0X25hbWUoXCJzdHJpbmcgZW5jbG9zZWQgaW4gc2luZ2xlIHF1b3Rlc1wiKQoKcXVvdGVkX3N0cmluZyA9IENvbWJpbmUoCiAgICBSZWdleChyJ1wiKD86W15cIlxcblxcclxcXFxdfCg/OlwiXCIpfCg/OlxcXFwoPzpbXnhdfHhbMC05YS1mQS1GXSspKSkqJykgKyAnXCInCiAgICB8IFJlZ2V4KHJcIicoPzpbXidcXG5cXHJcXFxcXXwoPzonJyl8KD86XFxcXCg/OlteeF18eFswLTlhLWZBLUZdKykpKSpcIikgKyBcIidcIgopLnNldF9uYW1lKFwicXVvdGVkU3RyaW5nIHVzaW5nIHNpbmdsZSBvciBkb3VibGUgcXVvdGVzXCIpCgp1bmljb2RlX3N0cmluZyA9IENvbWJpbmUoXCJ1XCIgKyBxdW90ZWRfc3RyaW5nLmNvcHkoKSkuc2V0X25hbWUoXCJ1bmljb2RlIHN0cmluZyBsaXRlcmFsXCIpCgoKYWxwaGFzOGJpdCA9IHNyYW5nZShyXCJbXFwweGMwLVxcMHhkNlxcMHhkOC1cXDB4ZjZcXDB4ZjgtXFwweGZmXVwiKQpwdW5jOGJpdCA9IHNyYW5nZShyXCJbXFwweGExLVxcMHhiZlxcMHhkN1xcMHhmN11cIikKCiMgYnVpbGQgbGlzdCBvZiBidWlsdC1pbiBleHByZXNzaW9ucywgZm9yIGZ1dHVyZSByZWZlcmVuY2UgaWYgYSBnbG9iYWwgZGVmYXVsdCB2YWx1ZQojIGdldHMgdXBkYXRlZApfYnVpbHRpbl9leHByczogTGlzdFtQYXJzZXJFbGVtZW50XSA9IFsKICAgIHYgZm9yIHYgaW4gdmFycygpLnZhbHVlcygpIGlmIGlzaW5zdGFuY2UodiwgUGFyc2VyRWxlbWVudCkKXQoKIyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IG5hbWVzCnRva2VuTWFwID0gdG9rZW5fbWFwCmNvbmRpdGlvbkFzUGFyc2VBY3Rpb24gPSBjb25kaXRpb25fYXNfcGFyc2VfYWN0aW9uCm51bGxEZWJ1Z0FjdGlvbiA9IG51bGxfZGVidWdfYWN0aW9uCnNnbFF1b3RlZFN0cmluZyA9IHNnbF9xdW90ZWRfc3RyaW5nCmRibFF1b3RlZFN0cmluZyA9IGRibF9xdW90ZWRfc3RyaW5nCnF1b3RlZFN0cmluZyA9IHF1b3RlZF9zdHJpbmcKdW5pY29kZVN0cmluZyA9IHVuaWNvZGVfc3RyaW5nCmxpbmVTdGFydCA9IGxpbmVfc3RhcnQKbGluZUVuZCA9IGxpbmVfZW5kCnN0cmluZ1N0YXJ0ID0gc3RyaW5nX3N0YXJ0CnN0cmluZ0VuZCA9IHN0cmluZ19lbmQKdHJhY2VQYXJzZUFjdGlvbiA9IHRyYWNlX3BhcnNlX2FjdGlvbgoKIiIiCm1vZHVsZV9kaWN0WyJweXBhcnNpbmcvaGVscGVycy5weSJdPSIiIgojIGhlbHBlcnMucHkKaW1wb3J0IGh0bWwuZW50aXRpZXMKaW1wb3J0IHJlCmltcG9ydCB0eXBpbmcKCmZyb20gLiBpbXBvcnQgX19kaWFnX18KZnJvbSAuY29yZSBpbXBvcnQgKgpmcm9tIC51dGlsIGltcG9ydCBfYnNsYXNoLCBfZmxhdHRlbiwgX2VzY2FwZV9yZWdleF9yYW5nZV9jaGFycwoKCiMKIyBnbG9iYWwgaGVscGVycwojCmRlZiBkZWxpbWl0ZWRfbGlzdCgKICAgIGV4cHI6IFVuaW9uW3N0ciwgUGFyc2VyRWxlbWVudF0sCiAgICBkZWxpbTogVW5pb25bc3RyLCBQYXJzZXJFbGVtZW50XSA9IFwiLFwiLAogICAgY29tYmluZTogYm9vbCA9IEZhbHNlLAogICAgbWluOiB0eXBpbmcuT3B0aW9uYWxbaW50XSA9IE5vbmUsCiAgICBtYXg6IHR5cGluZy5PcHRpb25hbFtpbnRdID0gTm9uZSwKICAgICosCiAgICBhbGxvd190cmFpbGluZ19kZWxpbTogYm9vbCA9IEZhbHNlLAopIC0+IFBhcnNlckVsZW1lbnQ6CiAgICBcIlwiXCJIZWxwZXIgdG8gZGVmaW5lIGEgZGVsaW1pdGVkIGxpc3Qgb2YgZXhwcmVzc2lvbnMgLSB0aGUgZGVsaW1pdGVyCiAgICBkZWZhdWx0cyB0byAnLCcuIEJ5IGRlZmF1bHQsIHRoZSBsaXN0IGVsZW1lbnRzIGFuZCBkZWxpbWl0ZXJzIGNhbgogICAgaGF2ZSBpbnRlcnZlbmluZyB3aGl0ZXNwYWNlLCBhbmQgY29tbWVudHMsIGJ1dCB0aGlzIGNhbiBiZQogICAgb3ZlcnJpZGRlbiBieSBwYXNzaW5nIGBgY29tYmluZT1UcnVlYGAgaW4gdGhlIGNvbnN0cnVjdG9yLiBJZgogICAgYGBjb21iaW5lYGAgaXMgc2V0IHRvIGBgVHJ1ZWBgLCB0aGUgbWF0Y2hpbmcgdG9rZW5zIGFyZQogICAgcmV0dXJuZWQgYXMgYSBzaW5nbGUgdG9rZW4gc3RyaW5nLCB3aXRoIHRoZSBkZWxpbWl0ZXJzIGluY2x1ZGVkOwogICAgb3RoZXJ3aXNlLCB0aGUgbWF0Y2hpbmcgdG9rZW5zIGFyZSByZXR1cm5lZCBhcyBhIGxpc3Qgb2YgdG9rZW5zLAogICAgd2l0aCB0aGUgZGVsaW1pdGVycyBzdXBwcmVzc2VkLgoKICAgIElmIGBgYWxsb3dfdHJhaWxpbmdfZGVsaW1gYCBpcyBzZXQgdG8gVHJ1ZSwgdGhlbiB0aGUgbGlzdCBtYXkgZW5kIHdpdGgKICAgIGEgZGVsaW1pdGVyLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBkZWxpbWl0ZWRfbGlzdChXb3JkKGFscGhhcykpLnBhcnNlX3N0cmluZyhcImFhLGJiLGNjXCIpICMgLT4gWydhYScsICdiYicsICdjYyddCiAgICAgICAgZGVsaW1pdGVkX2xpc3QoV29yZChoZXhudW1zKSwgZGVsaW09JzonLCBjb21iaW5lPVRydWUpLnBhcnNlX3N0cmluZyhcIkFBOkJCOkNDOkREOkVFXCIpICMgLT4gWydBQTpCQjpDQzpERDpFRSddCiAgICBcIlwiXCIKICAgIGlmIGlzaW5zdGFuY2UoZXhwciwgc3RyX3R5cGUpOgogICAgICAgIGV4cHIgPSBQYXJzZXJFbGVtZW50Ll9saXRlcmFsU3RyaW5nQ2xhc3MoZXhwcikKCiAgICBkbE5hbWUgPSBcIntleHByfSBbe2RlbGltfSB7ZXhwcn1dLi4ue2VuZH1cIi5mb3JtYXQoCiAgICAgICAgZXhwcj1zdHIoZXhwci5jb3B5KCkuc3RyZWFtbGluZSgpKSwKICAgICAgICBkZWxpbT1zdHIoZGVsaW0pLAogICAgICAgIGVuZD1cIiBbe31dXCIuZm9ybWF0KHN0cihkZWxpbSkpIGlmIGFsbG93X3RyYWlsaW5nX2RlbGltIGVsc2UgXCJcIiwKICAgICkKCiAgICBpZiBub3QgY29tYmluZToKICAgICAgICBkZWxpbSA9IFN1cHByZXNzKGRlbGltKQoKICAgIGlmIG1pbiBpcyBub3QgTm9uZToKICAgICAgICBpZiBtaW4gPCAxOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKFwibWluIG11c3QgYmUgZ3JlYXRlciB0aGFuIDBcIikKICAgICAgICBtaW4gLT0gMQogICAgaWYgbWF4IGlzIG5vdCBOb25lOgogICAgICAgIGlmIG1pbiBpcyBub3QgTm9uZSBhbmQgbWF4IDw9IG1pbjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihcIm1heCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiwgb3IgZXF1YWwgdG8gbWluXCIpCiAgICAgICAgbWF4IC09IDEKICAgIGRlbGltaXRlZF9saXN0X2V4cHIgPSBleHByICsgKGRlbGltICsgZXhwcilbbWluLCBtYXhdCgogICAgaWYgYWxsb3dfdHJhaWxpbmdfZGVsaW06CiAgICAgICAgZGVsaW1pdGVkX2xpc3RfZXhwciArPSBPcHQoZGVsaW0pCgogICAgaWYgY29tYmluZToKICAgICAgICByZXR1cm4gQ29tYmluZShkZWxpbWl0ZWRfbGlzdF9leHByKS5zZXRfbmFtZShkbE5hbWUpCiAgICBlbHNlOgogICAgICAgIHJldHVybiBkZWxpbWl0ZWRfbGlzdF9leHByLnNldF9uYW1lKGRsTmFtZSkKCgpkZWYgY291bnRlZF9hcnJheSgKICAgIGV4cHI6IFBhcnNlckVsZW1lbnQsCiAgICBpbnRfZXhwcjogdHlwaW5nLk9wdGlvbmFsW1BhcnNlckVsZW1lbnRdID0gTm9uZSwKICAgICosCiAgICBpbnRFeHByOiB0eXBpbmcuT3B0aW9uYWxbUGFyc2VyRWxlbWVudF0gPSBOb25lLAopIC0+IFBhcnNlckVsZW1lbnQ6CiAgICBcIlwiXCJIZWxwZXIgdG8gZGVmaW5lIGEgY291bnRlZCBsaXN0IG9mIGV4cHJlc3Npb25zLgoKICAgIFRoaXMgaGVscGVyIGRlZmluZXMgYSBwYXR0ZXJuIG9mIHRoZSBmb3JtOjoKCiAgICAgICAgaW50ZWdlciBleHByIGV4cHIgZXhwci4uLgoKICAgIHdoZXJlIHRoZSBsZWFkaW5nIGludGVnZXIgdGVsbHMgaG93IG1hbnkgZXhwciBleHByZXNzaW9ucyBmb2xsb3cuCiAgICBUaGUgbWF0Y2hlZCB0b2tlbnMgcmV0dXJucyB0aGUgYXJyYXkgb2YgZXhwciB0b2tlbnMgYXMgYSBsaXN0IC0gdGhlCiAgICBsZWFkaW5nIGNvdW50IHRva2VuIGlzIHN1cHByZXNzZWQuCgogICAgSWYgYGBpbnRfZXhwcmBgIGlzIHNwZWNpZmllZCwgaXQgc2hvdWxkIGJlIGEgcHlwYXJzaW5nIGV4cHJlc3Npb24KICAgIHRoYXQgcHJvZHVjZXMgYW4gaW50ZWdlciB2YWx1ZS4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgY291bnRlZF9hcnJheShXb3JkKGFscGhhcykpLnBhcnNlX3N0cmluZygnMiBhYiBjZCBlZicpICAjIC0+IFsnYWInLCAnY2QnXQoKICAgICAgICAjIGluIHRoaXMgcGFyc2VyLCB0aGUgbGVhZGluZyBpbnRlZ2VyIHZhbHVlIGlzIGdpdmVuIGluIGJpbmFyeSwKICAgICAgICAjICcxMCcgaW5kaWNhdGluZyB0aGF0IDIgdmFsdWVzIGFyZSBpbiB0aGUgYXJyYXkKICAgICAgICBiaW5hcnlfY29uc3RhbnQgPSBXb3JkKCcwMScpLnNldF9wYXJzZV9hY3Rpb24obGFtYmRhIHQ6IGludCh0WzBdLCAyKSkKICAgICAgICBjb3VudGVkX2FycmF5KFdvcmQoYWxwaGFzKSwgaW50X2V4cHI9YmluYXJ5X2NvbnN0YW50KS5wYXJzZV9zdHJpbmcoJzEwIGFiIGNkIGVmJykgICMgLT4gWydhYicsICdjZCddCgogICAgICAgICMgaWYgb3RoZXIgZmllbGRzIG11c3QgYmUgcGFyc2VkIGFmdGVyIHRoZSBjb3VudCBidXQgYmVmb3JlIHRoZQogICAgICAgICMgbGlzdCBpdGVtcywgZ2l2ZSB0aGUgZmllbGRzIHJlc3VsdHMgbmFtZXMgYW5kIHRoZXkgd2lsbAogICAgICAgICMgYmUgcHJlc2VydmVkIGluIHRoZSByZXR1cm5lZCBQYXJzZVJlc3VsdHM6CiAgICAgICAgY291bnRfd2l0aF9tZXRhZGF0YSA9IGludGVnZXIgKyBXb3JkKGFscGhhcykoXCJ0eXBlXCIpCiAgICAgICAgdHlwZWRfYXJyYXkgPSBjb3VudGVkX2FycmF5KFdvcmQoYWxwaGFudW1zKSwgaW50X2V4cHI9Y291bnRfd2l0aF9tZXRhZGF0YSkoXCJpdGVtc1wiKQogICAgICAgIHJlc3VsdCA9IHR5cGVkX2FycmF5LnBhcnNlX3N0cmluZyhcIjMgYm9vbCBUcnVlIFRydWUgRmFsc2VcIikKICAgICAgICBwcmludChyZXN1bHQuZHVtcCgpKQoKICAgICAgICAjIHByaW50cwogICAgICAgICMgWydUcnVlJywgJ1RydWUnLCAnRmFsc2UnXQogICAgICAgICMgLSBpdGVtczogWydUcnVlJywgJ1RydWUnLCAnRmFsc2UnXQogICAgICAgICMgLSB0eXBlOiAnYm9vbCcKICAgIFwiXCJcIgogICAgaW50RXhwciA9IGludEV4cHIgb3IgaW50X2V4cHIKICAgIGFycmF5X2V4cHIgPSBGb3J3YXJkKCkKCiAgICBkZWYgY291bnRfZmllbGRfcGFyc2VfYWN0aW9uKHMsIGwsIHQpOgogICAgICAgIG5vbmxvY2FsIGFycmF5X2V4cHIKICAgICAgICBuID0gdFswXQogICAgICAgIGFycmF5X2V4cHIgPDw9IChleHByICogbikgaWYgbiBlbHNlIEVtcHR5KCkKICAgICAgICAjIGNsZWFyIGxpc3QgY29udGVudHMsIGJ1dCBrZWVwIGFueSBuYW1lZCByZXN1bHRzCiAgICAgICAgZGVsIHRbOl0KCiAgICBpZiBpbnRFeHByIGlzIE5vbmU6CiAgICAgICAgaW50RXhwciA9IFdvcmQobnVtcykuc2V0X3BhcnNlX2FjdGlvbihsYW1iZGEgdDogaW50KHRbMF0pKQogICAgZWxzZToKICAgICAgICBpbnRFeHByID0gaW50RXhwci5jb3B5KCkKICAgIGludEV4cHIuc2V0X25hbWUoXCJhcnJheUxlblwiKQogICAgaW50RXhwci5hZGRfcGFyc2VfYWN0aW9uKGNvdW50X2ZpZWxkX3BhcnNlX2FjdGlvbiwgY2FsbF9kdXJpbmdfdHJ5PVRydWUpCiAgICByZXR1cm4gKGludEV4cHIgKyBhcnJheV9leHByKS5zZXRfbmFtZShcIihsZW4pIFwiICsgc3RyKGV4cHIpICsgXCIuLi5cIikKCgpkZWYgbWF0Y2hfcHJldmlvdXNfbGl0ZXJhbChleHByOiBQYXJzZXJFbGVtZW50KSAtPiBQYXJzZXJFbGVtZW50OgogICAgXCJcIlwiSGVscGVyIHRvIGRlZmluZSBhbiBleHByZXNzaW9uIHRoYXQgaXMgaW5kaXJlY3RseSBkZWZpbmVkIGZyb20KICAgIHRoZSB0b2tlbnMgbWF0Y2hlZCBpbiBhIHByZXZpb3VzIGV4cHJlc3Npb24sIHRoYXQgaXMsIGl0IGxvb2tzIGZvcgogICAgYSAncmVwZWF0JyBvZiBhIHByZXZpb3VzIGV4cHJlc3Npb24uICBGb3IgZXhhbXBsZTo6CgogICAgICAgIGZpcnN0ID0gV29yZChudW1zKQogICAgICAgIHNlY29uZCA9IG1hdGNoX3ByZXZpb3VzX2xpdGVyYWwoZmlyc3QpCiAgICAgICAgbWF0Y2hfZXhwciA9IGZpcnN0ICsgXCI6XCIgKyBzZWNvbmQKCiAgICB3aWxsIG1hdGNoIGBgXCIxOjFcImBgLCBidXQgbm90IGBgXCIxOjJcImBgLiAgQmVjYXVzZSB0aGlzCiAgICBtYXRjaGVzIGEgcHJldmlvdXMgbGl0ZXJhbCwgd2lsbCBhbHNvIG1hdGNoIHRoZSBsZWFkaW5nCiAgICBgYFwiMToxXCJgYCBpbiBgYFwiMToxMFwiYGAuIElmIHRoaXMgaXMgbm90IGRlc2lyZWQsIHVzZQogICAgOmNsYXNzOmBtYXRjaF9wcmV2aW91c19leHByYC4gRG8gKm5vdCogdXNlIHdpdGggcGFja3JhdCBwYXJzaW5nCiAgICBlbmFibGVkLgogICAgXCJcIlwiCiAgICByZXAgPSBGb3J3YXJkKCkKCiAgICBkZWYgY29weV90b2tlbl90b19yZXBlYXRlcihzLCBsLCB0KToKICAgICAgICBpZiB0OgogICAgICAgICAgICBpZiBsZW4odCkgPT0gMToKICAgICAgICAgICAgICAgIHJlcCA8PCB0WzBdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIGZsYXR0ZW4gdCB0b2tlbnMKICAgICAgICAgICAgICAgIHRmbGF0ID0gX2ZsYXR0ZW4odC5hc19saXN0KCkpCiAgICAgICAgICAgICAgICByZXAgPDwgQW5kKExpdGVyYWwodHQpIGZvciB0dCBpbiB0ZmxhdCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXAgPDwgRW1wdHkoKQoKICAgIGV4cHIuYWRkX3BhcnNlX2FjdGlvbihjb3B5X3Rva2VuX3RvX3JlcGVhdGVyLCBjYWxsRHVyaW5nVHJ5PVRydWUpCiAgICByZXAuc2V0X25hbWUoXCIocHJldikgXCIgKyBzdHIoZXhwcikpCiAgICByZXR1cm4gcmVwCgoKZGVmIG1hdGNoX3ByZXZpb3VzX2V4cHIoZXhwcjogUGFyc2VyRWxlbWVudCkgLT4gUGFyc2VyRWxlbWVudDoKICAgIFwiXCJcIkhlbHBlciB0byBkZWZpbmUgYW4gZXhwcmVzc2lvbiB0aGF0IGlzIGluZGlyZWN0bHkgZGVmaW5lZCBmcm9tCiAgICB0aGUgdG9rZW5zIG1hdGNoZWQgaW4gYSBwcmV2aW91cyBleHByZXNzaW9uLCB0aGF0IGlzLCBpdCBsb29rcyBmb3IKICAgIGEgJ3JlcGVhdCcgb2YgYSBwcmV2aW91cyBleHByZXNzaW9uLiAgRm9yIGV4YW1wbGU6OgoKICAgICAgICBmaXJzdCA9IFdvcmQobnVtcykKICAgICAgICBzZWNvbmQgPSBtYXRjaF9wcmV2aW91c19leHByKGZpcnN0KQogICAgICAgIG1hdGNoX2V4cHIgPSBmaXJzdCArIFwiOlwiICsgc2Vjb25kCgogICAgd2lsbCBtYXRjaCBgYFwiMToxXCJgYCwgYnV0IG5vdCBgYFwiMToyXCJgYC4gIEJlY2F1c2UgdGhpcwogICAgbWF0Y2hlcyBieSBleHByZXNzaW9ucywgd2lsbCAqbm90KiBtYXRjaCB0aGUgbGVhZGluZyBgYFwiMToxXCJgYAogICAgaW4gYGBcIjE6MTBcImBgOyB0aGUgZXhwcmVzc2lvbnMgYXJlIGV2YWx1YXRlZCBmaXJzdCwgYW5kIHRoZW4KICAgIGNvbXBhcmVkLCBzbyBgYFwiMVwiYGAgaXMgY29tcGFyZWQgd2l0aCBgYFwiMTBcImBgLiBEbyAqbm90KiB1c2UKICAgIHdpdGggcGFja3JhdCBwYXJzaW5nIGVuYWJsZWQuCiAgICBcIlwiXCIKICAgIHJlcCA9IEZvcndhcmQoKQogICAgZTIgPSBleHByLmNvcHkoKQogICAgcmVwIDw8PSBlMgoKICAgIGRlZiBjb3B5X3Rva2VuX3RvX3JlcGVhdGVyKHMsIGwsIHQpOgogICAgICAgIG1hdGNoVG9rZW5zID0gX2ZsYXR0ZW4odC5hc19saXN0KCkpCgogICAgICAgIGRlZiBtdXN0X21hdGNoX3RoZXNlX3Rva2VucyhzLCBsLCB0KToKICAgICAgICAgICAgdGhlc2VUb2tlbnMgPSBfZmxhdHRlbih0LmFzX2xpc3QoKSkKICAgICAgICAgICAgaWYgdGhlc2VUb2tlbnMgIT0gbWF0Y2hUb2tlbnM6CiAgICAgICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICBzLCBsLCBcIkV4cGVjdGVkIHt9LCBmb3VuZHt9XCIuZm9ybWF0KG1hdGNoVG9rZW5zLCB0aGVzZVRva2VucykKICAgICAgICAgICAgICAgICkKCiAgICAgICAgcmVwLnNldF9wYXJzZV9hY3Rpb24obXVzdF9tYXRjaF90aGVzZV90b2tlbnMsIGNhbGxEdXJpbmdUcnk9VHJ1ZSkKCiAgICBleHByLmFkZF9wYXJzZV9hY3Rpb24oY29weV90b2tlbl90b19yZXBlYXRlciwgY2FsbER1cmluZ1RyeT1UcnVlKQogICAgcmVwLnNldF9uYW1lKFwiKHByZXYpIFwiICsgc3RyKGV4cHIpKQogICAgcmV0dXJuIHJlcAoKCmRlZiBvbmVfb2YoCiAgICBzdHJzOiBVbmlvblt0eXBpbmcuSXRlcmFibGVbc3RyXSwgc3RyXSwKICAgIGNhc2VsZXNzOiBib29sID0gRmFsc2UsCiAgICB1c2VfcmVnZXg6IGJvb2wgPSBUcnVlLAogICAgYXNfa2V5d29yZDogYm9vbCA9IEZhbHNlLAogICAgKiwKICAgIHVzZVJlZ2V4OiBib29sID0gVHJ1ZSwKICAgIGFzS2V5d29yZDogYm9vbCA9IEZhbHNlLAopIC0+IFBhcnNlckVsZW1lbnQ6CiAgICBcIlwiXCJIZWxwZXIgdG8gcXVpY2tseSBkZWZpbmUgYSBzZXQgb2YgYWx0ZXJuYXRpdmUgOmNsYXNzOmBMaXRlcmFsYCBzLAogICAgYW5kIG1ha2VzIHN1cmUgdG8gZG8gbG9uZ2VzdC1maXJzdCB0ZXN0aW5nIHdoZW4gdGhlcmUgaXMgYSBjb25mbGljdCwKICAgIHJlZ2FyZGxlc3Mgb2YgdGhlIGlucHV0IG9yZGVyLCBidXQgcmV0dXJucwogICAgYSA6Y2xhc3M6YE1hdGNoRmlyc3RgIGZvciBiZXN0IHBlcmZvcm1hbmNlLgoKICAgIFBhcmFtZXRlcnM6CgogICAgLSBgYHN0cnNgYCAtIGEgc3RyaW5nIG9mIHNwYWNlLWRlbGltaXRlZCBsaXRlcmFscywgb3IgYSBjb2xsZWN0aW9uIG9mCiAgICAgIHN0cmluZyBsaXRlcmFscwogICAgLSBgYGNhc2VsZXNzYGAgLSB0cmVhdCBhbGwgbGl0ZXJhbHMgYXMgY2FzZWxlc3MgLSAoZGVmYXVsdD0gYGBGYWxzZWBgKQogICAgLSBgYHVzZV9yZWdleGBgIC0gYXMgYW4gb3B0aW1pemF0aW9uLCB3aWxsCiAgICAgIGdlbmVyYXRlIGEgOmNsYXNzOmBSZWdleGAgb2JqZWN0OyBvdGhlcndpc2UsIHdpbGwgZ2VuZXJhdGUKICAgICAgYSA6Y2xhc3M6YE1hdGNoRmlyc3RgIG9iamVjdCAoaWYgYGBjYXNlbGVzcz1UcnVlYGAgb3IgYGBhc0tleXdvcmQ9VHJ1ZWBgLCBvciBpZgogICAgICBjcmVhdGluZyBhIDpjbGFzczpgUmVnZXhgIHJhaXNlcyBhbiBleGNlcHRpb24pIC0gKGRlZmF1bHQ9IGBgVHJ1ZWBgKQogICAgLSBgYGFzX2tleXdvcmRgYCAtIGVuZm9yY2UgOmNsYXNzOmBLZXl3b3JkYC1zdHlsZSBtYXRjaGluZyBvbiB0aGUKICAgICAgZ2VuZXJhdGVkIGV4cHJlc3Npb25zIC0gKGRlZmF1bHQ9IGBgRmFsc2VgYCkKICAgIC0gYGBhc0tleXdvcmRgYCBhbmQgYGB1c2VSZWdleGBgIGFyZSByZXRhaW5lZCBmb3IgcHJlLVBFUDggY29tcGF0aWJpbGl0eSwKICAgICAgYnV0IHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSByZWxlYXNlCgogICAgRXhhbXBsZTo6CgogICAgICAgIGNvbXBfb3BlciA9IG9uZV9vZihcIjwgPSA+IDw9ID49ICE9XCIpCiAgICAgICAgdmFyID0gV29yZChhbHBoYXMpCiAgICAgICAgbnVtYmVyID0gV29yZChudW1zKQogICAgICAgIHRlcm0gPSB2YXIgfCBudW1iZXIKICAgICAgICBjb21wYXJpc29uX2V4cHIgPSB0ZXJtICsgY29tcF9vcGVyICsgdGVybQogICAgICAgIHByaW50KGNvbXBhcmlzb25fZXhwci5zZWFyY2hfc3RyaW5nKFwiQiA9IDEyICBBQT0yMyBCPD1BQSBBQT4xMlwiKSkKCiAgICBwcmludHM6OgoKICAgICAgICBbWydCJywgJz0nLCAnMTInXSwgWydBQScsICc9JywgJzIzJ10sIFsnQicsICc8PScsICdBQSddLCBbJ0FBJywgJz4nLCAnMTInXV0KICAgIFwiXCJcIgogICAgYXNLZXl3b3JkID0gYXNLZXl3b3JkIG9yIGFzX2tleXdvcmQKICAgIHVzZVJlZ2V4ID0gdXNlUmVnZXggYW5kIHVzZV9yZWdleAoKICAgIGlmICgKICAgICAgICBpc2luc3RhbmNlKGNhc2VsZXNzLCBzdHJfdHlwZSkKICAgICAgICBhbmQgX19kaWFnX18ud2Fybl9vbl9tdWx0aXBsZV9zdHJpbmdfYXJnc190b19vbmVvZgogICAgKToKICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICBcIk1vcmUgdGhhbiBvbmUgc3RyaW5nIGFyZ3VtZW50IHBhc3NlZCB0byBvbmVfb2YsIHBhc3NcIgogICAgICAgICAgICBcIiBjaG9pY2VzIGFzIGEgbGlzdCBvciBzcGFjZS1kZWxpbWl0ZWQgc3RyaW5nXCIsCiAgICAgICAgICAgIHN0YWNrbGV2ZWw9MiwKICAgICAgICApCgogICAgaWYgY2FzZWxlc3M6CiAgICAgICAgaXNlcXVhbCA9IGxhbWJkYSBhLCBiOiBhLnVwcGVyKCkgPT0gYi51cHBlcigpCiAgICAgICAgbWFza3MgPSBsYW1iZGEgYSwgYjogYi51cHBlcigpLnN0YXJ0c3dpdGgoYS51cHBlcigpKQogICAgICAgIHBhcnNlRWxlbWVudENsYXNzID0gQ2FzZWxlc3NLZXl3b3JkIGlmIGFzS2V5d29yZCBlbHNlIENhc2VsZXNzTGl0ZXJhbAogICAgZWxzZToKICAgICAgICBpc2VxdWFsID0gbGFtYmRhIGEsIGI6IGEgPT0gYgogICAgICAgIG1hc2tzID0gbGFtYmRhIGEsIGI6IGIuc3RhcnRzd2l0aChhKQogICAgICAgIHBhcnNlRWxlbWVudENsYXNzID0gS2V5d29yZCBpZiBhc0tleXdvcmQgZWxzZSBMaXRlcmFsCgogICAgc3ltYm9sczogTGlzdFtzdHJdID0gW10KICAgIGlmIGlzaW5zdGFuY2Uoc3Rycywgc3RyX3R5cGUpOgogICAgICAgIHN5bWJvbHMgPSBzdHJzLnNwbGl0KCkKICAgIGVsaWYgaXNpbnN0YW5jZShzdHJzLCBJdGVyYWJsZSk6CiAgICAgICAgc3ltYm9scyA9IGxpc3Qoc3RycykKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKFwiSW52YWxpZCBhcmd1bWVudCB0byBvbmVfb2YsIGV4cGVjdGVkIHN0cmluZyBvciBpdGVyYWJsZVwiKQogICAgaWYgbm90IHN5bWJvbHM6CiAgICAgICAgcmV0dXJuIE5vTWF0Y2goKQoKICAgICMgcmVvcmRlciBnaXZlbiBzeW1ib2xzIHRvIHRha2UgY2FyZSB0byBhdm9pZCBtYXNraW5nIGxvbmdlciBjaG9pY2VzIHdpdGggc2hvcnRlciBvbmVzCiAgICAjIChidXQgb25seSBpZiB0aGUgZ2l2ZW4gc3ltYm9scyBhcmUgbm90IGp1c3Qgc2luZ2xlIGNoYXJhY3RlcnMpCiAgICBpZiBhbnkobGVuKHN5bSkgPiAxIGZvciBzeW0gaW4gc3ltYm9scyk6CiAgICAgICAgaSA9IDAKICAgICAgICB3aGlsZSBpIDwgbGVuKHN5bWJvbHMpIC0gMToKICAgICAgICAgICAgY3VyID0gc3ltYm9sc1tpXQogICAgICAgICAgICBmb3Igaiwgb3RoZXIgaW4gZW51bWVyYXRlKHN5bWJvbHNbaSArIDEgOl0pOgogICAgICAgICAgICAgICAgaWYgaXNlcXVhbChvdGhlciwgY3VyKToKICAgICAgICAgICAgICAgICAgICBkZWwgc3ltYm9sc1tpICsgaiArIDFdCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsaWYgbWFza3MoY3VyLCBvdGhlcik6CiAgICAgICAgICAgICAgICAgICAgZGVsIHN5bWJvbHNbaSArIGogKyAxXQogICAgICAgICAgICAgICAgICAgIHN5bWJvbHMuaW5zZXJ0KGksIG90aGVyKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpICs9IDEKCiAgICBpZiB1c2VSZWdleDoKICAgICAgICByZV9mbGFnczogaW50ID0gcmUuSUdOT1JFQ0FTRSBpZiBjYXNlbGVzcyBlbHNlIDAKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBhbGwobGVuKHN5bSkgPT0gMSBmb3Igc3ltIGluIHN5bWJvbHMpOgogICAgICAgICAgICAgICAgIyBzeW1ib2xzIGFyZSBqdXN0IHNpbmdsZSBjaGFyYWN0ZXJzLCBjcmVhdGUgcmFuZ2UgcmVnZXggcGF0dGVybgogICAgICAgICAgICAgICAgcGF0dCA9IFwiW3t9XVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBcIlwiLmpvaW4oX2VzY2FwZV9yZWdleF9yYW5nZV9jaGFycyhzeW0pIGZvciBzeW0gaW4gc3ltYm9scykKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBhdHQgPSBcInxcIi5qb2luKHJlLmVzY2FwZShzeW0pIGZvciBzeW0gaW4gc3ltYm9scykKCiAgICAgICAgICAgICMgd3JhcCB3aXRoIFxcYiB3b3JkIGJyZWFrIG1hcmtlcnMgaWYgZGVmaW5pbmcgYXMga2V5d29yZHMKICAgICAgICAgICAgaWYgYXNLZXl3b3JkOgogICAgICAgICAgICAgICAgcGF0dCA9IHJcIlxcYig/Ont9KVxcYlwiLmZvcm1hdChwYXR0KQoKICAgICAgICAgICAgcmV0ID0gUmVnZXgocGF0dCwgZmxhZ3M9cmVfZmxhZ3MpLnNldF9uYW1lKFwiIHwgXCIuam9pbihzeW1ib2xzKSkKCiAgICAgICAgICAgIGlmIGNhc2VsZXNzOgogICAgICAgICAgICAgICAgIyBhZGQgcGFyc2UgYWN0aW9uIHRvIHJldHVybiBzeW1ib2xzIGFzIHNwZWNpZmllZCwgbm90IGluIHJhbmRvbQogICAgICAgICAgICAgICAgIyBjYXNpbmcgYXMgZm91bmQgaW4gaW5wdXQgc3RyaW5nCiAgICAgICAgICAgICAgICBzeW1ib2xfbWFwID0ge3N5bS5sb3dlcigpOiBzeW0gZm9yIHN5bSBpbiBzeW1ib2xzfQogICAgICAgICAgICAgICAgcmV0LmFkZF9wYXJzZV9hY3Rpb24obGFtYmRhIHMsIGwsIHQ6IHN5bWJvbF9tYXBbdFswXS5sb3dlcigpXSkKCiAgICAgICAgICAgIHJldHVybiByZXQKCiAgICAgICAgZXhjZXB0IHJlLmVycm9yOgogICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgXCJFeGNlcHRpb24gY3JlYXRpbmcgUmVnZXggZm9yIG9uZV9vZiwgYnVpbGRpbmcgTWF0Y2hGaXJzdFwiLCBzdGFja2xldmVsPTIKICAgICAgICAgICAgKQoKICAgICMgbGFzdCByZXNvcnQsIGp1c3QgdXNlIE1hdGNoRmlyc3QKICAgIHJldHVybiBNYXRjaEZpcnN0KHBhcnNlRWxlbWVudENsYXNzKHN5bSkgZm9yIHN5bSBpbiBzeW1ib2xzKS5zZXRfbmFtZSgKICAgICAgICBcIiB8IFwiLmpvaW4oc3ltYm9scykKICAgICkKCgpkZWYgZGljdF9vZihrZXk6IFBhcnNlckVsZW1lbnQsIHZhbHVlOiBQYXJzZXJFbGVtZW50KSAtPiBQYXJzZXJFbGVtZW50OgogICAgXCJcIlwiSGVscGVyIHRvIGVhc2lseSBhbmQgY2xlYXJseSBkZWZpbmUgYSBkaWN0aW9uYXJ5IGJ5IHNwZWNpZnlpbmcKICAgIHRoZSByZXNwZWN0aXZlIHBhdHRlcm5zIGZvciB0aGUga2V5IGFuZCB2YWx1ZS4gIFRha2VzIGNhcmUgb2YKICAgIGRlZmluaW5nIHRoZSA6Y2xhc3M6YERpY3RgLCA6Y2xhc3M6YFplcm9Pck1vcmVgLCBhbmQKICAgIDpjbGFzczpgR3JvdXBgIHRva2VucyBpbiB0aGUgcHJvcGVyIG9yZGVyLiAgVGhlIGtleSBwYXR0ZXJuCiAgICBjYW4gaW5jbHVkZSBkZWxpbWl0aW5nIG1hcmtlcnMgb3IgcHVuY3R1YXRpb24sIGFzIGxvbmcgYXMgdGhleSBhcmUKICAgIHN1cHByZXNzZWQsIHRoZXJlYnkgbGVhdmluZyB0aGUgc2lnbmlmaWNhbnQga2V5IHRleHQuICBUaGUgdmFsdWUKICAgIHBhdHRlcm4gY2FuIGluY2x1ZGUgbmFtZWQgcmVzdWx0cywgc28gdGhhdCB0aGUgOmNsYXNzOmBEaWN0YCByZXN1bHRzCiAgICBjYW4gaW5jbHVkZSBuYW1lZCB0b2tlbiBmaWVsZHMuCgogICAgRXhhbXBsZTo6CgogICAgICAgIHRleHQgPSBcInNoYXBlOiBTUVVBUkUgcG9zbjogdXBwZXIgbGVmdCBjb2xvcjogbGlnaHQgYmx1ZSB0ZXh0dXJlOiBidXJsYXBcIgogICAgICAgIGF0dHJfZXhwciA9IChsYWJlbCArIFN1cHByZXNzKCc6JykgKyBPbmVPck1vcmUoZGF0YV93b3JkLCBzdG9wX29uPWxhYmVsKS5zZXRfcGFyc2VfYWN0aW9uKCcgJy5qb2luKSkKICAgICAgICBwcmludChhdHRyX2V4cHJbMSwgLi4uXS5wYXJzZV9zdHJpbmcodGV4dCkuZHVtcCgpKQoKICAgICAgICBhdHRyX2xhYmVsID0gbGFiZWwKICAgICAgICBhdHRyX3ZhbHVlID0gU3VwcHJlc3MoJzonKSArIE9uZU9yTW9yZShkYXRhX3dvcmQsIHN0b3Bfb249bGFiZWwpLnNldF9wYXJzZV9hY3Rpb24oJyAnLmpvaW4pCgogICAgICAgICMgc2ltaWxhciB0byBEaWN0LCBidXQgc2ltcGxlciBjYWxsIGZvcm1hdAogICAgICAgIHJlc3VsdCA9IGRpY3Rfb2YoYXR0cl9sYWJlbCwgYXR0cl92YWx1ZSkucGFyc2Vfc3RyaW5nKHRleHQpCiAgICAgICAgcHJpbnQocmVzdWx0LmR1bXAoKSkKICAgICAgICBwcmludChyZXN1bHRbJ3NoYXBlJ10pCiAgICAgICAgcHJpbnQocmVzdWx0LnNoYXBlKSAgIyBvYmplY3QgYXR0cmlidXRlIGFjY2VzcyB3b3JrcyB0b28KICAgICAgICBwcmludChyZXN1bHQuYXNfZGljdCgpKQoKICAgIHByaW50czo6CgogICAgICAgIFtbJ3NoYXBlJywgJ1NRVUFSRSddLCBbJ3Bvc24nLCAndXBwZXIgbGVmdCddLCBbJ2NvbG9yJywgJ2xpZ2h0IGJsdWUnXSwgWyd0ZXh0dXJlJywgJ2J1cmxhcCddXQogICAgICAgIC0gY29sb3I6ICdsaWdodCBibHVlJwogICAgICAgIC0gcG9zbjogJ3VwcGVyIGxlZnQnCiAgICAgICAgLSBzaGFwZTogJ1NRVUFSRScKICAgICAgICAtIHRleHR1cmU6ICdidXJsYXAnCiAgICAgICAgU1FVQVJFCiAgICAgICAgU1FVQVJFCiAgICAgICAgeydjb2xvcic6ICdsaWdodCBibHVlJywgJ3NoYXBlJzogJ1NRVUFSRScsICdwb3NuJzogJ3VwcGVyIGxlZnQnLCAndGV4dHVyZSc6ICdidXJsYXAnfQogICAgXCJcIlwiCiAgICByZXR1cm4gRGljdChPbmVPck1vcmUoR3JvdXAoa2V5ICsgdmFsdWUpKSkKCgpkZWYgb3JpZ2luYWxfdGV4dF9mb3IoCiAgICBleHByOiBQYXJzZXJFbGVtZW50LCBhc19zdHJpbmc6IGJvb2wgPSBUcnVlLCAqLCBhc1N0cmluZzogYm9vbCA9IFRydWUKKSAtPiBQYXJzZXJFbGVtZW50OgogICAgXCJcIlwiSGVscGVyIHRvIHJldHVybiB0aGUgb3JpZ2luYWwsIHVudG9rZW5pemVkIHRleHQgZm9yIGEgZ2l2ZW4KICAgIGV4cHJlc3Npb24uICBVc2VmdWwgdG8gcmVzdG9yZSB0aGUgcGFyc2VkIGZpZWxkcyBvZiBhbiBIVE1MIHN0YXJ0CiAgICB0YWcgaW50byB0aGUgcmF3IHRhZyB0ZXh0IGl0c2VsZiwgb3IgdG8gcmV2ZXJ0IHNlcGFyYXRlIHRva2VucyB3aXRoCiAgICBpbnRlcnZlbmluZyB3aGl0ZXNwYWNlIGJhY2sgdG8gdGhlIG9yaWdpbmFsIG1hdGNoaW5nIGlucHV0IHRleHQuIEJ5CiAgICBkZWZhdWx0LCByZXR1cm5zIGFzdHJpbmcgY29udGFpbmluZyB0aGUgb3JpZ2luYWwgcGFyc2VkIHRleHQuCgogICAgSWYgdGhlIG9wdGlvbmFsIGBgYXNfc3RyaW5nYGAgYXJndW1lbnQgaXMgcGFzc2VkIGFzCiAgICBgYEZhbHNlYGAsIHRoZW4gdGhlIHJldHVybiB2YWx1ZSBpcwogICAgYSA6Y2xhc3M6YFBhcnNlUmVzdWx0c2AgY29udGFpbmluZyBhbnkgcmVzdWx0cyBuYW1lcyB0aGF0CiAgICB3ZXJlIG9yaWdpbmFsbHkgbWF0Y2hlZCwgYW5kIGEgc2luZ2xlIHRva2VuIGNvbnRhaW5pbmcgdGhlIG9yaWdpbmFsCiAgICBtYXRjaGVkIHRleHQgZnJvbSB0aGUgaW5wdXQgc3RyaW5nLiAgU28gaWYgdGhlIGV4cHJlc3Npb24gcGFzc2VkIHRvCiAgICA6Y2xhc3M6YG9yaWdpbmFsX3RleHRfZm9yYCBjb250YWlucyBleHByZXNzaW9ucyB3aXRoIGRlZmluZWQKICAgIHJlc3VsdHMgbmFtZXMsIHlvdSBtdXN0IHNldCBgYGFzX3N0cmluZ2BgIHRvIGBgRmFsc2VgYCBpZiB5b3UKICAgIHdhbnQgdG8gcHJlc2VydmUgdGhvc2UgcmVzdWx0cyBuYW1lIHZhbHVlcy4KCiAgICBUaGUgYGBhc1N0cmluZ2BgIHByZS1QRVA4IGFyZ3VtZW50IGlzIHJldGFpbmVkIGZvciBjb21wYXRpYmlsaXR5LAogICAgYnV0IHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSByZWxlYXNlLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBzcmMgPSBcInRoaXMgaXMgdGVzdCA8Yj4gYm9sZCA8aT50ZXh0PC9pPiA8L2I+IG5vcm1hbCB0ZXh0IFwiCiAgICAgICAgZm9yIHRhZyBpbiAoXCJiXCIsIFwiaVwiKToKICAgICAgICAgICAgb3BlbmVyLCBjbG9zZXIgPSBtYWtlX2h0bWxfdGFncyh0YWcpCiAgICAgICAgICAgIHBhdHQgPSBvcmlnaW5hbF90ZXh0X2ZvcihvcGVuZXIgKyBTa2lwVG8oY2xvc2VyKSArIGNsb3NlcikKICAgICAgICAgICAgcHJpbnQocGF0dC5zZWFyY2hfc3RyaW5nKHNyYylbMF0pCgogICAgcHJpbnRzOjoKCiAgICAgICAgWyc8Yj4gYm9sZCA8aT50ZXh0PC9pPiA8L2I+J10KICAgICAgICBbJzxpPnRleHQ8L2k+J10KICAgIFwiXCJcIgogICAgYXNTdHJpbmcgPSBhc1N0cmluZyBhbmQgYXNfc3RyaW5nCgogICAgbG9jTWFya2VyID0gRW1wdHkoKS5zZXRfcGFyc2VfYWN0aW9uKGxhbWJkYSBzLCBsb2MsIHQ6IGxvYykKICAgIGVuZGxvY01hcmtlciA9IGxvY01hcmtlci5jb3B5KCkKICAgIGVuZGxvY01hcmtlci5jYWxsUHJlcGFyc2UgPSBGYWxzZQogICAgbWF0Y2hFeHByID0gbG9jTWFya2VyKFwiX29yaWdpbmFsX3N0YXJ0XCIpICsgZXhwciArIGVuZGxvY01hcmtlcihcIl9vcmlnaW5hbF9lbmRcIikKICAgIGlmIGFzU3RyaW5nOgogICAgICAgIGV4dHJhY3RUZXh0ID0gbGFtYmRhIHMsIGwsIHQ6IHNbdC5fb3JpZ2luYWxfc3RhcnQgOiB0Ll9vcmlnaW5hbF9lbmRdCiAgICBlbHNlOgoKICAgICAgICBkZWYgZXh0cmFjdFRleHQocywgbCwgdCk6CiAgICAgICAgICAgIHRbOl0gPSBbc1t0LnBvcChcIl9vcmlnaW5hbF9zdGFydFwiKSA6IHQucG9wKFwiX29yaWdpbmFsX2VuZFwiKV1dCgogICAgbWF0Y2hFeHByLnNldF9wYXJzZV9hY3Rpb24oZXh0cmFjdFRleHQpCiAgICBtYXRjaEV4cHIuaWdub3JlRXhwcnMgPSBleHByLmlnbm9yZUV4cHJzCiAgICBtYXRjaEV4cHIuc3VwcHJlc3Nfd2FybmluZyhEaWFnbm9zdGljcy53YXJuX3VuZ3JvdXBlZF9uYW1lZF90b2tlbnNfaW5fY29sbGVjdGlvbikKICAgIHJldHVybiBtYXRjaEV4cHIKCgpkZWYgdW5ncm91cChleHByOiBQYXJzZXJFbGVtZW50KSAtPiBQYXJzZXJFbGVtZW50OgogICAgXCJcIlwiSGVscGVyIHRvIHVuZG8gcHlwYXJzaW5nJ3MgZGVmYXVsdCBncm91cGluZyBvZiBBbmQgZXhwcmVzc2lvbnMsCiAgICBldmVuIGlmIGFsbCBidXQgb25lIGFyZSBub24tZW1wdHkuCiAgICBcIlwiXCIKICAgIHJldHVybiBUb2tlbkNvbnZlcnRlcihleHByKS5hZGRfcGFyc2VfYWN0aW9uKGxhbWJkYSB0OiB0WzBdKQoKCmRlZiBsb2NhdGVkRXhwcihleHByOiBQYXJzZXJFbGVtZW50KSAtPiBQYXJzZXJFbGVtZW50OgogICAgXCJcIlwiCiAgICAoREVQUkVDQVRFRCAtIGZ1dHVyZSBjb2RlIHNob3VsZCB1c2UgdGhlIExvY2F0ZWQgY2xhc3MpCiAgICBIZWxwZXIgdG8gZGVjb3JhdGUgYSByZXR1cm5lZCB0b2tlbiB3aXRoIGl0cyBzdGFydGluZyBhbmQgZW5kaW5nCiAgICBsb2NhdGlvbnMgaW4gdGhlIGlucHV0IHN0cmluZy4KCiAgICBUaGlzIGhlbHBlciBhZGRzIHRoZSBmb2xsb3dpbmcgcmVzdWx0cyBuYW1lczoKCiAgICAtIGBgbG9jbl9zdGFydGBgIC0gbG9jYXRpb24gd2hlcmUgbWF0Y2hlZCBleHByZXNzaW9uIGJlZ2lucwogICAgLSBgYGxvY25fZW5kYGAgLSBsb2NhdGlvbiB3aGVyZSBtYXRjaGVkIGV4cHJlc3Npb24gZW5kcwogICAgLSBgYHZhbHVlYGAgLSB0aGUgYWN0dWFsIHBhcnNlZCByZXN1bHRzCgogICAgQmUgY2FyZWZ1bCBpZiB0aGUgaW5wdXQgdGV4dCBjb250YWlucyBgYDxUQUI+YGAgY2hhcmFjdGVycywgeW91CiAgICBtYXkgd2FudCB0byBjYWxsIDpjbGFzczpgUGFyc2VyRWxlbWVudC5wYXJzZVdpdGhUYWJzYAoKICAgIEV4YW1wbGU6OgoKICAgICAgICB3ZCA9IFdvcmQoYWxwaGFzKQogICAgICAgIGZvciBtYXRjaCBpbiBsb2NhdGVkRXhwcih3ZCkuc2VhcmNoU3RyaW5nKFwibGpzZGYxMjNsa3NkampmMTIzbGtramoxMjIyXCIpOgogICAgICAgICAgICBwcmludChtYXRjaCkKCiAgICBwcmludHM6OgoKICAgICAgICBbWzAsICdsanNkZicsIDVdXQogICAgICAgIFtbOCwgJ2xrc2RqamYnLCAxNV1dCiAgICAgICAgW1sxOCwgJ2xra2pqJywgMjNdXQogICAgXCJcIlwiCiAgICBsb2NhdG9yID0gRW1wdHkoKS5zZXRfcGFyc2VfYWN0aW9uKGxhbWJkYSBzcywgbGwsIHR0OiBsbCkKICAgIHJldHVybiBHcm91cCgKICAgICAgICBsb2NhdG9yKFwibG9jbl9zdGFydFwiKQogICAgICAgICsgZXhwcihcInZhbHVlXCIpCiAgICAgICAgKyBsb2NhdG9yLmNvcHkoKS5sZWF2ZVdoaXRlc3BhY2UoKShcImxvY25fZW5kXCIpCiAgICApCgoKZGVmIG5lc3RlZF9leHByKAogICAgb3BlbmVyOiBVbmlvbltzdHIsIFBhcnNlckVsZW1lbnRdID0gXCIoXCIsCiAgICBjbG9zZXI6IFVuaW9uW3N0ciwgUGFyc2VyRWxlbWVudF0gPSBcIilcIiwKICAgIGNvbnRlbnQ6IHR5cGluZy5PcHRpb25hbFtQYXJzZXJFbGVtZW50XSA9IE5vbmUsCiAgICBpZ25vcmVfZXhwcjogUGFyc2VyRWxlbWVudCA9IHF1b3RlZF9zdHJpbmcoKSwKICAgICosCiAgICBpZ25vcmVFeHByOiBQYXJzZXJFbGVtZW50ID0gcXVvdGVkX3N0cmluZygpLAopIC0+IFBhcnNlckVsZW1lbnQ6CiAgICBcIlwiXCJIZWxwZXIgbWV0aG9kIGZvciBkZWZpbmluZyBuZXN0ZWQgbGlzdHMgZW5jbG9zZWQgaW4gb3BlbmluZyBhbmQKICAgIGNsb3NpbmcgZGVsaW1pdGVycyAoYGBcIihcImBgIGFuZCBgYFwiKVwiYGAgYXJlIHRoZSBkZWZhdWx0KS4KCiAgICBQYXJhbWV0ZXJzOgogICAgLSBgYG9wZW5lcmBgIC0gb3BlbmluZyBjaGFyYWN0ZXIgZm9yIGEgbmVzdGVkIGxpc3QKICAgICAgKGRlZmF1bHQ9IGBgXCIoXCJgYCk7IGNhbiBhbHNvIGJlIGEgcHlwYXJzaW5nIGV4cHJlc3Npb24KICAgIC0gYGBjbG9zZXJgYCAtIGNsb3NpbmcgY2hhcmFjdGVyIGZvciBhIG5lc3RlZCBsaXN0CiAgICAgIChkZWZhdWx0PSBgYFwiKVwiYGApOyBjYW4gYWxzbyBiZSBhIHB5cGFyc2luZyBleHByZXNzaW9uCiAgICAtIGBgY29udGVudGBgIC0gZXhwcmVzc2lvbiBmb3IgaXRlbXMgd2l0aGluIHRoZSBuZXN0ZWQgbGlzdHMKICAgICAgKGRlZmF1bHQ9IGBgTm9uZWBgKQogICAgLSBgYGlnbm9yZV9leHByYGAgLSBleHByZXNzaW9uIGZvciBpZ25vcmluZyBvcGVuaW5nIGFuZCBjbG9zaW5nIGRlbGltaXRlcnMKICAgICAgKGRlZmF1bHQ9IDpjbGFzczpgcXVvdGVkX3N0cmluZ2ApCiAgICAtIGBgaWdub3JlRXhwcmBgIC0gdGhpcyBwcmUtUEVQOCBhcmd1bWVudCBpcyByZXRhaW5lZCBmb3IgY29tcGF0aWJpbGl0eQogICAgICBidXQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHJlbGVhc2UKCiAgICBJZiBhbiBleHByZXNzaW9uIGlzIG5vdCBwcm92aWRlZCBmb3IgdGhlIGNvbnRlbnQgYXJndW1lbnQsIHRoZQogICAgbmVzdGVkIGV4cHJlc3Npb24gd2lsbCBjYXB0dXJlIGFsbCB3aGl0ZXNwYWNlLWRlbGltaXRlZCBjb250ZW50CiAgICBiZXR3ZWVuIGRlbGltaXRlcnMgYXMgYSBsaXN0IG9mIHNlcGFyYXRlIHZhbHVlcy4KCiAgICBVc2UgdGhlIGBgaWdub3JlX2V4cHJgYCBhcmd1bWVudCB0byBkZWZpbmUgZXhwcmVzc2lvbnMgdGhhdCBtYXkKICAgIGNvbnRhaW4gb3BlbmluZyBvciBjbG9zaW5nIGNoYXJhY3RlcnMgdGhhdCBzaG91bGQgbm90IGJlIHRyZWF0ZWQgYXMKICAgIG9wZW5pbmcgb3IgY2xvc2luZyBjaGFyYWN0ZXJzIGZvciBuZXN0aW5nLCBzdWNoIGFzIHF1b3RlZF9zdHJpbmcgb3IKICAgIGEgY29tbWVudCBleHByZXNzaW9uLiAgU3BlY2lmeSBtdWx0aXBsZSBleHByZXNzaW9ucyB1c2luZyBhbgogICAgOmNsYXNzOmBPcmAgb3IgOmNsYXNzOmBNYXRjaEZpcnN0YC4gVGhlIGRlZmF1bHQgaXMKICAgIDpjbGFzczpgcXVvdGVkX3N0cmluZ2AsIGJ1dCBpZiBubyBleHByZXNzaW9ucyBhcmUgdG8gYmUgaWdub3JlZCwgdGhlbgogICAgcGFzcyBgYE5vbmVgYCBmb3IgdGhpcyBhcmd1bWVudC4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgZGF0YV90eXBlID0gb25lX29mKFwidm9pZCBpbnQgc2hvcnQgbG9uZyBjaGFyIGZsb2F0IGRvdWJsZVwiKQogICAgICAgIGRlY2xfZGF0YV90eXBlID0gQ29tYmluZShkYXRhX3R5cGUgKyBPcHQoV29yZCgnKicpKSkKICAgICAgICBpZGVudCA9IFdvcmQoYWxwaGFzKydfJywgYWxwaGFudW1zKydfJykKICAgICAgICBudW1iZXIgPSBweXBhcnNpbmdfY29tbW9uLm51bWJlcgogICAgICAgIGFyZyA9IEdyb3VwKGRlY2xfZGF0YV90eXBlICsgaWRlbnQpCiAgICAgICAgTFBBUiwgUlBBUiA9IG1hcChTdXBwcmVzcywgXCIoKVwiKQoKICAgICAgICBjb2RlX2JvZHkgPSBuZXN0ZWRfZXhwcigneycsICd9JywgaWdub3JlX2V4cHI9KHF1b3RlZF9zdHJpbmcgfCBjX3N0eWxlX2NvbW1lbnQpKQoKICAgICAgICBjX2Z1bmN0aW9uID0gKGRlY2xfZGF0YV90eXBlKFwidHlwZVwiKQogICAgICAgICAgICAgICAgICAgICAgKyBpZGVudChcIm5hbWVcIikKICAgICAgICAgICAgICAgICAgICAgICsgTFBBUiArIE9wdChkZWxpbWl0ZWRfbGlzdChhcmcpLCBbXSkoXCJhcmdzXCIpICsgUlBBUgogICAgICAgICAgICAgICAgICAgICAgKyBjb2RlX2JvZHkoXCJib2R5XCIpKQogICAgICAgIGNfZnVuY3Rpb24uaWdub3JlKGNfc3R5bGVfY29tbWVudCkKCiAgICAgICAgc291cmNlX2NvZGUgPSAnJycKICAgICAgICAgICAgaW50IGlzX29kZChpbnQgeCkgewogICAgICAgICAgICAgICAgcmV0dXJuICh4JTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpbnQgZGVjX3RvX2hleChjaGFyIGhjaGFyKSB7CiAgICAgICAgICAgICAgICBpZiAoaGNoYXIgPj0gJzAnICYmIGhjaGFyIDw9ICc5JykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAob3JkKGhjaGFyKS1vcmQoJzAnKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoMTArb3JkKGhjaGFyKS1vcmQoJ0EnKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAnJycKICAgICAgICBmb3IgZnVuYyBpbiBjX2Z1bmN0aW9uLnNlYXJjaF9zdHJpbmcoc291cmNlX2NvZGUpOgogICAgICAgICAgICBwcmludChcIiUobmFtZSlzICglKHR5cGUpcykgYXJnczogJShhcmdzKXNcIiAlIGZ1bmMpCgoKICAgIHByaW50czo6CgogICAgICAgIGlzX29kZCAoaW50KSBhcmdzOiBbWydpbnQnLCAneCddXQogICAgICAgIGRlY190b19oZXggKGludCkgYXJnczogW1snY2hhcicsICdoY2hhciddXQogICAgXCJcIlwiCiAgICBpZiBpZ25vcmVFeHByICE9IGlnbm9yZV9leHByOgogICAgICAgIGlnbm9yZUV4cHIgPSBpZ25vcmVfZXhwciBpZiBpZ25vcmVFeHByID09IHF1b3RlZF9zdHJpbmcoKSBlbHNlIGlnbm9yZUV4cHIKICAgIGlmIG9wZW5lciA9PSBjbG9zZXI6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihcIm9wZW5pbmcgYW5kIGNsb3Npbmcgc3RyaW5ncyBjYW5ub3QgYmUgdGhlIHNhbWVcIikKICAgIGlmIGNvbnRlbnQgaXMgTm9uZToKICAgICAgICBpZiBpc2luc3RhbmNlKG9wZW5lciwgc3RyX3R5cGUpIGFuZCBpc2luc3RhbmNlKGNsb3Nlciwgc3RyX3R5cGUpOgogICAgICAgICAgICBpZiBsZW4ob3BlbmVyKSA9PSAxIGFuZCBsZW4oY2xvc2VyKSA9PSAxOgogICAgICAgICAgICAgICAgaWYgaWdub3JlRXhwciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gQ29tYmluZSgKICAgICAgICAgICAgICAgICAgICAgICAgT25lT3JNb3JlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfmlnbm9yZUV4cHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgQ2hhcnNOb3RJbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuZXIgKyBjbG9zZXIgKyBQYXJzZXJFbGVtZW50LkRFRkFVTFRfV0hJVEVfQ0hBUlMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhhY3Q9MSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICkuc2V0X3BhcnNlX2FjdGlvbihsYW1iZGEgdDogdFswXS5zdHJpcCgpKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gZW1wdHkuY29weSgpICsgQ2hhcnNOb3RJbigKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbmVyICsgY2xvc2VyICsgUGFyc2VyRWxlbWVudC5ERUZBVUxUX1dISVRFX0NIQVJTCiAgICAgICAgICAgICAgICAgICAgKS5zZXRfcGFyc2VfYWN0aW9uKGxhbWJkYSB0OiB0WzBdLnN0cmlwKCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBpZ25vcmVFeHByIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBDb21iaW5lKAogICAgICAgICAgICAgICAgICAgICAgICBPbmVPck1vcmUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB+aWdub3JlRXhwcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB+TGl0ZXJhbChvcGVuZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIH5MaXRlcmFsKGNsb3NlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgQ2hhcnNOb3RJbihQYXJzZXJFbGVtZW50LkRFRkFVTFRfV0hJVEVfQ0hBUlMsIGV4YWN0PTEpCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApLnNldF9wYXJzZV9hY3Rpb24obGFtYmRhIHQ6IHRbMF0uc3RyaXAoKSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IENvbWJpbmUoCiAgICAgICAgICAgICAgICAgICAgICAgIE9uZU9yTW9yZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH5MaXRlcmFsKG9wZW5lcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgfkxpdGVyYWwoY2xvc2VyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBDaGFyc05vdEluKFBhcnNlckVsZW1lbnQuREVGQVVMVF9XSElURV9DSEFSUywgZXhhY3Q9MSkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICkuc2V0X3BhcnNlX2FjdGlvbihsYW1iZGEgdDogdFswXS5zdHJpcCgpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICBcIm9wZW5pbmcgYW5kIGNsb3NpbmcgYXJndW1lbnRzIG11c3QgYmUgc3RyaW5ncyBpZiBubyBjb250ZW50IGV4cHJlc3Npb24gaXMgZ2l2ZW5cIgogICAgICAgICAgICApCiAgICByZXQgPSBGb3J3YXJkKCkKICAgIGlmIGlnbm9yZUV4cHIgaXMgbm90IE5vbmU6CiAgICAgICAgcmV0IDw8PSBHcm91cCgKICAgICAgICAgICAgU3VwcHJlc3Mob3BlbmVyKSArIFplcm9Pck1vcmUoaWdub3JlRXhwciB8IHJldCB8IGNvbnRlbnQpICsgU3VwcHJlc3MoY2xvc2VyKQogICAgICAgICkKICAgIGVsc2U6CiAgICAgICAgcmV0IDw8PSBHcm91cChTdXBwcmVzcyhvcGVuZXIpICsgWmVyb09yTW9yZShyZXQgfCBjb250ZW50KSArIFN1cHByZXNzKGNsb3NlcikpCiAgICByZXQuc2V0X25hbWUoXCJuZXN0ZWQgJXMlcyBleHByZXNzaW9uXCIgJSAob3BlbmVyLCBjbG9zZXIpKQogICAgcmV0dXJuIHJldAoKCmRlZiBfbWFrZVRhZ3ModGFnU3RyLCB4bWwsIHN1cHByZXNzX0xUPVN1cHByZXNzKFwiPFwiKSwgc3VwcHJlc3NfR1Q9U3VwcHJlc3MoXCI+XCIpKToKICAgIFwiXCJcIkludGVybmFsIGhlbHBlciB0byBjb25zdHJ1Y3Qgb3BlbmluZyBhbmQgY2xvc2luZyB0YWcgZXhwcmVzc2lvbnMsIGdpdmVuIGEgdGFnIG5hbWVcIlwiXCIKICAgIGlmIGlzaW5zdGFuY2UodGFnU3RyLCBzdHJfdHlwZSk6CiAgICAgICAgcmVzbmFtZSA9IHRhZ1N0cgogICAgICAgIHRhZ1N0ciA9IEtleXdvcmQodGFnU3RyLCBjYXNlbGVzcz1ub3QgeG1sKQogICAgZWxzZToKICAgICAgICByZXNuYW1lID0gdGFnU3RyLm5hbWUKCiAgICB0YWdBdHRyTmFtZSA9IFdvcmQoYWxwaGFzLCBhbHBoYW51bXMgKyBcIl8tOlwiKQogICAgaWYgeG1sOgogICAgICAgIHRhZ0F0dHJWYWx1ZSA9IGRibF9xdW90ZWRfc3RyaW5nLmNvcHkoKS5zZXRfcGFyc2VfYWN0aW9uKHJlbW92ZV9xdW90ZXMpCiAgICAgICAgb3BlblRhZyA9ICgKICAgICAgICAgICAgc3VwcHJlc3NfTFQKICAgICAgICAgICAgKyB0YWdTdHIoXCJ0YWdcIikKICAgICAgICAgICAgKyBEaWN0KFplcm9Pck1vcmUoR3JvdXAodGFnQXR0ck5hbWUgKyBTdXBwcmVzcyhcIj1cIikgKyB0YWdBdHRyVmFsdWUpKSkKICAgICAgICAgICAgKyBPcHQoXCIvXCIsIGRlZmF1bHQ9W0ZhbHNlXSkoXCJlbXB0eVwiKS5zZXRfcGFyc2VfYWN0aW9uKAogICAgICAgICAgICAgICAgbGFtYmRhIHMsIGwsIHQ6IHRbMF0gPT0gXCIvXCIKICAgICAgICAgICAgKQogICAgICAgICAgICArIHN1cHByZXNzX0dUCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICB0YWdBdHRyVmFsdWUgPSBxdW90ZWRfc3RyaW5nLmNvcHkoKS5zZXRfcGFyc2VfYWN0aW9uKHJlbW92ZV9xdW90ZXMpIHwgV29yZCgKICAgICAgICAgICAgcHJpbnRhYmxlcywgZXhjbHVkZV9jaGFycz1cIj5cIgogICAgICAgICkKICAgICAgICBvcGVuVGFnID0gKAogICAgICAgICAgICBzdXBwcmVzc19MVAogICAgICAgICAgICArIHRhZ1N0cihcInRhZ1wiKQogICAgICAgICAgICArIERpY3QoCiAgICAgICAgICAgICAgICBaZXJvT3JNb3JlKAogICAgICAgICAgICAgICAgICAgIEdyb3VwKAogICAgICAgICAgICAgICAgICAgICAgICB0YWdBdHRyTmFtZS5zZXRfcGFyc2VfYWN0aW9uKGxhbWJkYSB0OiB0WzBdLmxvd2VyKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICsgT3B0KFN1cHByZXNzKFwiPVwiKSArIHRhZ0F0dHJWYWx1ZSkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICAgICAgKyBPcHQoXCIvXCIsIGRlZmF1bHQ9W0ZhbHNlXSkoXCJlbXB0eVwiKS5zZXRfcGFyc2VfYWN0aW9uKAogICAgICAgICAgICAgICAgbGFtYmRhIHMsIGwsIHQ6IHRbMF0gPT0gXCIvXCIKICAgICAgICAgICAgKQogICAgICAgICAgICArIHN1cHByZXNzX0dUCiAgICAgICAgKQogICAgY2xvc2VUYWcgPSBDb21iaW5lKExpdGVyYWwoXCI8L1wiKSArIHRhZ1N0ciArIFwiPlwiLCBhZGphY2VudD1GYWxzZSkKCiAgICBvcGVuVGFnLnNldF9uYW1lKFwiPCVzPlwiICUgcmVzbmFtZSkKICAgICMgYWRkIHN0YXJ0PHRhZ25hbWU+IHJlc3VsdHMgbmFtZSBpbiBwYXJzZSBhY3Rpb24gbm93IHRoYXQgdW5ncm91cGVkIG5hbWVzIGFyZSBub3QgcmVwb3J0ZWQgYXQgdHdvIGxldmVscwogICAgb3BlblRhZy5hZGRfcGFyc2VfYWN0aW9uKAogICAgICAgIGxhbWJkYSB0OiB0Ll9fc2V0aXRlbV9fKAogICAgICAgICAgICBcInN0YXJ0XCIgKyBcIlwiLmpvaW4ocmVzbmFtZS5yZXBsYWNlKFwiOlwiLCBcIiBcIikudGl0bGUoKS5zcGxpdCgpKSwgdC5jb3B5KCkKICAgICAgICApCiAgICApCiAgICBjbG9zZVRhZyA9IGNsb3NlVGFnKAogICAgICAgIFwiZW5kXCIgKyBcIlwiLmpvaW4ocmVzbmFtZS5yZXBsYWNlKFwiOlwiLCBcIiBcIikudGl0bGUoKS5zcGxpdCgpKQogICAgKS5zZXRfbmFtZShcIjwvJXM+XCIgJSByZXNuYW1lKQogICAgb3BlblRhZy50YWcgPSByZXNuYW1lCiAgICBjbG9zZVRhZy50YWcgPSByZXNuYW1lCiAgICBvcGVuVGFnLnRhZ19ib2R5ID0gU2tpcFRvKGNsb3NlVGFnKCkpCiAgICByZXR1cm4gb3BlblRhZywgY2xvc2VUYWcKCgpkZWYgbWFrZV9odG1sX3RhZ3MoCiAgICB0YWdfc3RyOiBVbmlvbltzdHIsIFBhcnNlckVsZW1lbnRdCikgLT4gVHVwbGVbUGFyc2VyRWxlbWVudCwgUGFyc2VyRWxlbWVudF06CiAgICBcIlwiXCJIZWxwZXIgdG8gY29uc3RydWN0IG9wZW5pbmcgYW5kIGNsb3NpbmcgdGFnIGV4cHJlc3Npb25zIGZvciBIVE1MLAogICAgZ2l2ZW4gYSB0YWcgbmFtZS4gTWF0Y2hlcyB0YWdzIGluIGVpdGhlciB1cHBlciBvciBsb3dlciBjYXNlLAogICAgYXR0cmlidXRlcyB3aXRoIG5hbWVzcGFjZXMgYW5kIHdpdGggcXVvdGVkIG9yIHVucXVvdGVkIHZhbHVlcy4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgdGV4dCA9ICc8dGQ+TW9yZSBpbmZvIGF0IHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL3B5cGFyc2luZy9weXBhcnNpbmcvd2lraVwiPnB5cGFyc2luZzwvYT4gd2lraSBwYWdlPC90ZD4nCiAgICAgICAgIyBtYWtlX2h0bWxfdGFncyByZXR1cm5zIHB5cGFyc2luZyBleHByZXNzaW9ucyBmb3IgdGhlIG9wZW5pbmcgYW5kCiAgICAgICAgIyBjbG9zaW5nIHRhZ3MgYXMgYSAyLXR1cGxlCiAgICAgICAgYSwgYV9lbmQgPSBtYWtlX2h0bWxfdGFncyhcIkFcIikKICAgICAgICBsaW5rX2V4cHIgPSBhICsgU2tpcFRvKGFfZW5kKShcImxpbmtfdGV4dFwiKSArIGFfZW5kCgogICAgICAgIGZvciBsaW5rIGluIGxpbmtfZXhwci5zZWFyY2hfc3RyaW5nKHRleHQpOgogICAgICAgICAgICAjIGF0dHJpYnV0ZXMgaW4gdGhlIDxBPiB0YWcgKGxpa2UgXCJocmVmXCIgc2hvd24gaGVyZSkgYXJlCiAgICAgICAgICAgICMgYWxzbyBhY2Nlc3NpYmxlIGFzIG5hbWVkIHJlc3VsdHMKICAgICAgICAgICAgcHJpbnQobGluay5saW5rX3RleHQsICctPicsIGxpbmsuaHJlZikKCiAgICBwcmludHM6OgoKICAgICAgICBweXBhcnNpbmcgLT4gaHR0cHM6Ly9naXRodWIuY29tL3B5cGFyc2luZy9weXBhcnNpbmcvd2lraQogICAgXCJcIlwiCiAgICByZXR1cm4gX21ha2VUYWdzKHRhZ19zdHIsIEZhbHNlKQoKCmRlZiBtYWtlX3htbF90YWdzKAogICAgdGFnX3N0cjogVW5pb25bc3RyLCBQYXJzZXJFbGVtZW50XQopIC0+IFR1cGxlW1BhcnNlckVsZW1lbnQsIFBhcnNlckVsZW1lbnRdOgogICAgXCJcIlwiSGVscGVyIHRvIGNvbnN0cnVjdCBvcGVuaW5nIGFuZCBjbG9zaW5nIHRhZyBleHByZXNzaW9ucyBmb3IgWE1MLAogICAgZ2l2ZW4gYSB0YWcgbmFtZS4gTWF0Y2hlcyB0YWdzIG9ubHkgaW4gdGhlIGdpdmVuIHVwcGVyL2xvd2VyIGNhc2UuCgogICAgRXhhbXBsZTogc2ltaWxhciB0byA6Y2xhc3M6YG1ha2VfaHRtbF90YWdzYAogICAgXCJcIlwiCiAgICByZXR1cm4gX21ha2VUYWdzKHRhZ19zdHIsIFRydWUpCgoKYW55X29wZW5fdGFnOiBQYXJzZXJFbGVtZW50CmFueV9jbG9zZV90YWc6IFBhcnNlckVsZW1lbnQKYW55X29wZW5fdGFnLCBhbnlfY2xvc2VfdGFnID0gbWFrZV9odG1sX3RhZ3MoCiAgICBXb3JkKGFscGhhcywgYWxwaGFudW1zICsgXCJfOlwiKS5zZXRfbmFtZShcImFueSB0YWdcIikKKQoKX2h0bWxFbnRpdHlNYXAgPSB7ay5yc3RyaXAoXCI7XCIpOiB2IGZvciBrLCB2IGluIGh0bWwuZW50aXRpZXMuaHRtbDUuaXRlbXMoKX0KY29tbW9uX2h0bWxfZW50aXR5ID0gUmVnZXgoXCImKD9QPGVudGl0eT5cIiArIFwifFwiLmpvaW4oX2h0bWxFbnRpdHlNYXApICsgXCIpO1wiKS5zZXRfbmFtZSgKICAgIFwiY29tbW9uIEhUTUwgZW50aXR5XCIKKQoKCmRlZiByZXBsYWNlX2h0bWxfZW50aXR5KHQpOgogICAgXCJcIlwiSGVscGVyIHBhcnNlciBhY3Rpb24gdG8gcmVwbGFjZSBjb21tb24gSFRNTCBlbnRpdGllcyB3aXRoIHRoZWlyIHNwZWNpYWwgY2hhcmFjdGVyc1wiXCJcIgogICAgcmV0dXJuIF9odG1sRW50aXR5TWFwLmdldCh0LmVudGl0eSkKCgpjbGFzcyBPcEFzc29jKEVudW0pOgogICAgTEVGVCA9IDEKICAgIFJJR0hUID0gMgoKCkluZml4Tm90YXRpb25PcGVyYXRvckFyZ1R5cGUgPSBVbmlvblsKICAgIFBhcnNlckVsZW1lbnQsIHN0ciwgVHVwbGVbVW5pb25bUGFyc2VyRWxlbWVudCwgc3RyXSwgVW5pb25bUGFyc2VyRWxlbWVudCwgc3RyXV0KXQpJbmZpeE5vdGF0aW9uT3BlcmF0b3JTcGVjID0gVW5pb25bCiAgICBUdXBsZVsKICAgICAgICBJbmZpeE5vdGF0aW9uT3BlcmF0b3JBcmdUeXBlLAogICAgICAgIGludCwKICAgICAgICBPcEFzc29jLAogICAgICAgIHR5cGluZy5PcHRpb25hbFtQYXJzZUFjdGlvbl0sCiAgICBdLAogICAgVHVwbGVbCiAgICAgICAgSW5maXhOb3RhdGlvbk9wZXJhdG9yQXJnVHlwZSwKICAgICAgICBpbnQsCiAgICAgICAgT3BBc3NvYywKICAgIF0sCl0KCgpkZWYgaW5maXhfbm90YXRpb24oCiAgICBiYXNlX2V4cHI6IFBhcnNlckVsZW1lbnQsCiAgICBvcF9saXN0OiBMaXN0W0luZml4Tm90YXRpb25PcGVyYXRvclNwZWNdLAogICAgbHBhcjogVW5pb25bc3RyLCBQYXJzZXJFbGVtZW50XSA9IFN1cHByZXNzKFwiKFwiKSwKICAgIHJwYXI6IFVuaW9uW3N0ciwgUGFyc2VyRWxlbWVudF0gPSBTdXBwcmVzcyhcIilcIiksCikgLT4gUGFyc2VyRWxlbWVudDoKICAgIFwiXCJcIkhlbHBlciBtZXRob2QgZm9yIGNvbnN0cnVjdGluZyBncmFtbWFycyBvZiBleHByZXNzaW9ucyBtYWRlIHVwIG9mCiAgICBvcGVyYXRvcnMgd29ya2luZyBpbiBhIHByZWNlZGVuY2UgaGllcmFyY2h5LiAgT3BlcmF0b3JzIG1heSBiZSB1bmFyeQogICAgb3IgYmluYXJ5LCBsZWZ0LSBvciByaWdodC1hc3NvY2lhdGl2ZS4gIFBhcnNlIGFjdGlvbnMgY2FuIGFsc28gYmUKICAgIGF0dGFjaGVkIHRvIG9wZXJhdG9yIGV4cHJlc3Npb25zLiBUaGUgZ2VuZXJhdGVkIHBhcnNlciB3aWxsIGFsc28KICAgIHJlY29nbml6ZSB0aGUgdXNlIG9mIHBhcmVudGhlc2VzIHRvIG92ZXJyaWRlIG9wZXJhdG9yIHByZWNlZGVuY2VzCiAgICAoc2VlIGV4YW1wbGUgYmVsb3cpLgoKICAgIE5vdGU6IGlmIHlvdSBkZWZpbmUgYSBkZWVwIG9wZXJhdG9yIGxpc3QsIHlvdSBtYXkgc2VlIHBlcmZvcm1hbmNlCiAgICBpc3N1ZXMgd2hlbiB1c2luZyBpbmZpeF9ub3RhdGlvbi4gU2VlCiAgICA6Y2xhc3M6YFBhcnNlckVsZW1lbnQuZW5hYmxlX3BhY2tyYXRgIGZvciBhIG1lY2hhbmlzbSB0byBwb3RlbnRpYWxseQogICAgaW1wcm92ZSB5b3VyIHBhcnNlciBwZXJmb3JtYW5jZS4KCiAgICBQYXJhbWV0ZXJzOgogICAgLSBgYGJhc2VfZXhwcmBgIC0gZXhwcmVzc2lvbiByZXByZXNlbnRpbmcgdGhlIG1vc3QgYmFzaWMgb3BlcmFuZCB0bwogICAgICBiZSB1c2VkIGluIHRoZSBleHByZXNzaW9uCiAgICAtIGBgb3BfbGlzdGBgIC0gbGlzdCBvZiB0dXBsZXMsIG9uZSBmb3IgZWFjaCBvcGVyYXRvciBwcmVjZWRlbmNlIGxldmVsCiAgICAgIGluIHRoZSBleHByZXNzaW9uIGdyYW1tYXI7IGVhY2ggdHVwbGUgaXMgb2YgdGhlIGZvcm0gYGAob3BfZXhwciwKICAgICAgbnVtX29wZXJhbmRzLCByaWdodF9sZWZ0X2Fzc29jLCAob3B0aW9uYWwpcGFyc2VfYWN0aW9uKWBgLCB3aGVyZToKCiAgICAgIC0gYGBvcF9leHByYGAgaXMgdGhlIHB5cGFyc2luZyBleHByZXNzaW9uIGZvciB0aGUgb3BlcmF0b3I7IG1heSBhbHNvCiAgICAgICAgYmUgYSBzdHJpbmcsIHdoaWNoIHdpbGwgYmUgY29udmVydGVkIHRvIGEgTGl0ZXJhbDsgaWYgYGBudW1fb3BlcmFuZHNgYAogICAgICAgIGlzIDMsIGBgb3BfZXhwcmBgIGlzIGEgdHVwbGUgb2YgdHdvIGV4cHJlc3Npb25zLCBmb3IgdGhlIHR3bwogICAgICAgIG9wZXJhdG9ycyBzZXBhcmF0aW5nIHRoZSAzIHRlcm1zCiAgICAgIC0gYGBudW1fb3BlcmFuZHNgYCBpcyB0aGUgbnVtYmVyIG9mIHRlcm1zIGZvciB0aGlzIG9wZXJhdG9yIChtdXN0IGJlIDEsCiAgICAgICAgMiwgb3IgMykKICAgICAgLSBgYHJpZ2h0X2xlZnRfYXNzb2NgYCBpcyB0aGUgaW5kaWNhdG9yIHdoZXRoZXIgdGhlIG9wZXJhdG9yIGlzIHJpZ2h0CiAgICAgICAgb3IgbGVmdCBhc3NvY2lhdGl2ZSwgdXNpbmcgdGhlIHB5cGFyc2luZy1kZWZpbmVkIGNvbnN0YW50cwogICAgICAgIGBgT3BBc3NvYy5SSUdIVGBgIGFuZCBgYE9wQXNzb2MuTEVGVGBgLgogICAgICAtIGBgcGFyc2VfYWN0aW9uYGAgaXMgdGhlIHBhcnNlIGFjdGlvbiB0byBiZSBhc3NvY2lhdGVkIHdpdGgKICAgICAgICBleHByZXNzaW9ucyBtYXRjaGluZyB0aGlzIG9wZXJhdG9yIGV4cHJlc3Npb24gKHRoZSBwYXJzZSBhY3Rpb24KICAgICAgICB0dXBsZSBtZW1iZXIgbWF5IGJlIG9taXR0ZWQpOyBpZiB0aGUgcGFyc2UgYWN0aW9uIGlzIHBhc3NlZAogICAgICAgIGEgdHVwbGUgb3IgbGlzdCBvZiBmdW5jdGlvbnMsIHRoaXMgaXMgZXF1aXZhbGVudCB0byBjYWxsaW5nCiAgICAgICAgYGBzZXRfcGFyc2VfYWN0aW9uKCpmbilgYAogICAgICAgICg6Y2xhc3M6YFBhcnNlckVsZW1lbnQuc2V0X3BhcnNlX2FjdGlvbmApCiAgICAtIGBgbHBhcmBgIC0gZXhwcmVzc2lvbiBmb3IgbWF0Y2hpbmcgbGVmdC1wYXJlbnRoZXNlczsgaWYgcGFzc2VkIGFzIGEKICAgICAgc3RyLCB0aGVuIHdpbGwgYmUgcGFyc2VkIGFzIFN1cHByZXNzKGxwYXIpLiBJZiBscGFyIGlzIHBhc3NlZCBhcwogICAgICBhbiBleHByZXNzaW9uIChzdWNoIGFzIGBgTGl0ZXJhbCgnKCcpYGApLCB0aGVuIGl0IHdpbGwgYmUga2VwdCBpbgogICAgICB0aGUgcGFyc2VkIHJlc3VsdHMsIGFuZCBncm91cGVkIHdpdGggdGhlbS4gKGRlZmF1bHQ9IGBgU3VwcHJlc3MoJygnKWBgKQogICAgLSBgYHJwYXJgYCAtIGV4cHJlc3Npb24gZm9yIG1hdGNoaW5nIHJpZ2h0LXBhcmVudGhlc2VzOyBpZiBwYXNzZWQgYXMgYQogICAgICBzdHIsIHRoZW4gd2lsbCBiZSBwYXJzZWQgYXMgU3VwcHJlc3MocnBhcikuIElmIHJwYXIgaXMgcGFzc2VkIGFzCiAgICAgIGFuIGV4cHJlc3Npb24gKHN1Y2ggYXMgYGBMaXRlcmFsKCcpJylgYCksIHRoZW4gaXQgd2lsbCBiZSBrZXB0IGluCiAgICAgIHRoZSBwYXJzZWQgcmVzdWx0cywgYW5kIGdyb3VwZWQgd2l0aCB0aGVtLiAoZGVmYXVsdD0gYGBTdXBwcmVzcygnKScpYGApCgogICAgRXhhbXBsZTo6CgogICAgICAgICMgc2ltcGxlIGV4YW1wbGUgb2YgZm91ci1mdW5jdGlvbiBhcml0aG1ldGljIHdpdGggaW50cyBhbmQKICAgICAgICAjIHZhcmlhYmxlIG5hbWVzCiAgICAgICAgaW50ZWdlciA9IHB5cGFyc2luZ19jb21tb24uc2lnbmVkX2ludGVnZXIKICAgICAgICB2YXJuYW1lID0gcHlwYXJzaW5nX2NvbW1vbi5pZGVudGlmaWVyCgogICAgICAgIGFyaXRoX2V4cHIgPSBpbmZpeF9ub3RhdGlvbihpbnRlZ2VyIHwgdmFybmFtZSwKICAgICAgICAgICAgWwogICAgICAgICAgICAoJy0nLCAxLCBPcEFzc29jLlJJR0hUKSwKICAgICAgICAgICAgKG9uZV9vZignKiAvJyksIDIsIE9wQXNzb2MuTEVGVCksCiAgICAgICAgICAgIChvbmVfb2YoJysgLScpLCAyLCBPcEFzc29jLkxFRlQpLAogICAgICAgICAgICBdKQoKICAgICAgICBhcml0aF9leHByLnJ1bl90ZXN0cygnJycKICAgICAgICAgICAgNSszKjYKICAgICAgICAgICAgKDUrMykqNgogICAgICAgICAgICAtMi0tMTEKICAgICAgICAgICAgJycnLCBmdWxsX2R1bXA9RmFsc2UpCgogICAgcHJpbnRzOjoKCiAgICAgICAgNSszKjYKICAgICAgICBbWzUsICcrJywgWzMsICcqJywgNl1dXQoKICAgICAgICAoNSszKSo2CiAgICAgICAgW1tbNSwgJysnLCAzXSwgJyonLCA2XV0KCiAgICAgICAgLTItLTExCiAgICAgICAgW1tbJy0nLCAyXSwgJy0nLCBbJy0nLCAxMV1dXQogICAgXCJcIlwiCiAgICAjIGNhcHRpdmUgdmVyc2lvbiBvZiBGb2xsb3dlZEJ5IHRoYXQgZG9lcyBub3QgZG8gcGFyc2UgYWN0aW9ucyBvciBjYXB0dXJlIHJlc3VsdHMgbmFtZXMKICAgIGNsYXNzIF9GQihGb2xsb3dlZEJ5KToKICAgICAgICBkZWYgcGFyc2VJbXBsKHNlbGYsIGluc3RyaW5nLCBsb2MsIGRvQWN0aW9ucz1UcnVlKToKICAgICAgICAgICAgc2VsZi5leHByLnRyeV9wYXJzZShpbnN0cmluZywgbG9jKQogICAgICAgICAgICByZXR1cm4gbG9jLCBbXQoKICAgIF9GQi5fX25hbWVfXyA9IFwiRm9sbG93ZWRCeT5cIgoKICAgIHJldCA9IEZvcndhcmQoKQogICAgaWYgaXNpbnN0YW5jZShscGFyLCBzdHIpOgogICAgICAgIGxwYXIgPSBTdXBwcmVzcyhscGFyKQogICAgaWYgaXNpbnN0YW5jZShycGFyLCBzdHIpOgogICAgICAgIHJwYXIgPSBTdXBwcmVzcyhycGFyKQoKICAgICMgaWYgbHBhciBhbmQgcnBhciBhcmUgbm90IHN1cHByZXNzZWQsIHdyYXAgaW4gZ3JvdXAKICAgIGlmIG5vdCAoaXNpbnN0YW5jZShycGFyLCBTdXBwcmVzcykgYW5kIGlzaW5zdGFuY2UocnBhciwgU3VwcHJlc3MpKToKICAgICAgICBsYXN0RXhwciA9IGJhc2VfZXhwciB8IEdyb3VwKGxwYXIgKyByZXQgKyBycGFyKQogICAgZWxzZToKICAgICAgICBsYXN0RXhwciA9IGJhc2VfZXhwciB8IChscGFyICsgcmV0ICsgcnBhcikKCiAgICBmb3IgaSwgb3BlckRlZiBpbiBlbnVtZXJhdGUob3BfbGlzdCk6CiAgICAgICAgb3BFeHByLCBhcml0eSwgcmlnaHRMZWZ0QXNzb2MsIHBhID0gKG9wZXJEZWYgKyAoTm9uZSwpKVs6NF0KICAgICAgICBpZiBpc2luc3RhbmNlKG9wRXhwciwgc3RyX3R5cGUpOgogICAgICAgICAgICBvcEV4cHIgPSBQYXJzZXJFbGVtZW50Ll9saXRlcmFsU3RyaW5nQ2xhc3Mob3BFeHByKQogICAgICAgIGlmIGFyaXR5ID09IDM6CiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9wRXhwciwgKHR1cGxlLCBsaXN0KSkgb3IgbGVuKG9wRXhwcikgIT0gMjoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgXCJpZiBudW10ZXJtcz0zLCBvcEV4cHIgbXVzdCBiZSBhIHR1cGxlIG9yIGxpc3Qgb2YgdHdvIGV4cHJlc3Npb25zXCIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgb3BFeHByMSwgb3BFeHByMiA9IG9wRXhwcgogICAgICAgICAgICB0ZXJtX25hbWUgPSBcInt9e30gdGVybVwiLmZvcm1hdChvcEV4cHIxLCBvcEV4cHIyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRlcm1fbmFtZSA9IFwie30gdGVybVwiLmZvcm1hdChvcEV4cHIpCgogICAgICAgIGlmIG5vdCAxIDw9IGFyaXR5IDw9IDM6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoXCJvcGVyYXRvciBtdXN0IGJlIHVuYXJ5ICgxKSwgYmluYXJ5ICgyKSwgb3IgdGVybmFyeSAoMylcIikKCiAgICAgICAgaWYgcmlnaHRMZWZ0QXNzb2Mgbm90IGluIChPcEFzc29jLkxFRlQsIE9wQXNzb2MuUklHSFQpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKFwib3BlcmF0b3IgbXVzdCBpbmRpY2F0ZSByaWdodCBvciBsZWZ0IGFzc29jaWF0aXZpdHlcIikKCiAgICAgICAgdGhpc0V4cHI6IEZvcndhcmQgPSBGb3J3YXJkKCkuc2V0X25hbWUodGVybV9uYW1lKQogICAgICAgIGlmIHJpZ2h0TGVmdEFzc29jIGlzIE9wQXNzb2MuTEVGVDoKICAgICAgICAgICAgaWYgYXJpdHkgPT0gMToKICAgICAgICAgICAgICAgIG1hdGNoRXhwciA9IF9GQihsYXN0RXhwciArIG9wRXhwcikgKyBHcm91cChsYXN0RXhwciArIG9wRXhwclsxLCAuLi5dKQogICAgICAgICAgICBlbGlmIGFyaXR5ID09IDI6CiAgICAgICAgICAgICAgICBpZiBvcEV4cHIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgbWF0Y2hFeHByID0gX0ZCKGxhc3RFeHByICsgb3BFeHByICsgbGFzdEV4cHIpICsgR3JvdXAoCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RFeHByICsgKG9wRXhwciArIGxhc3RFeHByKVsxLCAuLi5dCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtYXRjaEV4cHIgPSBfRkIobGFzdEV4cHIgKyBsYXN0RXhwcikgKyBHcm91cChsYXN0RXhwclsyLCAuLi5dKQogICAgICAgICAgICBlbGlmIGFyaXR5ID09IDM6CiAgICAgICAgICAgICAgICBtYXRjaEV4cHIgPSBfRkIoCiAgICAgICAgICAgICAgICAgICAgbGFzdEV4cHIgKyBvcEV4cHIxICsgbGFzdEV4cHIgKyBvcEV4cHIyICsgbGFzdEV4cHIKICAgICAgICAgICAgICAgICkgKyBHcm91cChsYXN0RXhwciArIE9uZU9yTW9yZShvcEV4cHIxICsgbGFzdEV4cHIgKyBvcEV4cHIyICsgbGFzdEV4cHIpKQogICAgICAgIGVsaWYgcmlnaHRMZWZ0QXNzb2MgaXMgT3BBc3NvYy5SSUdIVDoKICAgICAgICAgICAgaWYgYXJpdHkgPT0gMToKICAgICAgICAgICAgICAgICMgdHJ5IHRvIGF2b2lkIExSIHdpdGggdGhpcyBleHRyYSB0ZXN0CiAgICAgICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvcEV4cHIsIE9wdCk6CiAgICAgICAgICAgICAgICAgICAgb3BFeHByID0gT3B0KG9wRXhwcikKICAgICAgICAgICAgICAgIG1hdGNoRXhwciA9IF9GQihvcEV4cHIuZXhwciArIHRoaXNFeHByKSArIEdyb3VwKG9wRXhwciArIHRoaXNFeHByKQogICAgICAgICAgICBlbGlmIGFyaXR5ID09IDI6CiAgICAgICAgICAgICAgICBpZiBvcEV4cHIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgbWF0Y2hFeHByID0gX0ZCKGxhc3RFeHByICsgb3BFeHByICsgdGhpc0V4cHIpICsgR3JvdXAoCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RFeHByICsgKG9wRXhwciArIHRoaXNFeHByKVsxLCAuLi5dCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtYXRjaEV4cHIgPSBfRkIobGFzdEV4cHIgKyB0aGlzRXhwcikgKyBHcm91cCgKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEV4cHIgKyB0aGlzRXhwclsxLCAuLi5dCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbGlmIGFyaXR5ID09IDM6CiAgICAgICAgICAgICAgICBtYXRjaEV4cHIgPSBfRkIoCiAgICAgICAgICAgICAgICAgICAgbGFzdEV4cHIgKyBvcEV4cHIxICsgdGhpc0V4cHIgKyBvcEV4cHIyICsgdGhpc0V4cHIKICAgICAgICAgICAgICAgICkgKyBHcm91cChsYXN0RXhwciArIG9wRXhwcjEgKyB0aGlzRXhwciArIG9wRXhwcjIgKyB0aGlzRXhwcikKICAgICAgICBpZiBwYToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShwYSwgKHR1cGxlLCBsaXN0KSk6CiAgICAgICAgICAgICAgICBtYXRjaEV4cHIuc2V0X3BhcnNlX2FjdGlvbigqcGEpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBtYXRjaEV4cHIuc2V0X3BhcnNlX2FjdGlvbihwYSkKICAgICAgICB0aGlzRXhwciA8PD0gKG1hdGNoRXhwciB8IGxhc3RFeHByKS5zZXROYW1lKHRlcm1fbmFtZSkKICAgICAgICBsYXN0RXhwciA9IHRoaXNFeHByCiAgICByZXQgPDw9IGxhc3RFeHByCiAgICByZXR1cm4gcmV0CgoKZGVmIGluZGVudGVkQmxvY2soYmxvY2tTdGF0ZW1lbnRFeHByLCBpbmRlbnRTdGFjaywgaW5kZW50PVRydWUsIGJhY2t1cF9zdGFja3M9W10pOgogICAgXCJcIlwiCiAgICAoREVQUkVDQVRFRCAtIHVzZSBJbmRlbnRlZEJsb2NrIGNsYXNzIGluc3RlYWQpCiAgICBIZWxwZXIgbWV0aG9kIGZvciBkZWZpbmluZyBzcGFjZS1kZWxpbWl0ZWQgaW5kZW50YXRpb24gYmxvY2tzLAogICAgc3VjaCBhcyB0aG9zZSB1c2VkIHRvIGRlZmluZSBibG9jayBzdGF0ZW1lbnRzIGluIFB5dGhvbiBzb3VyY2UgY29kZS4KCiAgICBQYXJhbWV0ZXJzOgoKICAgIC0gYGBibG9ja1N0YXRlbWVudEV4cHJgYCAtIGV4cHJlc3Npb24gZGVmaW5pbmcgc3ludGF4IG9mIHN0YXRlbWVudCB0aGF0CiAgICAgIGlzIHJlcGVhdGVkIHdpdGhpbiB0aGUgaW5kZW50ZWQgYmxvY2sKICAgIC0gYGBpbmRlbnRTdGFja2BgIC0gbGlzdCBjcmVhdGVkIGJ5IGNhbGxlciB0byBtYW5hZ2UgaW5kZW50YXRpb24gc3RhY2sKICAgICAgKG11bHRpcGxlIGBgc3RhdGVtZW50V2l0aEluZGVudGVkQmxvY2tgYCBleHByZXNzaW9ucyB3aXRoaW4gYSBzaW5nbGUKICAgICAgZ3JhbW1hciBzaG91bGQgc2hhcmUgYSBjb21tb24gYGBpbmRlbnRTdGFja2BgKQogICAgLSBgYGluZGVudGBgIC0gYm9vbGVhbiBpbmRpY2F0aW5nIHdoZXRoZXIgYmxvY2sgbXVzdCBiZSBpbmRlbnRlZCBiZXlvbmQKICAgICAgdGhlIGN1cnJlbnQgbGV2ZWw7IHNldCB0byBgYEZhbHNlYGAgZm9yIGJsb2NrIG9mIGxlZnQtbW9zdCBzdGF0ZW1lbnRzCiAgICAgIChkZWZhdWx0PSBgYFRydWVgYCkKCiAgICBBIHZhbGlkIGJsb2NrIG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgYGBibG9ja1N0YXRlbWVudGBgLgoKICAgIChOb3RlIHRoYXQgaW5kZW50ZWRCbG9jayB1c2VzIGludGVybmFsIHBhcnNlIGFjdGlvbnMgd2hpY2ggbWFrZSBpdAogICAgaW5jb21wYXRpYmxlIHdpdGggcGFja3JhdCBwYXJzaW5nLikKCiAgICBFeGFtcGxlOjoKCiAgICAgICAgZGF0YSA9ICcnJwogICAgICAgIGRlZiBBKHopOgogICAgICAgICAgQTEKICAgICAgICAgIEIgPSAxMDAKICAgICAgICAgIEcgPSBBMgogICAgICAgICAgQTIKICAgICAgICAgIEEzCiAgICAgICAgQgogICAgICAgIGRlZiBCQihhLGIsYyk6CiAgICAgICAgICBCQjEKICAgICAgICAgIGRlZiBCQkEoKToKICAgICAgICAgICAgYmJhMQogICAgICAgICAgICBiYmEyCiAgICAgICAgICAgIGJiYTMKICAgICAgICBDCiAgICAgICAgRAogICAgICAgIGRlZiBzcGFtKHgseSk6CiAgICAgICAgICAgICBkZWYgZWdncyh6KToKICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgJycnCgoKICAgICAgICBpbmRlbnRTdGFjayA9IFsxXQogICAgICAgIHN0bXQgPSBGb3J3YXJkKCkKCiAgICAgICAgaWRlbnRpZmllciA9IFdvcmQoYWxwaGFzLCBhbHBoYW51bXMpCiAgICAgICAgZnVuY0RlY2wgPSAoXCJkZWZcIiArIGlkZW50aWZpZXIgKyBHcm91cChcIihcIiArIE9wdChkZWxpbWl0ZWRMaXN0KGlkZW50aWZpZXIpKSArIFwiKVwiKSArIFwiOlwiKQogICAgICAgIGZ1bmNfYm9keSA9IGluZGVudGVkQmxvY2soc3RtdCwgaW5kZW50U3RhY2spCiAgICAgICAgZnVuY0RlZiA9IEdyb3VwKGZ1bmNEZWNsICsgZnVuY19ib2R5KQoKICAgICAgICBydmFsdWUgPSBGb3J3YXJkKCkKICAgICAgICBmdW5jQ2FsbCA9IEdyb3VwKGlkZW50aWZpZXIgKyBcIihcIiArIE9wdChkZWxpbWl0ZWRMaXN0KHJ2YWx1ZSkpICsgXCIpXCIpCiAgICAgICAgcnZhbHVlIDw8IChmdW5jQ2FsbCB8IGlkZW50aWZpZXIgfCBXb3JkKG51bXMpKQogICAgICAgIGFzc2lnbm1lbnQgPSBHcm91cChpZGVudGlmaWVyICsgXCI9XCIgKyBydmFsdWUpCiAgICAgICAgc3RtdCA8PCAoZnVuY0RlZiB8IGFzc2lnbm1lbnQgfCBpZGVudGlmaWVyKQoKICAgICAgICBtb2R1bGVfYm9keSA9IHN0bXRbMSwgLi4uXQoKICAgICAgICBwYXJzZVRyZWUgPSBtb2R1bGVfYm9keS5wYXJzZVN0cmluZyhkYXRhKQogICAgICAgIHBhcnNlVHJlZS5wcHJpbnQoKQoKICAgIHByaW50czo6CgogICAgICAgIFtbJ2RlZicsCiAgICAgICAgICAnQScsCiAgICAgICAgICBbJygnLCAneicsICcpJ10sCiAgICAgICAgICAnOicsCiAgICAgICAgICBbWydBMSddLCBbWydCJywgJz0nLCAnMTAwJ11dLCBbWydHJywgJz0nLCAnQTInXV0sIFsnQTInXSwgWydBMyddXV0sCiAgICAgICAgICdCJywKICAgICAgICAgWydkZWYnLAogICAgICAgICAgJ0JCJywKICAgICAgICAgIFsnKCcsICdhJywgJ2InLCAnYycsICcpJ10sCiAgICAgICAgICAnOicsCiAgICAgICAgICBbWydCQjEnXSwgW1snZGVmJywgJ0JCQScsIFsnKCcsICcpJ10sICc6JywgW1snYmJhMSddLCBbJ2JiYTInXSwgWydiYmEzJ11dXV1dXSwKICAgICAgICAgJ0MnLAogICAgICAgICAnRCcsCiAgICAgICAgIFsnZGVmJywKICAgICAgICAgICdzcGFtJywKICAgICAgICAgIFsnKCcsICd4JywgJ3knLCAnKSddLAogICAgICAgICAgJzonLAogICAgICAgICAgW1tbJ2RlZicsICdlZ2dzJywgWycoJywgJ3onLCAnKSddLCAnOicsIFtbJ3Bhc3MnXV1dXV1dXQogICAgXCJcIlwiCiAgICBiYWNrdXBfc3RhY2tzLmFwcGVuZChpbmRlbnRTdGFja1s6XSkKCiAgICBkZWYgcmVzZXRfc3RhY2soKToKICAgICAgICBpbmRlbnRTdGFja1s6XSA9IGJhY2t1cF9zdGFja3NbLTFdCgogICAgZGVmIGNoZWNrUGVlckluZGVudChzLCBsLCB0KToKICAgICAgICBpZiBsID49IGxlbihzKToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgY3VyQ29sID0gY29sKGwsIHMpCiAgICAgICAgaWYgY3VyQ29sICE9IGluZGVudFN0YWNrWy0xXToKICAgICAgICAgICAgaWYgY3VyQ29sID4gaW5kZW50U3RhY2tbLTFdOgogICAgICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24ocywgbCwgXCJpbGxlZ2FsIG5lc3RpbmdcIikKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24ocywgbCwgXCJub3QgYSBwZWVyIGVudHJ5XCIpCgogICAgZGVmIGNoZWNrU3ViSW5kZW50KHMsIGwsIHQpOgogICAgICAgIGN1ckNvbCA9IGNvbChsLCBzKQogICAgICAgIGlmIGN1ckNvbCA+IGluZGVudFN0YWNrWy0xXToKICAgICAgICAgICAgaW5kZW50U3RhY2suYXBwZW5kKGN1ckNvbCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihzLCBsLCBcIm5vdCBhIHN1YmVudHJ5XCIpCgogICAgZGVmIGNoZWNrVW5pbmRlbnQocywgbCwgdCk6CiAgICAgICAgaWYgbCA+PSBsZW4ocyk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGN1ckNvbCA9IGNvbChsLCBzKQogICAgICAgIGlmIG5vdCAoaW5kZW50U3RhY2sgYW5kIGN1ckNvbCBpbiBpbmRlbnRTdGFjayk6CiAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKHMsIGwsIFwibm90IGFuIHVuaW5kZW50XCIpCiAgICAgICAgaWYgY3VyQ29sIDwgaW5kZW50U3RhY2tbLTFdOgogICAgICAgICAgICBpbmRlbnRTdGFjay5wb3AoKQoKICAgIE5MID0gT25lT3JNb3JlKExpbmVFbmQoKS5zZXRfd2hpdGVzcGFjZV9jaGFycyhcIlxcdCBcIikuc3VwcHJlc3MoKSkKICAgIElOREVOVCA9IChFbXB0eSgpICsgRW1wdHkoKS5zZXRfcGFyc2VfYWN0aW9uKGNoZWNrU3ViSW5kZW50KSkuc2V0X25hbWUoXCJJTkRFTlRcIikKICAgIFBFRVIgPSBFbXB0eSgpLnNldF9wYXJzZV9hY3Rpb24oY2hlY2tQZWVySW5kZW50KS5zZXRfbmFtZShcIlwiKQogICAgVU5ERU5UID0gRW1wdHkoKS5zZXRfcGFyc2VfYWN0aW9uKGNoZWNrVW5pbmRlbnQpLnNldF9uYW1lKFwiVU5JTkRFTlRcIikKICAgIGlmIGluZGVudDoKICAgICAgICBzbUV4cHIgPSBHcm91cCgKICAgICAgICAgICAgT3B0KE5MKQogICAgICAgICAgICArIElOREVOVAogICAgICAgICAgICArIE9uZU9yTW9yZShQRUVSICsgR3JvdXAoYmxvY2tTdGF0ZW1lbnRFeHByKSArIE9wdChOTCkpCiAgICAgICAgICAgICsgVU5ERU5UCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICBzbUV4cHIgPSBHcm91cCgKICAgICAgICAgICAgT3B0KE5MKQogICAgICAgICAgICArIE9uZU9yTW9yZShQRUVSICsgR3JvdXAoYmxvY2tTdGF0ZW1lbnRFeHByKSArIE9wdChOTCkpCiAgICAgICAgICAgICsgT3B0KFVOREVOVCkKICAgICAgICApCgogICAgIyBhZGQgYSBwYXJzZSBhY3Rpb24gdG8gcmVtb3ZlIGJhY2t1cF9zdGFjayBmcm9tIGxpc3Qgb2YgYmFja3VwcwogICAgc21FeHByLmFkZF9wYXJzZV9hY3Rpb24oCiAgICAgICAgbGFtYmRhOiBiYWNrdXBfc3RhY2tzLnBvcCgtMSkgYW5kIE5vbmUgaWYgYmFja3VwX3N0YWNrcyBlbHNlIE5vbmUKICAgICkKICAgIHNtRXhwci5zZXRfZmFpbF9hY3Rpb24obGFtYmRhIGEsIGIsIGMsIGQ6IHJlc2V0X3N0YWNrKCkpCiAgICBibG9ja1N0YXRlbWVudEV4cHIuaWdub3JlKF9ic2xhc2ggKyBMaW5lRW5kKCkpCiAgICByZXR1cm4gc21FeHByLnNldF9uYW1lKFwiaW5kZW50ZWQgYmxvY2tcIikKCgojIGl0J3MgZWFzeSB0byBnZXQgdGhlc2UgY29tbWVudCBzdHJ1Y3R1cmVzIHdyb25nIC0gdGhleSdyZSB2ZXJ5IGNvbW1vbiwgc28gbWF5IGFzIHdlbGwgbWFrZSB0aGVtIGF2YWlsYWJsZQpjX3N0eWxlX2NvbW1lbnQgPSBDb21iaW5lKFJlZ2V4KHJcIi9cXCooPzpbXipdfFxcKig/IS8pKSpcIikgKyBcIiovXCIpLnNldF9uYW1lKAogICAgXCJDIHN0eWxlIGNvbW1lbnRcIgopClwiQ29tbWVudCBvZiB0aGUgZm9ybSBgYC8qIC4uLiAqL2BgXCIKCmh0bWxfY29tbWVudCA9IFJlZ2V4KHJcIjwhLS1bXFxzXFxTXSo/LS0+XCIpLnNldF9uYW1lKFwiSFRNTCBjb21tZW50XCIpClwiQ29tbWVudCBvZiB0aGUgZm9ybSBgYDwhLS0gLi4uIC0tPmBgXCIKCnJlc3Rfb2ZfbGluZSA9IFJlZ2V4KHJcIi4qXCIpLmxlYXZlX3doaXRlc3BhY2UoKS5zZXRfbmFtZShcInJlc3Qgb2YgbGluZVwiKQpkYmxfc2xhc2hfY29tbWVudCA9IFJlZ2V4KHJcIi8vKD86XFxcXFxcbnxbXlxcbl0pKlwiKS5zZXRfbmFtZShcIi8vIGNvbW1lbnRcIikKXCJDb21tZW50IG9mIHRoZSBmb3JtIGBgLy8gLi4uICh0byBlbmQgb2YgbGluZSlgYFwiCgpjcHBfc3R5bGVfY29tbWVudCA9IENvbWJpbmUoCiAgICBSZWdleChyXCIvXFwqKD86W14qXXxcXCooPyEvKSkqXCIpICsgXCIqL1wiIHwgZGJsX3NsYXNoX2NvbW1lbnQKKS5zZXRfbmFtZShcIkMrKyBzdHlsZSBjb21tZW50XCIpClwiQ29tbWVudCBvZiBlaXRoZXIgZm9ybSA6Y2xhc3M6YGNfc3R5bGVfY29tbWVudGAgb3IgOmNsYXNzOmBkYmxfc2xhc2hfY29tbWVudGBcIgoKamF2YV9zdHlsZV9jb21tZW50ID0gY3BwX3N0eWxlX2NvbW1lbnQKXCJTYW1lIGFzIDpjbGFzczpgY3BwX3N0eWxlX2NvbW1lbnRgXCIKCnB5dGhvbl9zdHlsZV9jb21tZW50ID0gUmVnZXgoclwiIy4qXCIpLnNldF9uYW1lKFwiUHl0aG9uIHN0eWxlIGNvbW1lbnRcIikKXCJDb21tZW50IG9mIHRoZSBmb3JtIGBgIyAuLi4gKHRvIGVuZCBvZiBsaW5lKWBgXCIKCgojIGJ1aWxkIGxpc3Qgb2YgYnVpbHQtaW4gZXhwcmVzc2lvbnMsIGZvciBmdXR1cmUgcmVmZXJlbmNlIGlmIGEgZ2xvYmFsIGRlZmF1bHQgdmFsdWUKIyBnZXRzIHVwZGF0ZWQKX2J1aWx0aW5fZXhwcnM6IExpc3RbUGFyc2VyRWxlbWVudF0gPSBbCiAgICB2IGZvciB2IGluIHZhcnMoKS52YWx1ZXMoKSBpZiBpc2luc3RhbmNlKHYsIFBhcnNlckVsZW1lbnQpCl0KCgojIHByZS1QRVA4IGNvbXBhdGlibGUgbmFtZXMKZGVsaW1pdGVkTGlzdCA9IGRlbGltaXRlZF9saXN0CmNvdW50ZWRBcnJheSA9IGNvdW50ZWRfYXJyYXkKbWF0Y2hQcmV2aW91c0xpdGVyYWwgPSBtYXRjaF9wcmV2aW91c19saXRlcmFsCm1hdGNoUHJldmlvdXNFeHByID0gbWF0Y2hfcHJldmlvdXNfZXhwcgpvbmVPZiA9IG9uZV9vZgpkaWN0T2YgPSBkaWN0X29mCm9yaWdpbmFsVGV4dEZvciA9IG9yaWdpbmFsX3RleHRfZm9yCm5lc3RlZEV4cHIgPSBuZXN0ZWRfZXhwcgptYWtlSFRNTFRhZ3MgPSBtYWtlX2h0bWxfdGFncwptYWtlWE1MVGFncyA9IG1ha2VfeG1sX3RhZ3MKYW55T3BlblRhZywgYW55Q2xvc2VUYWcgPSBhbnlfb3Blbl90YWcsIGFueV9jbG9zZV90YWcKY29tbW9uSFRNTEVudGl0eSA9IGNvbW1vbl9odG1sX2VudGl0eQpyZXBsYWNlSFRNTEVudGl0eSA9IHJlcGxhY2VfaHRtbF9lbnRpdHkKb3BBc3NvYyA9IE9wQXNzb2MKaW5maXhOb3RhdGlvbiA9IGluZml4X25vdGF0aW9uCmNTdHlsZUNvbW1lbnQgPSBjX3N0eWxlX2NvbW1lbnQKaHRtbENvbW1lbnQgPSBodG1sX2NvbW1lbnQKcmVzdE9mTGluZSA9IHJlc3Rfb2ZfbGluZQpkYmxTbGFzaENvbW1lbnQgPSBkYmxfc2xhc2hfY29tbWVudApjcHBTdHlsZUNvbW1lbnQgPSBjcHBfc3R5bGVfY29tbWVudApqYXZhU3R5bGVDb21tZW50ID0gamF2YV9zdHlsZV9jb21tZW50CnB5dGhvblN0eWxlQ29tbWVudCA9IHB5dGhvbl9zdHlsZV9jb21tZW50CgoiIiIKbW9kdWxlX2RpY3RbInB5cGFyc2luZy90ZXN0aW5nLnB5Il09IiIiCiMgdGVzdGluZy5weQoKZnJvbSBjb250ZXh0bGliIGltcG9ydCBjb250ZXh0bWFuYWdlcgppbXBvcnQgdHlwaW5nCgpmcm9tIC5jb3JlIGltcG9ydCAoCiAgICBQYXJzZXJFbGVtZW50LAogICAgUGFyc2VFeGNlcHRpb24sCiAgICBLZXl3b3JkLAogICAgX19kaWFnX18sCiAgICBfX2NvbXBhdF9fLAopCgoKY2xhc3MgcHlwYXJzaW5nX3Rlc3Q6CiAgICBcIlwiXCIKICAgIG5hbWVzcGFjZSBjbGFzcyBmb3IgY2xhc3NlcyB1c2VmdWwgaW4gd3JpdGluZyB1bml0IHRlc3RzCiAgICBcIlwiXCIKCiAgICBjbGFzcyByZXNldF9weXBhcnNpbmdfY29udGV4dDoKICAgICAgICBcIlwiXCIKICAgICAgICBDb250ZXh0IG1hbmFnZXIgdG8gYmUgdXNlZCB3aGVuIHdyaXRpbmcgdW5pdCB0ZXN0cyB0aGF0IG1vZGlmeSBweXBhcnNpbmcgY29uZmlnIHZhbHVlczoKICAgICAgICAtIHBhY2tyYXQgcGFyc2luZwogICAgICAgIC0gYm91bmRlZCByZWN1cnNpb24gcGFyc2luZwogICAgICAgIC0gZGVmYXVsdCB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMuCiAgICAgICAgLSBkZWZhdWx0IGtleXdvcmQgY2hhcmFjdGVycwogICAgICAgIC0gbGl0ZXJhbCBzdHJpbmcgYXV0by1jb252ZXJzaW9uIGNsYXNzCiAgICAgICAgLSBfX2RpYWdfXyBzZXR0aW5ncwoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIHdpdGggcmVzZXRfcHlwYXJzaW5nX2NvbnRleHQoKToKICAgICAgICAgICAgICAgICMgdGVzdCB0aGF0IGxpdGVyYWxzIHVzZWQgdG8gY29uc3RydWN0IGEgZ3JhbW1hciBhcmUgYXV0b21hdGljYWxseSBzdXBwcmVzc2VkCiAgICAgICAgICAgICAgICBQYXJzZXJFbGVtZW50LmlubGluZUxpdGVyYWxzVXNpbmcoU3VwcHJlc3MpCgogICAgICAgICAgICAgICAgdGVybSA9IFdvcmQoYWxwaGFzKSB8IFdvcmQobnVtcykKICAgICAgICAgICAgICAgIGdyb3VwID0gR3JvdXAoJygnICsgdGVybVsuLi5dICsgJyknKQoKICAgICAgICAgICAgICAgICMgYXNzZXJ0IHRoYXQgdGhlICcoKScgY2hhcmFjdGVycyBhcmUgbm90IGluY2x1ZGVkIGluIHRoZSBwYXJzZWQgdG9rZW5zCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFBhcnNlQW5kQ2hlY2tMaXN0KGdyb3VwLCBcIihhYmMgMTIzIGRlZilcIiwgWydhYmMnLCAnMTIzJywgJ2RlZiddKQoKICAgICAgICAgICAgIyBhZnRlciBleGl0aW5nIGNvbnRleHQgbWFuYWdlciwgbGl0ZXJhbHMgYXJlIGNvbnZlcnRlZCB0byBMaXRlcmFsIGV4cHJlc3Npb25zIGFnYWluCiAgICAgICAgXCJcIlwiCgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAgICAgc2VsZi5fc2F2ZV9jb250ZXh0ID0ge30KCiAgICAgICAgZGVmIHNhdmUoc2VsZik6CiAgICAgICAgICAgIHNlbGYuX3NhdmVfY29udGV4dFtcImRlZmF1bHRfd2hpdGVzcGFjZVwiXSA9IFBhcnNlckVsZW1lbnQuREVGQVVMVF9XSElURV9DSEFSUwogICAgICAgICAgICBzZWxmLl9zYXZlX2NvbnRleHRbXCJkZWZhdWx0X2tleXdvcmRfY2hhcnNcIl0gPSBLZXl3b3JkLkRFRkFVTFRfS0VZV09SRF9DSEFSUwoKICAgICAgICAgICAgc2VsZi5fc2F2ZV9jb250ZXh0WwogICAgICAgICAgICAgICAgXCJsaXRlcmFsX3N0cmluZ19jbGFzc1wiCiAgICAgICAgICAgIF0gPSBQYXJzZXJFbGVtZW50Ll9saXRlcmFsU3RyaW5nQ2xhc3MKCiAgICAgICAgICAgIHNlbGYuX3NhdmVfY29udGV4dFtcInZlcmJvc2Vfc3RhY2t0cmFjZVwiXSA9IFBhcnNlckVsZW1lbnQudmVyYm9zZV9zdGFja3RyYWNlCgogICAgICAgICAgICBzZWxmLl9zYXZlX2NvbnRleHRbXCJwYWNrcmF0X2VuYWJsZWRcIl0gPSBQYXJzZXJFbGVtZW50Ll9wYWNrcmF0RW5hYmxlZAogICAgICAgICAgICBpZiBQYXJzZXJFbGVtZW50Ll9wYWNrcmF0RW5hYmxlZDoKICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfY29udGV4dFsKICAgICAgICAgICAgICAgICAgICBcInBhY2tyYXRfY2FjaGVfc2l6ZVwiCiAgICAgICAgICAgICAgICBdID0gUGFyc2VyRWxlbWVudC5wYWNrcmF0X2NhY2hlLnNpemUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfY29udGV4dFtcInBhY2tyYXRfY2FjaGVfc2l6ZVwiXSA9IE5vbmUKICAgICAgICAgICAgc2VsZi5fc2F2ZV9jb250ZXh0W1wicGFja3JhdF9wYXJzZVwiXSA9IFBhcnNlckVsZW1lbnQuX3BhcnNlCiAgICAgICAgICAgIHNlbGYuX3NhdmVfY29udGV4dFsKICAgICAgICAgICAgICAgIFwicmVjdXJzaW9uX2VuYWJsZWRcIgogICAgICAgICAgICBdID0gUGFyc2VyRWxlbWVudC5fbGVmdF9yZWN1cnNpb25fZW5hYmxlZAoKICAgICAgICAgICAgc2VsZi5fc2F2ZV9jb250ZXh0W1wiX19kaWFnX19cIl0gPSB7CiAgICAgICAgICAgICAgICBuYW1lOiBnZXRhdHRyKF9fZGlhZ19fLCBuYW1lKSBmb3IgbmFtZSBpbiBfX2RpYWdfXy5fYWxsX25hbWVzCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbGYuX3NhdmVfY29udGV4dFtcIl9fY29tcGF0X19cIl0gPSB7CiAgICAgICAgICAgICAgICBcImNvbGxlY3RfYWxsX0FuZF90b2tlbnNcIjogX19jb21wYXRfXy5jb2xsZWN0X2FsbF9BbmRfdG9rZW5zCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBzZWxmCgogICAgICAgIGRlZiByZXN0b3JlKHNlbGYpOgogICAgICAgICAgICAjIHJlc2V0IHB5cGFyc2luZyBnbG9iYWwgc3RhdGUKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgUGFyc2VyRWxlbWVudC5ERUZBVUxUX1dISVRFX0NIQVJTCiAgICAgICAgICAgICAgICAhPSBzZWxmLl9zYXZlX2NvbnRleHRbXCJkZWZhdWx0X3doaXRlc3BhY2VcIl0KICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIFBhcnNlckVsZW1lbnQuc2V0X2RlZmF1bHRfd2hpdGVzcGFjZV9jaGFycygKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zYXZlX2NvbnRleHRbXCJkZWZhdWx0X3doaXRlc3BhY2VcIl0KICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIFBhcnNlckVsZW1lbnQudmVyYm9zZV9zdGFja3RyYWNlID0gc2VsZi5fc2F2ZV9jb250ZXh0W1widmVyYm9zZV9zdGFja3RyYWNlXCJdCgogICAgICAgICAgICBLZXl3b3JkLkRFRkFVTFRfS0VZV09SRF9DSEFSUyA9IHNlbGYuX3NhdmVfY29udGV4dFtcImRlZmF1bHRfa2V5d29yZF9jaGFyc1wiXQogICAgICAgICAgICBQYXJzZXJFbGVtZW50LmlubGluZUxpdGVyYWxzVXNpbmcoCiAgICAgICAgICAgICAgICBzZWxmLl9zYXZlX2NvbnRleHRbXCJsaXRlcmFsX3N0cmluZ19jbGFzc1wiXQogICAgICAgICAgICApCgogICAgICAgICAgICBmb3IgbmFtZSwgdmFsdWUgaW4gc2VsZi5fc2F2ZV9jb250ZXh0W1wiX19kaWFnX19cIl0uaXRlbXMoKToKICAgICAgICAgICAgICAgIChfX2RpYWdfXy5lbmFibGUgaWYgdmFsdWUgZWxzZSBfX2RpYWdfXy5kaXNhYmxlKShuYW1lKQoKICAgICAgICAgICAgUGFyc2VyRWxlbWVudC5fcGFja3JhdEVuYWJsZWQgPSBGYWxzZQogICAgICAgICAgICBpZiBzZWxmLl9zYXZlX2NvbnRleHRbXCJwYWNrcmF0X2VuYWJsZWRcIl06CiAgICAgICAgICAgICAgICBQYXJzZXJFbGVtZW50LmVuYWJsZV9wYWNrcmF0KHNlbGYuX3NhdmVfY29udGV4dFtcInBhY2tyYXRfY2FjaGVfc2l6ZVwiXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIFBhcnNlckVsZW1lbnQuX3BhcnNlID0gc2VsZi5fc2F2ZV9jb250ZXh0W1wicGFja3JhdF9wYXJzZVwiXQogICAgICAgICAgICBQYXJzZXJFbGVtZW50Ll9sZWZ0X3JlY3Vyc2lvbl9lbmFibGVkID0gc2VsZi5fc2F2ZV9jb250ZXh0WwogICAgICAgICAgICAgICAgXCJyZWN1cnNpb25fZW5hYmxlZFwiCiAgICAgICAgICAgIF0KCiAgICAgICAgICAgIF9fY29tcGF0X18uY29sbGVjdF9hbGxfQW5kX3Rva2VucyA9IHNlbGYuX3NhdmVfY29udGV4dFtcIl9fY29tcGF0X19cIl0KCiAgICAgICAgICAgIHJldHVybiBzZWxmCgogICAgICAgIGRlZiBjb3B5KHNlbGYpOgogICAgICAgICAgICByZXQgPSB0eXBlKHNlbGYpKCkKICAgICAgICAgICAgcmV0Ll9zYXZlX2NvbnRleHQudXBkYXRlKHNlbGYuX3NhdmVfY29udGV4dCkKICAgICAgICAgICAgcmV0dXJuIHJldAoKICAgICAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zYXZlKCkKCiAgICAgICAgZGVmIF9fZXhpdF9fKHNlbGYsICphcmdzKToKICAgICAgICAgICAgc2VsZi5yZXN0b3JlKCkKCiAgICBjbGFzcyBUZXN0UGFyc2VSZXN1bHRzQXNzZXJ0czoKICAgICAgICBcIlwiXCIKICAgICAgICBBIG1peGluIGNsYXNzIHRvIGFkZCBwYXJzZSByZXN1bHRzIGFzc2VydGlvbiBtZXRob2RzIHRvIG5vcm1hbCB1bml0dGVzdC5UZXN0Q2FzZSBjbGFzc2VzLgogICAgICAgIFwiXCJcIgoKICAgICAgICBkZWYgYXNzZXJ0UGFyc2VSZXN1bHRzRXF1YWxzKAogICAgICAgICAgICBzZWxmLCByZXN1bHQsIGV4cGVjdGVkX2xpc3Q9Tm9uZSwgZXhwZWN0ZWRfZGljdD1Ob25lLCBtc2c9Tm9uZQogICAgICAgICk6CiAgICAgICAgICAgIFwiXCJcIgogICAgICAgICAgICBVbml0IHRlc3QgYXNzZXJ0aW9uIHRvIGNvbXBhcmUgYSA6Y2xhc3M6YFBhcnNlUmVzdWx0c2Agb2JqZWN0IHdpdGggYW4gb3B0aW9uYWwgYGBleHBlY3RlZF9saXN0YGAsCiAgICAgICAgICAgIGFuZCBjb21wYXJlIGFueSBkZWZpbmVkIHJlc3VsdHMgbmFtZXMgd2l0aCBhbiBvcHRpb25hbCBgYGV4cGVjdGVkX2RpY3RgYC4KICAgICAgICAgICAgXCJcIlwiCiAgICAgICAgICAgIGlmIGV4cGVjdGVkX2xpc3QgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV4cGVjdGVkX2xpc3QsIHJlc3VsdC5hc19saXN0KCksIG1zZz1tc2cpCiAgICAgICAgICAgIGlmIGV4cGVjdGVkX2RpY3QgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV4cGVjdGVkX2RpY3QsIHJlc3VsdC5hc19kaWN0KCksIG1zZz1tc2cpCgogICAgICAgIGRlZiBhc3NlcnRQYXJzZUFuZENoZWNrTGlzdCgKICAgICAgICAgICAgc2VsZiwgZXhwciwgdGVzdF9zdHJpbmcsIGV4cGVjdGVkX2xpc3QsIG1zZz1Ob25lLCB2ZXJib3NlPVRydWUKICAgICAgICApOgogICAgICAgICAgICBcIlwiXCIKICAgICAgICAgICAgQ29udmVuaWVuY2Ugd3JhcHBlciBhc3NlcnQgdG8gdGVzdCBhIHBhcnNlciBlbGVtZW50IGFuZCBpbnB1dCBzdHJpbmcsIGFuZCBhc3NlcnQgdGhhdAogICAgICAgICAgICB0aGUgcmVzdWx0aW5nIGBgUGFyc2VSZXN1bHRzLmFzTGlzdCgpYGAgaXMgZXF1YWwgdG8gdGhlIGBgZXhwZWN0ZWRfbGlzdGBgLgogICAgICAgICAgICBcIlwiXCIKICAgICAgICAgICAgcmVzdWx0ID0gZXhwci5wYXJzZV9zdHJpbmcodGVzdF9zdHJpbmcsIHBhcnNlX2FsbD1UcnVlKQogICAgICAgICAgICBpZiB2ZXJib3NlOgogICAgICAgICAgICAgICAgcHJpbnQocmVzdWx0LmR1bXAoKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KHJlc3VsdC5hc19saXN0KCkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UGFyc2VSZXN1bHRzRXF1YWxzKHJlc3VsdCwgZXhwZWN0ZWRfbGlzdD1leHBlY3RlZF9saXN0LCBtc2c9bXNnKQoKICAgICAgICBkZWYgYXNzZXJ0UGFyc2VBbmRDaGVja0RpY3QoCiAgICAgICAgICAgIHNlbGYsIGV4cHIsIHRlc3Rfc3RyaW5nLCBleHBlY3RlZF9kaWN0LCBtc2c9Tm9uZSwgdmVyYm9zZT1UcnVlCiAgICAgICAgKToKICAgICAgICAgICAgXCJcIlwiCiAgICAgICAgICAgIENvbnZlbmllbmNlIHdyYXBwZXIgYXNzZXJ0IHRvIHRlc3QgYSBwYXJzZXIgZWxlbWVudCBhbmQgaW5wdXQgc3RyaW5nLCBhbmQgYXNzZXJ0IHRoYXQKICAgICAgICAgICAgdGhlIHJlc3VsdGluZyBgYFBhcnNlUmVzdWx0cy5hc0RpY3QoKWBgIGlzIGVxdWFsIHRvIHRoZSBgYGV4cGVjdGVkX2RpY3RgYC4KICAgICAgICAgICAgXCJcIlwiCiAgICAgICAgICAgIHJlc3VsdCA9IGV4cHIucGFyc2Vfc3RyaW5nKHRlc3Rfc3RyaW5nLCBwYXJzZUFsbD1UcnVlKQogICAgICAgICAgICBpZiB2ZXJib3NlOgogICAgICAgICAgICAgICAgcHJpbnQocmVzdWx0LmR1bXAoKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KHJlc3VsdC5hc19saXN0KCkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UGFyc2VSZXN1bHRzRXF1YWxzKHJlc3VsdCwgZXhwZWN0ZWRfZGljdD1leHBlY3RlZF9kaWN0LCBtc2c9bXNnKQoKICAgICAgICBkZWYgYXNzZXJ0UnVuVGVzdFJlc3VsdHMoCiAgICAgICAgICAgIHNlbGYsIHJ1bl90ZXN0c19yZXBvcnQsIGV4cGVjdGVkX3BhcnNlX3Jlc3VsdHM9Tm9uZSwgbXNnPU5vbmUKICAgICAgICApOgogICAgICAgICAgICBcIlwiXCIKICAgICAgICAgICAgVW5pdCB0ZXN0IGFzc2VydGlvbiB0byBldmFsdWF0ZSBvdXRwdXQgb2YgYGBQYXJzZXJFbGVtZW50LnJ1blRlc3RzKClgYC4gSWYgYSBsaXN0IG9mCiAgICAgICAgICAgIGxpc3QtZGljdCB0dXBsZXMgaXMgZ2l2ZW4gYXMgdGhlIGBgZXhwZWN0ZWRfcGFyc2VfcmVzdWx0c2BgIGFyZ3VtZW50LCB0aGVuIHRoZXNlIGFyZSB6aXBwZWQKICAgICAgICAgICAgd2l0aCB0aGUgcmVwb3J0IHR1cGxlcyByZXR1cm5lZCBieSBgYHJ1blRlc3RzYGAgYW5kIGV2YWx1YXRlZCB1c2luZyBgYGFzc2VydFBhcnNlUmVzdWx0c0VxdWFsc2BgLgogICAgICAgICAgICBGaW5hbGx5LCBhc3NlcnRzIHRoYXQgdGhlIG92ZXJhbGwgYGBydW5UZXN0cygpYGAgc3VjY2VzcyB2YWx1ZSBpcyBgYFRydWVgYC4KCiAgICAgICAgICAgIDpwYXJhbSBydW5fdGVzdHNfcmVwb3J0OiB0dXBsZShib29sLCBbdHVwbGUoc3RyLCBQYXJzZVJlc3VsdHMgb3IgRXhjZXB0aW9uKV0pIHJldHVybmVkIGZyb20gcnVuVGVzdHMKICAgICAgICAgICAgOnBhcmFtIGV4cGVjdGVkX3BhcnNlX3Jlc3VsdHMgKG9wdGlvbmFsKTogW3R1cGxlKHN0ciwgbGlzdCwgZGljdCwgRXhjZXB0aW9uKV0KICAgICAgICAgICAgXCJcIlwiCiAgICAgICAgICAgIHJ1bl90ZXN0X3N1Y2Nlc3MsIHJ1bl90ZXN0X3Jlc3VsdHMgPSBydW5fdGVzdHNfcmVwb3J0CgogICAgICAgICAgICBpZiBleHBlY3RlZF9wYXJzZV9yZXN1bHRzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgbWVyZ2VkID0gWwogICAgICAgICAgICAgICAgICAgICgqcnB0LCBleHBlY3RlZCkKICAgICAgICAgICAgICAgICAgICBmb3IgcnB0LCBleHBlY3RlZCBpbiB6aXAocnVuX3Rlc3RfcmVzdWx0cywgZXhwZWN0ZWRfcGFyc2VfcmVzdWx0cykKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIGZvciB0ZXN0X3N0cmluZywgcmVzdWx0LCBleHBlY3RlZCBpbiBtZXJnZWQ6CiAgICAgICAgICAgICAgICAgICAgIyBleHBlY3RlZCBzaG91bGQgYmUgYSB0dXBsZSBjb250YWluaW5nIGEgbGlzdCBhbmQvb3IgYSBkaWN0IG9yIGFuIGV4Y2VwdGlvbiwKICAgICAgICAgICAgICAgICAgICAjIGFuZCBvcHRpb25hbCBmYWlsdXJlIG1lc3NhZ2Ugc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgIyBhbiBlbXB0eSB0dXBsZSB3aWxsIHNraXAgYW55IHJlc3VsdCB2YWxpZGF0aW9uCiAgICAgICAgICAgICAgICAgICAgZmFpbF9tc2cgPSBuZXh0KAogICAgICAgICAgICAgICAgICAgICAgICAoZXhwIGZvciBleHAgaW4gZXhwZWN0ZWQgaWYgaXNpbnN0YW5jZShleHAsIHN0cikpLCBOb25lCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkX2V4Y2VwdGlvbiA9IG5leHQoCiAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGV4cCBpbiBleHBlY3RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShleHAsIHR5cGUpIGFuZCBpc3N1YmNsYXNzKGV4cCwgRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICBOb25lLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBpZiBleHBlY3RlZF9leGNlcHRpb24gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9leGNlcHRpb249ZXhwZWN0ZWRfZXhjZXB0aW9uLCBtc2c9ZmFpbF9tc2cgb3IgbXNnCiAgICAgICAgICAgICAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHJlc3VsdCwgRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWlzZSByZXN1bHQKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9saXN0ID0gbmV4dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChleHAgZm9yIGV4cCBpbiBleHBlY3RlZCBpZiBpc2luc3RhbmNlKGV4cCwgbGlzdCkpLCBOb25lCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfZGljdCA9IG5leHQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXhwIGZvciBleHAgaW4gZXhwZWN0ZWQgaWYgaXNpbnN0YW5jZShleHAsIGRpY3QpKSwgTm9uZQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBlY3RlZF9saXN0LCBleHBlY3RlZF9kaWN0KSAhPSAoTm9uZSwgTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFBhcnNlUmVzdWx0c0VxdWFscygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfbGlzdD1leHBlY3RlZF9saXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkX2RpY3Q9ZXhwZWN0ZWRfZGljdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2c9ZmFpbF9tc2cgb3IgbXNnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3YXJuaW5nIGhlcmUgbWF5YmU/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludChcIm5vIHZhbGlkYXRpb24gZm9yIHshcn1cIi5mb3JtYXQodGVzdF9zdHJpbmcpKQoKICAgICAgICAgICAgIyBkbyB0aGlzIGxhc3QsIGluIGNhc2Ugc29tZSBzcGVjaWZpYyB0ZXN0IHJlc3VsdHMgY2FuIGJlIHJlcG9ydGVkIGluc3RlYWQKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKAogICAgICAgICAgICAgICAgcnVuX3Rlc3Rfc3VjY2VzcywgbXNnPW1zZyBpZiBtc2cgaXMgbm90IE5vbmUgZWxzZSBcImZhaWxlZCBydW5UZXN0c1wiCiAgICAgICAgICAgICkKCiAgICAgICAgQGNvbnRleHRtYW5hZ2VyCiAgICAgICAgZGVmIGFzc2VydFJhaXNlc1BhcnNlRXhjZXB0aW9uKHNlbGYsIGV4Y190eXBlPVBhcnNlRXhjZXB0aW9uLCBtc2c9Tm9uZSk6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoZXhjX3R5cGUsIG1zZz1tc2cpOgogICAgICAgICAgICAgICAgeWllbGQKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgd2l0aF9saW5lX251bWJlcnMoCiAgICAgICAgczogc3RyLAogICAgICAgIHN0YXJ0X2xpbmU6IHR5cGluZy5PcHRpb25hbFtpbnRdID0gTm9uZSwKICAgICAgICBlbmRfbGluZTogdHlwaW5nLk9wdGlvbmFsW2ludF0gPSBOb25lLAogICAgICAgIGV4cGFuZF90YWJzOiBib29sID0gVHJ1ZSwKICAgICAgICBlb2xfbWFyazogc3RyID0gXCJ8XCIsCiAgICAgICAgbWFya19zcGFjZXM6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICBtYXJrX2NvbnRyb2w6IHR5cGluZy5PcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICkgLT4gc3RyOgogICAgICAgIFwiXCJcIgogICAgICAgIEhlbHBmdWwgbWV0aG9kIGZvciBkZWJ1Z2dpbmcgYSBwYXJzZXIgLSBwcmludHMgYSBzdHJpbmcgd2l0aCBsaW5lIGFuZCBjb2x1bW4gbnVtYmVycy4KICAgICAgICAoTGluZSBhbmQgY29sdW1uIG51bWJlcnMgYXJlIDEtYmFzZWQuKQoKICAgICAgICA6cGFyYW0gczogdHVwbGUoYm9vbCwgc3RyIC0gc3RyaW5nIHRvIGJlIHByaW50ZWQgd2l0aCBsaW5lIGFuZCBjb2x1bW4gbnVtYmVycwogICAgICAgIDpwYXJhbSBzdGFydF9saW5lOiBpbnQgLSAob3B0aW9uYWwpIHN0YXJ0aW5nIGxpbmUgbnVtYmVyIGluIHMgdG8gcHJpbnQgKGRlZmF1bHQ9MSkKICAgICAgICA6cGFyYW0gZW5kX2xpbmU6IGludCAtIChvcHRpb25hbCkgZW5kaW5nIGxpbmUgbnVtYmVyIGluIHMgdG8gcHJpbnQgKGRlZmF1bHQ9bGVuKHMpKQogICAgICAgIDpwYXJhbSBleHBhbmRfdGFiczogYm9vbCAtIChvcHRpb25hbCkgZXhwYW5kIHRhYnMgdG8gc3BhY2VzLCB0byBtYXRjaCB0aGUgcHlwYXJzaW5nIGRlZmF1bHQKICAgICAgICA6cGFyYW0gZW9sX21hcms6IHN0ciAtIChvcHRpb25hbCkgc3RyaW5nIHRvIG1hcmsgdGhlIGVuZCBvZiBsaW5lcywgaGVscHMgdmlzdWFsaXplIHRyYWlsaW5nIHNwYWNlcyAoZGVmYXVsdD1cInxcIikKICAgICAgICA6cGFyYW0gbWFya19zcGFjZXM6IHN0ciAtIChvcHRpb25hbCkgc3BlY2lhbCBjaGFyYWN0ZXIgdG8gZGlzcGxheSBpbiBwbGFjZSBvZiBzcGFjZXMKICAgICAgICA6cGFyYW0gbWFya19jb250cm9sOiBzdHIgLSAob3B0aW9uYWwpIGNvbnZlcnQgbm9uLXByaW50aW5nIGNvbnRyb2wgY2hhcmFjdGVycyB0byBhIHBsYWNlaG9sZGluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI7IHZhbGlkIHZhbHVlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBcInVuaWNvZGVcIiAtIHJlcGxhY2VzIGNvbnRyb2wgY2hhcnMgd2l0aCBVbmljb2RlIHN5bWJvbHMsIHN1Y2ggYXMgXCLikI1cIiBhbmQgXCLikIpcIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGFueSBzaW5nbGUgY2hhcmFjdGVyIHN0cmluZyAtIHJlcGxhY2UgY29udHJvbCBjaGFyYWN0ZXJzIHdpdGggZ2l2ZW4gc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gTm9uZSAoZGVmYXVsdCkgLSBzdHJpbmcgaXMgZGlzcGxheWVkIGFzLWlzCgogICAgICAgIDpyZXR1cm46IHN0ciAtIGlucHV0IHN0cmluZyB3aXRoIGxlYWRpbmcgbGluZSBudW1iZXJzIGFuZCBjb2x1bW4gbnVtYmVyIGhlYWRlcnMKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBleHBhbmRfdGFiczoKICAgICAgICAgICAgcyA9IHMuZXhwYW5kdGFicygpCiAgICAgICAgaWYgbWFya19jb250cm9sIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBtYXJrX2NvbnRyb2wgPT0gXCJ1bmljb2RlXCI6CiAgICAgICAgICAgICAgICB0YmwgPSBzdHIubWFrZXRyYW5zKAogICAgICAgICAgICAgICAgICAgIHtjOiB1IGZvciBjLCB1IGluIHppcChyYW5nZSgwLCAzMyksIHJhbmdlKDB4MjQwMCwgMHgyNDMzKSl9CiAgICAgICAgICAgICAgICAgICAgfCB7MTI3OiAweDI0MjF9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBlb2xfbWFyayA9IFwiXCIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRibCA9IHN0ci5tYWtldHJhbnMoCiAgICAgICAgICAgICAgICAgICAge2M6IG1hcmtfY29udHJvbCBmb3IgYyBpbiBsaXN0KHJhbmdlKDAsIDMyKSkgKyBbMTI3XX0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgcyA9IHMudHJhbnNsYXRlKHRibCkKICAgICAgICBpZiBtYXJrX3NwYWNlcyBpcyBub3QgTm9uZSBhbmQgbWFya19zcGFjZXMgIT0gXCIgXCI6CiAgICAgICAgICAgIGlmIG1hcmtfc3BhY2VzID09IFwidW5pY29kZVwiOgogICAgICAgICAgICAgICAgdGJsID0gc3RyLm1ha2V0cmFucyh7OTogMHgyNDA5LCAzMjogMHgyNDIzfSkKICAgICAgICAgICAgICAgIHMgPSBzLnRyYW5zbGF0ZSh0YmwpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzID0gcy5yZXBsYWNlKFwiIFwiLCBtYXJrX3NwYWNlcykKICAgICAgICBpZiBzdGFydF9saW5lIGlzIE5vbmU6CiAgICAgICAgICAgIHN0YXJ0X2xpbmUgPSAxCiAgICAgICAgaWYgZW5kX2xpbmUgaXMgTm9uZToKICAgICAgICAgICAgZW5kX2xpbmUgPSBsZW4ocykKICAgICAgICBlbmRfbGluZSA9IG1pbihlbmRfbGluZSwgbGVuKHMpKQogICAgICAgIHN0YXJ0X2xpbmUgPSBtaW4obWF4KDEsIHN0YXJ0X2xpbmUpLCBlbmRfbGluZSkKCiAgICAgICAgaWYgbWFya19jb250cm9sICE9IFwidW5pY29kZVwiOgogICAgICAgICAgICBzX2xpbmVzID0gcy5zcGxpdGxpbmVzKClbc3RhcnRfbGluZSAtIDEgOiBlbmRfbGluZV0KICAgICAgICBlbHNlOgogICAgICAgICAgICBzX2xpbmVzID0gW2xpbmUgKyBcIuKQilwiIGZvciBsaW5lIGluIHMuc3BsaXQoXCLikIpcIilbc3RhcnRfbGluZSAtIDEgOiBlbmRfbGluZV1dCiAgICAgICAgaWYgbm90IHNfbGluZXM6CiAgICAgICAgICAgIHJldHVybiBcIlwiCgogICAgICAgIGxpbmVub193aWR0aCA9IGxlbihzdHIoZW5kX2xpbmUpKQogICAgICAgIG1heF9saW5lX2xlbiA9IG1heChsZW4obGluZSkgZm9yIGxpbmUgaW4gc19saW5lcykKICAgICAgICBsZWFkID0gXCIgXCIgKiAobGluZW5vX3dpZHRoICsgMSkKICAgICAgICBpZiBtYXhfbGluZV9sZW4gPj0gOTk6CiAgICAgICAgICAgIGhlYWRlcjAgPSAoCiAgICAgICAgICAgICAgICBsZWFkCiAgICAgICAgICAgICAgICArIFwiXCIuam9pbigKICAgICAgICAgICAgICAgICAgICBcInt9e31cIi5mb3JtYXQoXCIgXCIgKiA5OSwgKGkgKyAxKSAlIDEwMCkKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZShtYXgobWF4X2xpbmVfbGVuIC8vIDEwMCwgMSkpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICArIFwiXFxuXCIKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhlYWRlcjAgPSBcIlwiCiAgICAgICAgaGVhZGVyMSA9ICgKICAgICAgICAgICAgaGVhZGVyMAogICAgICAgICAgICArIGxlYWQKICAgICAgICAgICAgKyBcIlwiLmpvaW4oCiAgICAgICAgICAgICAgICBcIiAgICAgICAgIHt9XCIuZm9ybWF0KChpICsgMSkgJSAxMCkKICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKC0oLW1heF9saW5lX2xlbiAvLyAxMCkpCiAgICAgICAgICAgICkKICAgICAgICAgICAgKyBcIlxcblwiCiAgICAgICAgKQogICAgICAgIGhlYWRlcjIgPSBsZWFkICsgXCIxMjM0NTY3ODkwXCIgKiAoLSgtbWF4X2xpbmVfbGVuIC8vIDEwKSkgKyBcIlxcblwiCiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgaGVhZGVyMQogICAgICAgICAgICArIGhlYWRlcjIKICAgICAgICAgICAgKyBcIlxcblwiLmpvaW4oCiAgICAgICAgICAgICAgICBcIns6e31kfTp7fXt9XCIuZm9ybWF0KGksIGxpbmVub193aWR0aCwgbGluZSwgZW9sX21hcmspCiAgICAgICAgICAgICAgICBmb3IgaSwgbGluZSBpbiBlbnVtZXJhdGUoc19saW5lcywgc3RhcnQ9c3RhcnRfbGluZSkKICAgICAgICAgICAgKQogICAgICAgICAgICArIFwiXFxuXCIKICAgICAgICApCgoiIiIKbW9kdWxlX2RpY3RbInB5cGFyc2luZy9leGNlcHRpb25zLnB5Il09IiIiCiMgZXhjZXB0aW9ucy5weQoKaW1wb3J0IHJlCmltcG9ydCBzeXMKaW1wb3J0IHR5cGluZwoKZnJvbSAudXRpbCBpbXBvcnQgY29sLCBsaW5lLCBsaW5lbm8sIF9jb2xsYXBzZV9zdHJpbmdfdG9fcmFuZ2VzCmZyb20gLnVuaWNvZGUgaW1wb3J0IHB5cGFyc2luZ191bmljb2RlIGFzIHBwdQoKCmNsYXNzIEV4Y2VwdGlvbldvcmRVbmljb2RlKHBwdS5MYXRpbjEsIHBwdS5MYXRpbkEsIHBwdS5MYXRpbkIsIHBwdS5HcmVlaywgcHB1LkN5cmlsbGljKToKICAgIHBhc3MKCgpfZXh0cmFjdF9hbHBoYW51bXMgPSBfY29sbGFwc2Vfc3RyaW5nX3RvX3JhbmdlcyhFeGNlcHRpb25Xb3JkVW5pY29kZS5hbHBoYW51bXMpCl9leGNlcHRpb25fd29yZF9leHRyYWN0b3IgPSByZS5jb21waWxlKFwiKFtcIiArIF9leHRyYWN0X2FscGhhbnVtcyArIFwiXXsxLDE2fSl8LlwiKQoKCmNsYXNzIFBhcnNlQmFzZUV4Y2VwdGlvbihFeGNlcHRpb24pOgogICAgXCJcIlwiYmFzZSBleGNlcHRpb24gY2xhc3MgZm9yIGFsbCBwYXJzaW5nIHJ1bnRpbWUgZXhjZXB0aW9uc1wiXCJcIgoKICAgICMgUGVyZm9ybWFuY2UgdHVuaW5nOiB3ZSBjb25zdHJ1Y3QgYSAqbG90KiBvZiB0aGVzZSwgc28ga2VlcCB0aGlzCiAgICAjIGNvbnN0cnVjdG9yIGFzIHNtYWxsIGFuZCBmYXN0IGFzIHBvc3NpYmxlCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICBwc3RyOiBzdHIsCiAgICAgICAgbG9jOiBpbnQgPSAwLAogICAgICAgIG1zZzogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgIGVsZW09Tm9uZSwKICAgICk6CiAgICAgICAgc2VsZi5sb2MgPSBsb2MKICAgICAgICBpZiBtc2cgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5tc2cgPSBwc3RyCiAgICAgICAgICAgIHNlbGYucHN0ciA9IFwiXCIKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1zZyA9IG1zZwogICAgICAgICAgICBzZWxmLnBzdHIgPSBwc3RyCiAgICAgICAgc2VsZi5wYXJzZXJfZWxlbWVudCA9IHNlbGYucGFyc2VyRWxlbWVudCA9IGVsZW0KICAgICAgICBzZWxmLmFyZ3MgPSAocHN0ciwgbG9jLCBtc2cpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGV4cGxhaW5fZXhjZXB0aW9uKGV4YywgZGVwdGg9MTYpOgogICAgICAgIFwiXCJcIgogICAgICAgIE1ldGhvZCB0byB0YWtlIGFuIGV4Y2VwdGlvbiBhbmQgdHJhbnNsYXRlIHRoZSBQeXRob24gaW50ZXJuYWwgdHJhY2ViYWNrIGludG8gYSBsaXN0CiAgICAgICAgb2YgdGhlIHB5cGFyc2luZyBleHByZXNzaW9ucyB0aGF0IGNhdXNlZCB0aGUgZXhjZXB0aW9uIHRvIGJlIHJhaXNlZC4KCiAgICAgICAgUGFyYW1ldGVyczoKCiAgICAgICAgLSBleGMgLSBleGNlcHRpb24gcmFpc2VkIGR1cmluZyBwYXJzaW5nIChuZWVkIG5vdCBiZSBhIFBhcnNlRXhjZXB0aW9uLCBpbiBzdXBwb3J0CiAgICAgICAgICBvZiBQeXRob24gZXhjZXB0aW9ucyB0aGF0IG1pZ2h0IGJlIHJhaXNlZCBpbiBhIHBhcnNlIGFjdGlvbikKICAgICAgICAtIGRlcHRoIChkZWZhdWx0PTE2KSAtIG51bWJlciBvZiBsZXZlbHMgYmFjayBpbiB0aGUgc3RhY2sgdHJhY2UgdG8gbGlzdCBleHByZXNzaW9uCiAgICAgICAgICBhbmQgZnVuY3Rpb24gbmFtZXM7IGlmIE5vbmUsIHRoZSBmdWxsIHN0YWNrIHRyYWNlIG5hbWVzIHdpbGwgYmUgbGlzdGVkOyBpZiAwLCBvbmx5CiAgICAgICAgICB0aGUgZmFpbGluZyBpbnB1dCBsaW5lLCBtYXJrZXIsIGFuZCBleGNlcHRpb24gc3RyaW5nIHdpbGwgYmUgc2hvd24KCiAgICAgICAgUmV0dXJucyBhIG11bHRpLWxpbmUgc3RyaW5nIGxpc3RpbmcgdGhlIFBhcnNlckVsZW1lbnRzIGFuZC9vciBmdW5jdGlvbiBuYW1lcyBpbiB0aGUKICAgICAgICBleGNlcHRpb24ncyBzdGFjayB0cmFjZS4KICAgICAgICBcIlwiXCIKICAgICAgICBpbXBvcnQgaW5zcGVjdAogICAgICAgIGZyb20gLmNvcmUgaW1wb3J0IFBhcnNlckVsZW1lbnQKCiAgICAgICAgaWYgZGVwdGggaXMgTm9uZToKICAgICAgICAgICAgZGVwdGggPSBzeXMuZ2V0cmVjdXJzaW9ubGltaXQoKQogICAgICAgIHJldCA9IFtdCiAgICAgICAgaWYgaXNpbnN0YW5jZShleGMsIFBhcnNlQmFzZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHJldC5hcHBlbmQoZXhjLmxpbmUpCiAgICAgICAgICAgIHJldC5hcHBlbmQoXCIgXCIgKiAoZXhjLmNvbHVtbiAtIDEpICsgXCJeXCIpCiAgICAgICAgcmV0LmFwcGVuZChcInt9OiB7fVwiLmZvcm1hdCh0eXBlKGV4YykuX19uYW1lX18sIGV4YykpCgogICAgICAgIGlmIGRlcHRoID4gMDoKICAgICAgICAgICAgY2FsbGVycyA9IGluc3BlY3QuZ2V0aW5uZXJmcmFtZXMoZXhjLl9fdHJhY2ViYWNrX18sIGNvbnRleHQ9ZGVwdGgpCiAgICAgICAgICAgIHNlZW4gPSBzZXQoKQogICAgICAgICAgICBmb3IgaSwgZmYgaW4gZW51bWVyYXRlKGNhbGxlcnNbLWRlcHRoOl0pOgogICAgICAgICAgICAgICAgZnJtID0gZmZbMF0KCiAgICAgICAgICAgICAgICBmX3NlbGYgPSBmcm0uZl9sb2NhbHMuZ2V0KFwic2VsZlwiLCBOb25lKQogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShmX3NlbGYsIFBhcnNlckVsZW1lbnQpOgogICAgICAgICAgICAgICAgICAgIGlmIGZybS5mX2NvZGUuY29fbmFtZSBub3QgaW4gKFwicGFyc2VJbXBsXCIsIFwiX3BhcnNlTm9DYWNoZVwiKToKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICBpZiBpZChmX3NlbGYpIGluIHNlZW46CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgc2Vlbi5hZGQoaWQoZl9zZWxmKSkKCiAgICAgICAgICAgICAgICAgICAgc2VsZl90eXBlID0gdHlwZShmX3NlbGYpCiAgICAgICAgICAgICAgICAgICAgcmV0LmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgXCJ7fS57fSAtIHt9XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZl90eXBlLl9fbW9kdWxlX18sIHNlbGZfdHlwZS5fX25hbWVfXywgZl9zZWxmCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgZWxpZiBmX3NlbGYgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZl90eXBlID0gdHlwZShmX3NlbGYpCiAgICAgICAgICAgICAgICAgICAgcmV0LmFwcGVuZChcInt9Lnt9XCIuZm9ybWF0KHNlbGZfdHlwZS5fX21vZHVsZV9fLCBzZWxmX3R5cGUuX19uYW1lX18pKQoKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgY29kZSA9IGZybS5mX2NvZGUKICAgICAgICAgICAgICAgICAgICBpZiBjb2RlLmNvX25hbWUgaW4gKFwid3JhcHBlclwiLCBcIjxtb2R1bGU+XCIpOgogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgICAgICByZXQuYXBwZW5kKFwie31cIi5mb3JtYXQoY29kZS5jb19uYW1lKSkKCiAgICAgICAgICAgICAgICBkZXB0aCAtPSAxCiAgICAgICAgICAgICAgICBpZiBub3QgZGVwdGg6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgcmV0dXJuIFwiXFxuXCIuam9pbihyZXQpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX2Zyb21fZXhjZXB0aW9uKGNscywgcGUpOgogICAgICAgIFwiXCJcIgogICAgICAgIGludGVybmFsIGZhY3RvcnkgbWV0aG9kIHRvIHNpbXBsaWZ5IGNyZWF0aW5nIG9uZSB0eXBlIG9mIFBhcnNlRXhjZXB0aW9uCiAgICAgICAgZnJvbSBhbm90aGVyIC0gYXZvaWRzIGhhdmluZyBfX2luaXRfXyBzaWduYXR1cmUgY29uZmxpY3RzIGFtb25nIHN1YmNsYXNzZXMKICAgICAgICBcIlwiXCIKICAgICAgICByZXR1cm4gY2xzKHBlLnBzdHIsIHBlLmxvYywgcGUubXNnLCBwZS5wYXJzZXJFbGVtZW50KQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGxpbmUoc2VsZikgLT4gc3RyOgogICAgICAgIFwiXCJcIgogICAgICAgIFJldHVybiB0aGUgbGluZSBvZiB0ZXh0IHdoZXJlIHRoZSBleGNlcHRpb24gb2NjdXJyZWQuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIGxpbmUoc2VsZi5sb2MsIHNlbGYucHN0cikKCiAgICBAcHJvcGVydHkKICAgIGRlZiBsaW5lbm8oc2VsZikgLT4gaW50OgogICAgICAgIFwiXCJcIgogICAgICAgIFJldHVybiB0aGUgMS1iYXNlZCBsaW5lIG51bWJlciBvZiB0ZXh0IHdoZXJlIHRoZSBleGNlcHRpb24gb2NjdXJyZWQuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIGxpbmVubyhzZWxmLmxvYywgc2VsZi5wc3RyKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGNvbChzZWxmKSAtPiBpbnQ6CiAgICAgICAgXCJcIlwiCiAgICAgICAgUmV0dXJuIHRoZSAxLWJhc2VkIGNvbHVtbiBvbiB0aGUgbGluZSBvZiB0ZXh0IHdoZXJlIHRoZSBleGNlcHRpb24gb2NjdXJyZWQuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIGNvbChzZWxmLmxvYywgc2VsZi5wc3RyKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGNvbHVtbihzZWxmKSAtPiBpbnQ6CiAgICAgICAgXCJcIlwiCiAgICAgICAgUmV0dXJuIHRoZSAxLWJhc2VkIGNvbHVtbiBvbiB0aGUgbGluZSBvZiB0ZXh0IHdoZXJlIHRoZSBleGNlcHRpb24gb2NjdXJyZWQuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIGNvbChzZWxmLmxvYywgc2VsZi5wc3RyKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpIC0+IHN0cjoKICAgICAgICBpZiBzZWxmLnBzdHI6CiAgICAgICAgICAgIGlmIHNlbGYubG9jID49IGxlbihzZWxmLnBzdHIpOgogICAgICAgICAgICAgICAgZm91bmRzdHIgPSBcIiwgZm91bmQgZW5kIG9mIHRleHRcIgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBwdWxsIG91dCBuZXh0IHdvcmQgYXQgZXJyb3IgbG9jYXRpb24KICAgICAgICAgICAgICAgIGZvdW5kX21hdGNoID0gX2V4Y2VwdGlvbl93b3JkX2V4dHJhY3Rvci5tYXRjaChzZWxmLnBzdHIsIHNlbGYubG9jKQogICAgICAgICAgICAgICAgaWYgZm91bmRfbWF0Y2ggaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBmb3VuZF9tYXRjaC5ncm91cCgwKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHNlbGYucHN0cltzZWxmLmxvYyA6IHNlbGYubG9jICsgMV0KICAgICAgICAgICAgICAgIGZvdW5kc3RyID0gKFwiLCBmb3VuZCAlclwiICUgZm91bmQpLnJlcGxhY2UoclwiXFxcXFwiLCBcIlxcXFxcIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBmb3VuZHN0ciA9IFwiXCIKICAgICAgICByZXR1cm4gXCJ7fXt9ICAoYXQgY2hhciB7fSksIChsaW5lOnt9LCBjb2w6e30pXCIuZm9ybWF0KAogICAgICAgICAgICBzZWxmLm1zZywgZm91bmRzdHIsIHNlbGYubG9jLCBzZWxmLmxpbmVubywgc2VsZi5jb2x1bW4KICAgICAgICApCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzdHIoc2VsZikKCiAgICBkZWYgbWFya19pbnB1dF9saW5lKHNlbGYsIG1hcmtlcl9zdHJpbmc6IHN0ciA9IE5vbmUsICosIG1hcmtlclN0cmluZz1cIj4hPFwiKSAtPiBzdHI6CiAgICAgICAgXCJcIlwiCiAgICAgICAgRXh0cmFjdHMgdGhlIGV4Y2VwdGlvbiBsaW5lIGZyb20gdGhlIGlucHV0IHN0cmluZywgYW5kIG1hcmtzCiAgICAgICAgdGhlIGxvY2F0aW9uIG9mIHRoZSBleGNlcHRpb24gd2l0aCBhIHNwZWNpYWwgc3ltYm9sLgogICAgICAgIFwiXCJcIgogICAgICAgIG1hcmtlclN0cmluZyA9IG1hcmtlcl9zdHJpbmcgaWYgbWFya2VyX3N0cmluZyBpcyBub3QgTm9uZSBlbHNlIG1hcmtlclN0cmluZwogICAgICAgIGxpbmVfc3RyID0gc2VsZi5saW5lCiAgICAgICAgbGluZV9jb2x1bW4gPSBzZWxmLmNvbHVtbiAtIDEKICAgICAgICBpZiBtYXJrZXJTdHJpbmc6CiAgICAgICAgICAgIGxpbmVfc3RyID0gXCJcIi5qb2luKAogICAgICAgICAgICAgICAgKGxpbmVfc3RyWzpsaW5lX2NvbHVtbl0sIG1hcmtlclN0cmluZywgbGluZV9zdHJbbGluZV9jb2x1bW46XSkKICAgICAgICAgICAgKQogICAgICAgIHJldHVybiBsaW5lX3N0ci5zdHJpcCgpCgogICAgZGVmIGV4cGxhaW4oc2VsZiwgZGVwdGg9MTYpIC0+IHN0cjoKICAgICAgICBcIlwiXCIKICAgICAgICBNZXRob2QgdG8gdHJhbnNsYXRlIHRoZSBQeXRob24gaW50ZXJuYWwgdHJhY2ViYWNrIGludG8gYSBsaXN0CiAgICAgICAgb2YgdGhlIHB5cGFyc2luZyBleHByZXNzaW9ucyB0aGF0IGNhdXNlZCB0aGUgZXhjZXB0aW9uIHRvIGJlIHJhaXNlZC4KCiAgICAgICAgUGFyYW1ldGVyczoKCiAgICAgICAgLSBkZXB0aCAoZGVmYXVsdD0xNikgLSBudW1iZXIgb2YgbGV2ZWxzIGJhY2sgaW4gdGhlIHN0YWNrIHRyYWNlIHRvIGxpc3QgZXhwcmVzc2lvbgogICAgICAgICAgYW5kIGZ1bmN0aW9uIG5hbWVzOyBpZiBOb25lLCB0aGUgZnVsbCBzdGFjayB0cmFjZSBuYW1lcyB3aWxsIGJlIGxpc3RlZDsgaWYgMCwgb25seQogICAgICAgICAgdGhlIGZhaWxpbmcgaW5wdXQgbGluZSwgbWFya2VyLCBhbmQgZXhjZXB0aW9uIHN0cmluZyB3aWxsIGJlIHNob3duCgogICAgICAgIFJldHVybnMgYSBtdWx0aS1saW5lIHN0cmluZyBsaXN0aW5nIHRoZSBQYXJzZXJFbGVtZW50cyBhbmQvb3IgZnVuY3Rpb24gbmFtZXMgaW4gdGhlCiAgICAgICAgZXhjZXB0aW9uJ3Mgc3RhY2sgdHJhY2UuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgZXhwciA9IHBwLldvcmQocHAubnVtcykgKiAzCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGV4cHIucGFyc2Vfc3RyaW5nKFwiMTIzIDQ1NiBBNzg5XCIpCiAgICAgICAgICAgIGV4Y2VwdCBwcC5QYXJzZUV4Y2VwdGlvbiBhcyBwZToKICAgICAgICAgICAgICAgIHByaW50KHBlLmV4cGxhaW4oZGVwdGg9MCkpCgogICAgICAgIHByaW50czo6CgogICAgICAgICAgICAxMjMgNDU2IEE3ODkKICAgICAgICAgICAgICAgICAgICBeCiAgICAgICAgICAgIFBhcnNlRXhjZXB0aW9uOiBFeHBlY3RlZCBXOigwLTkpLCBmb3VuZCAnQScgIChhdCBjaGFyIDgpLCAobGluZToxLCBjb2w6OSkKCiAgICAgICAgTm90ZTogdGhlIGRpYWdub3N0aWMgb3V0cHV0IHdpbGwgaW5jbHVkZSBzdHJpbmcgcmVwcmVzZW50YXRpb25zIG9mIHRoZSBleHByZXNzaW9ucwogICAgICAgIHRoYXQgZmFpbGVkIHRvIHBhcnNlLiBUaGVzZSByZXByZXNlbnRhdGlvbnMgd2lsbCBiZSBtb3JlIGhlbHBmdWwgaWYgeW91IHVzZSBgc2V0X25hbWVgIHRvCiAgICAgICAgZ2l2ZSBpZGVudGlmaWFibGUgbmFtZXMgdG8geW91ciBleHByZXNzaW9ucy4gT3RoZXJ3aXNlIHRoZXkgd2lsbCB1c2UgdGhlIGRlZmF1bHQgc3RyaW5nCiAgICAgICAgZm9ybXMsIHdoaWNoIG1heSBiZSBjcnlwdGljIHRvIHJlYWQuCgogICAgICAgIE5vdGU6IHB5cGFyc2luZydzIGRlZmF1bHQgdHJ1bmNhdGlvbiBvZiBleGNlcHRpb24gdHJhY2ViYWNrcyBtYXkgYWxzbyB0cnVuY2F0ZSB0aGUKICAgICAgICBzdGFjayBvZiBleHByZXNzaW9ucyB0aGF0IGFyZSBkaXNwbGF5ZWQgaW4gdGhlIGBgZXhwbGFpbmBgIG91dHB1dC4gVG8gZ2V0IHRoZSBmdWxsIGxpc3RpbmcKICAgICAgICBvZiBwYXJzZXIgZXhwcmVzc2lvbnMsIHlvdSBtYXkgaGF2ZSB0byBzZXQgYGBQYXJzZXJFbGVtZW50LnZlcmJvc2Vfc3RhY2t0cmFjZSA9IFRydWVgYAogICAgICAgIFwiXCJcIgogICAgICAgIHJldHVybiBzZWxmLmV4cGxhaW5fZXhjZXB0aW9uKHNlbGYsIGRlcHRoKQoKICAgIG1hcmtJbnB1dGxpbmUgPSBtYXJrX2lucHV0X2xpbmUKCgpjbGFzcyBQYXJzZUV4Y2VwdGlvbihQYXJzZUJhc2VFeGNlcHRpb24pOgogICAgXCJcIlwiCiAgICBFeGNlcHRpb24gdGhyb3duIHdoZW4gYSBwYXJzZSBleHByZXNzaW9uIGRvZXNuJ3QgbWF0Y2ggdGhlIGlucHV0IHN0cmluZwoKICAgIEV4YW1wbGU6OgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIFdvcmQobnVtcykuc2V0X25hbWUoXCJpbnRlZ2VyXCIpLnBhcnNlX3N0cmluZyhcIkFCQ1wiKQogICAgICAgIGV4Y2VwdCBQYXJzZUV4Y2VwdGlvbiBhcyBwZToKICAgICAgICAgICAgcHJpbnQocGUpCiAgICAgICAgICAgIHByaW50KFwiY29sdW1uOiB7fVwiLmZvcm1hdChwZS5jb2x1bW4pKQoKICAgIHByaW50czo6CgogICAgICAgRXhwZWN0ZWQgaW50ZWdlciAoYXQgY2hhciAwKSwgKGxpbmU6MSwgY29sOjEpCiAgICAgICAgY29sdW1uOiAxCgogICAgXCJcIlwiCgoKY2xhc3MgUGFyc2VGYXRhbEV4Y2VwdGlvbihQYXJzZUJhc2VFeGNlcHRpb24pOgogICAgXCJcIlwiCiAgICBVc2VyLXRocm93YWJsZSBleGNlcHRpb24gdGhyb3duIHdoZW4gaW5jb25zaXN0ZW50IHBhcnNlIGNvbnRlbnQKICAgIGlzIGZvdW5kOyBzdG9wcyBhbGwgcGFyc2luZyBpbW1lZGlhdGVseQogICAgXCJcIlwiCgoKY2xhc3MgUGFyc2VTeW50YXhFeGNlcHRpb24oUGFyc2VGYXRhbEV4Y2VwdGlvbik6CiAgICBcIlwiXCIKICAgIEp1c3QgbGlrZSA6Y2xhc3M6YFBhcnNlRmF0YWxFeGNlcHRpb25gLCBidXQgdGhyb3duIGludGVybmFsbHkKICAgIHdoZW4gYW4gOmNsYXNzOmBFcnJvclN0b3A8QW5kLl9FcnJvclN0b3A+YCAoJy0nIG9wZXJhdG9yKSBpbmRpY2F0ZXMKICAgIHRoYXQgcGFyc2luZyBpcyB0byBzdG9wIGltbWVkaWF0ZWx5IGJlY2F1c2UgYW4gdW5iYWNrdHJhY2thYmxlCiAgICBzeW50YXggZXJyb3IgaGFzIGJlZW4gZm91bmQuCiAgICBcIlwiXCIKCgpjbGFzcyBSZWN1cnNpdmVHcmFtbWFyRXhjZXB0aW9uKEV4Y2VwdGlvbik6CiAgICBcIlwiXCIKICAgIEV4Y2VwdGlvbiB0aHJvd24gYnkgOmNsYXNzOmBQYXJzZXJFbGVtZW50LnZhbGlkYXRlYCBpZiB0aGUKICAgIGdyYW1tYXIgY291bGQgYmUgbGVmdC1yZWN1cnNpdmU7IHBhcnNlciBtYXkgbmVlZCB0byBlbmFibGUKICAgIGxlZnQgcmVjdXJzaW9uIHVzaW5nIDpjbGFzczpgUGFyc2VyRWxlbWVudC5lbmFibGVfbGVmdF9yZWN1cnNpb248UGFyc2VyRWxlbWVudC5lbmFibGVfbGVmdF9yZWN1cnNpb24+YAogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBhcnNlRWxlbWVudExpc3QpOgogICAgICAgIHNlbGYucGFyc2VFbGVtZW50VHJhY2UgPSBwYXJzZUVsZW1lbnRMaXN0CgogICAgZGVmIF9fc3RyX18oc2VsZikgLT4gc3RyOgogICAgICAgIHJldHVybiBcIlJlY3Vyc2l2ZUdyYW1tYXJFeGNlcHRpb246IHt9XCIuZm9ybWF0KHNlbGYucGFyc2VFbGVtZW50VHJhY2UpCgoiIiIKbW9kdWxlX2RpY3RbInB5cGFyc2luZy9yZXN1bHRzLnB5Il09IiIiCiMgcmVzdWx0cy5weQpmcm9tIGNvbGxlY3Rpb25zLmFiYyBpbXBvcnQgTXV0YWJsZU1hcHBpbmcsIE1hcHBpbmcsIE11dGFibGVTZXF1ZW5jZSwgSXRlcmF0b3IKaW1wb3J0IHBwcmludApmcm9tIHdlYWtyZWYgaW1wb3J0IHJlZiBhcyB3a3JlZgpmcm9tIHR5cGluZyBpbXBvcnQgVHVwbGUsIEFueQoKc3RyX3R5cGU6IFR1cGxlW3R5cGUsIC4uLl0gPSAoc3RyLCBieXRlcykKX2dlbmVyYXRvcl90eXBlID0gdHlwZSgoXyBmb3IgXyBpbiAoKSkpCgoKY2xhc3MgX1BhcnNlUmVzdWx0c1dpdGhPZmZzZXQ6CiAgICBfX3Nsb3RzX18gPSBbXCJ0dXBcIl0KCiAgICBkZWYgX19pbml0X18oc2VsZiwgcDEsIHAyKToKICAgICAgICBzZWxmLnR1cCA9IChwMSwgcDIpCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICAgIHJldHVybiBzZWxmLnR1cFtpXQoKICAgIGRlZiBfX2dldHN0YXRlX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYudHVwCgogICAgZGVmIF9fc2V0c3RhdGVfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi50dXAgPSBhcmdzWzBdCgoKY2xhc3MgUGFyc2VSZXN1bHRzOgogICAgXCJcIlwiU3RydWN0dXJlZCBwYXJzZSByZXN1bHRzLCB0byBwcm92aWRlIG11bHRpcGxlIG1lYW5zIG9mIGFjY2VzcyB0bwogICAgdGhlIHBhcnNlZCBkYXRhOgoKICAgIC0gYXMgYSBsaXN0IChgYGxlbihyZXN1bHRzKWBgKQogICAgLSBieSBsaXN0IGluZGV4IChgYHJlc3VsdHNbMF0sIHJlc3VsdHNbMV1gYCwgZXRjLikKICAgIC0gYnkgYXR0cmlidXRlIChgYHJlc3VsdHMuPHJlc3VsdHNfbmFtZT5gYCAtIHNlZSA6Y2xhc3M6YFBhcnNlckVsZW1lbnQuc2V0X3Jlc3VsdHNfbmFtZWApCgogICAgRXhhbXBsZTo6CgogICAgICAgIGludGVnZXIgPSBXb3JkKG51bXMpCiAgICAgICAgZGF0ZV9zdHIgPSAoaW50ZWdlci5zZXRfcmVzdWx0c19uYW1lKFwieWVhclwiKSArICcvJwogICAgICAgICAgICAgICAgICAgICsgaW50ZWdlci5zZXRfcmVzdWx0c19uYW1lKFwibW9udGhcIikgKyAnLycKICAgICAgICAgICAgICAgICAgICArIGludGVnZXIuc2V0X3Jlc3VsdHNfbmFtZShcImRheVwiKSkKICAgICAgICAjIGVxdWl2YWxlbnQgZm9ybToKICAgICAgICAjIGRhdGVfc3RyID0gKGludGVnZXIoXCJ5ZWFyXCIpICsgJy8nCiAgICAgICAgIyAgICAgICAgICAgICArIGludGVnZXIoXCJtb250aFwiKSArICcvJwogICAgICAgICMgICAgICAgICAgICAgKyBpbnRlZ2VyKFwiZGF5XCIpKQoKICAgICAgICAjIHBhcnNlX3N0cmluZyByZXR1cm5zIGEgUGFyc2VSZXN1bHRzIG9iamVjdAogICAgICAgIHJlc3VsdCA9IGRhdGVfc3RyLnBhcnNlX3N0cmluZyhcIjE5OTkvMTIvMzFcIikKCiAgICAgICAgZGVmIHRlc3QocywgZm49cmVwcik6CiAgICAgICAgICAgIHByaW50KFwie30gLT4ge31cIi5mb3JtYXQocywgZm4oZXZhbChzKSkpKQogICAgICAgIHRlc3QoXCJsaXN0KHJlc3VsdClcIikKICAgICAgICB0ZXN0KFwicmVzdWx0WzBdXCIpCiAgICAgICAgdGVzdChcInJlc3VsdFsnbW9udGgnXVwiKQogICAgICAgIHRlc3QoXCJyZXN1bHQuZGF5XCIpCiAgICAgICAgdGVzdChcIidtb250aCcgaW4gcmVzdWx0XCIpCiAgICAgICAgdGVzdChcIidtaW51dGVzJyBpbiByZXN1bHRcIikKICAgICAgICB0ZXN0KFwicmVzdWx0LmR1bXAoKVwiLCBzdHIpCgogICAgcHJpbnRzOjoKCiAgICAgICAgbGlzdChyZXN1bHQpIC0+IFsnMTk5OScsICcvJywgJzEyJywgJy8nLCAnMzEnXQogICAgICAgIHJlc3VsdFswXSAtPiAnMTk5OScKICAgICAgICByZXN1bHRbJ21vbnRoJ10gLT4gJzEyJwogICAgICAgIHJlc3VsdC5kYXkgLT4gJzMxJwogICAgICAgICdtb250aCcgaW4gcmVzdWx0IC0+IFRydWUKICAgICAgICAnbWludXRlcycgaW4gcmVzdWx0IC0+IEZhbHNlCiAgICAgICAgcmVzdWx0LmR1bXAoKSAtPiBbJzE5OTknLCAnLycsICcxMicsICcvJywgJzMxJ10KICAgICAgICAtIGRheTogJzMxJwogICAgICAgIC0gbW9udGg6ICcxMicKICAgICAgICAtIHllYXI6ICcxOTk5JwogICAgXCJcIlwiCgogICAgX251bGxfdmFsdWVzOiBUdXBsZVtBbnksIC4uLl0gPSAoTm9uZSwgW10sIFwiXCIsICgpKQoKICAgIF9fc2xvdHNfXyA9IFsKICAgICAgICBcIl9uYW1lXCIsCiAgICAgICAgXCJfcGFyZW50XCIsCiAgICAgICAgXCJfYWxsX25hbWVzXCIsCiAgICAgICAgXCJfbW9kYWxcIiwKICAgICAgICBcIl90b2tsaXN0XCIsCiAgICAgICAgXCJfdG9rZGljdFwiLAogICAgICAgIFwiX193ZWFrcmVmX19cIiwKICAgIF0KCiAgICBjbGFzcyBMaXN0KGxpc3QpOgogICAgICAgIFwiXCJcIgogICAgICAgIFNpbXBsZSB3cmFwcGVyIGNsYXNzIHRvIGRpc3Rpbmd1aXNoIHBhcnNlZCBsaXN0IHJlc3VsdHMgdGhhdCBzaG91bGQgYmUgcHJlc2VydmVkCiAgICAgICAgYXMgYWN0dWFsIFB5dGhvbiBsaXN0cywgaW5zdGVhZCBvZiBiZWluZyBjb252ZXJ0ZWQgdG8gOmNsYXNzOmBQYXJzZVJlc3VsdHNgOgoKICAgICAgICAgICAgTEJSQUNLLCBSQlJBQ0sgPSBtYXAocHAuU3VwcHJlc3MsIFwiW11cIikKICAgICAgICAgICAgZWxlbWVudCA9IHBwLkZvcndhcmQoKQogICAgICAgICAgICBpdGVtID0gcHBjLmludGVnZXIKICAgICAgICAgICAgZWxlbWVudF9saXN0ID0gTEJSQUNLICsgcHAuZGVsaW1pdGVkX2xpc3QoZWxlbWVudCkgKyBSQlJBQ0sKCiAgICAgICAgICAgICMgYWRkIHBhcnNlIGFjdGlvbnMgdG8gY29udmVydCBmcm9tIFBhcnNlUmVzdWx0cyB0byBhY3R1YWwgUHl0aG9uIGNvbGxlY3Rpb24gdHlwZXMKICAgICAgICAgICAgZGVmIGFzX3B5dGhvbl9saXN0KHQpOgogICAgICAgICAgICAgICAgcmV0dXJuIHBwLlBhcnNlUmVzdWx0cy5MaXN0KHQuYXNfbGlzdCgpKQogICAgICAgICAgICBlbGVtZW50X2xpc3QuYWRkX3BhcnNlX2FjdGlvbihhc19weXRob25fbGlzdCkKCiAgICAgICAgICAgIGVsZW1lbnQgPDw9IGl0ZW0gfCBlbGVtZW50X2xpc3QKCiAgICAgICAgICAgIGVsZW1lbnQucnVuX3Rlc3RzKCcnJwogICAgICAgICAgICAgICAgMTAwCiAgICAgICAgICAgICAgICBbMiwzLDRdCiAgICAgICAgICAgICAgICBbWzIsIDFdLDMsNF0KICAgICAgICAgICAgICAgIFsoMiwgMSksMyw0XQogICAgICAgICAgICAgICAgKDIsMyw0KQogICAgICAgICAgICAgICAgJycnLCBwb3N0X3BhcnNlPWxhbWJkYSBzLCByOiAoclswXSwgdHlwZShyWzBdKSkpCgogICAgICAgIHByaW50czoKCiAgICAgICAgICAgIDEwMAogICAgICAgICAgICAoMTAwLCA8Y2xhc3MgJ2ludCc+KQoKICAgICAgICAgICAgWzIsMyw0XQogICAgICAgICAgICAoWzIsIDMsIDRdLCA8Y2xhc3MgJ2xpc3QnPikKCiAgICAgICAgICAgIFtbMiwgMV0sMyw0XQogICAgICAgICAgICAoW1syLCAxXSwgMywgNF0sIDxjbGFzcyAnbGlzdCc+KQoKICAgICAgICAoVXNlZCBpbnRlcm5hbGx5IGJ5IDpjbGFzczpgR3JvdXBgIHdoZW4gYGFzbGlzdD1UcnVlYC4pCiAgICAgICAgXCJcIlwiCgogICAgICAgIGRlZiBfX25ld19fKGNscywgY29udGFpbmVkPU5vbmUpOgogICAgICAgICAgICBpZiBjb250YWluZWQgaXMgTm9uZToKICAgICAgICAgICAgICAgIGNvbnRhaW5lZCA9IFtdCgogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShjb250YWluZWQsIGxpc3QpOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgICAgIFwie30gbWF5IG9ubHkgYmUgY29uc3RydWN0ZWQgd2l0aCBhIGxpc3QsXCIKICAgICAgICAgICAgICAgICAgICBcIiBub3Qge31cIi5mb3JtYXQoY2xzLl9fbmFtZV9fLCB0eXBlKGNvbnRhaW5lZCkuX19uYW1lX18pCiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICByZXR1cm4gbGlzdC5fX25ld19fKGNscykKCiAgICBkZWYgX19uZXdfXyhjbHMsIHRva2xpc3Q9Tm9uZSwgbmFtZT1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh0b2tsaXN0LCBQYXJzZVJlc3VsdHMpOgogICAgICAgICAgICByZXR1cm4gdG9rbGlzdAogICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCiAgICAgICAgc2VsZi5fbmFtZSA9IE5vbmUKICAgICAgICBzZWxmLl9wYXJlbnQgPSBOb25lCiAgICAgICAgc2VsZi5fYWxsX25hbWVzID0gc2V0KCkKCiAgICAgICAgaWYgdG9rbGlzdCBpcyBOb25lOgogICAgICAgICAgICBzZWxmLl90b2tsaXN0ID0gW10KICAgICAgICBlbGlmIGlzaW5zdGFuY2UodG9rbGlzdCwgKGxpc3QsIF9nZW5lcmF0b3JfdHlwZSkpOgogICAgICAgICAgICBzZWxmLl90b2tsaXN0ID0gKAogICAgICAgICAgICAgICAgW3Rva2xpc3RbOl1dCiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHRva2xpc3QsIFBhcnNlUmVzdWx0cy5MaXN0KQogICAgICAgICAgICAgICAgZWxzZSBsaXN0KHRva2xpc3QpCiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl90b2tsaXN0ID0gW3Rva2xpc3RdCiAgICAgICAgc2VsZi5fdG9rZGljdCA9IGRpY3QoKQogICAgICAgIHJldHVybiBzZWxmCgogICAgIyBQZXJmb3JtYW5jZSB0dW5pbmc6IHdlIGNvbnN0cnVjdCBhICpsb3QqIG9mIHRoZXNlLCBzbyBrZWVwIHRoaXMKICAgICMgY29uc3RydWN0b3IgYXMgc21hbGwgYW5kIGZhc3QgYXMgcG9zc2libGUKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLCB0b2tsaXN0PU5vbmUsIG5hbWU9Tm9uZSwgYXNMaXN0PVRydWUsIG1vZGFsPVRydWUsIGlzaW5zdGFuY2U9aXNpbnN0YW5jZQogICAgKToKICAgICAgICBzZWxmLl9tb2RhbCA9IG1vZGFsCiAgICAgICAgaWYgbmFtZSBpcyBub3QgTm9uZSBhbmQgbmFtZSAhPSBcIlwiOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG5hbWUsIGludCk6CiAgICAgICAgICAgICAgICBuYW1lID0gc3RyKG5hbWUpCiAgICAgICAgICAgIGlmIG5vdCBtb2RhbDoKICAgICAgICAgICAgICAgIHNlbGYuX2FsbF9uYW1lcyA9IHtuYW1lfQogICAgICAgICAgICBzZWxmLl9uYW1lID0gbmFtZQogICAgICAgICAgICBpZiB0b2tsaXN0IG5vdCBpbiBzZWxmLl9udWxsX3ZhbHVlczoKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodG9rbGlzdCwgKHN0cl90eXBlLCB0eXBlKSk6CiAgICAgICAgICAgICAgICAgICAgdG9rbGlzdCA9IFt0b2tsaXN0XQogICAgICAgICAgICAgICAgaWYgYXNMaXN0OgogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodG9rbGlzdCwgUGFyc2VSZXN1bHRzKToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZltuYW1lXSA9IF9QYXJzZVJlc3VsdHNXaXRoT2Zmc2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VSZXN1bHRzKHRva2xpc3QuX3Rva2xpc3QpLCAwCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmW25hbWVdID0gX1BhcnNlUmVzdWx0c1dpdGhPZmZzZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXJzZVJlc3VsdHModG9rbGlzdFswXSksIDAKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGZbbmFtZV0uX25hbWUgPSBuYW1lCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZltuYW1lXSA9IHRva2xpc3RbMF0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgKEtleUVycm9yLCBUeXBlRXJyb3IsIEluZGV4RXJyb3IpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b2tsaXN0IGlzIG5vdCBzZWxmOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZltuYW1lXSA9IHRva2xpc3QKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX25hbWUgPSBuYW1lCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICAgIGlmIGlzaW5zdGFuY2UoaSwgKGludCwgc2xpY2UpKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3Rva2xpc3RbaV0KICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBpIG5vdCBpbiBzZWxmLl9hbGxfbmFtZXM6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fdG9rZGljdFtpXVstMV1bMF0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBQYXJzZVJlc3VsdHMoW3ZbMF0gZm9yIHYgaW4gc2VsZi5fdG9rZGljdFtpXV0pCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGssIHYsIGlzaW5zdGFuY2U9aXNpbnN0YW5jZSk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh2LCBfUGFyc2VSZXN1bHRzV2l0aE9mZnNldCk6CiAgICAgICAgICAgIHNlbGYuX3Rva2RpY3Rba10gPSBzZWxmLl90b2tkaWN0LmdldChrLCBsaXN0KCkpICsgW3ZdCiAgICAgICAgICAgIHN1YiA9IHZbMF0KICAgICAgICBlbGlmIGlzaW5zdGFuY2UoaywgKGludCwgc2xpY2UpKToKICAgICAgICAgICAgc2VsZi5fdG9rbGlzdFtrXSA9IHYKICAgICAgICAgICAgc3ViID0gdgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3Rva2RpY3Rba10gPSBzZWxmLl90b2tkaWN0LmdldChrLCBsaXN0KCkpICsgWwogICAgICAgICAgICAgICAgX1BhcnNlUmVzdWx0c1dpdGhPZmZzZXQodiwgMCkKICAgICAgICAgICAgXQogICAgICAgICAgICBzdWIgPSB2CiAgICAgICAgaWYgaXNpbnN0YW5jZShzdWIsIFBhcnNlUmVzdWx0cyk6CiAgICAgICAgICAgIHN1Yi5fcGFyZW50ID0gd2tyZWYoc2VsZikKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgaSk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShpLCAoaW50LCBzbGljZSkpOgogICAgICAgICAgICBteWxlbiA9IGxlbihzZWxmLl90b2tsaXN0KQogICAgICAgICAgICBkZWwgc2VsZi5fdG9rbGlzdFtpXQoKICAgICAgICAgICAgIyBjb252ZXJ0IGludCB0byBzbGljZQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGksIGludCk6CiAgICAgICAgICAgICAgICBpZiBpIDwgMDoKICAgICAgICAgICAgICAgICAgICBpICs9IG15bGVuCiAgICAgICAgICAgICAgICBpID0gc2xpY2UoaSwgaSArIDEpCiAgICAgICAgICAgICMgZ2V0IHJlbW92ZWQgaW5kaWNlcwogICAgICAgICAgICByZW1vdmVkID0gbGlzdChyYW5nZSgqaS5pbmRpY2VzKG15bGVuKSkpCiAgICAgICAgICAgIHJlbW92ZWQucmV2ZXJzZSgpCiAgICAgICAgICAgICMgZml4dXAgaW5kaWNlcyBpbiB0b2tlbiBkaWN0aW9uYXJ5CiAgICAgICAgICAgIGZvciBuYW1lLCBvY2N1cnJlbmNlcyBpbiBzZWxmLl90b2tkaWN0Lml0ZW1zKCk6CiAgICAgICAgICAgICAgICBmb3IgaiBpbiByZW1vdmVkOgogICAgICAgICAgICAgICAgICAgIGZvciBrLCAodmFsdWUsIHBvc2l0aW9uKSBpbiBlbnVtZXJhdGUob2NjdXJyZW5jZXMpOgogICAgICAgICAgICAgICAgICAgICAgICBvY2N1cnJlbmNlc1trXSA9IF9QYXJzZVJlc3VsdHNXaXRoT2Zmc2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsIHBvc2l0aW9uIC0gKHBvc2l0aW9uID4gaikKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRlbCBzZWxmLl90b2tkaWN0W2ldCgogICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCBrKSAtPiBib29sOgogICAgICAgIHJldHVybiBrIGluIHNlbGYuX3Rva2RpY3QKCiAgICBkZWYgX19sZW5fXyhzZWxmKSAtPiBpbnQ6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLl90b2tsaXN0KQoKICAgIGRlZiBfX2Jvb2xfXyhzZWxmKSAtPiBib29sOgogICAgICAgIHJldHVybiBub3Qgbm90IChzZWxmLl90b2tsaXN0IG9yIHNlbGYuX3Rva2RpY3QpCgogICAgZGVmIF9faXRlcl9fKHNlbGYpIC0+IEl0ZXJhdG9yOgogICAgICAgIHJldHVybiBpdGVyKHNlbGYuX3Rva2xpc3QpCgogICAgZGVmIF9fcmV2ZXJzZWRfXyhzZWxmKSAtPiBJdGVyYXRvcjoKICAgICAgICByZXR1cm4gaXRlcihzZWxmLl90b2tsaXN0Wzo6LTFdKQoKICAgIGRlZiBrZXlzKHNlbGYpOgogICAgICAgIHJldHVybiBpdGVyKHNlbGYuX3Rva2RpY3QpCgogICAgZGVmIHZhbHVlcyhzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGZba10gZm9yIGsgaW4gc2VsZi5rZXlzKCkpCgogICAgZGVmIGl0ZW1zKHNlbGYpOgogICAgICAgIHJldHVybiAoKGssIHNlbGZba10pIGZvciBrIGluIHNlbGYua2V5cygpKQoKICAgIGRlZiBoYXNrZXlzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgXCJcIlwiCiAgICAgICAgU2luY2UgYGBrZXlzKClgYCByZXR1cm5zIGFuIGl0ZXJhdG9yLCB0aGlzIG1ldGhvZCBpcyBoZWxwZnVsIGluIGJ5cGFzc2luZwogICAgICAgIGNvZGUgdGhhdCBsb29rcyBmb3IgdGhlIGV4aXN0ZW5jZSBvZiBhbnkgZGVmaW5lZCByZXN1bHRzIG5hbWVzLlwiXCJcIgogICAgICAgIHJldHVybiBib29sKHNlbGYuX3Rva2RpY3QpCgogICAgZGVmIHBvcChzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIFwiXCJcIgogICAgICAgIFJlbW92ZXMgYW5kIHJldHVybnMgaXRlbSBhdCBzcGVjaWZpZWQgaW5kZXggKGRlZmF1bHQ9IGBgbGFzdGBgKS4KICAgICAgICBTdXBwb3J0cyBib3RoIGBgbGlzdGBgIGFuZCBgYGRpY3RgYCBzZW1hbnRpY3MgZm9yIGBgcG9wKClgYC4gSWYKICAgICAgICBwYXNzZWQgbm8gYXJndW1lbnQgb3IgYW4gaW50ZWdlciBhcmd1bWVudCwgaXQgd2lsbCB1c2UgYGBsaXN0YGAKICAgICAgICBzZW1hbnRpY3MgYW5kIHBvcCB0b2tlbnMgZnJvbSB0aGUgbGlzdCBvZiBwYXJzZWQgdG9rZW5zLiBJZiBwYXNzZWQKICAgICAgICBhIG5vbi1pbnRlZ2VyIGFyZ3VtZW50IChtb3N0IGxpa2VseSBhIHN0cmluZyksIGl0IHdpbGwgdXNlIGBgZGljdGBgCiAgICAgICAgc2VtYW50aWNzIGFuZCBwb3AgdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgZnJvbSBhbnkgZGVmaW5lZCByZXN1bHRzCiAgICAgICAgbmFtZXMuIEEgc2Vjb25kIGRlZmF1bHQgcmV0dXJuIHZhbHVlIGFyZ3VtZW50IGlzIHN1cHBvcnRlZCwganVzdCBhcyBpbgogICAgICAgIGBgZGljdC5wb3AoKWBgLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIG51bWxpc3QgPSBXb3JkKG51bXMpWy4uLl0KICAgICAgICAgICAgcHJpbnQobnVtbGlzdC5wYXJzZV9zdHJpbmcoXCIwIDEyMyAzMjFcIikpICMgLT4gWycwJywgJzEyMycsICczMjEnXQoKICAgICAgICAgICAgZGVmIHJlbW92ZV9maXJzdCh0b2tlbnMpOgogICAgICAgICAgICAgICAgdG9rZW5zLnBvcCgwKQogICAgICAgICAgICBudW1saXN0LmFkZF9wYXJzZV9hY3Rpb24ocmVtb3ZlX2ZpcnN0KQogICAgICAgICAgICBwcmludChudW1saXN0LnBhcnNlX3N0cmluZyhcIjAgMTIzIDMyMVwiKSkgIyAtPiBbJzEyMycsICczMjEnXQoKICAgICAgICAgICAgbGFiZWwgPSBXb3JkKGFscGhhcykKICAgICAgICAgICAgcGF0dCA9IGxhYmVsKFwiTEFCRUxcIikgKyBXb3JkKG51bXMpWzEsIC4uLl0KICAgICAgICAgICAgcHJpbnQocGF0dC5wYXJzZV9zdHJpbmcoXCJBQUIgMTIzIDMyMVwiKS5kdW1wKCkpCgogICAgICAgICAgICAjIFVzZSBwb3AoKSBpbiBhIHBhcnNlIGFjdGlvbiB0byByZW1vdmUgbmFtZWQgcmVzdWx0IChub3RlIHRoYXQgY29ycmVzcG9uZGluZyB2YWx1ZSBpcyBub3QKICAgICAgICAgICAgIyByZW1vdmVkIGZyb20gbGlzdCBmb3JtIG9mIHJlc3VsdHMpCiAgICAgICAgICAgIGRlZiByZW1vdmVfTEFCRUwodG9rZW5zKToKICAgICAgICAgICAgICAgIHRva2Vucy5wb3AoXCJMQUJFTFwiKQogICAgICAgICAgICAgICAgcmV0dXJuIHRva2VucwogICAgICAgICAgICBwYXR0LmFkZF9wYXJzZV9hY3Rpb24ocmVtb3ZlX0xBQkVMKQogICAgICAgICAgICBwcmludChwYXR0LnBhcnNlX3N0cmluZyhcIkFBQiAxMjMgMzIxXCIpLmR1bXAoKSkKCiAgICAgICAgcHJpbnRzOjoKCiAgICAgICAgICAgIFsnQUFCJywgJzEyMycsICczMjEnXQogICAgICAgICAgICAtIExBQkVMOiAnQUFCJwoKICAgICAgICAgICAgWydBQUInLCAnMTIzJywgJzMyMSddCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYgbm90IGFyZ3M6CiAgICAgICAgICAgIGFyZ3MgPSBbLTFdCiAgICAgICAgZm9yIGssIHYgaW4ga3dhcmdzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGsgPT0gXCJkZWZhdWx0XCI6CiAgICAgICAgICAgICAgICBhcmdzID0gKGFyZ3NbMF0sIHYpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgXCJwb3AoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50IHshcn1cIi5mb3JtYXQoaykKICAgICAgICAgICAgICAgICkKICAgICAgICBpZiBpc2luc3RhbmNlKGFyZ3NbMF0sIGludCkgb3IgbGVuKGFyZ3MpID09IDEgb3IgYXJnc1swXSBpbiBzZWxmOgogICAgICAgICAgICBpbmRleCA9IGFyZ3NbMF0KICAgICAgICAgICAgcmV0ID0gc2VsZltpbmRleF0KICAgICAgICAgICAgZGVsIHNlbGZbaW5kZXhdCiAgICAgICAgICAgIHJldHVybiByZXQKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWZhdWx0dmFsdWUgPSBhcmdzWzFdCiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0dmFsdWUKCiAgICBkZWYgZ2V0KHNlbGYsIGtleSwgZGVmYXVsdF92YWx1ZT1Ob25lKToKICAgICAgICBcIlwiXCIKICAgICAgICBSZXR1cm5zIG5hbWVkIHJlc3VsdCBtYXRjaGluZyB0aGUgZ2l2ZW4ga2V5LCBvciBpZiB0aGVyZSBpcyBubwogICAgICAgIHN1Y2ggbmFtZSwgdGhlbiByZXR1cm5zIHRoZSBnaXZlbiBgYGRlZmF1bHRfdmFsdWVgYCBvciBgYE5vbmVgYCBpZiBubwogICAgICAgIGBgZGVmYXVsdF92YWx1ZWBgIGlzIHNwZWNpZmllZC4KCiAgICAgICAgU2ltaWxhciB0byBgYGRpY3QuZ2V0KClgYC4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBpbnRlZ2VyID0gV29yZChudW1zKQogICAgICAgICAgICBkYXRlX3N0ciA9IGludGVnZXIoXCJ5ZWFyXCIpICsgJy8nICsgaW50ZWdlcihcIm1vbnRoXCIpICsgJy8nICsgaW50ZWdlcihcImRheVwiKQoKICAgICAgICAgICAgcmVzdWx0ID0gZGF0ZV9zdHIucGFyc2Vfc3RyaW5nKFwiMTk5OS8xMi8zMVwiKQogICAgICAgICAgICBwcmludChyZXN1bHQuZ2V0KFwieWVhclwiKSkgIyAtPiAnMTk5OScKICAgICAgICAgICAgcHJpbnQocmVzdWx0LmdldChcImhvdXJcIiwgXCJub3Qgc3BlY2lmaWVkXCIpKSAjIC0+ICdub3Qgc3BlY2lmaWVkJwogICAgICAgICAgICBwcmludChyZXN1bHQuZ2V0KFwiaG91clwiKSkgIyAtPiBOb25lCiAgICAgICAgXCJcIlwiCiAgICAgICAgaWYga2V5IGluIHNlbGY6CiAgICAgICAgICAgIHJldHVybiBzZWxmW2tleV0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gZGVmYXVsdF92YWx1ZQoKICAgIGRlZiBpbnNlcnQoc2VsZiwgaW5kZXgsIGluc19zdHJpbmcpOgogICAgICAgIFwiXCJcIgogICAgICAgIEluc2VydHMgbmV3IGVsZW1lbnQgYXQgbG9jYXRpb24gaW5kZXggaW4gdGhlIGxpc3Qgb2YgcGFyc2VkIHRva2Vucy4KCiAgICAgICAgU2ltaWxhciB0byBgYGxpc3QuaW5zZXJ0KClgYC4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBudW1saXN0ID0gV29yZChudW1zKVsuLi5dCiAgICAgICAgICAgIHByaW50KG51bWxpc3QucGFyc2Vfc3RyaW5nKFwiMCAxMjMgMzIxXCIpKSAjIC0+IFsnMCcsICcxMjMnLCAnMzIxJ10KCiAgICAgICAgICAgICMgdXNlIGEgcGFyc2UgYWN0aW9uIHRvIGluc2VydCB0aGUgcGFyc2UgbG9jYXRpb24gaW4gdGhlIGZyb250IG9mIHRoZSBwYXJzZWQgcmVzdWx0cwogICAgICAgICAgICBkZWYgaW5zZXJ0X2xvY24obG9jbiwgdG9rZW5zKToKICAgICAgICAgICAgICAgIHRva2Vucy5pbnNlcnQoMCwgbG9jbikKICAgICAgICAgICAgbnVtbGlzdC5hZGRfcGFyc2VfYWN0aW9uKGluc2VydF9sb2NuKQogICAgICAgICAgICBwcmludChudW1saXN0LnBhcnNlX3N0cmluZyhcIjAgMTIzIDMyMVwiKSkgIyAtPiBbMCwgJzAnLCAnMTIzJywgJzMyMSddCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi5fdG9rbGlzdC5pbnNlcnQoaW5kZXgsIGluc19zdHJpbmcpCiAgICAgICAgIyBmaXh1cCBpbmRpY2VzIGluIHRva2VuIGRpY3Rpb25hcnkKICAgICAgICBmb3IgbmFtZSwgb2NjdXJyZW5jZXMgaW4gc2VsZi5fdG9rZGljdC5pdGVtcygpOgogICAgICAgICAgICBmb3IgaywgKHZhbHVlLCBwb3NpdGlvbikgaW4gZW51bWVyYXRlKG9jY3VycmVuY2VzKToKICAgICAgICAgICAgICAgIG9jY3VycmVuY2VzW2tdID0gX1BhcnNlUmVzdWx0c1dpdGhPZmZzZXQoCiAgICAgICAgICAgICAgICAgICAgdmFsdWUsIHBvc2l0aW9uICsgKHBvc2l0aW9uID4gaW5kZXgpCiAgICAgICAgICAgICAgICApCgogICAgZGVmIGFwcGVuZChzZWxmLCBpdGVtKToKICAgICAgICBcIlwiXCIKICAgICAgICBBZGQgc2luZ2xlIGVsZW1lbnQgdG8gZW5kIG9mIGBgUGFyc2VSZXN1bHRzYGAgbGlzdCBvZiBlbGVtZW50cy4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBudW1saXN0ID0gV29yZChudW1zKVsuLi5dCiAgICAgICAgICAgIHByaW50KG51bWxpc3QucGFyc2Vfc3RyaW5nKFwiMCAxMjMgMzIxXCIpKSAjIC0+IFsnMCcsICcxMjMnLCAnMzIxJ10KCiAgICAgICAgICAgICMgdXNlIGEgcGFyc2UgYWN0aW9uIHRvIGNvbXB1dGUgdGhlIHN1bSBvZiB0aGUgcGFyc2VkIGludGVnZXJzLCBhbmQgYWRkIGl0IHRvIHRoZSBlbmQKICAgICAgICAgICAgZGVmIGFwcGVuZF9zdW0odG9rZW5zKToKICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoc3VtKG1hcChpbnQsIHRva2VucykpKQogICAgICAgICAgICBudW1saXN0LmFkZF9wYXJzZV9hY3Rpb24oYXBwZW5kX3N1bSkKICAgICAgICAgICAgcHJpbnQobnVtbGlzdC5wYXJzZV9zdHJpbmcoXCIwIDEyMyAzMjFcIikpICMgLT4gWycwJywgJzEyMycsICczMjEnLCA0NDRdCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi5fdG9rbGlzdC5hcHBlbmQoaXRlbSkKCiAgICBkZWYgZXh0ZW5kKHNlbGYsIGl0ZW1zZXEpOgogICAgICAgIFwiXCJcIgogICAgICAgIEFkZCBzZXF1ZW5jZSBvZiBlbGVtZW50cyB0byBlbmQgb2YgYGBQYXJzZVJlc3VsdHNgYCBsaXN0IG9mIGVsZW1lbnRzLgoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIHBhdHQgPSBXb3JkKGFscGhhcylbMSwgLi4uXQoKICAgICAgICAgICAgIyB1c2UgYSBwYXJzZSBhY3Rpb24gdG8gYXBwZW5kIHRoZSByZXZlcnNlIG9mIHRoZSBtYXRjaGVkIHN0cmluZ3MsIHRvIG1ha2UgYSBwYWxpbmRyb21lCiAgICAgICAgICAgIGRlZiBtYWtlX3BhbGluZHJvbWUodG9rZW5zKToKICAgICAgICAgICAgICAgIHRva2Vucy5leHRlbmQocmV2ZXJzZWQoW3RbOjotMV0gZm9yIHQgaW4gdG9rZW5zXSkpCiAgICAgICAgICAgICAgICByZXR1cm4gJycuam9pbih0b2tlbnMpCiAgICAgICAgICAgIHBhdHQuYWRkX3BhcnNlX2FjdGlvbihtYWtlX3BhbGluZHJvbWUpCiAgICAgICAgICAgIHByaW50KHBhdHQucGFyc2Vfc3RyaW5nKFwibHNrZGogc2Rsa2pmIGxrc2RcIikpICMgLT4gJ2xza2Rqc2Rsa2pmbGtzZGRza2xmamtsZHNqZGtzbCcKICAgICAgICBcIlwiXCIKICAgICAgICBpZiBpc2luc3RhbmNlKGl0ZW1zZXEsIFBhcnNlUmVzdWx0cyk6CiAgICAgICAgICAgIHNlbGYuX19pYWRkX18oaXRlbXNlcSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl90b2tsaXN0LmV4dGVuZChpdGVtc2VxKQoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICBcIlwiXCIKICAgICAgICBDbGVhciBhbGwgZWxlbWVudHMgYW5kIHJlc3VsdHMgbmFtZXMuCiAgICAgICAgXCJcIlwiCiAgICAgICAgZGVsIHNlbGYuX3Rva2xpc3RbOl0KICAgICAgICBzZWxmLl90b2tkaWN0LmNsZWFyKCkKCiAgICBkZWYgX19nZXRhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZltuYW1lXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgaWYgbmFtZS5zdGFydHN3aXRoKFwiX19cIik6CiAgICAgICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihuYW1lKQogICAgICAgICAgICByZXR1cm4gXCJcIgoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKSAtPiBcIlBhcnNlUmVzdWx0c1wiOgogICAgICAgIHJldCA9IHNlbGYuY29weSgpCiAgICAgICAgcmV0ICs9IG90aGVyCiAgICAgICAgcmV0dXJuIHJldAoKICAgIGRlZiBfX2lhZGRfXyhzZWxmLCBvdGhlcikgLT4gXCJQYXJzZVJlc3VsdHNcIjoKICAgICAgICBpZiBvdGhlci5fdG9rZGljdDoKICAgICAgICAgICAgb2Zmc2V0ID0gbGVuKHNlbGYuX3Rva2xpc3QpCiAgICAgICAgICAgIGFkZG9mZnNldCA9IGxhbWJkYSBhOiBvZmZzZXQgaWYgYSA8IDAgZWxzZSBhICsgb2Zmc2V0CiAgICAgICAgICAgIG90aGVyaXRlbXMgPSBvdGhlci5fdG9rZGljdC5pdGVtcygpCiAgICAgICAgICAgIG90aGVyZGljdGl0ZW1zID0gWwogICAgICAgICAgICAgICAgKGssIF9QYXJzZVJlc3VsdHNXaXRoT2Zmc2V0KHZbMF0sIGFkZG9mZnNldCh2WzFdKSkpCiAgICAgICAgICAgICAgICBmb3Igaywgdmxpc3QgaW4gb3RoZXJpdGVtcwogICAgICAgICAgICAgICAgZm9yIHYgaW4gdmxpc3QKICAgICAgICAgICAgXQogICAgICAgICAgICBmb3IgaywgdiBpbiBvdGhlcmRpY3RpdGVtczoKICAgICAgICAgICAgICAgIHNlbGZba10gPSB2CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHZbMF0sIFBhcnNlUmVzdWx0cyk6CiAgICAgICAgICAgICAgICAgICAgdlswXS5fcGFyZW50ID0gd2tyZWYoc2VsZikKCiAgICAgICAgc2VsZi5fdG9rbGlzdCArPSBvdGhlci5fdG9rbGlzdAogICAgICAgIHNlbGYuX2FsbF9uYW1lcyB8PSBvdGhlci5fYWxsX25hbWVzCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19yYWRkX18oc2VsZiwgb3RoZXIpIC0+IFwiUGFyc2VSZXN1bHRzXCI6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgaW50KSBhbmQgb3RoZXIgPT0gMDoKICAgICAgICAgICAgIyB1c2VmdWwgZm9yIG1lcmdpbmcgbWFueSBQYXJzZVJlc3VsdHMgdXNpbmcgc3VtKCkgYnVpbHRpbgogICAgICAgICAgICByZXR1cm4gc2VsZi5jb3B5KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIHRoaXMgbWF5IHJhaXNlIGEgVHlwZUVycm9yIC0gc28gYmUgaXQKICAgICAgICAgICAgcmV0dXJuIG90aGVyICsgc2VsZgoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIFwie30oeyFyfSwge30pXCIuZm9ybWF0KHR5cGUoc2VsZikuX19uYW1lX18sIHNlbGYuX3Rva2xpc3QsIHNlbGYuYXNfZGljdCgpKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBcIltcIgogICAgICAgICAgICArIFwiLCBcIi5qb2luKAogICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgIHN0cihpKSBpZiBpc2luc3RhbmNlKGksIFBhcnNlUmVzdWx0cykgZWxzZSByZXByKGkpCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5fdG9rbGlzdAogICAgICAgICAgICAgICAgXQogICAgICAgICAgICApCiAgICAgICAgICAgICsgXCJdXCIKICAgICAgICApCgogICAgZGVmIF9hc1N0cmluZ0xpc3Qoc2VsZiwgc2VwPVwiXCIpOgogICAgICAgIG91dCA9IFtdCiAgICAgICAgZm9yIGl0ZW0gaW4gc2VsZi5fdG9rbGlzdDoKICAgICAgICAgICAgaWYgb3V0IGFuZCBzZXA6CiAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKHNlcCkKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBQYXJzZVJlc3VsdHMpOgogICAgICAgICAgICAgICAgb3V0ICs9IGl0ZW0uX2FzU3RyaW5nTGlzdCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKHN0cihpdGVtKSkKICAgICAgICByZXR1cm4gb3V0CgogICAgZGVmIGFzX2xpc3Qoc2VsZikgLT4gbGlzdDoKICAgICAgICBcIlwiXCIKICAgICAgICBSZXR1cm5zIHRoZSBwYXJzZSByZXN1bHRzIGFzIGEgbmVzdGVkIGxpc3Qgb2YgbWF0Y2hpbmcgdG9rZW5zLCBhbGwgY29udmVydGVkIHRvIHN0cmluZ3MuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgcGF0dCA9IFdvcmQoYWxwaGFzKVsxLCAuLi5dCiAgICAgICAgICAgIHJlc3VsdCA9IHBhdHQucGFyc2Vfc3RyaW5nKFwic2xka2ogbHNka2ogc2xka2pcIikKICAgICAgICAgICAgIyBldmVuIHRob3VnaCB0aGUgcmVzdWx0IHByaW50cyBpbiBzdHJpbmctbGlrZSBmb3JtLCBpdCBpcyBhY3R1YWxseSBhIHB5cGFyc2luZyBQYXJzZVJlc3VsdHMKICAgICAgICAgICAgcHJpbnQodHlwZShyZXN1bHQpLCByZXN1bHQpICMgLT4gPGNsYXNzICdweXBhcnNpbmcuUGFyc2VSZXN1bHRzJz4gWydzbGRraicsICdsc2RraicsICdzbGRraiddCgogICAgICAgICAgICAjIFVzZSBhc19saXN0KCkgdG8gY3JlYXRlIGFuIGFjdHVhbCBsaXN0CiAgICAgICAgICAgIHJlc3VsdF9saXN0ID0gcmVzdWx0LmFzX2xpc3QoKQogICAgICAgICAgICBwcmludCh0eXBlKHJlc3VsdF9saXN0KSwgcmVzdWx0X2xpc3QpICMgLT4gPGNsYXNzICdsaXN0Jz4gWydzbGRraicsICdsc2RraicsICdzbGRraiddCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgcmVzLmFzX2xpc3QoKSBpZiBpc2luc3RhbmNlKHJlcywgUGFyc2VSZXN1bHRzKSBlbHNlIHJlcwogICAgICAgICAgICBmb3IgcmVzIGluIHNlbGYuX3Rva2xpc3QKICAgICAgICBdCgogICAgZGVmIGFzX2RpY3Qoc2VsZikgLT4gZGljdDoKICAgICAgICBcIlwiXCIKICAgICAgICBSZXR1cm5zIHRoZSBuYW1lZCBwYXJzZSByZXN1bHRzIGFzIGEgbmVzdGVkIGRpY3Rpb25hcnkuCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgaW50ZWdlciA9IFdvcmQobnVtcykKICAgICAgICAgICAgZGF0ZV9zdHIgPSBpbnRlZ2VyKFwieWVhclwiKSArICcvJyArIGludGVnZXIoXCJtb250aFwiKSArICcvJyArIGludGVnZXIoXCJkYXlcIikKCiAgICAgICAgICAgIHJlc3VsdCA9IGRhdGVfc3RyLnBhcnNlX3N0cmluZygnMTIvMzEvMTk5OScpCiAgICAgICAgICAgIHByaW50KHR5cGUocmVzdWx0KSwgcmVwcihyZXN1bHQpKSAjIC0+IDxjbGFzcyAncHlwYXJzaW5nLlBhcnNlUmVzdWx0cyc+IChbJzEyJywgJy8nLCAnMzEnLCAnLycsICcxOTk5J10sIHsnZGF5JzogWygnMTk5OScsIDQpXSwgJ3llYXInOiBbKCcxMicsIDApXSwgJ21vbnRoJzogWygnMzEnLCAyKV19KQoKICAgICAgICAgICAgcmVzdWx0X2RpY3QgPSByZXN1bHQuYXNfZGljdCgpCiAgICAgICAgICAgIHByaW50KHR5cGUocmVzdWx0X2RpY3QpLCByZXByKHJlc3VsdF9kaWN0KSkgIyAtPiA8Y2xhc3MgJ2RpY3QnPiB7J2RheSc6ICcxOTk5JywgJ3llYXInOiAnMTInLCAnbW9udGgnOiAnMzEnfQoKICAgICAgICAgICAgIyBldmVuIHRob3VnaCBhIFBhcnNlUmVzdWx0cyBzdXBwb3J0cyBkaWN0LWxpa2UgYWNjZXNzLCBzb21ldGltZSB5b3UganVzdCBuZWVkIHRvIGhhdmUgYSBkaWN0CiAgICAgICAgICAgIGltcG9ydCBqc29uCiAgICAgICAgICAgIHByaW50KGpzb24uZHVtcHMocmVzdWx0KSkgIyAtPiBFeGNlcHRpb246IFR5cGVFcnJvcjogLi4uIGlzIG5vdCBKU09OIHNlcmlhbGl6YWJsZQogICAgICAgICAgICBwcmludChqc29uLmR1bXBzKHJlc3VsdC5hc19kaWN0KCkpKSAjIC0+IHtcIm1vbnRoXCI6IFwiMzFcIiwgXCJkYXlcIjogXCIxOTk5XCIsIFwieWVhclwiOiBcIjEyXCJ9CiAgICAgICAgXCJcIlwiCgogICAgICAgIGRlZiB0b19pdGVtKG9iaik6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBQYXJzZVJlc3VsdHMpOgogICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hc19kaWN0KCkgaWYgb2JqLmhhc2tleXMoKSBlbHNlIFt0b19pdGVtKHYpIGZvciB2IGluIG9ial0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBvYmoKCiAgICAgICAgcmV0dXJuIGRpY3QoKGssIHRvX2l0ZW0odikpIGZvciBrLCB2IGluIHNlbGYuaXRlbXMoKSkKCiAgICBkZWYgY29weShzZWxmKSAtPiBcIlBhcnNlUmVzdWx0c1wiOgogICAgICAgIFwiXCJcIgogICAgICAgIFJldHVybnMgYSBuZXcgY29weSBvZiBhIDpjbGFzczpgUGFyc2VSZXN1bHRzYCBvYmplY3QuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0ID0gUGFyc2VSZXN1bHRzKHNlbGYuX3Rva2xpc3QpCiAgICAgICAgcmV0Ll90b2tkaWN0ID0gc2VsZi5fdG9rZGljdC5jb3B5KCkKICAgICAgICByZXQuX3BhcmVudCA9IHNlbGYuX3BhcmVudAogICAgICAgIHJldC5fYWxsX25hbWVzIHw9IHNlbGYuX2FsbF9uYW1lcwogICAgICAgIHJldC5fbmFtZSA9IHNlbGYuX25hbWUKICAgICAgICByZXR1cm4gcmV0CgogICAgZGVmIGdldF9uYW1lKHNlbGYpOgogICAgICAgIHJcIlwiXCIKICAgICAgICBSZXR1cm5zIHRoZSByZXN1bHRzIG5hbWUgZm9yIHRoaXMgdG9rZW4gZXhwcmVzc2lvbi4gVXNlZnVsIHdoZW4gc2V2ZXJhbAogICAgICAgIGRpZmZlcmVudCBleHByZXNzaW9ucyBtaWdodCBtYXRjaCBhdCBhIHBhcnRpY3VsYXIgbG9jYXRpb24uCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgaW50ZWdlciA9IFdvcmQobnVtcykKICAgICAgICAgICAgc3NuX2V4cHIgPSBSZWdleChyXCJcXGRcXGRcXGQtXFxkXFxkLVxcZFxcZFxcZFxcZFwiKQogICAgICAgICAgICBob3VzZV9udW1iZXJfZXhwciA9IFN1cHByZXNzKCcjJykgKyBXb3JkKG51bXMsIGFscGhhbnVtcykKICAgICAgICAgICAgdXNlcl9kYXRhID0gKEdyb3VwKGhvdXNlX251bWJlcl9leHByKShcImhvdXNlX251bWJlclwiKQogICAgICAgICAgICAgICAgICAgICAgICB8IEdyb3VwKHNzbl9leHByKShcInNzblwiKQogICAgICAgICAgICAgICAgICAgICAgICB8IEdyb3VwKGludGVnZXIpKFwiYWdlXCIpKQogICAgICAgICAgICB1c2VyX2luZm8gPSB1c2VyX2RhdGFbMSwgLi4uXQoKICAgICAgICAgICAgcmVzdWx0ID0gdXNlcl9pbmZvLnBhcnNlX3N0cmluZyhcIjIyIDExMS0yMi0zMzMzICMyMjFCXCIpCiAgICAgICAgICAgIGZvciBpdGVtIGluIHJlc3VsdDoKICAgICAgICAgICAgICAgIHByaW50KGl0ZW0uZ2V0X25hbWUoKSwgJzonLCBpdGVtWzBdKQoKICAgICAgICBwcmludHM6OgoKICAgICAgICAgICAgYWdlIDogMjIKICAgICAgICAgICAgc3NuIDogMTExLTIyLTMzMzMKICAgICAgICAgICAgaG91c2VfbnVtYmVyIDogMjIxQgogICAgICAgIFwiXCJcIgogICAgICAgIGlmIHNlbGYuX25hbWU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9uYW1lCiAgICAgICAgZWxpZiBzZWxmLl9wYXJlbnQ6CiAgICAgICAgICAgIHBhciA9IHNlbGYuX3BhcmVudCgpCgogICAgICAgICAgICBkZWYgZmluZF9pbl9wYXJlbnQoc3ViKToKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KAogICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgawogICAgICAgICAgICAgICAgICAgICAgICBmb3Igaywgdmxpc3QgaW4gcGFyLl90b2tkaWN0Lml0ZW1zKCkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHYsIGxvYyBpbiB2bGlzdAogICAgICAgICAgICAgICAgICAgICAgICBpZiBzdWIgaXMgdgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgTm9uZSwKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIHJldHVybiBmaW5kX2luX3BhcmVudChzZWxmKSBpZiBwYXIgZWxzZSBOb25lCiAgICAgICAgZWxpZiAoCiAgICAgICAgICAgIGxlbihzZWxmKSA9PSAxCiAgICAgICAgICAgIGFuZCBsZW4oc2VsZi5fdG9rZGljdCkgPT0gMQogICAgICAgICAgICBhbmQgbmV4dChpdGVyKHNlbGYuX3Rva2RpY3QudmFsdWVzKCkpKVswXVsxXSBpbiAoMCwgLTEpCiAgICAgICAgKToKICAgICAgICAgICAgcmV0dXJuIG5leHQoaXRlcihzZWxmLl90b2tkaWN0LmtleXMoKSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgZHVtcChzZWxmLCBpbmRlbnQ9XCJcIiwgZnVsbD1UcnVlLCBpbmNsdWRlX2xpc3Q9VHJ1ZSwgX2RlcHRoPTApIC0+IHN0cjoKICAgICAgICBcIlwiXCIKICAgICAgICBEaWFnbm9zdGljIG1ldGhvZCBmb3IgbGlzdGluZyBvdXQgdGhlIGNvbnRlbnRzIG9mCiAgICAgICAgYSA6Y2xhc3M6YFBhcnNlUmVzdWx0c2AuIEFjY2VwdHMgYW4gb3B0aW9uYWwgYGBpbmRlbnRgYCBhcmd1bWVudCBzbwogICAgICAgIHRoYXQgdGhpcyBzdHJpbmcgY2FuIGJlIGVtYmVkZGVkIGluIGEgbmVzdGVkIGRpc3BsYXkgb2Ygb3RoZXIgZGF0YS4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBpbnRlZ2VyID0gV29yZChudW1zKQogICAgICAgICAgICBkYXRlX3N0ciA9IGludGVnZXIoXCJ5ZWFyXCIpICsgJy8nICsgaW50ZWdlcihcIm1vbnRoXCIpICsgJy8nICsgaW50ZWdlcihcImRheVwiKQoKICAgICAgICAgICAgcmVzdWx0ID0gZGF0ZV9zdHIucGFyc2Vfc3RyaW5nKCcxOTk5LzEyLzMxJykKICAgICAgICAgICAgcHJpbnQocmVzdWx0LmR1bXAoKSkKCiAgICAgICAgcHJpbnRzOjoKCiAgICAgICAgICAgIFsnMTk5OScsICcvJywgJzEyJywgJy8nLCAnMzEnXQogICAgICAgICAgICAtIGRheTogJzMxJwogICAgICAgICAgICAtIG1vbnRoOiAnMTInCiAgICAgICAgICAgIC0geWVhcjogJzE5OTknCiAgICAgICAgXCJcIlwiCiAgICAgICAgb3V0ID0gW10KICAgICAgICBOTCA9IFwiXFxuXCIKICAgICAgICBvdXQuYXBwZW5kKGluZGVudCArIHN0cihzZWxmLmFzX2xpc3QoKSkgaWYgaW5jbHVkZV9saXN0IGVsc2UgXCJcIikKCiAgICAgICAgaWYgZnVsbDoKICAgICAgICAgICAgaWYgc2VsZi5oYXNrZXlzKCk6CiAgICAgICAgICAgICAgICBpdGVtcyA9IHNvcnRlZCgoc3RyKGspLCB2KSBmb3IgaywgdiBpbiBzZWxmLml0ZW1zKCkpCiAgICAgICAgICAgICAgICBmb3IgaywgdiBpbiBpdGVtczoKICAgICAgICAgICAgICAgICAgICBpZiBvdXQ6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dC5hcHBlbmQoTkwpCiAgICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZChcInt9e30tIHt9OiBcIi5mb3JtYXQoaW5kZW50LCAoXCIgIFwiICogX2RlcHRoKSwgaykpCiAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2LCBQYXJzZVJlc3VsdHMpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiB2OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LmR1bXAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGVudD1pbmRlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGw9ZnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZV9saXN0PWluY2x1ZGVfbGlzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RlcHRoPV9kZXB0aCArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZChzdHIodikpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZChyZXByKHYpKQogICAgICAgICAgICBpZiBhbnkoaXNpbnN0YW5jZSh2diwgUGFyc2VSZXN1bHRzKSBmb3IgdnYgaW4gc2VsZik6CiAgICAgICAgICAgICAgICB2ID0gc2VsZgogICAgICAgICAgICAgICAgZm9yIGksIHZ2IGluIGVudW1lcmF0ZSh2KToKICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHZ2LCBQYXJzZVJlc3VsdHMpOgogICAgICAgICAgICAgICAgICAgICAgICBvdXQuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG57fXt9W3t9XTpcXG57fXt9e31cIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChcIiAgXCIgKiAoX2RlcHRoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFwiICBcIiAqIChfZGVwdGggKyAxKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnYuZHVtcCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZW50PWluZGVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbD1mdWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlX2xpc3Q9aW5jbHVkZV9saXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGVwdGg9X2RlcHRoICsgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuJXMlc1slZF06XFxuJXMlcyVzXCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoXCIgIFwiICogKF9kZXB0aCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChcIiAgXCIgKiAoX2RlcHRoICsgMSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cih2diksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIFwiXCIuam9pbihvdXQpCgogICAgZGVmIHBwcmludChzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIFwiXCJcIgogICAgICAgIFByZXR0eS1wcmludGVyIGZvciBwYXJzZWQgcmVzdWx0cyBhcyBhIGxpc3QsIHVzaW5nIHRoZQogICAgICAgIGBwcHJpbnQgPGh0dHBzOi8vZG9jcy5weXRob24ub3JnLzMvbGlicmFyeS9wcHJpbnQuaHRtbD5gXyBtb2R1bGUuCiAgICAgICAgQWNjZXB0cyBhZGRpdGlvbmFsIHBvc2l0aW9uYWwgb3Iga2V5d29yZCBhcmdzIGFzIGRlZmluZWQgZm9yCiAgICAgICAgYHBwcmludC5wcHJpbnQgPGh0dHBzOi8vZG9jcy5weXRob24ub3JnLzMvbGlicmFyeS9wcHJpbnQuaHRtbCNwcHJpbnQucHByaW50PmBfIC4KCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICBpZGVudCA9IFdvcmQoYWxwaGFzLCBhbHBoYW51bXMpCiAgICAgICAgICAgIG51bSA9IFdvcmQobnVtcykKICAgICAgICAgICAgZnVuYyA9IEZvcndhcmQoKQogICAgICAgICAgICB0ZXJtID0gaWRlbnQgfCBudW0gfCBHcm91cCgnKCcgKyBmdW5jICsgJyknKQogICAgICAgICAgICBmdW5jIDw8PSBpZGVudCArIEdyb3VwKE9wdGlvbmFsKGRlbGltaXRlZF9saXN0KHRlcm0pKSkKICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5wYXJzZV9zdHJpbmcoXCJmbmEgYSxiLChmbmIgYyxkLDIwMCksMTAwXCIpCiAgICAgICAgICAgIHJlc3VsdC5wcHJpbnQod2lkdGg9NDApCgogICAgICAgIHByaW50czo6CgogICAgICAgICAgICBbJ2ZuYScsCiAgICAgICAgICAgICBbJ2EnLAogICAgICAgICAgICAgICdiJywKICAgICAgICAgICAgICBbJygnLCAnZm5iJywgWydjJywgJ2QnLCAnMjAwJ10sICcpJ10sCiAgICAgICAgICAgICAgJzEwMCddXQogICAgICAgIFwiXCJcIgogICAgICAgIHBwcmludC5wcHJpbnQoc2VsZi5hc19saXN0KCksICphcmdzLCAqKmt3YXJncykKCiAgICAjIGFkZCBzdXBwb3J0IGZvciBwaWNrbGUgcHJvdG9jb2wKICAgIGRlZiBfX2dldHN0YXRlX18oc2VsZik6CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgc2VsZi5fdG9rbGlzdCwKICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgc2VsZi5fdG9rZGljdC5jb3B5KCksCiAgICAgICAgICAgICAgICBzZWxmLl9wYXJlbnQgaXMgbm90IE5vbmUgYW5kIHNlbGYuX3BhcmVudCgpIG9yIE5vbmUsCiAgICAgICAgICAgICAgICBzZWxmLl9hbGxfbmFtZXMsCiAgICAgICAgICAgICAgICBzZWxmLl9uYW1lLAogICAgICAgICAgICApLAogICAgICAgICkKCiAgICBkZWYgX19zZXRzdGF0ZV9fKHNlbGYsIHN0YXRlKToKICAgICAgICBzZWxmLl90b2tsaXN0LCAoc2VsZi5fdG9rZGljdCwgcGFyLCBpbkFjY3VtTmFtZXMsIHNlbGYuX25hbWUpID0gc3RhdGUKICAgICAgICBzZWxmLl9hbGxfbmFtZXMgPSBzZXQoaW5BY2N1bU5hbWVzKQogICAgICAgIGlmIHBhciBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5fcGFyZW50ID0gd2tyZWYocGFyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3BhcmVudCA9IE5vbmUKCiAgICBkZWYgX19nZXRuZXdhcmdzX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3Rva2xpc3QsIHNlbGYuX25hbWUKCiAgICBkZWYgX19kaXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZGlyKHR5cGUoc2VsZikpICsgbGlzdChzZWxmLmtleXMoKSkKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9tX2RpY3QoY2xzLCBvdGhlciwgbmFtZT1Ob25lKSAtPiBcIlBhcnNlUmVzdWx0c1wiOgogICAgICAgIFwiXCJcIgogICAgICAgIEhlbHBlciBjbGFzc21ldGhvZCB0byBjb25zdHJ1Y3QgYSBgYFBhcnNlUmVzdWx0c2BgIGZyb20gYSBgYGRpY3RgYCwgcHJlc2VydmluZyB0aGUKICAgICAgICBuYW1lLXZhbHVlIHJlbGF0aW9ucyBhcyByZXN1bHRzIG5hbWVzLiBJZiBhbiBvcHRpb25hbCBgYG5hbWVgYCBhcmd1bWVudCBpcwogICAgICAgIGdpdmVuLCBhIG5lc3RlZCBgYFBhcnNlUmVzdWx0c2BgIHdpbGwgYmUgcmV0dXJuZWQuCiAgICAgICAgXCJcIlwiCgogICAgICAgIGRlZiBpc19pdGVyYWJsZShvYmopOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpdGVyKG9iaikKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIG5vdCBpc2luc3RhbmNlKG9iaiwgc3RyX3R5cGUpCgogICAgICAgIHJldCA9IGNscyhbXSkKICAgICAgICBmb3IgaywgdiBpbiBvdGhlci5pdGVtcygpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHYsIE1hcHBpbmcpOgogICAgICAgICAgICAgICAgcmV0ICs9IGNscy5mcm9tX2RpY3QodiwgbmFtZT1rKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0ICs9IGNscyhbdl0sIG5hbWU9aywgYXNMaXN0PWlzX2l0ZXJhYmxlKHYpKQogICAgICAgIGlmIG5hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldCA9IGNscyhbcmV0XSwgbmFtZT1uYW1lKQogICAgICAgIHJldHVybiByZXQKCiAgICBhc0xpc3QgPSBhc19saXN0CiAgICBhc0RpY3QgPSBhc19kaWN0CiAgICBnZXROYW1lID0gZ2V0X25hbWUKCgpNdXRhYmxlTWFwcGluZy5yZWdpc3RlcihQYXJzZVJlc3VsdHMpCk11dGFibGVTZXF1ZW5jZS5yZWdpc3RlcihQYXJzZVJlc3VsdHMpCgoiIiIKbW9kdWxlX2RpY3RbInB5cGFyc2luZy9fX2luaXRfXy5weSJdPSIiIgojIG1vZHVsZSBweXBhcnNpbmcucHkKIwojIENvcHlyaWdodCAoYykgMjAwMy0yMDIyICBQYXVsIFQuIE1jR3VpcmUKIwojIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwojIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQojIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwojIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKIyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8KIyBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8KIyB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CiMKIyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZQojIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgojCiMgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwKIyBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKIyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuCiMgSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkKIyBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULAojIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFCiMgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiMKCl9fZG9jX18gPSBcIlwiXCIKcHlwYXJzaW5nIG1vZHVsZSAtIENsYXNzZXMgYW5kIG1ldGhvZHMgdG8gZGVmaW5lIGFuZCBleGVjdXRlIHBhcnNpbmcgZ3JhbW1hcnMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClRoZSBweXBhcnNpbmcgbW9kdWxlIGlzIGFuIGFsdGVybmF0aXZlIGFwcHJvYWNoIHRvIGNyZWF0aW5nIGFuZApleGVjdXRpbmcgc2ltcGxlIGdyYW1tYXJzLCB2cy4gdGhlIHRyYWRpdGlvbmFsIGxleC95YWNjIGFwcHJvYWNoLCBvciB0aGUKdXNlIG9mIHJlZ3VsYXIgZXhwcmVzc2lvbnMuICBXaXRoIHB5cGFyc2luZywgeW91IGRvbid0IG5lZWQgdG8gbGVhcm4KYSBuZXcgc3ludGF4IGZvciBkZWZpbmluZyBncmFtbWFycyBvciBtYXRjaGluZyBleHByZXNzaW9ucyAtIHRoZSBwYXJzaW5nCm1vZHVsZSBwcm92aWRlcyBhIGxpYnJhcnkgb2YgY2xhc3NlcyB0aGF0IHlvdSB1c2UgdG8gY29uc3RydWN0IHRoZQpncmFtbWFyIGRpcmVjdGx5IGluIFB5dGhvbi4KCkhlcmUgaXMgYSBwcm9ncmFtIHRvIHBhcnNlIFwiSGVsbG8sIFdvcmxkIVwiIChvciBhbnkgZ3JlZXRpbmcgb2YgdGhlIGZvcm0KYGBcIjxzYWx1dGF0aW9uPiwgPGFkZHJlc3NlZT4hXCJgYCksIGJ1aWx0IHVwIHVzaW5nIDpjbGFzczpgV29yZGAsCjpjbGFzczpgTGl0ZXJhbGAsIGFuZCA6Y2xhc3M6YEFuZGAgZWxlbWVudHMKKHRoZSA6bWV0aDpgJysnPFBhcnNlckVsZW1lbnQuX19hZGRfXz5gIG9wZXJhdG9ycyBjcmVhdGUgOmNsYXNzOmBBbmRgIGV4cHJlc3Npb25zLAphbmQgdGhlIHN0cmluZ3MgYXJlIGF1dG8tY29udmVydGVkIHRvIDpjbGFzczpgTGl0ZXJhbGAgZXhwcmVzc2lvbnMpOjoKCiAgICBmcm9tIHB5cGFyc2luZyBpbXBvcnQgV29yZCwgYWxwaGFzCgogICAgIyBkZWZpbmUgZ3JhbW1hciBvZiBhIGdyZWV0aW5nCiAgICBncmVldCA9IFdvcmQoYWxwaGFzKSArIFwiLFwiICsgV29yZChhbHBoYXMpICsgXCIhXCIKCiAgICBoZWxsbyA9IFwiSGVsbG8sIFdvcmxkIVwiCiAgICBwcmludChoZWxsbywgXCItPlwiLCBncmVldC5wYXJzZV9zdHJpbmcoaGVsbG8pKQoKVGhlIHByb2dyYW0gb3V0cHV0cyB0aGUgZm9sbG93aW5nOjoKCiAgICBIZWxsbywgV29ybGQhIC0+IFsnSGVsbG8nLCAnLCcsICdXb3JsZCcsICchJ10KClRoZSBQeXRob24gcmVwcmVzZW50YXRpb24gb2YgdGhlIGdyYW1tYXIgaXMgcXVpdGUgcmVhZGFibGUsIG93aW5nIHRvIHRoZQpzZWxmLWV4cGxhbmF0b3J5IGNsYXNzIG5hbWVzLCBhbmQgdGhlIHVzZSBvZiA6Y2xhc3M6YCcrJzxBbmQ+YCwKOmNsYXNzOmAnfCc8TWF0Y2hGaXJzdD5gLCA6Y2xhc3M6YCdeJzxPcj5gIGFuZCA6Y2xhc3M6YCcmJzxFYWNoPmAgb3BlcmF0b3JzLgoKVGhlIDpjbGFzczpgUGFyc2VSZXN1bHRzYCBvYmplY3QgcmV0dXJuZWQgZnJvbQo6Y2xhc3M6YFBhcnNlckVsZW1lbnQucGFyc2VTdHJpbmdgIGNhbiBiZQphY2Nlc3NlZCBhcyBhIG5lc3RlZCBsaXN0LCBhIGRpY3Rpb25hcnksIG9yIGFuIG9iamVjdCB3aXRoIG5hbWVkCmF0dHJpYnV0ZXMuCgpUaGUgcHlwYXJzaW5nIG1vZHVsZSBoYW5kbGVzIHNvbWUgb2YgdGhlIHByb2JsZW1zIHRoYXQgYXJlIHR5cGljYWxseQp2ZXhpbmcgd2hlbiB3cml0aW5nIHRleHQgcGFyc2VyczoKCiAgLSBleHRyYSBvciBtaXNzaW5nIHdoaXRlc3BhY2UgKHRoZSBhYm92ZSBwcm9ncmFtIHdpbGwgYWxzbyBoYW5kbGUKICAgIFwiSGVsbG8sV29ybGQhXCIsIFwiSGVsbG8gICwgIFdvcmxkICAhXCIsIGV0Yy4pCiAgLSBxdW90ZWQgc3RyaW5ncwogIC0gZW1iZWRkZWQgY29tbWVudHMKCgpHZXR0aW5nIFN0YXJ0ZWQgLQotLS0tLS0tLS0tLS0tLS0tLQpWaXNpdCB0aGUgY2xhc3NlcyA6Y2xhc3M6YFBhcnNlckVsZW1lbnRgIGFuZCA6Y2xhc3M6YFBhcnNlUmVzdWx0c2AgdG8Kc2VlIHRoZSBiYXNlIGNsYXNzZXMgdGhhdCBtb3N0IG90aGVyIHB5cGFyc2luZwpjbGFzc2VzIGluaGVyaXQgZnJvbS4gVXNlIHRoZSBkb2NzdHJpbmdzIGZvciBleGFtcGxlcyBvZiBob3cgdG86CgogLSBjb25zdHJ1Y3QgbGl0ZXJhbCBtYXRjaCBleHByZXNzaW9ucyBmcm9tIDpjbGFzczpgTGl0ZXJhbGAgYW5kCiAgIDpjbGFzczpgQ2FzZWxlc3NMaXRlcmFsYCBjbGFzc2VzCiAtIGNvbnN0cnVjdCBjaGFyYWN0ZXIgd29yZC1ncm91cCBleHByZXNzaW9ucyB1c2luZyB0aGUgOmNsYXNzOmBXb3JkYAogICBjbGFzcwogLSBzZWUgaG93IHRvIGNyZWF0ZSByZXBldGl0aXZlIGV4cHJlc3Npb25zIHVzaW5nIDpjbGFzczpgWmVyb09yTW9yZWAKICAgYW5kIDpjbGFzczpgT25lT3JNb3JlYCBjbGFzc2VzCiAtIHVzZSA6Y2xhc3M6YCcrJzxBbmQ+YCwgOmNsYXNzOmAnfCc8TWF0Y2hGaXJzdD5gLCA6Y2xhc3M6YCdeJzxPcj5gLAogICBhbmQgOmNsYXNzOmAnJic8RWFjaD5gIG9wZXJhdG9ycyB0byBjb21iaW5lIHNpbXBsZSBleHByZXNzaW9ucyBpbnRvCiAgIG1vcmUgY29tcGxleCBvbmVzCiAtIGFzc29jaWF0ZSBuYW1lcyB3aXRoIHlvdXIgcGFyc2VkIHJlc3VsdHMgdXNpbmcKICAgOmNsYXNzOmBQYXJzZXJFbGVtZW50LnNldFJlc3VsdHNOYW1lYAogLSBhY2Nlc3MgdGhlIHBhcnNlZCBkYXRhLCB3aGljaCBpcyByZXR1cm5lZCBhcyBhIDpjbGFzczpgUGFyc2VSZXN1bHRzYAogICBvYmplY3QKIC0gZmluZCBzb21lIGhlbHBmdWwgZXhwcmVzc2lvbiBzaG9ydC1jdXRzIGxpa2UgOmNsYXNzOmBkZWxpbWl0ZWRMaXN0YAogICBhbmQgOmNsYXNzOmBvbmVPZmAKIC0gZmluZCBtb3JlIHVzZWZ1bCBjb21tb24gZXhwcmVzc2lvbnMgaW4gdGhlIDpjbGFzczpgcHlwYXJzaW5nX2NvbW1vbmAKICAgbmFtZXNwYWNlIGNsYXNzClwiXCJcIgpmcm9tIHR5cGluZyBpbXBvcnQgTmFtZWRUdXBsZQoKCmNsYXNzIHZlcnNpb25faW5mbyhOYW1lZFR1cGxlKToKICAgIG1ham9yOiBpbnQKICAgIG1pbm9yOiBpbnQKICAgIG1pY3JvOiBpbnQKICAgIHJlbGVhc2VsZXZlbDogc3RyCiAgICBzZXJpYWw6IGludAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIF9fdmVyc2lvbl9fKHNlbGYpOgogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIFwie30ue30ue31cIi5mb3JtYXQoc2VsZi5tYWpvciwgc2VsZi5taW5vciwgc2VsZi5taWNybykKICAgICAgICAgICAgKyAoCiAgICAgICAgICAgICAgICBcInt9e317fVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBcInJcIiBpZiBzZWxmLnJlbGVhc2VsZXZlbFswXSA9PSBcImNcIiBlbHNlIFwiXCIsCiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWxlYXNlbGV2ZWxbMF0sCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXJpYWwsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgXCJcIiwKICAgICAgICAgICAgKVtzZWxmLnJlbGVhc2VsZXZlbCA9PSBcImZpbmFsXCJdCiAgICAgICAgKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiBcInt9IHt9IC8ge31cIi5mb3JtYXQoX19uYW1lX18sIHNlbGYuX192ZXJzaW9uX18sIF9fdmVyc2lvbl90aW1lX18pCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBcInt9Lnt9KHt9KVwiLmZvcm1hdCgKICAgICAgICAgICAgX19uYW1lX18sCiAgICAgICAgICAgIHR5cGUoc2VsZikuX19uYW1lX18sCiAgICAgICAgICAgIFwiLCBcIi5qb2luKFwie309eyFyfVwiLmZvcm1hdCgqbnYpIGZvciBudiBpbiB6aXAoc2VsZi5fZmllbGRzLCBzZWxmKSksCiAgICAgICAgKQoKCl9fdmVyc2lvbl9pbmZvX18gPSB2ZXJzaW9uX2luZm8oMywgMCwgOSwgXCJmaW5hbFwiLCAwKQpfX3ZlcnNpb25fdGltZV9fID0gXCIwNSBNYXkgMjAyMiAwNzowMiBVVENcIgpfX3ZlcnNpb25fXyA9IF9fdmVyc2lvbl9pbmZvX18uX192ZXJzaW9uX18KX192ZXJzaW9uVGltZV9fID0gX192ZXJzaW9uX3RpbWVfXwpfX2F1dGhvcl9fID0gXCJQYXVsIE1jR3VpcmUgPHB0bWNnLmdtK3B5cGFyc2luZ0BnbWFpbC5jb20+XCIKCmZyb20gLnV0aWwgaW1wb3J0ICoKZnJvbSAuZXhjZXB0aW9ucyBpbXBvcnQgKgpmcm9tIC5hY3Rpb25zIGltcG9ydCAqCmZyb20gLmNvcmUgaW1wb3J0IF9fZGlhZ19fLCBfX2NvbXBhdF9fCmZyb20gLnJlc3VsdHMgaW1wb3J0ICoKZnJvbSAuY29yZSBpbXBvcnQgKgpmcm9tIC5jb3JlIGltcG9ydCBfYnVpbHRpbl9leHBycyBhcyBjb3JlX2J1aWx0aW5fZXhwcnMKZnJvbSAuaGVscGVycyBpbXBvcnQgKgpmcm9tIC5oZWxwZXJzIGltcG9ydCBfYnVpbHRpbl9leHBycyBhcyBoZWxwZXJfYnVpbHRpbl9leHBycwoKZnJvbSAudW5pY29kZSBpbXBvcnQgdW5pY29kZV9zZXQsIFVuaWNvZGVSYW5nZUxpc3QsIHB5cGFyc2luZ191bmljb2RlIGFzIHVuaWNvZGUKZnJvbSAudGVzdGluZyBpbXBvcnQgcHlwYXJzaW5nX3Rlc3QgYXMgdGVzdGluZwpmcm9tIC5jb21tb24gaW1wb3J0ICgKICAgIHB5cGFyc2luZ19jb21tb24gYXMgY29tbW9uLAogICAgX2J1aWx0aW5fZXhwcnMgYXMgY29tbW9uX2J1aWx0aW5fZXhwcnMsCikKCiMgZGVmaW5lIGJhY2t3YXJkIGNvbXBhdCBzeW5vbnltcwppZiBcInB5cGFyc2luZ191bmljb2RlXCIgbm90IGluIGdsb2JhbHMoKToKICAgIHB5cGFyc2luZ191bmljb2RlID0gdW5pY29kZQppZiBcInB5cGFyc2luZ19jb21tb25cIiBub3QgaW4gZ2xvYmFscygpOgogICAgcHlwYXJzaW5nX2NvbW1vbiA9IGNvbW1vbgppZiBcInB5cGFyc2luZ190ZXN0XCIgbm90IGluIGdsb2JhbHMoKToKICAgIHB5cGFyc2luZ190ZXN0ID0gdGVzdGluZwoKY29yZV9idWlsdGluX2V4cHJzICs9IGNvbW1vbl9idWlsdGluX2V4cHJzICsgaGVscGVyX2J1aWx0aW5fZXhwcnMKCgpfX2FsbF9fID0gWwogICAgXCJfX3ZlcnNpb25fX1wiLAogICAgXCJfX3ZlcnNpb25fdGltZV9fXCIsCiAgICBcIl9fYXV0aG9yX19cIiwKICAgIFwiX19jb21wYXRfX1wiLAogICAgXCJfX2RpYWdfX1wiLAogICAgXCJBbmRcIiwKICAgIFwiQXRMaW5lU3RhcnRcIiwKICAgIFwiQXRTdHJpbmdTdGFydFwiLAogICAgXCJDYXNlbGVzc0tleXdvcmRcIiwKICAgIFwiQ2FzZWxlc3NMaXRlcmFsXCIsCiAgICBcIkNoYXJzTm90SW5cIiwKICAgIFwiQ29tYmluZVwiLAogICAgXCJEaWN0XCIsCiAgICBcIkVhY2hcIiwKICAgIFwiRW1wdHlcIiwKICAgIFwiRm9sbG93ZWRCeVwiLAogICAgXCJGb3J3YXJkXCIsCiAgICBcIkdvVG9Db2x1bW5cIiwKICAgIFwiR3JvdXBcIiwKICAgIFwiSW5kZW50ZWRCbG9ja1wiLAogICAgXCJLZXl3b3JkXCIsCiAgICBcIkxpbmVFbmRcIiwKICAgIFwiTGluZVN0YXJ0XCIsCiAgICBcIkxpdGVyYWxcIiwKICAgIFwiTG9jYXRlZFwiLAogICAgXCJQcmVjZWRlZEJ5XCIsCiAgICBcIk1hdGNoRmlyc3RcIiwKICAgIFwiTm9NYXRjaFwiLAogICAgXCJOb3RBbnlcIiwKICAgIFwiT25lT3JNb3JlXCIsCiAgICBcIk9ubHlPbmNlXCIsCiAgICBcIk9wQXNzb2NcIiwKICAgIFwiT3B0XCIsCiAgICBcIk9wdGlvbmFsXCIsCiAgICBcIk9yXCIsCiAgICBcIlBhcnNlQmFzZUV4Y2VwdGlvblwiLAogICAgXCJQYXJzZUVsZW1lbnRFbmhhbmNlXCIsCiAgICBcIlBhcnNlRXhjZXB0aW9uXCIsCiAgICBcIlBhcnNlRXhwcmVzc2lvblwiLAogICAgXCJQYXJzZUZhdGFsRXhjZXB0aW9uXCIsCiAgICBcIlBhcnNlUmVzdWx0c1wiLAogICAgXCJQYXJzZVN5bnRheEV4Y2VwdGlvblwiLAogICAgXCJQYXJzZXJFbGVtZW50XCIsCiAgICBcIlBvc2l0aW9uVG9rZW5cIiwKICAgIFwiUXVvdGVkU3RyaW5nXCIsCiAgICBcIlJlY3Vyc2l2ZUdyYW1tYXJFeGNlcHRpb25cIiwKICAgIFwiUmVnZXhcIiwKICAgIFwiU2tpcFRvXCIsCiAgICBcIlN0cmluZ0VuZFwiLAogICAgXCJTdHJpbmdTdGFydFwiLAogICAgXCJTdXBwcmVzc1wiLAogICAgXCJUb2tlblwiLAogICAgXCJUb2tlbkNvbnZlcnRlclwiLAogICAgXCJXaGl0ZVwiLAogICAgXCJXb3JkXCIsCiAgICBcIldvcmRFbmRcIiwKICAgIFwiV29yZFN0YXJ0XCIsCiAgICBcIlplcm9Pck1vcmVcIiwKICAgIFwiQ2hhclwiLAogICAgXCJhbHBoYW51bXNcIiwKICAgIFwiYWxwaGFzXCIsCiAgICBcImFscGhhczhiaXRcIiwKICAgIFwiYW55X2Nsb3NlX3RhZ1wiLAogICAgXCJhbnlfb3Blbl90YWdcIiwKICAgIFwiY19zdHlsZV9jb21tZW50XCIsCiAgICBcImNvbFwiLAogICAgXCJjb21tb25faHRtbF9lbnRpdHlcIiwKICAgIFwiY291bnRlZF9hcnJheVwiLAogICAgXCJjcHBfc3R5bGVfY29tbWVudFwiLAogICAgXCJkYmxfcXVvdGVkX3N0cmluZ1wiLAogICAgXCJkYmxfc2xhc2hfY29tbWVudFwiLAogICAgXCJkZWxpbWl0ZWRfbGlzdFwiLAogICAgXCJkaWN0X29mXCIsCiAgICBcImVtcHR5XCIsCiAgICBcImhleG51bXNcIiwKICAgIFwiaHRtbF9jb21tZW50XCIsCiAgICBcImlkZW50Y2hhcnNcIiwKICAgIFwiaWRlbnRib2R5Y2hhcnNcIiwKICAgIFwiamF2YV9zdHlsZV9jb21tZW50XCIsCiAgICBcImxpbmVcIiwKICAgIFwibGluZV9lbmRcIiwKICAgIFwibGluZV9zdGFydFwiLAogICAgXCJsaW5lbm9cIiwKICAgIFwibWFrZV9odG1sX3RhZ3NcIiwKICAgIFwibWFrZV94bWxfdGFnc1wiLAogICAgXCJtYXRjaF9vbmx5X2F0X2NvbFwiLAogICAgXCJtYXRjaF9wcmV2aW91c19leHByXCIsCiAgICBcIm1hdGNoX3ByZXZpb3VzX2xpdGVyYWxcIiwKICAgIFwibmVzdGVkX2V4cHJcIiwKICAgIFwibnVsbF9kZWJ1Z19hY3Rpb25cIiwKICAgIFwibnVtc1wiLAogICAgXCJvbmVfb2ZcIiwKICAgIFwicHJpbnRhYmxlc1wiLAogICAgXCJwdW5jOGJpdFwiLAogICAgXCJweXRob25fc3R5bGVfY29tbWVudFwiLAogICAgXCJxdW90ZWRfc3RyaW5nXCIsCiAgICBcInJlbW92ZV9xdW90ZXNcIiwKICAgIFwicmVwbGFjZV93aXRoXCIsCiAgICBcInJlcGxhY2VfaHRtbF9lbnRpdHlcIiwKICAgIFwicmVzdF9vZl9saW5lXCIsCiAgICBcInNnbF9xdW90ZWRfc3RyaW5nXCIsCiAgICBcInNyYW5nZVwiLAogICAgXCJzdHJpbmdfZW5kXCIsCiAgICBcInN0cmluZ19zdGFydFwiLAogICAgXCJ0cmFjZV9wYXJzZV9hY3Rpb25cIiwKICAgIFwidW5pY29kZV9zdHJpbmdcIiwKICAgIFwid2l0aF9hdHRyaWJ1dGVcIiwKICAgIFwiaW5kZW50ZWRCbG9ja1wiLAogICAgXCJvcmlnaW5hbF90ZXh0X2ZvclwiLAogICAgXCJ1bmdyb3VwXCIsCiAgICBcImluZml4X25vdGF0aW9uXCIsCiAgICBcImxvY2F0ZWRFeHByXCIsCiAgICBcIndpdGhfY2xhc3NcIiwKICAgIFwiQ2xvc2VNYXRjaFwiLAogICAgXCJ0b2tlbl9tYXBcIiwKICAgIFwicHlwYXJzaW5nX2NvbW1vblwiLAogICAgXCJweXBhcnNpbmdfdW5pY29kZVwiLAogICAgXCJ1bmljb2RlX3NldFwiLAogICAgXCJjb25kaXRpb25fYXNfcGFyc2VfYWN0aW9uXCIsCiAgICBcInB5cGFyc2luZ190ZXN0XCIsCiAgICAjIHByZS1QRVA4IGNvbXBhdGliaWxpdHkgbmFtZXMKICAgIFwiX192ZXJzaW9uVGltZV9fXCIsCiAgICBcImFueUNsb3NlVGFnXCIsCiAgICBcImFueU9wZW5UYWdcIiwKICAgIFwiY1N0eWxlQ29tbWVudFwiLAogICAgXCJjb21tb25IVE1MRW50aXR5XCIsCiAgICBcImNvdW50ZWRBcnJheVwiLAogICAgXCJjcHBTdHlsZUNvbW1lbnRcIiwKICAgIFwiZGJsUXVvdGVkU3RyaW5nXCIsCiAgICBcImRibFNsYXNoQ29tbWVudFwiLAogICAgXCJkZWxpbWl0ZWRMaXN0XCIsCiAgICBcImRpY3RPZlwiLAogICAgXCJodG1sQ29tbWVudFwiLAogICAgXCJqYXZhU3R5bGVDb21tZW50XCIsCiAgICBcImxpbmVFbmRcIiwKICAgIFwibGluZVN0YXJ0XCIsCiAgICBcIm1ha2VIVE1MVGFnc1wiLAogICAgXCJtYWtlWE1MVGFnc1wiLAogICAgXCJtYXRjaE9ubHlBdENvbFwiLAogICAgXCJtYXRjaFByZXZpb3VzRXhwclwiLAogICAgXCJtYXRjaFByZXZpb3VzTGl0ZXJhbFwiLAogICAgXCJuZXN0ZWRFeHByXCIsCiAgICBcIm51bGxEZWJ1Z0FjdGlvblwiLAogICAgXCJvbmVPZlwiLAogICAgXCJvcEFzc29jXCIsCiAgICBcInB5dGhvblN0eWxlQ29tbWVudFwiLAogICAgXCJxdW90ZWRTdHJpbmdcIiwKICAgIFwicmVtb3ZlUXVvdGVzXCIsCiAgICBcInJlcGxhY2VIVE1MRW50aXR5XCIsCiAgICBcInJlcGxhY2VXaXRoXCIsCiAgICBcInJlc3RPZkxpbmVcIiwKICAgIFwic2dsUXVvdGVkU3RyaW5nXCIsCiAgICBcInN0cmluZ0VuZFwiLAogICAgXCJzdHJpbmdTdGFydFwiLAogICAgXCJ0cmFjZVBhcnNlQWN0aW9uXCIsCiAgICBcInVuaWNvZGVTdHJpbmdcIiwKICAgIFwid2l0aEF0dHJpYnV0ZVwiLAogICAgXCJpbmRlbnRlZEJsb2NrXCIsCiAgICBcIm9yaWdpbmFsVGV4dEZvclwiLAogICAgXCJpbmZpeE5vdGF0aW9uXCIsCiAgICBcImxvY2F0ZWRFeHByXCIsCiAgICBcIndpdGhDbGFzc1wiLAogICAgXCJ0b2tlbk1hcFwiLAogICAgXCJjb25kaXRpb25Bc1BhcnNlQWN0aW9uXCIsCiAgICBcImF1dG9uYW1lX2VsZW1lbnRzXCIsCl0KCiIiIgptb2R1bGVfZGljdFsicHlwYXJzaW5nL3V0aWwucHkiXT0iIiIKIyB1dGlsLnB5CmltcG9ydCB3YXJuaW5ncwppbXBvcnQgdHlwZXMKaW1wb3J0IGNvbGxlY3Rpb25zCmltcG9ydCBpdGVydG9vbHMKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IGxydV9jYWNoZQpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgVW5pb24sIEl0ZXJhYmxlCgpfYnNsYXNoID0gY2hyKDkyKQoKCmNsYXNzIF9fY29uZmlnX2ZsYWdzOgogICAgXCJcIlwiSW50ZXJuYWwgY2xhc3MgZm9yIGRlZmluaW5nIGNvbXBhdGliaWxpdHkgYW5kIGRlYnVnZ2luZyBmbGFnc1wiXCJcIgoKICAgIF9hbGxfbmFtZXM6IExpc3Rbc3RyXSA9IFtdCiAgICBfZml4ZWRfbmFtZXM6IExpc3Rbc3RyXSA9IFtdCiAgICBfdHlwZV9kZXNjID0gXCJjb25maWd1cmF0aW9uXCIKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfc2V0KGNscywgZG5hbWUsIHZhbHVlKToKICAgICAgICBpZiBkbmFtZSBpbiBjbHMuX2ZpeGVkX25hbWVzOgogICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgXCJ7fS57fSB7fSBpcyB7fSBhbmQgY2Fubm90IGJlIG92ZXJyaWRkZW5cIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgY2xzLl9fbmFtZV9fLAogICAgICAgICAgICAgICAgICAgIGRuYW1lLAogICAgICAgICAgICAgICAgICAgIGNscy5fdHlwZV9kZXNjLAogICAgICAgICAgICAgICAgICAgIHN0cihnZXRhdHRyKGNscywgZG5hbWUpKS51cHBlcigpLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGRuYW1lIGluIGNscy5fYWxsX25hbWVzOgogICAgICAgICAgICBzZXRhdHRyKGNscywgZG5hbWUsIHZhbHVlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoXCJubyBzdWNoIHt9IHshcn1cIi5mb3JtYXQoY2xzLl90eXBlX2Rlc2MsIGRuYW1lKSkKCiAgICBlbmFibGUgPSBjbGFzc21ldGhvZChsYW1iZGEgY2xzLCBuYW1lOiBjbHMuX3NldChuYW1lLCBUcnVlKSkKICAgIGRpc2FibGUgPSBjbGFzc21ldGhvZChsYW1iZGEgY2xzLCBuYW1lOiBjbHMuX3NldChuYW1lLCBGYWxzZSkpCgoKQGxydV9jYWNoZShtYXhzaXplPTEyOCkKZGVmIGNvbChsb2M6IGludCwgc3RyZzogc3RyKSAtPiBpbnQ6CiAgICBcIlwiXCIKICAgIFJldHVybnMgY3VycmVudCBjb2x1bW4gd2l0aGluIGEgc3RyaW5nLCBjb3VudGluZyBuZXdsaW5lcyBhcyBsaW5lIHNlcGFyYXRvcnMuCiAgICBUaGUgZmlyc3QgY29sdW1uIGlzIG51bWJlciAxLgoKICAgIE5vdGU6IHRoZSBkZWZhdWx0IHBhcnNpbmcgYmVoYXZpb3IgaXMgdG8gZXhwYW5kIHRhYnMgaW4gdGhlIGlucHV0IHN0cmluZwogICAgYmVmb3JlIHN0YXJ0aW5nIHRoZSBwYXJzaW5nIHByb2Nlc3MuICBTZWUKICAgIDpjbGFzczpgUGFyc2VyRWxlbWVudC5wYXJzZVN0cmluZ2AgZm9yIG1vcmUKICAgIGluZm9ybWF0aW9uIG9uIHBhcnNpbmcgc3RyaW5ncyBjb250YWluaW5nIGBgPFRBQj5gYCBzLCBhbmQgc3VnZ2VzdGVkCiAgICBtZXRob2RzIHRvIG1haW50YWluIGEgY29uc2lzdGVudCB2aWV3IG9mIHRoZSBwYXJzZWQgc3RyaW5nLCB0aGUgcGFyc2UKICAgIGxvY2F0aW9uLCBhbmQgbGluZSBhbmQgY29sdW1uIHBvc2l0aW9ucyB3aXRoaW4gdGhlIHBhcnNlZCBzdHJpbmcuCiAgICBcIlwiXCIKICAgIHMgPSBzdHJnCiAgICByZXR1cm4gMSBpZiAwIDwgbG9jIDwgbGVuKHMpIGFuZCBzW2xvYyAtIDFdID09IFwiXFxuXCIgZWxzZSBsb2MgLSBzLnJmaW5kKFwiXFxuXCIsIDAsIGxvYykKCgpAbHJ1X2NhY2hlKG1heHNpemU9MTI4KQpkZWYgbGluZW5vKGxvYzogaW50LCBzdHJnOiBzdHIpIC0+IGludDoKICAgIFwiXCJcIlJldHVybnMgY3VycmVudCBsaW5lIG51bWJlciB3aXRoaW4gYSBzdHJpbmcsIGNvdW50aW5nIG5ld2xpbmVzIGFzIGxpbmUgc2VwYXJhdG9ycy4KICAgIFRoZSBmaXJzdCBsaW5lIGlzIG51bWJlciAxLgoKICAgIE5vdGUgLSB0aGUgZGVmYXVsdCBwYXJzaW5nIGJlaGF2aW9yIGlzIHRvIGV4cGFuZCB0YWJzIGluIHRoZSBpbnB1dCBzdHJpbmcKICAgIGJlZm9yZSBzdGFydGluZyB0aGUgcGFyc2luZyBwcm9jZXNzLiAgU2VlIDpjbGFzczpgUGFyc2VyRWxlbWVudC5wYXJzZVN0cmluZ2AKICAgIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIHBhcnNpbmcgc3RyaW5ncyBjb250YWluaW5nIGBgPFRBQj5gYCBzLCBhbmQKICAgIHN1Z2dlc3RlZCBtZXRob2RzIHRvIG1haW50YWluIGEgY29uc2lzdGVudCB2aWV3IG9mIHRoZSBwYXJzZWQgc3RyaW5nLCB0aGUKICAgIHBhcnNlIGxvY2F0aW9uLCBhbmQgbGluZSBhbmQgY29sdW1uIHBvc2l0aW9ucyB3aXRoaW4gdGhlIHBhcnNlZCBzdHJpbmcuCiAgICBcIlwiXCIKICAgIHJldHVybiBzdHJnLmNvdW50KFwiXFxuXCIsIDAsIGxvYykgKyAxCgoKQGxydV9jYWNoZShtYXhzaXplPTEyOCkKZGVmIGxpbmUobG9jOiBpbnQsIHN0cmc6IHN0cikgLT4gc3RyOgogICAgXCJcIlwiCiAgICBSZXR1cm5zIHRoZSBsaW5lIG9mIHRleHQgY29udGFpbmluZyBsb2Mgd2l0aGluIGEgc3RyaW5nLCBjb3VudGluZyBuZXdsaW5lcyBhcyBsaW5lIHNlcGFyYXRvcnMuCiAgICBcIlwiXCIKICAgIGxhc3RfY3IgPSBzdHJnLnJmaW5kKFwiXFxuXCIsIDAsIGxvYykKICAgIG5leHRfY3IgPSBzdHJnLmZpbmQoXCJcXG5cIiwgbG9jKQogICAgcmV0dXJuIHN0cmdbbGFzdF9jciArIDEgOiBuZXh0X2NyXSBpZiBuZXh0X2NyID49IDAgZWxzZSBzdHJnW2xhc3RfY3IgKyAxIDpdCgoKY2xhc3MgX1VuYm91bmRlZENhY2hlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIGNhY2hlID0ge30KICAgICAgICBjYWNoZV9nZXQgPSBjYWNoZS5nZXQKICAgICAgICBzZWxmLm5vdF9pbl9jYWNoZSA9IG5vdF9pbl9jYWNoZSA9IG9iamVjdCgpCgogICAgICAgIGRlZiBnZXQoXywga2V5KToKICAgICAgICAgICAgcmV0dXJuIGNhY2hlX2dldChrZXksIG5vdF9pbl9jYWNoZSkKCiAgICAgICAgZGVmIHNldF8oXywga2V5LCB2YWx1ZSk6CiAgICAgICAgICAgIGNhY2hlW2tleV0gPSB2YWx1ZQoKICAgICAgICBkZWYgY2xlYXIoXyk6CiAgICAgICAgICAgIGNhY2hlLmNsZWFyKCkKCiAgICAgICAgc2VsZi5zaXplID0gTm9uZQogICAgICAgIHNlbGYuZ2V0ID0gdHlwZXMuTWV0aG9kVHlwZShnZXQsIHNlbGYpCiAgICAgICAgc2VsZi5zZXQgPSB0eXBlcy5NZXRob2RUeXBlKHNldF8sIHNlbGYpCiAgICAgICAgc2VsZi5jbGVhciA9IHR5cGVzLk1ldGhvZFR5cGUoY2xlYXIsIHNlbGYpCgoKY2xhc3MgX0ZpZm9DYWNoZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzaXplKToKICAgICAgICBzZWxmLm5vdF9pbl9jYWNoZSA9IG5vdF9pbl9jYWNoZSA9IG9iamVjdCgpCiAgICAgICAgY2FjaGUgPSBjb2xsZWN0aW9ucy5PcmRlcmVkRGljdCgpCiAgICAgICAgY2FjaGVfZ2V0ID0gY2FjaGUuZ2V0CgogICAgICAgIGRlZiBnZXQoXywga2V5KToKICAgICAgICAgICAgcmV0dXJuIGNhY2hlX2dldChrZXksIG5vdF9pbl9jYWNoZSkKCiAgICAgICAgZGVmIHNldF8oXywga2V5LCB2YWx1ZSk6CiAgICAgICAgICAgIGNhY2hlW2tleV0gPSB2YWx1ZQogICAgICAgICAgICB3aGlsZSBsZW4oY2FjaGUpID4gc2l6ZToKICAgICAgICAgICAgICAgIGNhY2hlLnBvcGl0ZW0obGFzdD1GYWxzZSkKCiAgICAgICAgZGVmIGNsZWFyKF8pOgogICAgICAgICAgICBjYWNoZS5jbGVhcigpCgogICAgICAgIHNlbGYuc2l6ZSA9IHNpemUKICAgICAgICBzZWxmLmdldCA9IHR5cGVzLk1ldGhvZFR5cGUoZ2V0LCBzZWxmKQogICAgICAgIHNlbGYuc2V0ID0gdHlwZXMuTWV0aG9kVHlwZShzZXRfLCBzZWxmKQogICAgICAgIHNlbGYuY2xlYXIgPSB0eXBlcy5NZXRob2RUeXBlKGNsZWFyLCBzZWxmKQoKCmNsYXNzIExSVU1lbW86CiAgICBcIlwiXCIKICAgIEEgbWVtb2l6aW5nIG1hcHBpbmcgdGhhdCByZXRhaW5zIGBjYXBhY2l0eWAgZGVsZXRlZCBpdGVtcwoKICAgIFRoZSBtZW1vIHRyYWNrcyByZXRhaW5lZCBpdGVtcyBieSB0aGVpciBhY2Nlc3Mgb3JkZXI7IG9uY2UgYGNhcGFjaXR5YCBpdGVtcwogICAgYXJlIHJldGFpbmVkLCB0aGUgbGVhc3QgcmVjZW50bHkgdXNlZCBpdGVtIGlzIGRpc2NhcmRlZC4KICAgIFwiXCJcIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjYXBhY2l0eSk6CiAgICAgICAgc2VsZi5fY2FwYWNpdHkgPSBjYXBhY2l0eQogICAgICAgIHNlbGYuX2FjdGl2ZSA9IHt9CiAgICAgICAgc2VsZi5fbWVtb3J5ID0gY29sbGVjdGlvbnMuT3JkZXJlZERpY3QoKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2FjdGl2ZVtrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBzZWxmLl9tZW1vcnkubW92ZV90b19lbmQoa2V5KQogICAgICAgICAgICByZXR1cm4gc2VsZi5fbWVtb3J5W2tleV0KCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgc2VsZi5fbWVtb3J5LnBvcChrZXksIE5vbmUpCiAgICAgICAgc2VsZi5fYWN0aXZlW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdmFsdWUgPSBzZWxmLl9hY3RpdmUucG9wKGtleSkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICB3aGlsZSBsZW4oc2VsZi5fbWVtb3J5KSA+PSBzZWxmLl9jYXBhY2l0eToKICAgICAgICAgICAgICAgIHNlbGYuX21lbW9yeS5wb3BpdGVtKGxhc3Q9RmFsc2UpCiAgICAgICAgICAgIHNlbGYuX21lbW9yeVtrZXldID0gdmFsdWUKCiAgICBkZWYgY2xlYXIoc2VsZik6CiAgICAgICAgc2VsZi5fYWN0aXZlLmNsZWFyKCkKICAgICAgICBzZWxmLl9tZW1vcnkuY2xlYXIoKQoKCmNsYXNzIFVuYm91bmRlZE1lbW8oZGljdCk6CiAgICBcIlwiXCIKICAgIEEgbWVtb2l6aW5nIG1hcHBpbmcgdGhhdCByZXRhaW5zIGFsbCBkZWxldGVkIGl0ZW1zCiAgICBcIlwiXCIKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KToKICAgICAgICBwYXNzCgoKZGVmIF9lc2NhcGVfcmVnZXhfcmFuZ2VfY2hhcnMoczogc3RyKSAtPiBzdHI6CiAgICAjIGVzY2FwZSB0aGVzZSBjaGFyczogXi1bXQogICAgZm9yIGMgaW4gclwiXFxeLVtdXCI6CiAgICAgICAgcyA9IHMucmVwbGFjZShjLCBfYnNsYXNoICsgYykKICAgIHMgPSBzLnJlcGxhY2UoXCJcXG5cIiwgclwiXFxuXCIpCiAgICBzID0gcy5yZXBsYWNlKFwiXFx0XCIsIHJcIlxcdFwiKQogICAgcmV0dXJuIHN0cihzKQoKCmRlZiBfY29sbGFwc2Vfc3RyaW5nX3RvX3JhbmdlcygKICAgIHM6IFVuaW9uW3N0ciwgSXRlcmFibGVbc3RyXV0sIHJlX2VzY2FwZTogYm9vbCA9IFRydWUKKSAtPiBzdHI6CiAgICBkZWYgaXNfY29uc2VjdXRpdmUoYyk6CiAgICAgICAgY19pbnQgPSBvcmQoYykKICAgICAgICBpc19jb25zZWN1dGl2ZS5wcmV2LCBwcmV2ID0gY19pbnQsIGlzX2NvbnNlY3V0aXZlLnByZXYKICAgICAgICBpZiBjX2ludCAtIHByZXYgPiAxOgogICAgICAgICAgICBpc19jb25zZWN1dGl2ZS52YWx1ZSA9IG5leHQoaXNfY29uc2VjdXRpdmUuY291bnRlcikKICAgICAgICByZXR1cm4gaXNfY29uc2VjdXRpdmUudmFsdWUKCiAgICBpc19jb25zZWN1dGl2ZS5wcmV2ID0gMAogICAgaXNfY29uc2VjdXRpdmUuY291bnRlciA9IGl0ZXJ0b29scy5jb3VudCgpCiAgICBpc19jb25zZWN1dGl2ZS52YWx1ZSA9IC0xCgogICAgZGVmIGVzY2FwZV9yZV9yYW5nZV9jaGFyKGMpOgogICAgICAgIHJldHVybiBcIlxcXFxcIiArIGMgaWYgYyBpbiByXCJcXF4tXVtcIiBlbHNlIGMKCiAgICBkZWYgbm9fZXNjYXBlX3JlX3JhbmdlX2NoYXIoYyk6CiAgICAgICAgcmV0dXJuIGMKCiAgICBpZiBub3QgcmVfZXNjYXBlOgogICAgICAgIGVzY2FwZV9yZV9yYW5nZV9jaGFyID0gbm9fZXNjYXBlX3JlX3JhbmdlX2NoYXIKCiAgICByZXQgPSBbXQogICAgcyA9IFwiXCIuam9pbihzb3J0ZWQoc2V0KHMpKSkKICAgIGlmIGxlbihzKSA+IDM6CiAgICAgICAgZm9yIF8sIGNoYXJzIGluIGl0ZXJ0b29scy5ncm91cGJ5KHMsIGtleT1pc19jb25zZWN1dGl2ZSk6CiAgICAgICAgICAgIGZpcnN0ID0gbGFzdCA9IG5leHQoY2hhcnMpCiAgICAgICAgICAgIGxhc3QgPSBjb2xsZWN0aW9ucy5kZXF1ZSgKICAgICAgICAgICAgICAgIGl0ZXJ0b29scy5jaGFpbihpdGVyKFtsYXN0XSksIGNoYXJzKSwgbWF4bGVuPTEKICAgICAgICAgICAgKS5wb3AoKQogICAgICAgICAgICBpZiBmaXJzdCA9PSBsYXN0OgogICAgICAgICAgICAgICAgcmV0LmFwcGVuZChlc2NhcGVfcmVfcmFuZ2VfY2hhcihmaXJzdCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZXAgPSBcIlwiIGlmIG9yZChsYXN0KSA9PSBvcmQoZmlyc3QpICsgMSBlbHNlIFwiLVwiCiAgICAgICAgICAgICAgICByZXQuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIFwie317fXt9XCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICBlc2NhcGVfcmVfcmFuZ2VfY2hhcihmaXJzdCksIHNlcCwgZXNjYXBlX3JlX3JhbmdlX2NoYXIobGFzdCkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCiAgICBlbHNlOgogICAgICAgIHJldCA9IFtlc2NhcGVfcmVfcmFuZ2VfY2hhcihjKSBmb3IgYyBpbiBzXQoKICAgIHJldHVybiBcIlwiLmpvaW4ocmV0KQoKCmRlZiBfZmxhdHRlbihsbDogbGlzdCkgLT4gbGlzdDoKICAgIHJldCA9IFtdCiAgICBmb3IgaSBpbiBsbDoKICAgICAgICBpZiBpc2luc3RhbmNlKGksIGxpc3QpOgogICAgICAgICAgICByZXQuZXh0ZW5kKF9mbGF0dGVuKGkpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldC5hcHBlbmQoaSkKICAgIHJldHVybiByZXQKCiIiIgptb2R1bGVfZGljdFsicHlwYXJzaW5nL2NvbW1vbi5weSJdPSIiIgojIGNvbW1vbi5weQpmcm9tIC5jb3JlIGltcG9ydCAqCmZyb20gLmhlbHBlcnMgaW1wb3J0IGRlbGltaXRlZF9saXN0LCBhbnlfb3Blbl90YWcsIGFueV9jbG9zZV90YWcKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCgojIHNvbWUgb3RoZXIgdXNlZnVsIGV4cHJlc3Npb25zIC0gdXNpbmcgbG93ZXItY2FzZSBjbGFzcyBuYW1lIHNpbmNlIHdlIGFyZSByZWFsbHkgdXNpbmcgdGhpcyBhcyBhIG5hbWVzcGFjZQpjbGFzcyBweXBhcnNpbmdfY29tbW9uOgogICAgXCJcIlwiSGVyZSBhcmUgc29tZSBjb21tb24gbG93LWxldmVsIGV4cHJlc3Npb25zIHRoYXQgbWF5IGJlIHVzZWZ1bCBpbgogICAganVtcC1zdGFydGluZyBwYXJzZXIgZGV2ZWxvcG1lbnQ6CgogICAgLSBudW1lcmljIGZvcm1zICg6Y2xhc3M6YGludGVnZXJzPGludGVnZXI+YCwgOmNsYXNzOmByZWFsczxyZWFsPmAsCiAgICAgIDpjbGFzczpgc2NpZW50aWZpYyBub3RhdGlvbjxzY2lfcmVhbD5gKQogICAgLSBjb21tb24gOmNsYXNzOmBwcm9ncmFtbWluZyBpZGVudGlmaWVyczxpZGVudGlmaWVyPmAKICAgIC0gbmV0d29yayBhZGRyZXNzZXMgKDpjbGFzczpgTUFDPG1hY19hZGRyZXNzPmAsCiAgICAgIDpjbGFzczpgSVB2NDxpcHY0X2FkZHJlc3M+YCwgOmNsYXNzOmBJUHY2PGlwdjZfYWRkcmVzcz5gKQogICAgLSBJU084NjAxIDpjbGFzczpgZGF0ZXM8aXNvODYwMV9kYXRlPmAgYW5kCiAgICAgIDpjbGFzczpgZGF0ZXRpbWU8aXNvODYwMV9kYXRldGltZT5gCiAgICAtIDpjbGFzczpgVVVJRDx1dWlkPmAKICAgIC0gOmNsYXNzOmBjb21tYS1zZXBhcmF0ZWQgbGlzdDxjb21tYV9zZXBhcmF0ZWRfbGlzdD5gCiAgICAtIDpjbGFzczpgdXJsYAoKICAgIFBhcnNlIGFjdGlvbnM6CgogICAgLSA6Y2xhc3M6YGNvbnZlcnRUb0ludGVnZXJgCiAgICAtIDpjbGFzczpgY29udmVydFRvRmxvYXRgCiAgICAtIDpjbGFzczpgY29udmVydFRvRGF0ZWAKICAgIC0gOmNsYXNzOmBjb252ZXJ0VG9EYXRldGltZWAKICAgIC0gOmNsYXNzOmBzdHJpcEhUTUxUYWdzYAogICAgLSA6Y2xhc3M6YHVwY2FzZVRva2Vuc2AKICAgIC0gOmNsYXNzOmBkb3duY2FzZVRva2Vuc2AKCiAgICBFeGFtcGxlOjoKCiAgICAgICAgcHlwYXJzaW5nX2NvbW1vbi5udW1iZXIucnVuVGVzdHMoJycnCiAgICAgICAgICAgICMgYW55IGludCBvciByZWFsIG51bWJlciwgcmV0dXJuZWQgYXMgdGhlIGFwcHJvcHJpYXRlIHR5cGUKICAgICAgICAgICAgMTAwCiAgICAgICAgICAgIC0xMDAKICAgICAgICAgICAgKzEwMAogICAgICAgICAgICAzLjE0MTU5CiAgICAgICAgICAgIDYuMDJlMjMKICAgICAgICAgICAgMWUtMTIKICAgICAgICAgICAgJycnKQoKICAgICAgICBweXBhcnNpbmdfY29tbW9uLmZudW1iZXIucnVuVGVzdHMoJycnCiAgICAgICAgICAgICMgYW55IGludCBvciByZWFsIG51bWJlciwgcmV0dXJuZWQgYXMgZmxvYXQKICAgICAgICAgICAgMTAwCiAgICAgICAgICAgIC0xMDAKICAgICAgICAgICAgKzEwMAogICAgICAgICAgICAzLjE0MTU5CiAgICAgICAgICAgIDYuMDJlMjMKICAgICAgICAgICAgMWUtMTIKICAgICAgICAgICAgJycnKQoKICAgICAgICBweXBhcnNpbmdfY29tbW9uLmhleF9pbnRlZ2VyLnJ1blRlc3RzKCcnJwogICAgICAgICAgICAjIGhleCBudW1iZXJzCiAgICAgICAgICAgIDEwMAogICAgICAgICAgICBGRgogICAgICAgICAgICAnJycpCgogICAgICAgIHB5cGFyc2luZ19jb21tb24uZnJhY3Rpb24ucnVuVGVzdHMoJycnCiAgICAgICAgICAgICMgZnJhY3Rpb25zCiAgICAgICAgICAgIDEvMgogICAgICAgICAgICAtMy80CiAgICAgICAgICAgICcnJykKCiAgICAgICAgcHlwYXJzaW5nX2NvbW1vbi5taXhlZF9pbnRlZ2VyLnJ1blRlc3RzKCcnJwogICAgICAgICAgICAjIG1peGVkIGZyYWN0aW9ucwogICAgICAgICAgICAxCiAgICAgICAgICAgIDEvMgogICAgICAgICAgICAtMy80CiAgICAgICAgICAgIDEtMy80CiAgICAgICAgICAgICcnJykKCiAgICAgICAgaW1wb3J0IHV1aWQKICAgICAgICBweXBhcnNpbmdfY29tbW9uLnV1aWQuc2V0UGFyc2VBY3Rpb24odG9rZW5NYXAodXVpZC5VVUlEKSkKICAgICAgICBweXBhcnNpbmdfY29tbW9uLnV1aWQucnVuVGVzdHMoJycnCiAgICAgICAgICAgICMgdXVpZAogICAgICAgICAgICAxMjM0NTY3OC0xMjM0LTU2NzgtMTIzNC01Njc4MTIzNDU2NzgKICAgICAgICAgICAgJycnKQoKICAgIHByaW50czo6CgogICAgICAgICMgYW55IGludCBvciByZWFsIG51bWJlciwgcmV0dXJuZWQgYXMgdGhlIGFwcHJvcHJpYXRlIHR5cGUKICAgICAgICAxMDAKICAgICAgICBbMTAwXQoKICAgICAgICAtMTAwCiAgICAgICAgWy0xMDBdCgogICAgICAgICsxMDAKICAgICAgICBbMTAwXQoKICAgICAgICAzLjE0MTU5CiAgICAgICAgWzMuMTQxNTldCgogICAgICAgIDYuMDJlMjMKICAgICAgICBbNi4wMmUrMjNdCgogICAgICAgIDFlLTEyCiAgICAgICAgWzFlLTEyXQoKICAgICAgICAjIGFueSBpbnQgb3IgcmVhbCBudW1iZXIsIHJldHVybmVkIGFzIGZsb2F0CiAgICAgICAgMTAwCiAgICAgICAgWzEwMC4wXQoKICAgICAgICAtMTAwCiAgICAgICAgWy0xMDAuMF0KCiAgICAgICAgKzEwMAogICAgICAgIFsxMDAuMF0KCiAgICAgICAgMy4xNDE1OQogICAgICAgIFszLjE0MTU5XQoKICAgICAgICA2LjAyZTIzCiAgICAgICAgWzYuMDJlKzIzXQoKICAgICAgICAxZS0xMgogICAgICAgIFsxZS0xMl0KCiAgICAgICAgIyBoZXggbnVtYmVycwogICAgICAgIDEwMAogICAgICAgIFsyNTZdCgogICAgICAgIEZGCiAgICAgICAgWzI1NV0KCiAgICAgICAgIyBmcmFjdGlvbnMKICAgICAgICAxLzIKICAgICAgICBbMC41XQoKICAgICAgICAtMy80CiAgICAgICAgWy0wLjc1XQoKICAgICAgICAjIG1peGVkIGZyYWN0aW9ucwogICAgICAgIDEKICAgICAgICBbMV0KCiAgICAgICAgMS8yCiAgICAgICAgWzAuNV0KCiAgICAgICAgLTMvNAogICAgICAgIFstMC43NV0KCiAgICAgICAgMS0zLzQKICAgICAgICBbMS43NV0KCiAgICAgICAgIyB1dWlkCiAgICAgICAgMTIzNDU2NzgtMTIzNC01Njc4LTEyMzQtNTY3ODEyMzQ1Njc4CiAgICAgICAgW1VVSUQoJzEyMzQ1Njc4LTEyMzQtNTY3OC0xMjM0LTU2NzgxMjM0NTY3OCcpXQogICAgXCJcIlwiCgogICAgY29udmVydF90b19pbnRlZ2VyID0gdG9rZW5fbWFwKGludCkKICAgIFwiXCJcIgogICAgUGFyc2UgYWN0aW9uIGZvciBjb252ZXJ0aW5nIHBhcnNlZCBpbnRlZ2VycyB0byBQeXRob24gaW50CiAgICBcIlwiXCIKCiAgICBjb252ZXJ0X3RvX2Zsb2F0ID0gdG9rZW5fbWFwKGZsb2F0KQogICAgXCJcIlwiCiAgICBQYXJzZSBhY3Rpb24gZm9yIGNvbnZlcnRpbmcgcGFyc2VkIG51bWJlcnMgdG8gUHl0aG9uIGZsb2F0CiAgICBcIlwiXCIKCiAgICBpbnRlZ2VyID0gV29yZChudW1zKS5zZXRfbmFtZShcImludGVnZXJcIikuc2V0X3BhcnNlX2FjdGlvbihjb252ZXJ0X3RvX2ludGVnZXIpCiAgICBcIlwiXCJleHByZXNzaW9uIHRoYXQgcGFyc2VzIGFuIHVuc2lnbmVkIGludGVnZXIsIHJldHVybnMgYW4gaW50XCJcIlwiCgogICAgaGV4X2ludGVnZXIgPSAoCiAgICAgICAgV29yZChoZXhudW1zKS5zZXRfbmFtZShcImhleCBpbnRlZ2VyXCIpLnNldF9wYXJzZV9hY3Rpb24odG9rZW5fbWFwKGludCwgMTYpKQogICAgKQogICAgXCJcIlwiZXhwcmVzc2lvbiB0aGF0IHBhcnNlcyBhIGhleGFkZWNpbWFsIGludGVnZXIsIHJldHVybnMgYW4gaW50XCJcIlwiCgogICAgc2lnbmVkX2ludGVnZXIgPSAoCiAgICAgICAgUmVnZXgoclwiWystXT9cXGQrXCIpCiAgICAgICAgLnNldF9uYW1lKFwic2lnbmVkIGludGVnZXJcIikKICAgICAgICAuc2V0X3BhcnNlX2FjdGlvbihjb252ZXJ0X3RvX2ludGVnZXIpCiAgICApCiAgICBcIlwiXCJleHByZXNzaW9uIHRoYXQgcGFyc2VzIGFuIGludGVnZXIgd2l0aCBvcHRpb25hbCBsZWFkaW5nIHNpZ24sIHJldHVybnMgYW4gaW50XCJcIlwiCgogICAgZnJhY3Rpb24gPSAoCiAgICAgICAgc2lnbmVkX2ludGVnZXIoKS5zZXRfcGFyc2VfYWN0aW9uKGNvbnZlcnRfdG9fZmxvYXQpCiAgICAgICAgKyBcIi9cIgogICAgICAgICsgc2lnbmVkX2ludGVnZXIoKS5zZXRfcGFyc2VfYWN0aW9uKGNvbnZlcnRfdG9fZmxvYXQpCiAgICApLnNldF9uYW1lKFwiZnJhY3Rpb25cIikKICAgIFwiXCJcImZyYWN0aW9uYWwgZXhwcmVzc2lvbiBvZiBhbiBpbnRlZ2VyIGRpdmlkZWQgYnkgYW4gaW50ZWdlciwgcmV0dXJucyBhIGZsb2F0XCJcIlwiCiAgICBmcmFjdGlvbi5hZGRfcGFyc2VfYWN0aW9uKGxhbWJkYSB0dDogdHRbMF0gLyB0dFstMV0pCgogICAgbWl4ZWRfaW50ZWdlciA9ICgKICAgICAgICBmcmFjdGlvbiB8IHNpZ25lZF9pbnRlZ2VyICsgT3B0KE9wdChcIi1cIikuc3VwcHJlc3MoKSArIGZyYWN0aW9uKQogICAgKS5zZXRfbmFtZShcImZyYWN0aW9uIG9yIG1peGVkIGludGVnZXItZnJhY3Rpb25cIikKICAgIFwiXCJcIm1peGVkIGludGVnZXIgb2YgdGhlIGZvcm0gJ2ludGVnZXIgLSBmcmFjdGlvbicsIHdpdGggb3B0aW9uYWwgbGVhZGluZyBpbnRlZ2VyLCByZXR1cm5zIGZsb2F0XCJcIlwiCiAgICBtaXhlZF9pbnRlZ2VyLmFkZF9wYXJzZV9hY3Rpb24oc3VtKQoKICAgIHJlYWwgPSAoCiAgICAgICAgUmVnZXgoclwiWystXT8oPzpcXGQrXFwuXFxkKnxcXC5cXGQrKVwiKQogICAgICAgIC5zZXRfbmFtZShcInJlYWwgbnVtYmVyXCIpCiAgICAgICAgLnNldF9wYXJzZV9hY3Rpb24oY29udmVydF90b19mbG9hdCkKICAgICkKICAgIFwiXCJcImV4cHJlc3Npb24gdGhhdCBwYXJzZXMgYSBmbG9hdGluZyBwb2ludCBudW1iZXIgYW5kIHJldHVybnMgYSBmbG9hdFwiXCJcIgoKICAgIHNjaV9yZWFsID0gKAogICAgICAgIFJlZ2V4KHJcIlsrLV0/KD86XFxkKyg/OltlRV1bKy1dP1xcZCspfCg/OlxcZCtcXC5cXGQqfFxcLlxcZCspKD86W2VFXVsrLV0/XFxkKyk/KVwiKQogICAgICAgIC5zZXRfbmFtZShcInJlYWwgbnVtYmVyIHdpdGggc2NpZW50aWZpYyBub3RhdGlvblwiKQogICAgICAgIC5zZXRfcGFyc2VfYWN0aW9uKGNvbnZlcnRfdG9fZmxvYXQpCiAgICApCiAgICBcIlwiXCJleHByZXNzaW9uIHRoYXQgcGFyc2VzIGEgZmxvYXRpbmcgcG9pbnQgbnVtYmVyIHdpdGggb3B0aW9uYWwKICAgIHNjaWVudGlmaWMgbm90YXRpb24gYW5kIHJldHVybnMgYSBmbG9hdFwiXCJcIgoKICAgICMgc3RyZWFtbGluaW5nIHRoaXMgZXhwcmVzc2lvbiBtYWtlcyB0aGUgZG9jcyBuaWNlci1sb29raW5nCiAgICBudW1iZXIgPSAoc2NpX3JlYWwgfCByZWFsIHwgc2lnbmVkX2ludGVnZXIpLnNldE5hbWUoXCJudW1iZXJcIikuc3RyZWFtbGluZSgpCiAgICBcIlwiXCJhbnkgbnVtZXJpYyBleHByZXNzaW9uLCByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIFB5dGhvbiB0eXBlXCJcIlwiCgogICAgZm51bWJlciA9ICgKICAgICAgICBSZWdleChyXCJbKy1dP1xcZCtcXC4/XFxkKihbZUVdWystXT9cXGQrKT9cIikKICAgICAgICAuc2V0X25hbWUoXCJmbnVtYmVyXCIpCiAgICAgICAgLnNldF9wYXJzZV9hY3Rpb24oY29udmVydF90b19mbG9hdCkKICAgICkKICAgIFwiXCJcImFueSBpbnQgb3IgcmVhbCBudW1iZXIsIHJldHVybmVkIGFzIGZsb2F0XCJcIlwiCgogICAgaWRlbnRpZmllciA9IFdvcmQoaWRlbnRjaGFycywgaWRlbnRib2R5Y2hhcnMpLnNldF9uYW1lKFwiaWRlbnRpZmllclwiKQogICAgXCJcIlwidHlwaWNhbCBjb2RlIGlkZW50aWZpZXIgKGxlYWRpbmcgYWxwaGEgb3IgJ18nLCBmb2xsb3dlZCBieSAwIG9yIG1vcmUgYWxwaGFzLCBudW1zLCBvciAnXycpXCJcIlwiCgogICAgaXB2NF9hZGRyZXNzID0gUmVnZXgoCiAgICAgICAgclwiKDI1WzAtNV18MlswLTRdWzAtOV18MT9bMC05XXsxLDJ9KShcXC4oMjVbMC01XXwyWzAtNF1bMC05XXwxP1swLTldezEsMn0pKXszfVwiCiAgICApLnNldF9uYW1lKFwiSVB2NCBhZGRyZXNzXCIpCiAgICBcIklQdjQgYWRkcmVzcyAoYGAwLjAuMC4wIC0gMjU1LjI1NS4yNTUuMjU1YGApXCIKCiAgICBfaXB2Nl9wYXJ0ID0gUmVnZXgoclwiWzAtOWEtZkEtRl17MSw0fVwiKS5zZXRfbmFtZShcImhleF9pbnRlZ2VyXCIpCiAgICBfZnVsbF9pcHY2X2FkZHJlc3MgPSAoX2lwdjZfcGFydCArIChcIjpcIiArIF9pcHY2X3BhcnQpICogNykuc2V0X25hbWUoCiAgICAgICAgXCJmdWxsIElQdjYgYWRkcmVzc1wiCiAgICApCiAgICBfc2hvcnRfaXB2Nl9hZGRyZXNzID0gKAogICAgICAgIE9wdChfaXB2Nl9wYXJ0ICsgKFwiOlwiICsgX2lwdjZfcGFydCkgKiAoMCwgNikpCiAgICAgICAgKyBcIjo6XCIKICAgICAgICArIE9wdChfaXB2Nl9wYXJ0ICsgKFwiOlwiICsgX2lwdjZfcGFydCkgKiAoMCwgNikpCiAgICApLnNldF9uYW1lKFwic2hvcnQgSVB2NiBhZGRyZXNzXCIpCiAgICBfc2hvcnRfaXB2Nl9hZGRyZXNzLmFkZF9jb25kaXRpb24oCiAgICAgICAgbGFtYmRhIHQ6IHN1bSgxIGZvciB0dCBpbiB0IGlmIHB5cGFyc2luZ19jb21tb24uX2lwdjZfcGFydC5tYXRjaGVzKHR0KSkgPCA4CiAgICApCiAgICBfbWl4ZWRfaXB2Nl9hZGRyZXNzID0gKFwiOjpmZmZmOlwiICsgaXB2NF9hZGRyZXNzKS5zZXRfbmFtZShcIm1peGVkIElQdjYgYWRkcmVzc1wiKQogICAgaXB2Nl9hZGRyZXNzID0gQ29tYmluZSgKICAgICAgICAoX2Z1bGxfaXB2Nl9hZGRyZXNzIHwgX21peGVkX2lwdjZfYWRkcmVzcyB8IF9zaG9ydF9pcHY2X2FkZHJlc3MpLnNldF9uYW1lKAogICAgICAgICAgICBcIklQdjYgYWRkcmVzc1wiCiAgICAgICAgKQogICAgKS5zZXRfbmFtZShcIklQdjYgYWRkcmVzc1wiKQogICAgXCJJUHY2IGFkZHJlc3MgKGxvbmcsIHNob3J0LCBvciBtaXhlZCBmb3JtKVwiCgogICAgbWFjX2FkZHJlc3MgPSBSZWdleCgKICAgICAgICByXCJbMC05YS1mQS1GXXsyfShbOi4tXSlbMC05YS1mQS1GXXsyfSg/OlxcMVswLTlhLWZBLUZdezJ9KXs0fVwiCiAgICApLnNldF9uYW1lKFwiTUFDIGFkZHJlc3NcIikKICAgIFwiTUFDIGFkZHJlc3MgeHg6eHg6eHg6eHg6eHggKG1heSBhbHNvIGhhdmUgJy0nIG9yICcuJyBkZWxpbWl0ZXJzKVwiCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNvbnZlcnRfdG9fZGF0ZShmbXQ6IHN0ciA9IFwiJVktJW0tJWRcIik6CiAgICAgICAgXCJcIlwiCiAgICAgICAgSGVscGVyIHRvIGNyZWF0ZSBhIHBhcnNlIGFjdGlvbiBmb3IgY29udmVydGluZyBwYXJzZWQgZGF0ZSBzdHJpbmcgdG8gUHl0aG9uIGRhdGV0aW1lLmRhdGUKCiAgICAgICAgUGFyYW1zIC0KICAgICAgICAtIGZtdCAtIGZvcm1hdCB0byBiZSBwYXNzZWQgdG8gZGF0ZXRpbWUuc3RycHRpbWUgKGRlZmF1bHQ9IGBgXCIlWS0lbS0lZFwiYGApCgogICAgICAgIEV4YW1wbGU6OgoKICAgICAgICAgICAgZGF0ZV9leHByID0gcHlwYXJzaW5nX2NvbW1vbi5pc284NjAxX2RhdGUuY29weSgpCiAgICAgICAgICAgIGRhdGVfZXhwci5zZXRQYXJzZUFjdGlvbihweXBhcnNpbmdfY29tbW9uLmNvbnZlcnRUb0RhdGUoKSkKICAgICAgICAgICAgcHJpbnQoZGF0ZV9leHByLnBhcnNlU3RyaW5nKFwiMTk5OS0xMi0zMVwiKSkKCiAgICAgICAgcHJpbnRzOjoKCiAgICAgICAgICAgIFtkYXRldGltZS5kYXRlKDE5OTksIDEyLCAzMSldCiAgICAgICAgXCJcIlwiCgogICAgICAgIGRlZiBjdnRfZm4oc3MsIGxsLCB0dCk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJldHVybiBkYXRldGltZS5zdHJwdGltZSh0dFswXSwgZm10KS5kYXRlKCkKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3IgYXMgdmU6CiAgICAgICAgICAgICAgICByYWlzZSBQYXJzZUV4Y2VwdGlvbihzcywgbGwsIHN0cih2ZSkpCgogICAgICAgIHJldHVybiBjdnRfZm4KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY29udmVydF90b19kYXRldGltZShmbXQ6IHN0ciA9IFwiJVktJW0tJWRUJUg6JU06JVMuJWZcIik6CiAgICAgICAgXCJcIlwiSGVscGVyIHRvIGNyZWF0ZSBhIHBhcnNlIGFjdGlvbiBmb3IgY29udmVydGluZyBwYXJzZWQKICAgICAgICBkYXRldGltZSBzdHJpbmcgdG8gUHl0aG9uIGRhdGV0aW1lLmRhdGV0aW1lCgogICAgICAgIFBhcmFtcyAtCiAgICAgICAgLSBmbXQgLSBmb3JtYXQgdG8gYmUgcGFzc2VkIHRvIGRhdGV0aW1lLnN0cnB0aW1lIChkZWZhdWx0PSBgYFwiJVktJW0tJWRUJUg6JU06JVMuJWZcImBgKQoKICAgICAgICBFeGFtcGxlOjoKCiAgICAgICAgICAgIGR0X2V4cHIgPSBweXBhcnNpbmdfY29tbW9uLmlzbzg2MDFfZGF0ZXRpbWUuY29weSgpCiAgICAgICAgICAgIGR0X2V4cHIuc2V0UGFyc2VBY3Rpb24ocHlwYXJzaW5nX2NvbW1vbi5jb252ZXJ0VG9EYXRldGltZSgpKQogICAgICAgICAgICBwcmludChkdF9leHByLnBhcnNlU3RyaW5nKFwiMTk5OS0xMi0zMVQyMzo1OTo1OS45OTlcIikpCgogICAgICAgIHByaW50czo6CgogICAgICAgICAgICBbZGF0ZXRpbWUuZGF0ZXRpbWUoMTk5OSwgMTIsIDMxLCAyMywgNTksIDU5LCA5OTkwMDApXQogICAgICAgIFwiXCJcIgoKICAgICAgICBkZWYgY3Z0X2ZuKHMsIGwsIHQpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZXRpbWUuc3RycHRpbWUodFswXSwgZm10KQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyB2ZToKICAgICAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKHMsIGwsIHN0cih2ZSkpCgogICAgICAgIHJldHVybiBjdnRfZm4KCiAgICBpc284NjAxX2RhdGUgPSBSZWdleCgKICAgICAgICByXCIoP1A8eWVhcj5cXGR7NH0pKD86LSg/UDxtb250aD5cXGRcXGQpKD86LSg/UDxkYXk+XFxkXFxkKSk/KT9cIgogICAgKS5zZXRfbmFtZShcIklTTzg2MDEgZGF0ZVwiKQogICAgXCJJU084NjAxIGRhdGUgKGBgeXl5eS1tbS1kZGBgKVwiCgogICAgaXNvODYwMV9kYXRldGltZSA9IFJlZ2V4KAogICAgICAgIHJcIig/UDx5ZWFyPlxcZHs0fSktKD9QPG1vbnRoPlxcZFxcZCktKD9QPGRheT5cXGRcXGQpW1QgXSg/UDxob3VyPlxcZFxcZCk6KD9QPG1pbnV0ZT5cXGRcXGQpKDooP1A8c2Vjb25kPlxcZFxcZChcXC5cXGQqKT8pPyk/KD9QPHR6Plp8WystXVxcZFxcZDo/XFxkXFxkKT9cIgogICAgKS5zZXRfbmFtZShcIklTTzg2MDEgZGF0ZXRpbWVcIikKICAgIFwiSVNPODYwMSBkYXRldGltZSAoYGB5eXl5LW1tLWRkVGhoOm1tOnNzLnMoWnwrLTAwOjAwKWBgKSAtIHRyYWlsaW5nIHNlY29uZHMsIG1pbGxpc2Vjb25kcywgYW5kIHRpbWV6b25lIG9wdGlvbmFsOyBhY2NlcHRzIHNlcGFyYXRpbmcgYGAnVCdgYCBvciBgYCcgJ2BgXCIKCiAgICB1dWlkID0gUmVnZXgoclwiWzAtOWEtZkEtRl17OH0oLVswLTlhLWZBLUZdezR9KXszfS1bMC05YS1mQS1GXXsxMn1cIikuc2V0X25hbWUoXCJVVUlEXCIpCiAgICBcIlVVSUQgKGBgeHh4eHh4eHgteHh4eC14eHh4LXh4eHgteHh4eHh4eHh4eHh4YGApXCIKCiAgICBfaHRtbF9zdHJpcHBlciA9IGFueV9vcGVuX3RhZy5zdXBwcmVzcygpIHwgYW55X2Nsb3NlX3RhZy5zdXBwcmVzcygpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHN0cmlwX2h0bWxfdGFncyhzOiBzdHIsIGw6IGludCwgdG9rZW5zOiBQYXJzZVJlc3VsdHMpOgogICAgICAgIFwiXCJcIlBhcnNlIGFjdGlvbiB0byByZW1vdmUgSFRNTCB0YWdzIGZyb20gd2ViIHBhZ2UgSFRNTCBzb3VyY2UKCiAgICAgICAgRXhhbXBsZTo6CgogICAgICAgICAgICAjIHN0cmlwIEhUTUwgbGlua3MgZnJvbSBub3JtYWwgdGV4dAogICAgICAgICAgICB0ZXh0ID0gJzx0ZD5Nb3JlIGluZm8gYXQgdGhlIDxhIGhyZWY9XCJodHRwczovL2dpdGh1Yi5jb20vcHlwYXJzaW5nL3B5cGFyc2luZy93aWtpXCI+cHlwYXJzaW5nPC9hPiB3aWtpIHBhZ2U8L3RkPicKICAgICAgICAgICAgdGQsIHRkX2VuZCA9IG1ha2VIVE1MVGFncyhcIlREXCIpCiAgICAgICAgICAgIHRhYmxlX3RleHQgPSB0ZCArIFNraXBUbyh0ZF9lbmQpLnNldFBhcnNlQWN0aW9uKHB5cGFyc2luZ19jb21tb24uc3RyaXBIVE1MVGFncykoXCJib2R5XCIpICsgdGRfZW5kCiAgICAgICAgICAgIHByaW50KHRhYmxlX3RleHQucGFyc2VTdHJpbmcodGV4dCkuYm9keSkKCiAgICAgICAgUHJpbnRzOjoKCiAgICAgICAgICAgIE1vcmUgaW5mbyBhdCB0aGUgcHlwYXJzaW5nIHdpa2kgcGFnZQogICAgICAgIFwiXCJcIgogICAgICAgIHJldHVybiBweXBhcnNpbmdfY29tbW9uLl9odG1sX3N0cmlwcGVyLnRyYW5zZm9ybV9zdHJpbmcodG9rZW5zWzBdKQoKICAgIF9jb21tYXNlcGl0ZW0gPSAoCiAgICAgICAgQ29tYmluZSgKICAgICAgICAgICAgT25lT3JNb3JlKAogICAgICAgICAgICAgICAgfkxpdGVyYWwoXCIsXCIpCiAgICAgICAgICAgICAgICArIH5MaW5lRW5kKCkKICAgICAgICAgICAgICAgICsgV29yZChwcmludGFibGVzLCBleGNsdWRlX2NoYXJzPVwiLFwiKQogICAgICAgICAgICAgICAgKyBPcHQoV2hpdGUoXCIgXFx0XCIpICsgfkZvbGxvd2VkQnkoTGluZUVuZCgpIHwgXCIsXCIpKQogICAgICAgICAgICApCiAgICAgICAgKQogICAgICAgIC5zdHJlYW1saW5lKCkKICAgICAgICAuc2V0X25hbWUoXCJjb21tYUl0ZW1cIikKICAgICkKICAgIGNvbW1hX3NlcGFyYXRlZF9saXN0ID0gZGVsaW1pdGVkX2xpc3QoCiAgICAgICAgT3B0KHF1b3RlZF9zdHJpbmcuY29weSgpIHwgX2NvbW1hc2VwaXRlbSwgZGVmYXVsdD1cIlwiKQogICAgKS5zZXRfbmFtZShcImNvbW1hIHNlcGFyYXRlZCBsaXN0XCIpCiAgICBcIlwiXCJQcmVkZWZpbmVkIGV4cHJlc3Npb24gb2YgMSBvciBtb3JlIHByaW50YWJsZSB3b3JkcyBvciBxdW90ZWQgc3RyaW5ncywgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIlwiXCIKCiAgICB1cGNhc2VfdG9rZW5zID0gc3RhdGljbWV0aG9kKHRva2VuX21hcChsYW1iZGEgdDogdC51cHBlcigpKSkKICAgIFwiXCJcIlBhcnNlIGFjdGlvbiB0byBjb252ZXJ0IHRva2VucyB0byB1cHBlciBjYXNlLlwiXCJcIgoKICAgIGRvd25jYXNlX3Rva2VucyA9IHN0YXRpY21ldGhvZCh0b2tlbl9tYXAobGFtYmRhIHQ6IHQubG93ZXIoKSkpCiAgICBcIlwiXCJQYXJzZSBhY3Rpb24gdG8gY29udmVydCB0b2tlbnMgdG8gbG93ZXIgY2FzZS5cIlwiXCIKCiAgICAjIGZtdDogb2ZmCiAgICB1cmwgPSBSZWdleCgKICAgICAgICAjIGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9kZW1vL3VybC1yZWdleAogICAgICAgICMgaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZHBlcmluaS83MjkyOTQKICAgICAgICByXCJeXCIgKwogICAgICAgICMgcHJvdG9jb2wgaWRlbnRpZmllciAob3B0aW9uYWwpCiAgICAgICAgIyBzaG9ydCBzeW50YXggLy8gc3RpbGwgcmVxdWlyZWQKICAgICAgICByXCIoPzooPzooP1A8c2NoZW1lPmh0dHBzP3xmdHApOik/XFwvXFwvKVwiICsKICAgICAgICAjIHVzZXI6cGFzcyBCYXNpY0F1dGggKG9wdGlvbmFsKQogICAgICAgIHJcIig/Oig/UDxhdXRoPlxcUysoPzo6XFxTKik/KUApP1wiICsKICAgICAgICByXCIoP1A8aG9zdD5cIiArCiAgICAgICAgIyBJUCBhZGRyZXNzIGV4Y2x1c2lvbgogICAgICAgICMgcHJpdmF0ZSAmIGxvY2FsIG5ldHdvcmtzCiAgICAgICAgclwiKD8hKD86MTB8MTI3KSg/OlxcLlxcZHsxLDN9KXszfSlcIiArCiAgICAgICAgclwiKD8hKD86MTY5XFwuMjU0fDE5MlxcLjE2OCkoPzpcXC5cXGR7MSwzfSl7Mn0pXCIgKwogICAgICAgIHJcIig/ITE3MlxcLig/OjFbNi05XXwyXFxkfDNbMC0xXSkoPzpcXC5cXGR7MSwzfSl7Mn0pXCIgKwogICAgICAgICMgSVAgYWRkcmVzcyBkb3R0ZWQgbm90YXRpb24gb2N0ZXRzCiAgICAgICAgIyBleGNsdWRlcyBsb29wYmFjayBuZXR3b3JrIDAuMC4wLjAKICAgICAgICAjIGV4Y2x1ZGVzIHJlc2VydmVkIHNwYWNlID49IDIyNC4wLjAuMAogICAgICAgICMgZXhjbHVkZXMgbmV0d29yayAmIGJyb2FkY2FzdCBhZGRyZXNzZXMKICAgICAgICAjIChmaXJzdCAmIGxhc3QgSVAgYWRkcmVzcyBvZiBlYWNoIGNsYXNzKQogICAgICAgIHJcIig/OlsxLTldXFxkP3wxXFxkXFxkfDJbMDFdXFxkfDIyWzAtM10pXCIgKwogICAgICAgIHJcIig/OlxcLig/OjE/XFxkezEsMn18MlswLTRdXFxkfDI1WzAtNV0pKXsyfVwiICsKICAgICAgICByXCIoPzpcXC4oPzpbMS05XVxcZD98MVxcZFxcZHwyWzAtNF1cXGR8MjVbMC00XSkpXCIgKwogICAgICAgIHJcInxcIiArCiAgICAgICAgIyBob3N0ICYgZG9tYWluIG5hbWVzLCBtYXkgZW5kIHdpdGggZG90CiAgICAgICAgIyBjYW4gYmUgcmVwbGFjZWQgYnkgYSBzaG9ydGVzdCBhbHRlcm5hdGl2ZQogICAgICAgICMgKD8hWy1fXSkoPzpbLVxcd1xcdTAwYTEtXFx1ZmZmZl17MCw2M31bXi1fXVxcLikrCiAgICAgICAgclwiKD86XCIgKwogICAgICAgIHJcIig/OlwiICsKICAgICAgICByXCJbYS16MC05XFx1MDBhMS1cXHVmZmZmXVwiICsKICAgICAgICByXCJbYS16MC05XFx1MDBhMS1cXHVmZmZmXy1dezAsNjJ9XCIgKwogICAgICAgIHJcIik/XCIgKwogICAgICAgIHJcIlthLXowLTlcXHUwMGExLVxcdWZmZmZdXFwuXCIgKwogICAgICAgIHJcIikrXCIgKwogICAgICAgICMgVExEIGlkZW50aWZpZXIgbmFtZSwgbWF5IGVuZCB3aXRoIGRvdAogICAgICAgIHJcIig/OlthLXpcXHUwMGExLVxcdWZmZmZdezIsfVxcLj8pXCIgKwogICAgICAgIHJcIilcIiArCiAgICAgICAgIyBwb3J0IG51bWJlciAob3B0aW9uYWwpCiAgICAgICAgclwiKDooP1A8cG9ydD5cXGR7Miw1fSkpP1wiICsKICAgICAgICAjIHJlc291cmNlIHBhdGggKG9wdGlvbmFsKQogICAgICAgIHJcIig/UDxwYXRoPlxcL1tePyMgXSopP1wiICsKICAgICAgICAjIHF1ZXJ5IHN0cmluZyAob3B0aW9uYWwpCiAgICAgICAgclwiKFxcPyg/UDxxdWVyeT5bXiNdKikpP1wiICsKICAgICAgICAjIGZyYWdtZW50IChvcHRpb25hbCkKICAgICAgICByXCIoIyg/UDxmcmFnbWVudD5cXFMqKSk/XCIgKwogICAgICAgIHJcIiRcIgogICAgKS5zZXRfbmFtZShcInVybFwiKQogICAgIyBmbXQ6IG9uCgogICAgIyBwcmUtUEVQOCBjb21wYXRpYmlsaXR5IG5hbWVzCiAgICBjb252ZXJ0VG9JbnRlZ2VyID0gY29udmVydF90b19pbnRlZ2VyCiAgICBjb252ZXJ0VG9GbG9hdCA9IGNvbnZlcnRfdG9fZmxvYXQKICAgIGNvbnZlcnRUb0RhdGUgPSBjb252ZXJ0X3RvX2RhdGUKICAgIGNvbnZlcnRUb0RhdGV0aW1lID0gY29udmVydF90b19kYXRldGltZQogICAgc3RyaXBIVE1MVGFncyA9IHN0cmlwX2h0bWxfdGFncwogICAgdXBjYXNlVG9rZW5zID0gdXBjYXNlX3Rva2VucwogICAgZG93bmNhc2VUb2tlbnMgPSBkb3duY2FzZV90b2tlbnMKCgpfYnVpbHRpbl9leHBycyA9IFsKICAgIHYgZm9yIHYgaW4gdmFycyhweXBhcnNpbmdfY29tbW9uKS52YWx1ZXMoKSBpZiBpc2luc3RhbmNlKHYsIFBhcnNlckVsZW1lbnQpCl0KCiIiIgptb2R1bGVfZGljdFsicHlwYXJzaW5nL2FjdGlvbnMucHkiXT0iIiIKIyBhY3Rpb25zLnB5Cgpmcm9tIC5leGNlcHRpb25zIGltcG9ydCBQYXJzZUV4Y2VwdGlvbgpmcm9tIC51dGlsIGltcG9ydCBjb2wKCgpjbGFzcyBPbmx5T25jZToKICAgIFwiXCJcIgogICAgV3JhcHBlciBmb3IgcGFyc2UgYWN0aW9ucywgdG8gZW5zdXJlIHRoZXkgYXJlIG9ubHkgY2FsbGVkIG9uY2UuCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWV0aG9kX2NhbGwpOgogICAgICAgIGZyb20gLmNvcmUgaW1wb3J0IF90cmltX2FyaXR5CgogICAgICAgIHNlbGYuY2FsbGFibGUgPSBfdHJpbV9hcml0eShtZXRob2RfY2FsbCkKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIHMsIGwsIHQpOgogICAgICAgIGlmIG5vdCBzZWxmLmNhbGxlZDoKICAgICAgICAgICAgcmVzdWx0cyA9IHNlbGYuY2FsbGFibGUocywgbCwgdCkKICAgICAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgICAgIHJldHVybiByZXN1bHRzCiAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24ocywgbCwgXCJPbmx5T25jZSBvYmogY2FsbGVkIG11bHRpcGxlIHRpbWVzIHcvb3V0IHJlc2V0XCIpCgogICAgZGVmIHJlc2V0KHNlbGYpOgogICAgICAgIFwiXCJcIgogICAgICAgIEFsbG93IHRoZSBhc3NvY2lhdGVkIHBhcnNlIGFjdGlvbiB0byBiZSBjYWxsZWQgb25jZSBtb3JlLgogICAgICAgIFwiXCJcIgoKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCgoKZGVmIG1hdGNoX29ubHlfYXRfY29sKG4pOgogICAgXCJcIlwiCiAgICBIZWxwZXIgbWV0aG9kIGZvciBkZWZpbmluZyBwYXJzZSBhY3Rpb25zIHRoYXQgcmVxdWlyZSBtYXRjaGluZyBhdAogICAgYSBzcGVjaWZpYyBjb2x1bW4gaW4gdGhlIGlucHV0IHRleHQuCiAgICBcIlwiXCIKCiAgICBkZWYgdmVyaWZ5X2NvbChzdHJnLCBsb2NuLCB0b2tzKToKICAgICAgICBpZiBjb2wobG9jbiwgc3RyZykgIT0gbjoKICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oc3RyZywgbG9jbiwgXCJtYXRjaGVkIHRva2VuIG5vdCBhdCBjb2x1bW4ge31cIi5mb3JtYXQobikpCgogICAgcmV0dXJuIHZlcmlmeV9jb2wKCgpkZWYgcmVwbGFjZV93aXRoKHJlcGxfc3RyKToKICAgIFwiXCJcIgogICAgSGVscGVyIG1ldGhvZCBmb3IgY29tbW9uIHBhcnNlIGFjdGlvbnMgdGhhdCBzaW1wbHkgcmV0dXJuCiAgICBhIGxpdGVyYWwgdmFsdWUuICBFc3BlY2lhbGx5IHVzZWZ1bCB3aGVuIHVzZWQgd2l0aAogICAgOmNsYXNzOmB0cmFuc2Zvcm1fc3RyaW5nPFBhcnNlckVsZW1lbnQudHJhbnNmb3JtX3N0cmluZz5gICgpLgoKICAgIEV4YW1wbGU6OgoKICAgICAgICBudW0gPSBXb3JkKG51bXMpLnNldF9wYXJzZV9hY3Rpb24obGFtYmRhIHRva3M6IGludCh0b2tzWzBdKSkKICAgICAgICBuYSA9IG9uZV9vZihcIk4vQSBOQVwiKS5zZXRfcGFyc2VfYWN0aW9uKHJlcGxhY2Vfd2l0aChtYXRoLm5hbikpCiAgICAgICAgdGVybSA9IG5hIHwgbnVtCgogICAgICAgIHRlcm1bMSwgLi4uXS5wYXJzZV9zdHJpbmcoXCIzMjQgMjM0IE4vQSAyMzRcIikgIyAtPiBbMzI0LCAyMzQsIG5hbiwgMjM0XQogICAgXCJcIlwiCiAgICByZXR1cm4gbGFtYmRhIHMsIGwsIHQ6IFtyZXBsX3N0cl0KCgpkZWYgcmVtb3ZlX3F1b3RlcyhzLCBsLCB0KToKICAgIFwiXCJcIgogICAgSGVscGVyIHBhcnNlIGFjdGlvbiBmb3IgcmVtb3ZpbmcgcXVvdGF0aW9uIG1hcmtzIGZyb20gcGFyc2VkCiAgICBxdW90ZWQgc3RyaW5ncy4KCiAgICBFeGFtcGxlOjoKCiAgICAgICAgIyBieSBkZWZhdWx0LCBxdW90YXRpb24gbWFya3MgYXJlIGluY2x1ZGVkIGluIHBhcnNlZCByZXN1bHRzCiAgICAgICAgcXVvdGVkX3N0cmluZy5wYXJzZV9zdHJpbmcoXCInTm93IGlzIHRoZSBXaW50ZXIgb2Ygb3VyIERpc2NvbnRlbnQnXCIpICMgLT4gW1wiJ05vdyBpcyB0aGUgV2ludGVyIG9mIG91ciBEaXNjb250ZW50J1wiXQoKICAgICAgICAjIHVzZSByZW1vdmVfcXVvdGVzIHRvIHN0cmlwIHF1b3RhdGlvbiBtYXJrcyBmcm9tIHBhcnNlZCByZXN1bHRzCiAgICAgICAgcXVvdGVkX3N0cmluZy5zZXRfcGFyc2VfYWN0aW9uKHJlbW92ZV9xdW90ZXMpCiAgICAgICAgcXVvdGVkX3N0cmluZy5wYXJzZV9zdHJpbmcoXCInTm93IGlzIHRoZSBXaW50ZXIgb2Ygb3VyIERpc2NvbnRlbnQnXCIpICMgLT4gW1wiTm93IGlzIHRoZSBXaW50ZXIgb2Ygb3VyIERpc2NvbnRlbnRcIl0KICAgIFwiXCJcIgogICAgcmV0dXJuIHRbMF1bMTotMV0KCgpkZWYgd2l0aF9hdHRyaWJ1dGUoKmFyZ3MsICoqYXR0cl9kaWN0KToKICAgIFwiXCJcIgogICAgSGVscGVyIHRvIGNyZWF0ZSBhIHZhbGlkYXRpbmcgcGFyc2UgYWN0aW9uIHRvIGJlIHVzZWQgd2l0aCBzdGFydAogICAgdGFncyBjcmVhdGVkIHdpdGggOmNsYXNzOmBtYWtlX3htbF90YWdzYCBvcgogICAgOmNsYXNzOmBtYWtlX2h0bWxfdGFnc2AuIFVzZSBgYHdpdGhfYXR0cmlidXRlYGAgdG8gcXVhbGlmeQogICAgYSBzdGFydGluZyB0YWcgd2l0aCBhIHJlcXVpcmVkIGF0dHJpYnV0ZSB2YWx1ZSwgdG8gYXZvaWQgZmFsc2UKICAgIG1hdGNoZXMgb24gY29tbW9uIHRhZ3Mgc3VjaCBhcyBgYDxURD5gYCBvciBgYDxESVY+YGAuCgogICAgQ2FsbCBgYHdpdGhfYXR0cmlidXRlYGAgd2l0aCBhIHNlcmllcyBvZiBhdHRyaWJ1dGUgbmFtZXMgYW5kCiAgICB2YWx1ZXMuIFNwZWNpZnkgdGhlIGxpc3Qgb2YgZmlsdGVyIGF0dHJpYnV0ZXMgbmFtZXMgYW5kIHZhbHVlcyBhczoKCiAgICAtIGtleXdvcmQgYXJndW1lbnRzLCBhcyBpbiBgYChhbGlnbj1cInJpZ2h0XCIpYGAsIG9yCiAgICAtIGFzIGFuIGV4cGxpY2l0IGRpY3Qgd2l0aCBgYCoqYGAgb3BlcmF0b3IsIHdoZW4gYW4gYXR0cmlidXRlCiAgICAgIG5hbWUgaXMgYWxzbyBhIFB5dGhvbiByZXNlcnZlZCB3b3JkLCBhcyBpbiBgYCoqe1wiY2xhc3NcIjpcIkN1c3RvbWVyXCIsIFwiYWxpZ25cIjpcInJpZ2h0XCJ9YGAKICAgIC0gYSBsaXN0IG9mIG5hbWUtdmFsdWUgdHVwbGVzLCBhcyBpbiBgYCgoXCJuczE6Y2xhc3NcIiwgXCJDdXN0b21lclwiKSwgKFwibnMyOmFsaWduXCIsIFwicmlnaHRcIikpYGAKCiAgICBGb3IgYXR0cmlidXRlIG5hbWVzIHdpdGggYSBuYW1lc3BhY2UgcHJlZml4LCB5b3UgbXVzdCB1c2UgdGhlIHNlY29uZAogICAgZm9ybS4gIEF0dHJpYnV0ZSBuYW1lcyBhcmUgbWF0Y2hlZCBpbnNlbnNpdGl2ZSB0byB1cHBlci9sb3dlciBjYXNlLgoKICAgIElmIGp1c3QgdGVzdGluZyBmb3IgYGBjbGFzc2BgICh3aXRoIG9yIHdpdGhvdXQgYSBuYW1lc3BhY2UpLCB1c2UKICAgIDpjbGFzczpgd2l0aF9jbGFzc2AuCgogICAgVG8gdmVyaWZ5IHRoYXQgdGhlIGF0dHJpYnV0ZSBleGlzdHMsIGJ1dCB3aXRob3V0IHNwZWNpZnlpbmcgYSB2YWx1ZSwKICAgIHBhc3MgYGB3aXRoX2F0dHJpYnV0ZS5BTllfVkFMVUVgYCBhcyB0aGUgdmFsdWUuCgogICAgRXhhbXBsZTo6CgogICAgICAgIGh0bWwgPSAnJycKICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgU29tZSB0ZXh0CiAgICAgICAgICAgIDxkaXYgdHlwZT1cImdyaWRcIj4xIDQgMCAxIDA8L2Rpdj4KICAgICAgICAgICAgPGRpdiB0eXBlPVwiZ3JhcGhcIj4xLDMgMiwzIDEsMTwvZGl2PgogICAgICAgICAgICA8ZGl2PnRoaXMgaGFzIG5vIHR5cGU8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICcnJwogICAgICAgIGRpdixkaXZfZW5kID0gbWFrZV9odG1sX3RhZ3MoXCJkaXZcIikKCiAgICAgICAgIyBvbmx5IG1hdGNoIGRpdiB0YWcgaGF2aW5nIGEgdHlwZSBhdHRyaWJ1dGUgd2l0aCB2YWx1ZSBcImdyaWRcIgogICAgICAgIGRpdl9ncmlkID0gZGl2KCkuc2V0X3BhcnNlX2FjdGlvbih3aXRoX2F0dHJpYnV0ZSh0eXBlPVwiZ3JpZFwiKSkKICAgICAgICBncmlkX2V4cHIgPSBkaXZfZ3JpZCArIFNraXBUbyhkaXYgfCBkaXZfZW5kKShcImJvZHlcIikKICAgICAgICBmb3IgZ3JpZF9oZWFkZXIgaW4gZ3JpZF9leHByLnNlYXJjaF9zdHJpbmcoaHRtbCk6CiAgICAgICAgICAgIHByaW50KGdyaWRfaGVhZGVyLmJvZHkpCgogICAgICAgICMgY29uc3RydWN0IGEgbWF0Y2ggd2l0aCBhbnkgZGl2IHRhZyBoYXZpbmcgYSB0eXBlIGF0dHJpYnV0ZSwgcmVnYXJkbGVzcyBvZiB0aGUgdmFsdWUKICAgICAgICBkaXZfYW55X3R5cGUgPSBkaXYoKS5zZXRfcGFyc2VfYWN0aW9uKHdpdGhfYXR0cmlidXRlKHR5cGU9d2l0aF9hdHRyaWJ1dGUuQU5ZX1ZBTFVFKSkKICAgICAgICBkaXZfZXhwciA9IGRpdl9hbnlfdHlwZSArIFNraXBUbyhkaXYgfCBkaXZfZW5kKShcImJvZHlcIikKICAgICAgICBmb3IgZGl2X2hlYWRlciBpbiBkaXZfZXhwci5zZWFyY2hfc3RyaW5nKGh0bWwpOgogICAgICAgICAgICBwcmludChkaXZfaGVhZGVyLmJvZHkpCgogICAgcHJpbnRzOjoKCiAgICAgICAgMSA0IDAgMSAwCgogICAgICAgIDEgNCAwIDEgMAogICAgICAgIDEsMyAyLDMgMSwxCiAgICBcIlwiXCIKICAgIGlmIGFyZ3M6CiAgICAgICAgYXR0cnMgPSBhcmdzWzpdCiAgICBlbHNlOgogICAgICAgIGF0dHJzID0gYXR0cl9kaWN0Lml0ZW1zKCkKICAgIGF0dHJzID0gWyhrLCB2KSBmb3IgaywgdiBpbiBhdHRyc10KCiAgICBkZWYgcGEocywgbCwgdG9rZW5zKToKICAgICAgICBmb3IgYXR0ck5hbWUsIGF0dHJWYWx1ZSBpbiBhdHRyczoKICAgICAgICAgICAgaWYgYXR0ck5hbWUgbm90IGluIHRva2VuczoKICAgICAgICAgICAgICAgIHJhaXNlIFBhcnNlRXhjZXB0aW9uKHMsIGwsIFwibm8gbWF0Y2hpbmcgYXR0cmlidXRlIFwiICsgYXR0ck5hbWUpCiAgICAgICAgICAgIGlmIGF0dHJWYWx1ZSAhPSB3aXRoX2F0dHJpYnV0ZS5BTllfVkFMVUUgYW5kIHRva2Vuc1thdHRyTmFtZV0gIT0gYXR0clZhbHVlOgogICAgICAgICAgICAgICAgcmFpc2UgUGFyc2VFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgICAgICBsLAogICAgICAgICAgICAgICAgICAgIFwiYXR0cmlidXRlIHshcn0gaGFzIHZhbHVlIHshcn0sIG11c3QgYmUgeyFyfVwiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgYXR0ck5hbWUsIHRva2Vuc1thdHRyTmFtZV0sIGF0dHJWYWx1ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApCgogICAgcmV0dXJuIHBhCgoKd2l0aF9hdHRyaWJ1dGUuQU5ZX1ZBTFVFID0gb2JqZWN0KCkKCgpkZWYgd2l0aF9jbGFzcyhjbGFzc25hbWUsIG5hbWVzcGFjZT1cIlwiKToKICAgIFwiXCJcIgogICAgU2ltcGxpZmllZCB2ZXJzaW9uIG9mIDpjbGFzczpgd2l0aF9hdHRyaWJ1dGVgIHdoZW4KICAgIG1hdGNoaW5nIG9uIGEgZGl2IGNsYXNzIC0gbWFkZSBkaWZmaWN1bHQgYmVjYXVzZSBgYGNsYXNzYGAgaXMKICAgIGEgcmVzZXJ2ZWQgd29yZCBpbiBQeXRob24uCgogICAgRXhhbXBsZTo6CgogICAgICAgIGh0bWwgPSAnJycKICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgU29tZSB0ZXh0CiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJncmlkXCI+MSA0IDAgMSAwPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJncmFwaFwiPjEsMyAyLDMgMSwxPC9kaXY+CiAgICAgICAgICAgIDxkaXY+dGhpcyAmbHQ7ZGl2Jmd0OyBoYXMgbm8gY2xhc3M8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICcnJwogICAgICAgIGRpdixkaXZfZW5kID0gbWFrZV9odG1sX3RhZ3MoXCJkaXZcIikKICAgICAgICBkaXZfZ3JpZCA9IGRpdigpLnNldF9wYXJzZV9hY3Rpb24od2l0aF9jbGFzcyhcImdyaWRcIikpCgogICAgICAgIGdyaWRfZXhwciA9IGRpdl9ncmlkICsgU2tpcFRvKGRpdiB8IGRpdl9lbmQpKFwiYm9keVwiKQogICAgICAgIGZvciBncmlkX2hlYWRlciBpbiBncmlkX2V4cHIuc2VhcmNoX3N0cmluZyhodG1sKToKICAgICAgICAgICAgcHJpbnQoZ3JpZF9oZWFkZXIuYm9keSkKCiAgICAgICAgZGl2X2FueV90eXBlID0gZGl2KCkuc2V0X3BhcnNlX2FjdGlvbih3aXRoX2NsYXNzKHdpdGhBdHRyaWJ1dGUuQU5ZX1ZBTFVFKSkKICAgICAgICBkaXZfZXhwciA9IGRpdl9hbnlfdHlwZSArIFNraXBUbyhkaXYgfCBkaXZfZW5kKShcImJvZHlcIikKICAgICAgICBmb3IgZGl2X2hlYWRlciBpbiBkaXZfZXhwci5zZWFyY2hfc3RyaW5nKGh0bWwpOgogICAgICAgICAgICBwcmludChkaXZfaGVhZGVyLmJvZHkpCgogICAgcHJpbnRzOjoKCiAgICAgICAgMSA0IDAgMSAwCgogICAgICAgIDEgNCAwIDEgMAogICAgICAgIDEsMyAyLDMgMSwxCiAgICBcIlwiXCIKICAgIGNsYXNzYXR0ciA9IFwie306Y2xhc3NcIi5mb3JtYXQobmFtZXNwYWNlKSBpZiBuYW1lc3BhY2UgZWxzZSBcImNsYXNzXCIKICAgIHJldHVybiB3aXRoX2F0dHJpYnV0ZSgqKntjbGFzc2F0dHI6IGNsYXNzbmFtZX0pCgoKIyBwcmUtUEVQOCBjb21wYXRpYmlsaXR5IHN5bWJvbHMKcmVwbGFjZVdpdGggPSByZXBsYWNlX3dpdGgKcmVtb3ZlUXVvdGVzID0gcmVtb3ZlX3F1b3Rlcwp3aXRoQXR0cmlidXRlID0gd2l0aF9hdHRyaWJ1dGUKd2l0aENsYXNzID0gd2l0aF9jbGFzcwptYXRjaE9ubHlBdENvbCA9IG1hdGNoX29ubHlfYXRfY29sCgoiIiIKbW9kdWxlX2RpY3RbInB5cGFyc2luZy9kaWFncmFtL19faW5pdF9fLnB5Il09IiIiCmltcG9ydCByYWlscm9hZAppbXBvcnQgcHlwYXJzaW5nCmltcG9ydCB0eXBpbmcKZnJvbSB0eXBpbmcgaW1wb3J0ICgKICAgIExpc3QsCiAgICBOYW1lZFR1cGxlLAogICAgR2VuZXJpYywKICAgIFR5cGVWYXIsCiAgICBEaWN0LAogICAgQ2FsbGFibGUsCiAgICBTZXQsCiAgICBJdGVyYWJsZSwKKQpmcm9tIGppbmphMiBpbXBvcnQgVGVtcGxhdGUKZnJvbSBpbyBpbXBvcnQgU3RyaW5nSU8KaW1wb3J0IGluc3BlY3QKCgpqaW5qYTJfdGVtcGxhdGVfc291cmNlID0gXCJcIlwiXFwKPCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIHslIGlmIG5vdCBoZWFkICV9CiAgICAgICAgPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPgogICAgICAgICAgICAucmFpbHJvYWQtaGVhZGluZyB7CiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogbW9ub3NwYWNlOwogICAgICAgICAgICB9CiAgICAgICAgPC9zdHlsZT4KICAgIHslIGVsc2UgJX0KICAgICAgICB7eyBoZWFkIHwgc2FmZSB9fQogICAgeyUgZW5kaWYgJX0KPC9oZWFkPgo8Ym9keT4Ke3sgYm9keSB8IHNhZmUgfX0KeyUgZm9yIGRpYWdyYW0gaW4gZGlhZ3JhbXMgJX0KICAgIDxkaXYgY2xhc3M9XCJyYWlscm9hZC1ncm91cFwiPgogICAgICAgIDxoMSBjbGFzcz1cInJhaWxyb2FkLWhlYWRpbmdcIj57eyBkaWFncmFtLnRpdGxlIH19PC9oMT4KICAgICAgICA8ZGl2IGNsYXNzPVwicmFpbHJvYWQtZGVzY3JpcHRpb25cIj57eyBkaWFncmFtLnRleHQgfX08L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPVwicmFpbHJvYWQtc3ZnXCI+CiAgICAgICAgICAgIHt7IGRpYWdyYW0uc3ZnIH19CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KeyUgZW5kZm9yICV9CjwvYm9keT4KPC9odG1sPgpcIlwiXCIKCnRlbXBsYXRlID0gVGVtcGxhdGUoamluamEyX3RlbXBsYXRlX3NvdXJjZSkKCiMgTm90ZTogaWRlYWxseSB0aGlzIHdvdWxkIGJlIGEgZGF0YWNsYXNzLCBidXQgd2UncmUgc3VwcG9ydGluZyBQeXRob24gMy41KyBzbyB3ZSBjYW4ndCBkbyB0aGlzIHlldApOYW1lZERpYWdyYW0gPSBOYW1lZFR1cGxlKAogICAgXCJOYW1lZERpYWdyYW1cIiwKICAgIFsoXCJuYW1lXCIsIHN0ciksIChcImRpYWdyYW1cIiwgdHlwaW5nLk9wdGlvbmFsW3JhaWxyb2FkLkRpYWdyYW1JdGVtXSksIChcImluZGV4XCIsIGludCldLAopClwiXCJcIgpBIHNpbXBsZSBzdHJ1Y3R1cmUgZm9yIGFzc29jaWF0aW5nIGEgbmFtZSB3aXRoIGEgcmFpbHJvYWQgZGlhZ3JhbQpcIlwiXCIKClQgPSBUeXBlVmFyKFwiVFwiKQoKCmNsYXNzIEVhY2hJdGVtKHJhaWxyb2FkLkdyb3VwKToKICAgIFwiXCJcIgogICAgQ3VzdG9tIHJhaWxyb2FkIGl0ZW0gdG8gY29tcG9zZSBhOgogICAgLSBHcm91cCBjb250YWluaW5nIGEKICAgICAgLSBPbmVPck1vcmUgY29udGFpbmluZyBhCiAgICAgICAgLSBDaG9pY2Ugb2YgdGhlIGVsZW1lbnRzIGluIHRoZSBFYWNoCiAgICB3aXRoIHRoZSBncm91cCBsYWJlbCBpbmRpY2F0aW5nIHRoYXQgYWxsIG11c3QgYmUgbWF0Y2hlZAogICAgXCJcIlwiCgogICAgYWxsX2xhYmVsID0gXCJbQUxMXVwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICppdGVtcyk6CiAgICAgICAgY2hvaWNlX2l0ZW0gPSByYWlscm9hZC5DaG9pY2UobGVuKGl0ZW1zKSAtIDEsICppdGVtcykKICAgICAgICBvbmVfb3JfbW9yZV9pdGVtID0gcmFpbHJvYWQuT25lT3JNb3JlKGl0ZW09Y2hvaWNlX2l0ZW0pCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhvbmVfb3JfbW9yZV9pdGVtLCBsYWJlbD1zZWxmLmFsbF9sYWJlbCkKCgpjbGFzcyBBbm5vdGF0ZWRJdGVtKHJhaWxyb2FkLkdyb3VwKToKICAgIFwiXCJcIgogICAgU2ltcGxlIHN1YmNsYXNzIG9mIEdyb3VwIHRoYXQgY3JlYXRlcyBhbiBhbm5vdGF0aW9uIGxhYmVsCiAgICBcIlwiXCIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbGFiZWw6IHN0ciwgaXRlbSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhpdGVtPWl0ZW0sIGxhYmVsPVwiW3t9XVwiLmZvcm1hdChsYWJlbCkgaWYgbGFiZWwgZWxzZSBsYWJlbCkKCgpjbGFzcyBFZGl0YWJsZVBhcnRpYWwoR2VuZXJpY1tUXSk6CiAgICBcIlwiXCIKICAgIEFjdHMgbGlrZSBhIGZ1bmN0b29scy5wYXJ0aWFsLCBidXQgY2FuIGJlIGVkaXRlZC4gSW4gb3RoZXIgd29yZHMsIGl0IHJlcHJlc2VudHMgYSB0eXBlIHRoYXQgaGFzbid0IHlldCBiZWVuCiAgICBjb25zdHJ1Y3RlZC4KICAgIFwiXCJcIgoKICAgICMgV2UgbmVlZCB0aGlzIGhlcmUgYmVjYXVzZSB0aGUgcmFpbHJvYWQgY29uc3RydWN0b3JzIGFjdHVhbGx5IHRyYW5zZm9ybSB0aGUgZGF0YSwgc28gY2FuJ3QgYmUgY2FsbGVkIHVudGlsIHRoZQogICAgIyBlbnRpcmUgdHJlZSBpcyBhc3NlbWJsZWQKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZnVuYzogQ2FsbGFibGVbLi4uLCBUXSwgYXJnczogbGlzdCwga3dhcmdzOiBkaWN0KToKICAgICAgICBzZWxmLmZ1bmMgPSBmdW5jCiAgICAgICAgc2VsZi5hcmdzID0gYXJncwogICAgICAgIHNlbGYua3dhcmdzID0ga3dhcmdzCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9jYWxsKGNscywgZnVuYzogQ2FsbGFibGVbLi4uLCBUXSwgKmFyZ3MsICoqa3dhcmdzKSAtPiBcIkVkaXRhYmxlUGFydGlhbFtUXVwiOgogICAgICAgIFwiXCJcIgogICAgICAgIElmIHlvdSBjYWxsIHRoaXMgZnVuY3Rpb24gaW4gdGhlIHNhbWUgd2F5IHRoYXQgeW91IHdvdWxkIGNhbGwgdGhlIGNvbnN0cnVjdG9yLCBpdCB3aWxsIHN0b3JlIHRoZSBhcmd1bWVudHMKICAgICAgICBhcyB5b3UgZXhwZWN0LiBGb3IgZXhhbXBsZSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKEZyYWN0aW9uLCAxLCAzKSgpID09IEZyYWN0aW9uKDEsIDMpCiAgICAgICAgXCJcIlwiCiAgICAgICAgcmV0dXJuIEVkaXRhYmxlUGFydGlhbChmdW5jPWZ1bmMsIGFyZ3M9bGlzdChhcmdzKSwga3dhcmdzPWt3YXJncykKCiAgICBAcHJvcGVydHkKICAgIGRlZiBuYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmt3YXJnc1tcIm5hbWVcIl0KCiAgICBkZWYgX19jYWxsX18oc2VsZikgLT4gVDoKICAgICAgICBcIlwiXCIKICAgICAgICBFdmFsdWF0ZSB0aGUgcGFydGlhbCBhbmQgcmV0dXJuIHRoZSByZXN1bHQKICAgICAgICBcIlwiXCIKICAgICAgICBhcmdzID0gc2VsZi5hcmdzLmNvcHkoKQogICAgICAgIGt3YXJncyA9IHNlbGYua3dhcmdzLmNvcHkoKQoKICAgICAgICAjIFRoaXMgaXMgYSBoZWxwZnVsIGhhY2sgdG8gYWxsb3cgeW91IHRvIHNwZWNpZnkgdmFyYXJncyBwYXJhbWV0ZXJzIChlLmcuICphcmdzKSBhcyBrZXl3b3JkIGFyZ3MgKGUuZy4KICAgICAgICAjIGFyZ3M9WydsaXN0JywgJ29mJywgJ3RoaW5ncyddKQogICAgICAgIGFyZ19zcGVjID0gaW5zcGVjdC5nZXRmdWxsYXJnc3BlYyhzZWxmLmZ1bmMpCiAgICAgICAgaWYgYXJnX3NwZWMudmFyYXJncyBpbiBzZWxmLmt3YXJnczoKICAgICAgICAgICAgYXJncyArPSBrd2FyZ3MucG9wKGFyZ19zcGVjLnZhcmFyZ3MpCgogICAgICAgIHJldHVybiBzZWxmLmZ1bmMoKmFyZ3MsICoqa3dhcmdzKQoKCmRlZiByYWlscm9hZF90b19odG1sKGRpYWdyYW1zOiBMaXN0W05hbWVkRGlhZ3JhbV0sICoqa3dhcmdzKSAtPiBzdHI6CiAgICBcIlwiXCIKICAgIEdpdmVuIGEgbGlzdCBvZiBOYW1lZERpYWdyYW0sIHByb2R1Y2UgYSBzaW5nbGUgSFRNTCBzdHJpbmcgdGhhdCB2aXN1YWxpc2VzIHRob3NlIGRpYWdyYW1zCiAgICA6cGFyYW1zIGt3YXJnczoga3dhcmdzIHRvIGJlIHBhc3NlZCBpbiB0byB0aGUgdGVtcGxhdGUKICAgIFwiXCJcIgogICAgZGF0YSA9IFtdCiAgICBmb3IgZGlhZ3JhbSBpbiBkaWFncmFtczoKICAgICAgICBpZiBkaWFncmFtLmRpYWdyYW0gaXMgTm9uZToKICAgICAgICAgICAgY29udGludWUKICAgICAgICBpbyA9IFN0cmluZ0lPKCkKICAgICAgICBkaWFncmFtLmRpYWdyYW0ud3JpdGVTdmcoaW8ud3JpdGUpCiAgICAgICAgdGl0bGUgPSBkaWFncmFtLm5hbWUKICAgICAgICBpZiBkaWFncmFtLmluZGV4ID09IDA6CiAgICAgICAgICAgIHRpdGxlICs9IFwiIChyb290KVwiCiAgICAgICAgZGF0YS5hcHBlbmQoe1widGl0bGVcIjogdGl0bGUsIFwidGV4dFwiOiBcIlwiLCBcInN2Z1wiOiBpby5nZXR2YWx1ZSgpfSkKCiAgICByZXR1cm4gdGVtcGxhdGUucmVuZGVyKGRpYWdyYW1zPWRhdGEsICoqa3dhcmdzKQoKCmRlZiByZXNvbHZlX3BhcnRpYWwocGFydGlhbDogXCJFZGl0YWJsZVBhcnRpYWxbVF1cIikgLT4gVDoKICAgIFwiXCJcIgogICAgUmVjdXJzaXZlbHkgcmVzb2x2ZXMgYSBjb2xsZWN0aW9uIG9mIFBhcnRpYWxzIGludG8gd2hhdGV2ZXIgdHlwZSB0aGV5IGFyZQogICAgXCJcIlwiCiAgICBpZiBpc2luc3RhbmNlKHBhcnRpYWwsIEVkaXRhYmxlUGFydGlhbCk6CiAgICAgICAgcGFydGlhbC5hcmdzID0gcmVzb2x2ZV9wYXJ0aWFsKHBhcnRpYWwuYXJncykKICAgICAgICBwYXJ0aWFsLmt3YXJncyA9IHJlc29sdmVfcGFydGlhbChwYXJ0aWFsLmt3YXJncykKICAgICAgICByZXR1cm4gcGFydGlhbCgpCiAgICBlbGlmIGlzaW5zdGFuY2UocGFydGlhbCwgbGlzdCk6CiAgICAgICAgcmV0dXJuIFtyZXNvbHZlX3BhcnRpYWwoeCkgZm9yIHggaW4gcGFydGlhbF0KICAgIGVsaWYgaXNpbnN0YW5jZShwYXJ0aWFsLCBkaWN0KToKICAgICAgICByZXR1cm4ge2tleTogcmVzb2x2ZV9wYXJ0aWFsKHgpIGZvciBrZXksIHggaW4gcGFydGlhbC5pdGVtcygpfQogICAgZWxzZToKICAgICAgICByZXR1cm4gcGFydGlhbAoKCmRlZiB0b19yYWlscm9hZCgKICAgIGVsZW1lbnQ6IHB5cGFyc2luZy5QYXJzZXJFbGVtZW50LAogICAgZGlhZ3JhbV9rd2FyZ3M6IHR5cGluZy5PcHRpb25hbFtkaWN0XSA9IE5vbmUsCiAgICB2ZXJ0aWNhbDogaW50ID0gMywKICAgIHNob3dfcmVzdWx0c19uYW1lczogYm9vbCA9IEZhbHNlLAogICAgc2hvd19ncm91cHM6IGJvb2wgPSBGYWxzZSwKKSAtPiBMaXN0W05hbWVkRGlhZ3JhbV06CiAgICBcIlwiXCIKICAgIENvbnZlcnQgYSBweXBhcnNpbmcgZWxlbWVudCB0cmVlIGludG8gYSBsaXN0IG9mIGRpYWdyYW1zLiBUaGlzIGlzIHRoZSByZWNvbW1lbmRlZCBlbnRyeXBvaW50IHRvIGRpYWdyYW0KICAgIGNyZWF0aW9uIGlmIHlvdSB3YW50IHRvIGFjY2VzcyB0aGUgUmFpbHJvYWQgdHJlZSBiZWZvcmUgaXQgaXMgY29udmVydGVkIHRvIEhUTUwKICAgIDpwYXJhbSBlbGVtZW50OiBiYXNlIGVsZW1lbnQgb2YgdGhlIHBhcnNlciBiZWluZyBkaWFncmFtbWVkCiAgICA6cGFyYW0gZGlhZ3JhbV9rd2FyZ3M6IGt3YXJncyB0byBwYXNzIHRvIHRoZSBEaWFncmFtKCkgY29uc3RydWN0b3IKICAgIDpwYXJhbSB2ZXJ0aWNhbDogKG9wdGlvbmFsKSAtIGludCAtIGxpbWl0IGF0IHdoaWNoIG51bWJlciBvZiBhbHRlcm5hdGl2ZXMgc2hvdWxkIGJlCiAgICAgICBzaG93biB2ZXJ0aWNhbGx5IGluc3RlYWQgb2YgaG9yaXpvbnRhbGx5CiAgICA6cGFyYW0gc2hvd19yZXN1bHRzX25hbWVzIC0gYm9vbCB0byBpbmRpY2F0ZSB3aGV0aGVyIHJlc3VsdHMgbmFtZSBhbm5vdGF0aW9ucyBzaG91bGQgYmUKICAgICAgIGluY2x1ZGVkIGluIHRoZSBkaWFncmFtCiAgICA6cGFyYW0gc2hvd19ncm91cHMgLSBib29sIHRvIGluZGljYXRlIHdoZXRoZXIgZ3JvdXBzIHNob3VsZCBiZSBoaWdobGlnaHRlZCB3aXRoIGFuIHVubGFiZWxlZAogICAgICAgc3Vycm91bmRpbmcgYm94CiAgICBcIlwiXCIKICAgICMgQ29udmVydCB0aGUgd2hvbGUgdHJlZSB1bmRlcm5lYXRoIHRoZSByb290CiAgICBsb29rdXAgPSBDb252ZXJ0ZXJTdGF0ZShkaWFncmFtX2t3YXJncz1kaWFncmFtX2t3YXJncyBvciB7fSkKICAgIF90b19kaWFncmFtX2VsZW1lbnQoCiAgICAgICAgZWxlbWVudCwKICAgICAgICBsb29rdXA9bG9va3VwLAogICAgICAgIHBhcmVudD1Ob25lLAogICAgICAgIHZlcnRpY2FsPXZlcnRpY2FsLAogICAgICAgIHNob3dfcmVzdWx0c19uYW1lcz1zaG93X3Jlc3VsdHNfbmFtZXMsCiAgICAgICAgc2hvd19ncm91cHM9c2hvd19ncm91cHMsCiAgICApCgogICAgcm9vdF9pZCA9IGlkKGVsZW1lbnQpCiAgICAjIENvbnZlcnQgdGhlIHJvb3QgaWYgaXQgaGFzbid0IGJlZW4gYWxyZWFkeQogICAgaWYgcm9vdF9pZCBpbiBsb29rdXA6CiAgICAgICAgaWYgbm90IGVsZW1lbnQuY3VzdG9tTmFtZToKICAgICAgICAgICAgbG9va3VwW3Jvb3RfaWRdLm5hbWUgPSBcIlwiCiAgICAgICAgbG9va3VwW3Jvb3RfaWRdLm1hcmtfZm9yX2V4dHJhY3Rpb24ocm9vdF9pZCwgbG9va3VwLCBmb3JjZT1UcnVlKQoKICAgICMgTm93IHRoYXQgd2UncmUgZmluaXNoZWQsIHdlIGNhbiBjb252ZXJ0IGZyb20gaW50ZXJtZWRpYXRlIHN0cnVjdHVyZXMgaW50byBSYWlscm9hZCBlbGVtZW50cwogICAgZGlhZ3MgPSBsaXN0KGxvb2t1cC5kaWFncmFtcy52YWx1ZXMoKSkKICAgIGlmIGxlbihkaWFncykgPiAxOgogICAgICAgICMgY29sbGFwc2Ugb3V0IGR1cGxpY2F0ZSBkaWFncyB3aXRoIHRoZSBzYW1lIG5hbWUKICAgICAgICBzZWVuID0gc2V0KCkKICAgICAgICBkZWR1cGVkX2RpYWdzID0gW10KICAgICAgICBmb3IgZCBpbiBkaWFnczoKICAgICAgICAgICAgIyBkb24ndCBleHRyYWN0IFNraXBUbyBlbGVtZW50cywgdGhleSBhcmUgdW5pbmZvcm1hdGl2ZSBhcyBzdWJkaWFncmFtcwogICAgICAgICAgICBpZiBkLm5hbWUgPT0gXCIuLi5cIjoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGQubmFtZSBpcyBub3QgTm9uZSBhbmQgZC5uYW1lIG5vdCBpbiBzZWVuOgogICAgICAgICAgICAgICAgc2Vlbi5hZGQoZC5uYW1lKQogICAgICAgICAgICAgICAgZGVkdXBlZF9kaWFncy5hcHBlbmQoZCkKICAgICAgICByZXNvbHZlZCA9IFtyZXNvbHZlX3BhcnRpYWwocGFydGlhbCkgZm9yIHBhcnRpYWwgaW4gZGVkdXBlZF9kaWFnc10KICAgIGVsc2U6CiAgICAgICAgIyBzcGVjaWFsIGNhc2UgLSBpZiBqdXN0IG9uZSBkaWFncmFtLCBhbHdheXMgZGlzcGxheSBpdCwgZXZlbiBpZgogICAgICAgICMgaXQgaGFzIG5vIG5hbWUKICAgICAgICByZXNvbHZlZCA9IFtyZXNvbHZlX3BhcnRpYWwocGFydGlhbCkgZm9yIHBhcnRpYWwgaW4gZGlhZ3NdCiAgICByZXR1cm4gc29ydGVkKHJlc29sdmVkLCBrZXk9bGFtYmRhIGRpYWc6IGRpYWcuaW5kZXgpCgoKZGVmIF9zaG91bGRfdmVydGljYWwoCiAgICBzcGVjaWZpY2F0aW9uOiBpbnQsIGV4cHJzOiBJdGVyYWJsZVtweXBhcnNpbmcuUGFyc2VyRWxlbWVudF0KKSAtPiBib29sOgogICAgXCJcIlwiCiAgICBSZXR1cm5zIHRydWUgaWYgd2Ugc2hvdWxkIHJldHVybiBhIHZlcnRpY2FsIGxpc3Qgb2YgZWxlbWVudHMKICAgIFwiXCJcIgogICAgaWYgc3BlY2lmaWNhdGlvbiBpcyBOb25lOgogICAgICAgIHJldHVybiBGYWxzZQogICAgZWxzZToKICAgICAgICByZXR1cm4gbGVuKF92aXNpYmxlX2V4cHJzKGV4cHJzKSkgPj0gc3BlY2lmaWNhdGlvbgoKCmNsYXNzIEVsZW1lbnRTdGF0ZToKICAgIFwiXCJcIgogICAgU3RhdGUgcmVjb3JkZWQgZm9yIGFuIGluZGl2aWR1YWwgcHlwYXJzaW5nIEVsZW1lbnQKICAgIFwiXCJcIgoKICAgICMgTm90ZTogdGhpcyBzaG91bGQgYmUgYSBkYXRhY2xhc3MsIGJ1dCB3ZSBoYXZlIHRvIHN1cHBvcnQgUHl0aG9uIDMuNQogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgZWxlbWVudDogcHlwYXJzaW5nLlBhcnNlckVsZW1lbnQsCiAgICAgICAgY29udmVydGVkOiBFZGl0YWJsZVBhcnRpYWwsCiAgICAgICAgcGFyZW50OiBFZGl0YWJsZVBhcnRpYWwsCiAgICAgICAgbnVtYmVyOiBpbnQsCiAgICAgICAgbmFtZTogc3RyID0gTm9uZSwKICAgICAgICBwYXJlbnRfaW5kZXg6IHR5cGluZy5PcHRpb25hbFtpbnRdID0gTm9uZSwKICAgICk6CiAgICAgICAgIzogVGhlIHB5cGFyc2luZyBlbGVtZW50IHRoYXQgdGhpcyByZXByZXNlbnRzCiAgICAgICAgc2VsZi5lbGVtZW50OiBweXBhcnNpbmcuUGFyc2VyRWxlbWVudCA9IGVsZW1lbnQKICAgICAgICAjOiBUaGUgbmFtZSBvZiB0aGUgZWxlbWVudAogICAgICAgIHNlbGYubmFtZTogdHlwaW5nLk9wdGlvbmFsW3N0cl0gPSBuYW1lCiAgICAgICAgIzogVGhlIG91dHB1dCBSYWlscm9hZCBlbGVtZW50IGluIGFuIHVuY29udmVydGVkIHN0YXRlCiAgICAgICAgc2VsZi5jb252ZXJ0ZWQ6IEVkaXRhYmxlUGFydGlhbCA9IGNvbnZlcnRlZAogICAgICAgICM6IFRoZSBwYXJlbnQgUmFpbHJvYWQgZWxlbWVudCwgd2hpY2ggd2Ugc3RvcmUgc28gdGhhdCB3ZSBjYW4gZXh0cmFjdCB0aGlzIGlmIGl0J3MgZHVwbGljYXRlZAogICAgICAgIHNlbGYucGFyZW50OiBFZGl0YWJsZVBhcnRpYWwgPSBwYXJlbnQKICAgICAgICAjOiBUaGUgb3JkZXIgaW4gd2hpY2ggd2UgZm91bmQgdGhpcyBlbGVtZW50LCB1c2VkIGZvciBzb3J0aW5nIGRpYWdyYW1zIGlmIHRoaXMgaXMgZXh0cmFjdGVkIGludG8gYSBkaWFncmFtCiAgICAgICAgc2VsZi5udW1iZXI6IGludCA9IG51bWJlcgogICAgICAgICM6IFRoZSBpbmRleCBvZiB0aGlzIGluc2lkZSBpdHMgcGFyZW50CiAgICAgICAgc2VsZi5wYXJlbnRfaW5kZXg6IHR5cGluZy5PcHRpb25hbFtpbnRdID0gcGFyZW50X2luZGV4CiAgICAgICAgIzogSWYgdHJ1ZSwgd2Ugc2hvdWxkIGV4dHJhY3QgdGhpcyBvdXQgaW50byBhIHN1YmRpYWdyYW0KICAgICAgICBzZWxmLmV4dHJhY3Q6IGJvb2wgPSBGYWxzZQogICAgICAgICM6IElmIHRydWUsIGFsbCBvZiB0aGlzIGVsZW1lbnQncyBjaGlsZHJlbiBoYXZlIGJlZW4gZmlsbGVkIG91dAogICAgICAgIHNlbGYuY29tcGxldGU6IGJvb2wgPSBGYWxzZQoKICAgIGRlZiBtYXJrX2Zvcl9leHRyYWN0aW9uKAogICAgICAgIHNlbGYsIGVsX2lkOiBpbnQsIHN0YXRlOiBcIkNvbnZlcnRlclN0YXRlXCIsIG5hbWU6IHN0ciA9IE5vbmUsIGZvcmNlOiBib29sID0gRmFsc2UKICAgICk6CiAgICAgICAgXCJcIlwiCiAgICAgICAgQ2FsbGVkIHdoZW4gdGhpcyBpbnN0YW5jZSBoYXMgYmVlbiBzZWVuIHR3aWNlLCBhbmQgdGh1cyBzaG91bGQgZXZlbnR1YWxseSBiZSBleHRyYWN0ZWQgaW50byBhIHN1Yi1kaWFncmFtCiAgICAgICAgOnBhcmFtIGVsX2lkOiBpZCBvZiB0aGUgZWxlbWVudAogICAgICAgIDpwYXJhbSBzdGF0ZTogZWxlbWVudC9kaWFncmFtIHN0YXRlIHRyYWNrZXIKICAgICAgICA6cGFyYW0gbmFtZTogbmFtZSB0byB1c2UgZm9yIHRoaXMgZWxlbWVudCdzIHRleHQKICAgICAgICA6cGFyYW0gZm9yY2U6IElmIHRydWUsIGZvcmNlIGV4dHJhY3Rpb24gbm93LCByZWdhcmRsZXNzIG9mIHRoZSBzdGF0ZSBvZiB0aGlzLiBPbmx5IHVzZWZ1bCBmb3IgZXh0cmFjdGluZyB0aGUKICAgICAgICByb290IGVsZW1lbnQgd2hlbiB3ZSBrbm93IHdlJ3JlIGZpbmlzaGVkCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi5leHRyYWN0ID0gVHJ1ZQoKICAgICAgICAjIFNldCB0aGUgbmFtZQogICAgICAgIGlmIG5vdCBzZWxmLm5hbWU6CiAgICAgICAgICAgIGlmIG5hbWU6CiAgICAgICAgICAgICAgICAjIEFsbG93IGZvcmNpbmcgYSBjdXN0b20gbmFtZQogICAgICAgICAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgICAgICBlbGlmIHNlbGYuZWxlbWVudC5jdXN0b21OYW1lOgogICAgICAgICAgICAgICAgc2VsZi5uYW1lID0gc2VsZi5lbGVtZW50LmN1c3RvbU5hbWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubmFtZSA9IFwiXCIKCiAgICAgICAgIyBKdXN0IGJlY2F1c2UgdGhpcyBpcyBtYXJrZWQgZm9yIGV4dHJhY3Rpb24gZG9lc24ndCBtZWFuIHdlIGNhbiBkbyBpdCB5ZXQuIFdlIG1heSBoYXZlIHRvIHdhaXQgZm9yIGNoaWxkcmVuCiAgICAgICAgIyB0byBiZSBhZGRlZAogICAgICAgICMgQWxzbywgaWYgdGhpcyBpcyBqdXN0IGEgc3RyaW5nIGxpdGVyYWwgZXRjLCBkb24ndCBib3RoZXIgZXh0cmFjdGluZyBpdAogICAgICAgIGlmIGZvcmNlIG9yIChzZWxmLmNvbXBsZXRlIGFuZCBfd29ydGhfZXh0cmFjdGluZyhzZWxmLmVsZW1lbnQpKToKICAgICAgICAgICAgc3RhdGUuZXh0cmFjdF9pbnRvX2RpYWdyYW0oZWxfaWQpCgoKY2xhc3MgQ29udmVydGVyU3RhdGU6CiAgICBcIlwiXCIKICAgIFN0b3JlcyBzb21lIHN0YXRlIHRoYXQgcGVyc2lzdHMgYmV0d2VlbiByZWN1cnNpb25zIGludG8gdGhlIGVsZW1lbnQgdHJlZQogICAgXCJcIlwiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRpYWdyYW1fa3dhcmdzOiB0eXBpbmcuT3B0aW9uYWxbZGljdF0gPSBOb25lKToKICAgICAgICAjOiBBIGRpY3Rpb25hcnkgbWFwcGluZyBQYXJzZXJFbGVtZW50cyB0byBzdGF0ZSByZWxhdGluZyB0byB0aGVtCiAgICAgICAgc2VsZi5fZWxlbWVudF9kaWFncmFtX3N0YXRlczogRGljdFtpbnQsIEVsZW1lbnRTdGF0ZV0gPSB7fQogICAgICAgICM6IEEgZGljdGlvbmFyeSBtYXBwaW5nIFBhcnNlckVsZW1lbnQgSURzIHRvIHN1YmRpYWdyYW1zIGdlbmVyYXRlZCBmcm9tIHRoZW0KICAgICAgICBzZWxmLmRpYWdyYW1zOiBEaWN0W2ludCwgRWRpdGFibGVQYXJ0aWFsW05hbWVkRGlhZ3JhbV1dID0ge30KICAgICAgICAjOiBUaGUgaW5kZXggb2YgdGhlIG5leHQgdW5uYW1lZCBlbGVtZW50CiAgICAgICAgc2VsZi51bm5hbWVkX2luZGV4OiBpbnQgPSAxCiAgICAgICAgIzogVGhlIGluZGV4IG9mIHRoZSBuZXh0IGVsZW1lbnQuIFRoaXMgaXMgdXNlZCBmb3Igc29ydGluZwogICAgICAgIHNlbGYuaW5kZXg6IGludCA9IDAKICAgICAgICAjOiBTaGFyZWQga3dhcmdzIHRoYXQgYXJlIHVzZWQgdG8gY3VzdG9taXplIHRoZSBjb25zdHJ1Y3Rpb24gb2YgZGlhZ3JhbXMKICAgICAgICBzZWxmLmRpYWdyYW1fa3dhcmdzOiBkaWN0ID0gZGlhZ3JhbV9rd2FyZ3Mgb3Ige30KICAgICAgICBzZWxmLmV4dHJhY3RlZF9kaWFncmFtX25hbWVzOiBTZXRbc3RyXSA9IHNldCgpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleTogaW50LCB2YWx1ZTogRWxlbWVudFN0YXRlKToKICAgICAgICBzZWxmLl9lbGVtZW50X2RpYWdyYW1fc3RhdGVzW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXk6IGludCkgLT4gRWxlbWVudFN0YXRlOgogICAgICAgIHJldHVybiBzZWxmLl9lbGVtZW50X2RpYWdyYW1fc3RhdGVzW2tleV0KCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5OiBpbnQpOgogICAgICAgIGRlbCBzZWxmLl9lbGVtZW50X2RpYWdyYW1fc3RhdGVzW2tleV0KCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleTogaW50KToKICAgICAgICByZXR1cm4ga2V5IGluIHNlbGYuX2VsZW1lbnRfZGlhZ3JhbV9zdGF0ZXMKCiAgICBkZWYgZ2VuZXJhdGVfdW5uYW1lZChzZWxmKSAtPiBpbnQ6CiAgICAgICAgXCJcIlwiCiAgICAgICAgR2VuZXJhdGUgYSBudW1iZXIgdXNlZCBpbiB0aGUgbmFtZSBvZiBhbiBvdGhlcndpc2UgdW5uYW1lZCBkaWFncmFtCiAgICAgICAgXCJcIlwiCiAgICAgICAgc2VsZi51bm5hbWVkX2luZGV4ICs9IDEKICAgICAgICByZXR1cm4gc2VsZi51bm5hbWVkX2luZGV4CgogICAgZGVmIGdlbmVyYXRlX2luZGV4KHNlbGYpIC0+IGludDoKICAgICAgICBcIlwiXCIKICAgICAgICBHZW5lcmF0ZSBhIG51bWJlciB1c2VkIHRvIGluZGV4IGEgZGlhZ3JhbQogICAgICAgIFwiXCJcIgogICAgICAgIHNlbGYuaW5kZXggKz0gMQogICAgICAgIHJldHVybiBzZWxmLmluZGV4CgogICAgZGVmIGV4dHJhY3RfaW50b19kaWFncmFtKHNlbGYsIGVsX2lkOiBpbnQpOgogICAgICAgIFwiXCJcIgogICAgICAgIFVzZWQgd2hlbiB3ZSBlbmNvdW50ZXIgdGhlIHNhbWUgdG9rZW4gdHdpY2UgaW4gdGhlIHNhbWUgdHJlZS4gV2hlbiB0aGlzCiAgICAgICAgaGFwcGVucywgd2UgcmVwbGFjZSBhbGwgaW5zdGFuY2VzIG9mIHRoYXQgdG9rZW4gd2l0aCBhIHRlcm1pbmFsLCBhbmQKICAgICAgICBjcmVhdGUgYSBuZXcgc3ViZGlhZ3JhbSBmb3IgdGhlIHRva2VuCiAgICAgICAgXCJcIlwiCiAgICAgICAgcG9zaXRpb24gPSBzZWxmW2VsX2lkXQoKICAgICAgICAjIFJlcGxhY2UgdGhlIG9yaWdpbmFsIGRlZmluaXRpb24gb2YgdGhpcyBlbGVtZW50IHdpdGggYSByZWd1bGFyIGJsb2NrCiAgICAgICAgaWYgcG9zaXRpb24ucGFyZW50OgogICAgICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLk5vblRlcm1pbmFsLCB0ZXh0PXBvc2l0aW9uLm5hbWUpCiAgICAgICAgICAgIGlmIFwiaXRlbVwiIGluIHBvc2l0aW9uLnBhcmVudC5rd2FyZ3M6CiAgICAgICAgICAgICAgICBwb3NpdGlvbi5wYXJlbnQua3dhcmdzW1wiaXRlbVwiXSA9IHJldAogICAgICAgICAgICBlbGlmIFwiaXRlbXNcIiBpbiBwb3NpdGlvbi5wYXJlbnQua3dhcmdzOgogICAgICAgICAgICAgICAgcG9zaXRpb24ucGFyZW50Lmt3YXJnc1tcIml0ZW1zXCJdW3Bvc2l0aW9uLnBhcmVudF9pbmRleF0gPSByZXQKCiAgICAgICAgIyBJZiB0aGUgZWxlbWVudCB3ZSdyZSBleHRyYWN0aW5nIGlzIGEgZ3JvdXAsIHNraXAgdG8gaXRzIGNvbnRlbnQgYnV0IGtlZXAgdGhlIHRpdGxlCiAgICAgICAgaWYgcG9zaXRpb24uY29udmVydGVkLmZ1bmMgPT0gcmFpbHJvYWQuR3JvdXA6CiAgICAgICAgICAgIGNvbnRlbnQgPSBwb3NpdGlvbi5jb252ZXJ0ZWQua3dhcmdzW1wiaXRlbVwiXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbnRlbnQgPSBwb3NpdGlvbi5jb252ZXJ0ZWQKCiAgICAgICAgc2VsZi5kaWFncmFtc1tlbF9pZF0gPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKAogICAgICAgICAgICBOYW1lZERpYWdyYW0sCiAgICAgICAgICAgIG5hbWU9cG9zaXRpb24ubmFtZSwKICAgICAgICAgICAgZGlhZ3JhbT1FZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKAogICAgICAgICAgICAgICAgcmFpbHJvYWQuRGlhZ3JhbSwgY29udGVudCwgKipzZWxmLmRpYWdyYW1fa3dhcmdzCiAgICAgICAgICAgICksCiAgICAgICAgICAgIGluZGV4PXBvc2l0aW9uLm51bWJlciwKICAgICAgICApCgogICAgICAgIGRlbCBzZWxmW2VsX2lkXQoKCmRlZiBfd29ydGhfZXh0cmFjdGluZyhlbGVtZW50OiBweXBhcnNpbmcuUGFyc2VyRWxlbWVudCkgLT4gYm9vbDoKICAgIFwiXCJcIgogICAgUmV0dXJucyB0cnVlIGlmIHRoaXMgZWxlbWVudCBpcyB3b3J0aCBoYXZpbmcgaXRzIG93biBzdWItZGlhZ3JhbS4gU2ltcGx5LCBpZiBhbnkgb2YgaXRzIGNoaWxkcmVuCiAgICB0aGVtc2VsdmVzIGhhdmUgY2hpbGRyZW4sIHRoZW4gaXRzIGNvbXBsZXggZW5vdWdoIHRvIGV4dHJhY3QKICAgIFwiXCJcIgogICAgY2hpbGRyZW4gPSBlbGVtZW50LnJlY3Vyc2UoKQogICAgcmV0dXJuIGFueShjaGlsZC5yZWN1cnNlKCkgZm9yIGNoaWxkIGluIGNoaWxkcmVuKQoKCmRlZiBfYXBwbHlfZGlhZ3JhbV9pdGVtX2VuaGFuY2VtZW50cyhmbik6CiAgICBcIlwiXCIKICAgIGRlY29yYXRvciB0byBlbnN1cmUgZW5oYW5jZW1lbnRzIHRvIGEgZGlhZ3JhbSBpdGVtIChzdWNoIGFzIHJlc3VsdHMgbmFtZSBhbm5vdGF0aW9ucykKICAgIGdldCBhcHBsaWVkIG9uIHJldHVybiBmcm9tIF90b19kaWFncmFtX2VsZW1lbnQgKHdlIGRvIHRoaXMgc2luY2UgdGhlcmUgYXJlIHNldmVyYWwKICAgIHJldHVybnMgaW4gX3RvX2RpYWdyYW1fZWxlbWVudCkKICAgIFwiXCJcIgoKICAgIGRlZiBfaW5uZXIoCiAgICAgICAgZWxlbWVudDogcHlwYXJzaW5nLlBhcnNlckVsZW1lbnQsCiAgICAgICAgcGFyZW50OiB0eXBpbmcuT3B0aW9uYWxbRWRpdGFibGVQYXJ0aWFsXSwKICAgICAgICBsb29rdXA6IENvbnZlcnRlclN0YXRlID0gTm9uZSwKICAgICAgICB2ZXJ0aWNhbDogaW50ID0gTm9uZSwKICAgICAgICBpbmRleDogaW50ID0gMCwKICAgICAgICBuYW1lX2hpbnQ6IHN0ciA9IE5vbmUsCiAgICAgICAgc2hvd19yZXN1bHRzX25hbWVzOiBib29sID0gRmFsc2UsCiAgICAgICAgc2hvd19ncm91cHM6IGJvb2wgPSBGYWxzZSwKICAgICkgLT4gdHlwaW5nLk9wdGlvbmFsW0VkaXRhYmxlUGFydGlhbF06CgogICAgICAgIHJldCA9IGZuKAogICAgICAgICAgICBlbGVtZW50LAogICAgICAgICAgICBwYXJlbnQsCiAgICAgICAgICAgIGxvb2t1cCwKICAgICAgICAgICAgdmVydGljYWwsCiAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICBuYW1lX2hpbnQsCiAgICAgICAgICAgIHNob3dfcmVzdWx0c19uYW1lcywKICAgICAgICAgICAgc2hvd19ncm91cHMsCiAgICAgICAgKQoKICAgICAgICAjIGFwcGx5IGFubm90YXRpb24gZm9yIHJlc3VsdHMgbmFtZSwgaWYgcHJlc2VudAogICAgICAgIGlmIHNob3dfcmVzdWx0c19uYW1lcyBhbmQgcmV0IGlzIG5vdCBOb25lOgogICAgICAgICAgICBlbGVtZW50X3Jlc3VsdHNfbmFtZSA9IGVsZW1lbnQucmVzdWx0c05hbWUKICAgICAgICAgICAgaWYgZWxlbWVudF9yZXN1bHRzX25hbWU6CiAgICAgICAgICAgICAgICAjIGFkZCBcIipcIiB0byBpbmRpY2F0ZSBpZiB0aGlzIGlzIGEgXCJsaXN0IGFsbCByZXN1bHRzXCIgbmFtZQogICAgICAgICAgICAgICAgZWxlbWVudF9yZXN1bHRzX25hbWUgKz0gXCJcIiBpZiBlbGVtZW50Lm1vZGFsUmVzdWx0cyBlbHNlIFwiKlwiCiAgICAgICAgICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKAogICAgICAgICAgICAgICAgICAgIHJhaWxyb2FkLkdyb3VwLCBpdGVtPXJldCwgbGFiZWw9ZWxlbWVudF9yZXN1bHRzX25hbWUKICAgICAgICAgICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJldAoKICAgIHJldHVybiBfaW5uZXIKCgpkZWYgX3Zpc2libGVfZXhwcnMoZXhwcnM6IEl0ZXJhYmxlW3B5cGFyc2luZy5QYXJzZXJFbGVtZW50XSk6CiAgICBub25fZGlhZ3JhbW1pbmdfZXhwcnMgPSAoCiAgICAgICAgcHlwYXJzaW5nLlBhcnNlRWxlbWVudEVuaGFuY2UsCiAgICAgICAgcHlwYXJzaW5nLlBvc2l0aW9uVG9rZW4sCiAgICAgICAgcHlwYXJzaW5nLkFuZC5fRXJyb3JTdG9wLAogICAgKQogICAgcmV0dXJuIFsKICAgICAgICBlCiAgICAgICAgZm9yIGUgaW4gZXhwcnMKICAgICAgICBpZiBub3QgKGUuY3VzdG9tTmFtZSBvciBlLnJlc3VsdHNOYW1lIG9yIGlzaW5zdGFuY2UoZSwgbm9uX2RpYWdyYW1taW5nX2V4cHJzKSkKICAgIF0KCgpAX2FwcGx5X2RpYWdyYW1faXRlbV9lbmhhbmNlbWVudHMKZGVmIF90b19kaWFncmFtX2VsZW1lbnQoCiAgICBlbGVtZW50OiBweXBhcnNpbmcuUGFyc2VyRWxlbWVudCwKICAgIHBhcmVudDogdHlwaW5nLk9wdGlvbmFsW0VkaXRhYmxlUGFydGlhbF0sCiAgICBsb29rdXA6IENvbnZlcnRlclN0YXRlID0gTm9uZSwKICAgIHZlcnRpY2FsOiBpbnQgPSBOb25lLAogICAgaW5kZXg6IGludCA9IDAsCiAgICBuYW1lX2hpbnQ6IHN0ciA9IE5vbmUsCiAgICBzaG93X3Jlc3VsdHNfbmFtZXM6IGJvb2wgPSBGYWxzZSwKICAgIHNob3dfZ3JvdXBzOiBib29sID0gRmFsc2UsCikgLT4gdHlwaW5nLk9wdGlvbmFsW0VkaXRhYmxlUGFydGlhbF06CiAgICBcIlwiXCIKICAgIFJlY3Vyc2l2ZWx5IGNvbnZlcnRzIGEgUHlQYXJzaW5nIEVsZW1lbnQgdG8gYSByYWlscm9hZCBFbGVtZW50CiAgICA6cGFyYW0gbG9va3VwOiBUaGUgc2hhcmVkIGNvbnZlcnRlciBzdGF0ZSB0aGF0IGtlZXBzIHRyYWNrIG9mIHVzZWZ1bCB0aGluZ3MKICAgIDpwYXJhbSBpbmRleDogVGhlIGluZGV4IG9mIHRoaXMgZWxlbWVudCB3aXRoaW4gdGhlIHBhcmVudAogICAgOnBhcmFtIHBhcmVudDogVGhlIHBhcmVudCBvZiB0aGlzIGVsZW1lbnQgaW4gdGhlIG91dHB1dCB0cmVlCiAgICA6cGFyYW0gdmVydGljYWw6IENvbnRyb2xzIGF0IHdoYXQgcG9pbnQgd2UgbWFrZSBhIGxpc3Qgb2YgZWxlbWVudHMgdmVydGljYWwuIElmIHRoaXMgaXMgYW4gaW50ZWdlciAodGhlIGRlZmF1bHQpLAogICAgaXQgc2V0cyB0aGUgdGhyZXNob2xkIG9mIHRoZSBudW1iZXIgb2YgaXRlbXMgYmVmb3JlIHdlIGdvIHZlcnRpY2FsLiBJZiBUcnVlLCBhbHdheXMgZ28gdmVydGljYWwsIGlmIEZhbHNlLCBuZXZlcgogICAgZG8gc28KICAgIDpwYXJhbSBuYW1lX2hpbnQ6IElmIHByb3ZpZGVkLCB0aGlzIHdpbGwgb3ZlcnJpZGUgdGhlIGdlbmVyYXRlZCBuYW1lCiAgICA6cGFyYW0gc2hvd19yZXN1bHRzX25hbWVzOiBib29sIGZsYWcgaW5kaWNhdGluZyB3aGV0aGVyIHRvIGFkZCBhbm5vdGF0aW9ucyBmb3IgcmVzdWx0cyBuYW1lcwogICAgOnJldHVybnM6IFRoZSBjb252ZXJ0ZWQgdmVyc2lvbiBvZiB0aGUgaW5wdXQgZWxlbWVudCwgYnV0IGFzIGEgUGFydGlhbCB0aGF0IGhhc24ndCB5ZXQgYmVlbiBjb25zdHJ1Y3RlZAogICAgOnBhcmFtIHNob3dfZ3JvdXBzOiBib29sIGZsYWcgaW5kaWNhdGluZyB3aGV0aGVyIHRvIHNob3cgZ3JvdXBzIHVzaW5nIGJvdW5kaW5nIGJveAogICAgXCJcIlwiCiAgICBleHBycyA9IGVsZW1lbnQucmVjdXJzZSgpCiAgICBuYW1lID0gbmFtZV9oaW50IG9yIGVsZW1lbnQuY3VzdG9tTmFtZSBvciBlbGVtZW50Ll9fY2xhc3NfXy5fX25hbWVfXwoKICAgICMgUHl0aG9uJ3MgaWQoKSBpcyB1c2VkIHRvIHByb3ZpZGUgYSB1bmlxdWUgaWRlbnRpZmllciBmb3IgZWxlbWVudHMKICAgIGVsX2lkID0gaWQoZWxlbWVudCkKCiAgICBlbGVtZW50X3Jlc3VsdHNfbmFtZSA9IGVsZW1lbnQucmVzdWx0c05hbWUKCiAgICAjIEhlcmUgd2UgYmFzaWNhbGx5IGJ5cGFzcyBwcm9jZXNzaW5nIGNlcnRhaW4gd3JhcHBlciBlbGVtZW50cyBpZiB0aGV5IGNvbnRyaWJ1dGUgbm90aGluZyB0byB0aGUgZGlhZ3JhbQogICAgaWYgbm90IGVsZW1lbnQuY3VzdG9tTmFtZToKICAgICAgICBpZiBpc2luc3RhbmNlKAogICAgICAgICAgICBlbGVtZW50LAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAjIHB5cGFyc2luZy5Ub2tlbkNvbnZlcnRlciwKICAgICAgICAgICAgICAgICMgcHlwYXJzaW5nLkZvcndhcmQsCiAgICAgICAgICAgICAgICBweXBhcnNpbmcuTG9jYXRlZCwKICAgICAgICAgICAgKSwKICAgICAgICApOgogICAgICAgICAgICAjIEhvd2V2ZXIsIGlmIHRoaXMgZWxlbWVudCBoYXMgYSB1c2VmdWwgY3VzdG9tIG5hbWUsIGFuZCBpdHMgY2hpbGQgZG9lcyBub3QsIHdlIGNhbiBwYXNzIGl0IG9uIHRvIHRoZSBjaGlsZAogICAgICAgICAgICBpZiBleHByczoKICAgICAgICAgICAgICAgIGlmIG5vdCBleHByc1swXS5jdXN0b21OYW1lOgogICAgICAgICAgICAgICAgICAgIHByb3BhZ2F0ZWRfbmFtZSA9IG5hbWUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJvcGFnYXRlZF9uYW1lID0gTm9uZQoKICAgICAgICAgICAgICAgIHJldHVybiBfdG9fZGlhZ3JhbV9lbGVtZW50KAogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZXhwciwKICAgICAgICAgICAgICAgICAgICBwYXJlbnQ9cGFyZW50LAogICAgICAgICAgICAgICAgICAgIGxvb2t1cD1sb29rdXAsCiAgICAgICAgICAgICAgICAgICAgdmVydGljYWw9dmVydGljYWwsCiAgICAgICAgICAgICAgICAgICAgaW5kZXg9aW5kZXgsCiAgICAgICAgICAgICAgICAgICAgbmFtZV9oaW50PXByb3BhZ2F0ZWRfbmFtZSwKICAgICAgICAgICAgICAgICAgICBzaG93X3Jlc3VsdHNfbmFtZXM9c2hvd19yZXN1bHRzX25hbWVzLAogICAgICAgICAgICAgICAgICAgIHNob3dfZ3JvdXBzPXNob3dfZ3JvdXBzLAogICAgICAgICAgICAgICAgKQoKICAgICMgSWYgdGhlIGVsZW1lbnQgaXNuJ3Qgd29ydGggZXh0cmFjdGluZywgd2UgYWx3YXlzIHRyZWF0IGl0IGFzIHRoZSBmaXJzdCB0aW1lIHdlIHNheSBpdAogICAgaWYgX3dvcnRoX2V4dHJhY3RpbmcoZWxlbWVudCk6CiAgICAgICAgaWYgZWxfaWQgaW4gbG9va3VwOgogICAgICAgICAgICAjIElmIHdlJ3ZlIHNlZW4gdGhpcyBlbGVtZW50IGV4YWN0bHkgb25jZSBiZWZvcmUsIHdlIGFyZSBvbmx5IGp1c3Qgbm93IGZpbmRpbmcgb3V0IHRoYXQgaXQncyBhIGR1cGxpY2F0ZSwKICAgICAgICAgICAgIyBzbyB3ZSBoYXZlIHRvIGV4dHJhY3QgaXQgaW50byBhIG5ldyBkaWFncmFtLgogICAgICAgICAgICBsb29rZWRfdXAgPSBsb29rdXBbZWxfaWRdCiAgICAgICAgICAgIGxvb2tlZF91cC5tYXJrX2Zvcl9leHRyYWN0aW9uKGVsX2lkLCBsb29rdXAsIG5hbWU9bmFtZV9oaW50KQogICAgICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLk5vblRlcm1pbmFsLCB0ZXh0PWxvb2tlZF91cC5uYW1lKQogICAgICAgICAgICByZXR1cm4gcmV0CgogICAgICAgIGVsaWYgZWxfaWQgaW4gbG9va3VwLmRpYWdyYW1zOgogICAgICAgICAgICAjIElmIHdlIGhhdmUgc2VlbiB0aGUgZWxlbWVudCBhdCBsZWFzdCB0d2ljZSBiZWZvcmUsIGFuZCBoYXZlIGFscmVhZHkgZXh0cmFjdGVkIGl0IGludG8gYSBzdWJkaWFncmFtLCB3ZQogICAgICAgICAgICAjIGp1c3QgcHV0IGluIGEgbWFya2VyIGVsZW1lbnQgdGhhdCByZWZlcnMgdG8gdGhlIHN1Yi1kaWFncmFtCiAgICAgICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwoCiAgICAgICAgICAgICAgICByYWlscm9hZC5Ob25UZXJtaW5hbCwgdGV4dD1sb29rdXAuZGlhZ3JhbXNbZWxfaWRdLmt3YXJnc1tcIm5hbWVcIl0KICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4gcmV0CgogICAgIyBSZWN1cnNpdmVseSBjb252ZXJ0IGNoaWxkIGVsZW1lbnRzCiAgICAjIEhlcmUgd2UgZmluZCB0aGUgbW9zdCByZWxldmFudCBSYWlscm9hZCBlbGVtZW50IGZvciBtYXRjaGluZyBweXBhcnNpbmcgRWxlbWVudAogICAgIyBXZSB1c2UgYGBpdGVtcz1bXWBgIGhlcmUgdG8gaG9sZCB0aGUgcGxhY2UgZm9yIHdoZXJlIHRoZSBjaGlsZCBlbGVtZW50cyB3aWxsIGdvIG9uY2UgY3JlYXRlZAogICAgaWYgaXNpbnN0YW5jZShlbGVtZW50LCBweXBhcnNpbmcuQW5kKToKICAgICAgICAjIGRldGVjdCBBbmQncyBjcmVhdGVkIHdpdGggYGBleHByKk5gYCBub3RhdGlvbiAtIGZvciB0aGVzZSB1c2UgYSBPbmVPck1vcmUgd2l0aCBhIHJlcGVhdAogICAgICAgICMgKGFsbCB3aWxsIGhhdmUgdGhlIHNhbWUgbmFtZSwgYW5kIHJlc3VsdHNOYW1lKQogICAgICAgIGlmIG5vdCBleHByczoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBpZiBsZW4oc2V0KChlLm5hbWUsIGUucmVzdWx0c05hbWUpIGZvciBlIGluIGV4cHJzKSkgPT0gMToKICAgICAgICAgICAgcmV0ID0gRWRpdGFibGVQYXJ0aWFsLmZyb21fY2FsbCgKICAgICAgICAgICAgICAgIHJhaWxyb2FkLk9uZU9yTW9yZSwgaXRlbT1cIlwiLCByZXBlYXQ9c3RyKGxlbihleHBycykpCiAgICAgICAgICAgICkKICAgICAgICBlbGlmIF9zaG91bGRfdmVydGljYWwodmVydGljYWwsIGV4cHJzKToKICAgICAgICAgICAgcmV0ID0gRWRpdGFibGVQYXJ0aWFsLmZyb21fY2FsbChyYWlscm9hZC5TdGFjaywgaXRlbXM9W10pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0ID0gRWRpdGFibGVQYXJ0aWFsLmZyb21fY2FsbChyYWlscm9hZC5TZXF1ZW5jZSwgaXRlbXM9W10pCiAgICBlbGlmIGlzaW5zdGFuY2UoZWxlbWVudCwgKHB5cGFyc2luZy5PciwgcHlwYXJzaW5nLk1hdGNoRmlyc3QpKToKICAgICAgICBpZiBub3QgZXhwcnM6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgaWYgX3Nob3VsZF92ZXJ0aWNhbCh2ZXJ0aWNhbCwgZXhwcnMpOgogICAgICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLkNob2ljZSwgMCwgaXRlbXM9W10pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0ID0gRWRpdGFibGVQYXJ0aWFsLmZyb21fY2FsbChyYWlscm9hZC5Ib3Jpem9udGFsQ2hvaWNlLCBpdGVtcz1bXSkKICAgIGVsaWYgaXNpbnN0YW5jZShlbGVtZW50LCBweXBhcnNpbmcuRWFjaCk6CiAgICAgICAgaWYgbm90IGV4cHJzOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwoRWFjaEl0ZW0sIGl0ZW1zPVtdKQogICAgZWxpZiBpc2luc3RhbmNlKGVsZW1lbnQsIHB5cGFyc2luZy5Ob3RBbnkpOgogICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwoQW5ub3RhdGVkSXRlbSwgbGFiZWw9XCJOT1RcIiwgaXRlbT1cIlwiKQogICAgZWxpZiBpc2luc3RhbmNlKGVsZW1lbnQsIHB5cGFyc2luZy5Gb2xsb3dlZEJ5KToKICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKEFubm90YXRlZEl0ZW0sIGxhYmVsPVwiTE9PS0FIRUFEXCIsIGl0ZW09XCJcIikKICAgIGVsaWYgaXNpbnN0YW5jZShlbGVtZW50LCBweXBhcnNpbmcuUHJlY2VkZWRCeSk6CiAgICAgICAgcmV0ID0gRWRpdGFibGVQYXJ0aWFsLmZyb21fY2FsbChBbm5vdGF0ZWRJdGVtLCBsYWJlbD1cIkxPT0tCRUhJTkRcIiwgaXRlbT1cIlwiKQogICAgZWxpZiBpc2luc3RhbmNlKGVsZW1lbnQsIHB5cGFyc2luZy5Hcm91cCk6CiAgICAgICAgaWYgc2hvd19ncm91cHM6CiAgICAgICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwoQW5ub3RhdGVkSXRlbSwgbGFiZWw9XCJcIiwgaXRlbT1cIlwiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwocmFpbHJvYWQuR3JvdXAsIGxhYmVsPVwiXCIsIGl0ZW09XCJcIikKICAgIGVsaWYgaXNpbnN0YW5jZShlbGVtZW50LCBweXBhcnNpbmcuVG9rZW5Db252ZXJ0ZXIpOgogICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwoCiAgICAgICAgICAgIEFubm90YXRlZEl0ZW0sIGxhYmVsPXR5cGUoZWxlbWVudCkuX19uYW1lX18ubG93ZXIoKSwgaXRlbT1cIlwiCiAgICAgICAgKQogICAgZWxpZiBpc2luc3RhbmNlKGVsZW1lbnQsIHB5cGFyc2luZy5PcHQpOgogICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwocmFpbHJvYWQuT3B0aW9uYWwsIGl0ZW09XCJcIikKICAgIGVsaWYgaXNpbnN0YW5jZShlbGVtZW50LCBweXBhcnNpbmcuT25lT3JNb3JlKToKICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLk9uZU9yTW9yZSwgaXRlbT1cIlwiKQogICAgZWxpZiBpc2luc3RhbmNlKGVsZW1lbnQsIHB5cGFyc2luZy5aZXJvT3JNb3JlKToKICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLlplcm9Pck1vcmUsIGl0ZW09XCJcIikKICAgIGVsaWYgaXNpbnN0YW5jZShlbGVtZW50LCBweXBhcnNpbmcuR3JvdXApOgogICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwoCiAgICAgICAgICAgIHJhaWxyb2FkLkdyb3VwLCBpdGVtPU5vbmUsIGxhYmVsPWVsZW1lbnRfcmVzdWx0c19uYW1lCiAgICAgICAgKQogICAgZWxpZiBpc2luc3RhbmNlKGVsZW1lbnQsIHB5cGFyc2luZy5FbXB0eSkgYW5kIG5vdCBlbGVtZW50LmN1c3RvbU5hbWU6CiAgICAgICAgIyBTa2lwIHVubmFtZWQgXCJFbXB0eVwiIGVsZW1lbnRzCiAgICAgICAgcmV0ID0gTm9uZQogICAgZWxpZiBsZW4oZXhwcnMpID4gMToKICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLlNlcXVlbmNlLCBpdGVtcz1bXSkKICAgIGVsaWYgbGVuKGV4cHJzKSA+IDAgYW5kIG5vdCBlbGVtZW50X3Jlc3VsdHNfbmFtZToKICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKHJhaWxyb2FkLkdyb3VwLCBpdGVtPVwiXCIsIGxhYmVsPW5hbWUpCiAgICBlbHNlOgogICAgICAgIHRlcm1pbmFsID0gRWRpdGFibGVQYXJ0aWFsLmZyb21fY2FsbChyYWlscm9hZC5UZXJtaW5hbCwgZWxlbWVudC5kZWZhdWx0TmFtZSkKICAgICAgICByZXQgPSB0ZXJtaW5hbAoKICAgIGlmIHJldCBpcyBOb25lOgogICAgICAgIHJldHVybgoKICAgICMgSW5kaWNhdGUgdGhpcyBlbGVtZW50J3MgcG9zaXRpb24gaW4gdGhlIHRyZWUgc28gd2UgY2FuIGV4dHJhY3QgaXQgaWYgbmVjZXNzYXJ5CiAgICBsb29rdXBbZWxfaWRdID0gRWxlbWVudFN0YXRlKAogICAgICAgIGVsZW1lbnQ9ZWxlbWVudCwKICAgICAgICBjb252ZXJ0ZWQ9cmV0LAogICAgICAgIHBhcmVudD1wYXJlbnQsCiAgICAgICAgcGFyZW50X2luZGV4PWluZGV4LAogICAgICAgIG51bWJlcj1sb29rdXAuZ2VuZXJhdGVfaW5kZXgoKSwKICAgICkKICAgIGlmIGVsZW1lbnQuY3VzdG9tTmFtZToKICAgICAgICBsb29rdXBbZWxfaWRdLm1hcmtfZm9yX2V4dHJhY3Rpb24oZWxfaWQsIGxvb2t1cCwgZWxlbWVudC5jdXN0b21OYW1lKQoKICAgIGkgPSAwCiAgICBmb3IgZXhwciBpbiBleHByczoKICAgICAgICAjIEFkZCBhIHBsYWNlaG9sZGVyIGluZGV4IGluIGNhc2Ugd2UgaGF2ZSB0byBleHRyYWN0IHRoZSBjaGlsZCBiZWZvcmUgd2UgZXZlbiBhZGQgaXQgdG8gdGhlIHBhcmVudAogICAgICAgIGlmIFwiaXRlbXNcIiBpbiByZXQua3dhcmdzOgogICAgICAgICAgICByZXQua3dhcmdzW1wiaXRlbXNcIl0uaW5zZXJ0KGksIE5vbmUpCgogICAgICAgIGl0ZW0gPSBfdG9fZGlhZ3JhbV9lbGVtZW50KAogICAgICAgICAgICBleHByLAogICAgICAgICAgICBwYXJlbnQ9cmV0LAogICAgICAgICAgICBsb29rdXA9bG9va3VwLAogICAgICAgICAgICB2ZXJ0aWNhbD12ZXJ0aWNhbCwKICAgICAgICAgICAgaW5kZXg9aSwKICAgICAgICAgICAgc2hvd19yZXN1bHRzX25hbWVzPXNob3dfcmVzdWx0c19uYW1lcywKICAgICAgICAgICAgc2hvd19ncm91cHM9c2hvd19ncm91cHMsCiAgICAgICAgKQoKICAgICAgICAjIFNvbWUgZWxlbWVudHMgZG9uJ3QgbmVlZCB0byBiZSBzaG93biBpbiB0aGUgZGlhZ3JhbQogICAgICAgIGlmIGl0ZW0gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIFwiaXRlbVwiIGluIHJldC5rd2FyZ3M6CiAgICAgICAgICAgICAgICByZXQua3dhcmdzW1wiaXRlbVwiXSA9IGl0ZW0KICAgICAgICAgICAgZWxpZiBcIml0ZW1zXCIgaW4gcmV0Lmt3YXJnczoKICAgICAgICAgICAgICAgICMgSWYgd2UndmUgYWxyZWFkeSBleHRyYWN0ZWQgdGhlIGNoaWxkLCBkb24ndCB0b3VjaCB0aGlzIGluZGV4LCBzaW5jZSBpdCdzIG9jY3VwaWVkIGJ5IGEgbm9udGVybWluYWwKICAgICAgICAgICAgICAgIHJldC5rd2FyZ3NbXCJpdGVtc1wiXVtpXSA9IGl0ZW0KICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgIGVsaWYgXCJpdGVtc1wiIGluIHJldC5rd2FyZ3M6CiAgICAgICAgICAgICMgSWYgd2UncmUgc3VwcG9zZWQgdG8gc2tpcCB0aGlzIGVsZW1lbnQsIHJlbW92ZSBpdCBmcm9tIHRoZSBwYXJlbnQKICAgICAgICAgICAgZGVsIHJldC5rd2FyZ3NbXCJpdGVtc1wiXVtpXQoKICAgICMgSWYgYWxsIHRoaXMgaXRlbXMgY2hpbGRyZW4gYXJlIG5vbmUsIHNraXAgdGhpcyBpdGVtCiAgICBpZiByZXQgYW5kICgKICAgICAgICAoXCJpdGVtc1wiIGluIHJldC5rd2FyZ3MgYW5kIGxlbihyZXQua3dhcmdzW1wiaXRlbXNcIl0pID09IDApCiAgICAgICAgb3IgKFwiaXRlbVwiIGluIHJldC5rd2FyZ3MgYW5kIHJldC5rd2FyZ3NbXCJpdGVtXCJdIGlzIE5vbmUpCiAgICApOgogICAgICAgIHJldCA9IEVkaXRhYmxlUGFydGlhbC5mcm9tX2NhbGwocmFpbHJvYWQuVGVybWluYWwsIG5hbWUpCgogICAgIyBNYXJrIHRoaXMgZWxlbWVudCBhcyBcImNvbXBsZXRlXCIsIGllIGl0IGhhcyBhbGwgb2YgaXRzIGNoaWxkcmVuCiAgICBpZiBlbF9pZCBpbiBsb29rdXA6CiAgICAgICAgbG9va3VwW2VsX2lkXS5jb21wbGV0ZSA9IFRydWUKCiAgICBpZiBlbF9pZCBpbiBsb29rdXAgYW5kIGxvb2t1cFtlbF9pZF0uZXh0cmFjdCBhbmQgbG9va3VwW2VsX2lkXS5jb21wbGV0ZToKICAgICAgICBsb29rdXAuZXh0cmFjdF9pbnRvX2RpYWdyYW0oZWxfaWQpCiAgICAgICAgaWYgcmV0IGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXQgPSBFZGl0YWJsZVBhcnRpYWwuZnJvbV9jYWxsKAogICAgICAgICAgICAgICAgcmFpbHJvYWQuTm9uVGVybWluYWwsIHRleHQ9bG9va3VwLmRpYWdyYW1zW2VsX2lkXS5rd2FyZ3NbXCJuYW1lXCJdCiAgICAgICAgICAgICkKCiAgICByZXR1cm4gcmV0CgoiIiIKCmltcG9ydCBvcwppbXBvcnQgdHlwZXMKaW1wb3J0IHppcGZpbGUKaW1wb3J0IHN5cwppbXBvcnQgaW8KCmNsYXNzIFppcEltcG9ydGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgemlwX2ZpbGUpOgogICAgICAgIHNlbGYuemZpbGUgPSB6aXBfZmlsZQogICAgICAgIHNlbGYuX3BhdGhzID0gW3guZmlsZW5hbWUgZm9yIHggaW4gc2VsZi56ZmlsZS5maWxlbGlzdF0KICAgICAgICAKICAgIGRlZiBfbW9kX3RvX3BhdGhzKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAjIGdldCB0aGUgcHl0aG9uIG1vZHVsZSBuYW1lCiAgICAgICAgcHlfZmlsZW5hbWUgPSBmdWxsbmFtZS5yZXBsYWNlKCIuIiwgb3Muc2VwKSArICIucHkiCiAgICAgICAgIyBnZXQgdGhlIGZpbGVuYW1lIGlmIGl0IGlzIGEgcGFja2FnZS9zdWJwYWNrYWdlCiAgICAgICAgcHlfcGFja2FnZSA9IGZ1bGxuYW1lLnJlcGxhY2UoIi4iLCBvcy5zZXApICsgIi9fX2luaXRfXy5weSIKICAgICAgICBpZiBweV9maWxlbmFtZSBpbiBzZWxmLl9wYXRoczoKICAgICAgICAgICAgcmV0dXJuIHB5X2ZpbGVuYW1lCiAgICAgICAgZWxpZiBweV9wYWNrYWdlIGluIHNlbGYuX3BhdGhzOgogICAgICAgICAgICByZXR1cm4gcHlfcGFja2FnZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIGZpbmRfbW9kdWxlKHNlbGYsIGZ1bGxuYW1lLCBwYXRoKToKICAgICAgICBpZiBzZWxmLl9tb2RfdG9fcGF0aHMoZnVsbG5hbWUpIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIGxvYWRfbW9kdWxlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICBmaWxlbmFtZSA9IHNlbGYuX21vZF90b19wYXRocyhmdWxsbmFtZSkKICAgICAgICBpZiBub3QgZmlsZW5hbWUgaW4gc2VsZi5fcGF0aHM6CiAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKGZ1bGxuYW1lKQogICAgICAgIG5ld19tb2R1bGUgPSB0eXBlcy5Nb2R1bGVUeXBlKGZ1bGxuYW1lKQogICAgICAgIHN5cy5tb2R1bGVzW2Z1bGxuYW1lXT1uZXdfbW9kdWxlCiAgICAgICAgaWYgZmlsZW5hbWUuZW5kc3dpdGgoIl9faW5pdF9fLnB5Iik6CiAgICAgICAgICAgIG5ld19tb2R1bGUuX19wYXRoX18gPSBbXSAKICAgICAgICAgICAgbmV3X21vZHVsZS5fX3BhY2thZ2VfXyA9IGZ1bGxuYW1lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbmV3X21vZHVsZS5fX3BhY2thZ2VfXyA9IGZ1bGxuYW1lLnJwYXJ0aXRpb24oJy4nKVswXQogICAgICAgIGV4ZWMoc2VsZi56ZmlsZS5vcGVuKGZpbGVuYW1lLCAncicpLnJlYWQoKSxuZXdfbW9kdWxlLl9fZGljdF9fKQogICAgICAgIG5ld19tb2R1bGUuX19maWxlX18gPSBmaWxlbmFtZQogICAgICAgIG5ld19tb2R1bGUuX19sb2FkZXJfXyA9IHNlbGYKICAgICAgICByZXR1cm4gbmV3X21vZHVsZQoKbW9kdWxlX3ppcD16aXBmaWxlLlppcEZpbGUoaW8uQnl0ZXNJTygpLCJ3IikKZm9yIGtleSBpbiBtb2R1bGVfZGljdDoKICAgIG1vZHVsZV96aXAud3JpdGVzdHIoa2V5LG1vZHVsZV9kaWN0W2tleV0pCgptb2R1bGVfaW1wb3J0ZXI9WmlwSW1wb3J0ZXIobW9kdWxlX3ppcCkKc3lzLm1ldGFfcGF0aC5pbnNlcnQoMCxtb2R1bGVfaW1wb3J0ZXIpCgpmcm9tIHB5cGFyc2luZyBpbXBvcnQgKgo=').decode("utf-8"),pyparsing_module.__dict__)
sys.modules["pyparsing"]=pyparsing_module

from pyparsing import (Suppress, Word, nums, alphas, Regex, Forward, Group, 
						Optional, OneOrMore, ParseResults)


from collections import defaultdict


import base64
pt = base64.b64decode(b'ewoJIkh5ZHJvZ2VuIjogewoJCSJBdG9taWNOdW1iZXIiOiAxLAoJCSJTeW1ib2wiOiAiSCIsCgkJIkF0b21pY01hc3MiOiAxLjAwNywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDAsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDEsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMSwKCQkiUGVyaW9kIjogMSwKCQkiR3JvdXAiOiAxLAoJCSJQaGFzZSI6ICJnYXMiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIk5vbm1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMC43OSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDEzLjU5ODQsCgkJIkRlbnNpdHkiOiA4Ljk5ZS0wNSwKCQkiTWVsdGluZ1BvaW50IjogMTQuMTc1LAoJCSJCb2lsaW5nUG9pbnQiOiAyMC4yOCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDMsCgkJIkRpc2NvdmVyZXIiOiAiQ2F2ZW5kaXNoIiwKCQkiWWVhciI6IDE3NjYsCgkJIlNwZWNpZmljSGVhdCI6IDE0LjMwNCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiAxLAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAxLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICIxczEiCgl9LAoJIkhlbGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMiwKCQkiU3ltYm9sIjogIkhlIiwKCQkiQXRvbWljTWFzcyI6IDQuMDAyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMiwKCQkiTnVtYmVyb2ZQcm90b25zIjogMiwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAyLAoJCSJQZXJpb2QiOiAxLAoJCSJHcm91cCI6IDE4LAoJCSJQaGFzZSI6ICJnYXMiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIk5vYmxlIEdhcyIsCgkJIkF0b21pY1JhZGl1cyI6IDAuNDksCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogbnVsbCwKCQkiRmlyc3RJb25pemF0aW9uIjogMjQuNTg3NCwKCQkiRGVuc2l0eSI6IDAuMDAwMTc5LAoJCSJNZWx0aW5nUG9pbnQiOiBudWxsLAoJCSJCb2lsaW5nUG9pbnQiOiA0LjIyLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogNSwKCQkiRGlzY292ZXJlciI6ICJKYW5zc2VuIiwKCQkiWWVhciI6IDE4NjgsCgkJIlNwZWNpZmljSGVhdCI6IDUuMTkzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDEsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIjFzMiIKCX0sCgkiTGl0aGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMywKCQkiU3ltYm9sIjogIkxpIiwKCQkiQXRvbWljTWFzcyI6IDYuOTQxLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNCwKCQkiTnVtYmVyb2ZQcm90b25zIjogMywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAzLAoJCSJQZXJpb2QiOiAyLAoJCSJHcm91cCI6IDEsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJBbGthbGkgTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjEsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMC45OCwKCQkiRmlyc3RJb25pemF0aW9uIjogNS4zOTE3LAoJCSJEZW5zaXR5IjogMC41MzQsCgkJIk1lbHRpbmdQb2ludCI6IDQ1My44NSwKCQkiQm9pbGluZ1BvaW50IjogMTYxNSwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDUsCgkJIkRpc2NvdmVyZXIiOiAiQXJmdmVkc29uIiwKCQkiWWVhciI6IDE4MTcsCgkJIlNwZWNpZmljSGVhdCI6IDMuNTgyLAoJCSJOdW1iZXJvZlNoZWxscyI6IDIsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDEsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltIZV0gMnMxIgoJfSwKCSJCZXJ5bGxpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDQsCgkJIlN5bWJvbCI6ICJCZSIsCgkJIkF0b21pY01hc3MiOiA5LjAxMiwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDUsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDQsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNCwKCQkiUGVyaW9kIjogMiwKCQkiR3JvdXAiOiAyLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWxrYWxpbmUgRWFydGggTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjQsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS41NywKCQkiRmlyc3RJb25pemF0aW9uIjogOS4zMjI3LAoJCSJEZW5zaXR5IjogMS44NSwKCQkiTWVsdGluZ1BvaW50IjogMTU2MC4xNSwKCQkiQm9pbGluZ1BvaW50IjogMjc0MiwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDYsCgkJIkRpc2NvdmVyZXIiOiAiVmF1bHF1ZWxpbiIsCgkJIlllYXIiOiAxNzk4LAoJCSJTcGVjaWZpY0hlYXQiOiAxLjgyNSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiAyLAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAyLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbSGVdIDJzMiIKCX0sCgkiQm9yb24iOiB7CgkJIkF0b21pY051bWJlciI6IDUsCgkJIlN5bWJvbCI6ICJCIiwKCQkiQXRvbWljTWFzcyI6IDEwLjgxMSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDYsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDUsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNSwKCQkiUGVyaW9kIjogMiwKCQkiR3JvdXAiOiAxMywKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6ICJ5ZXMiLAoJCSJUeXBlIjogIk1ldGFsbG9pZCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuMiwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjA0LAoJCSJGaXJzdElvbml6YXRpb24iOiA4LjI5OCwKCQkiRGVuc2l0eSI6IDIuMzQsCgkJIk1lbHRpbmdQb2ludCI6IDI1NzMuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDQyMDAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiA2LAoJCSJEaXNjb3ZlcmVyIjogIkdheS1MdXNzYWMiLAoJCSJZZWFyIjogMTgwOCwKCQkiU3BlY2lmaWNIZWF0IjogMS4wMjYsCgkJIk51bWJlcm9mU2hlbGxzIjogMiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogMywKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0hlXSAyczIgMnAxIgoJfSwKCSJDYXJib24iOiB7CgkJIkF0b21pY051bWJlciI6IDYsCgkJIlN5bWJvbCI6ICJDIiwKCQkiQXRvbWljTWFzcyI6IDEyLjAxMSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDYsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNiwKCQkiUGVyaW9kIjogMiwKCQkiR3JvdXAiOiAxNCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIk5vbm1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMC45MSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjU1LAoJCSJGaXJzdElvbml6YXRpb24iOiAxMS4yNjAzLAoJCSJEZW5zaXR5IjogMi4yNywKCQkiTWVsdGluZ1BvaW50IjogMzk0OC4xNSwKCQkiQm9pbGluZ1BvaW50IjogNDMwMCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDcsCgkJIkRpc2NvdmVyZXIiOiAiUHJlaGlzdG9yaWMiLAoJCSJZZWFyIjogbnVsbCwKCQkiU3BlY2lmaWNIZWF0IjogMC43MDksCgkJIk51bWJlcm9mU2hlbGxzIjogMiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0hlXSAyczIgMnAyIgoJfSwKCSJOaXRyb2dlbiI6IHsKCQkiQXRvbWljTnVtYmVyIjogNywKCQkiU3ltYm9sIjogIk4iLAoJCSJBdG9taWNNYXNzIjogMTQuMDA3LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNywKCQkiTnVtYmVyb2ZQcm90b25zIjogNywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA3LAoJCSJQZXJpb2QiOiAyLAoJCSJHcm91cCI6IDE1LAoJCSJQaGFzZSI6ICJnYXMiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIk5vbm1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMC43NSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAzLjA0LAoJCSJGaXJzdElvbml6YXRpb24iOiAxNC41MzQxLAoJCSJEZW5zaXR5IjogMC4wMDEyNSwKCQkiTWVsdGluZ1BvaW50IjogNjMuMjksCgkJIkJvaWxpbmdQb2ludCI6IDc3LjM2LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogOCwKCQkiRGlzY292ZXJlciI6ICJSdXRoZXJmb3JkIiwKCQkiWWVhciI6IDE3NzIsCgkJIlNwZWNpZmljSGVhdCI6IDEuMDQsCgkJIk51bWJlcm9mU2hlbGxzIjogMiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNSwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0hlXSAyczIgMnAzIgoJfSwKCSJPeHlnZW4iOiB7CgkJIkF0b21pY051bWJlciI6IDgsCgkJIlN5bWJvbCI6ICJPIiwKCQkiQXRvbWljTWFzcyI6IDE1Ljk5OSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDgsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogOCwKCQkiUGVyaW9kIjogMiwKCQkiR3JvdXAiOiAxNiwKCQkiUGhhc2UiOiAiZ2FzIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiAieWVzIiwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJOb25tZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDAuNjUsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMy40NCwKCQkiRmlyc3RJb25pemF0aW9uIjogMTMuNjE4MSwKCQkiRGVuc2l0eSI6IDAuMDAxNDMsCgkJIk1lbHRpbmdQb2ludCI6IDUwLjUsCgkJIkJvaWxpbmdQb2ludCI6IDkwLjIsCgkJIk51bWJlck9mSXNvdG9wZXMiOiA4LAoJCSJEaXNjb3ZlcmVyIjogIlByaWVzdGxleS9TY2hlZWxlIiwKCQkiWWVhciI6IDE3NzQsCgkJIlNwZWNpZmljSGVhdCI6IDAuOTE4LAoJCSJOdW1iZXJvZlNoZWxscyI6IDIsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDYsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltIZV0gMnMyIDJwNCIKCX0sCgkiRmx1b3JpbmUiOiB7CgkJIkF0b21pY051bWJlciI6IDksCgkJIlN5bWJvbCI6ICJGIiwKCQkiQXRvbWljTWFzcyI6IDE4Ljk5OCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA5LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDksCgkJIlBlcmlvZCI6IDIsCgkJIkdyb3VwIjogMTcsCgkJIlBoYXNlIjogImdhcyIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiSGFsb2dlbiIsCgkJIkF0b21pY1JhZGl1cyI6IDAuNTcsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMy45OCwKCQkiRmlyc3RJb25pemF0aW9uIjogMTcuNDIyOCwKCQkiRGVuc2l0eSI6IDAuMDAxNywKCQkiTWVsdGluZ1BvaW50IjogNTMuNjMsCgkJIkJvaWxpbmdQb2ludCI6IDg1LjAzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogNiwKCQkiRGlzY292ZXJlciI6ICJNb2lzc2FuIiwKCQkiWWVhciI6IDE4ODYsCgkJIlNwZWNpZmljSGVhdCI6IDAuODI0LAoJCSJOdW1iZXJvZlNoZWxscyI6IDIsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDcsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltIZV0gMnMyIDJwNSIKCX0sCgkiTmVvbiI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTAsCgkJIlN5bWJvbCI6ICJOZSIsCgkJIkF0b21pY01hc3MiOiAyMC4xOCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMCwKCQkiUGVyaW9kIjogMiwKCQkiR3JvdXAiOiAxOCwKCQkiUGhhc2UiOiAiZ2FzIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiAieWVzIiwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJOb2JsZSBHYXMiLAoJCSJBdG9taWNSYWRpdXMiOiAwLjUxLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDIxLjU2NDUsCgkJIkRlbnNpdHkiOiAwLjAwMDksCgkJIk1lbHRpbmdQb2ludCI6IDI0LjcwMywKCQkiQm9pbGluZ1BvaW50IjogMjcuMDcsCgkJIk51bWJlck9mSXNvdG9wZXMiOiA4LAoJCSJEaXNjb3ZlcmVyIjogIlJhbXNheSBhbmQgVHJhdmVycyIsCgkJIlllYXIiOiAxODk4LAoJCSJTcGVjaWZpY0hlYXQiOiAxLjAzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDIsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDgsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltIZV0gMnMyIDJwNiIKCX0sCgkiU29kaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMSwKCQkiU3ltYm9sIjogIk5hIiwKCQkiQXRvbWljTWFzcyI6IDIyLjk5LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTIsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDExLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDExLAoJCSJQZXJpb2QiOiAzLAoJCSJHcm91cCI6IDEsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJBbGthbGkgTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjIsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMC45MywKCQkiRmlyc3RJb25pemF0aW9uIjogNS4xMzkxLAoJCSJEZW5zaXR5IjogMC45NzEsCgkJIk1lbHRpbmdQb2ludCI6IDM3MS4xNSwKCQkiQm9pbGluZ1BvaW50IjogMTE1NiwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDcsCgkJIkRpc2NvdmVyZXIiOiAiRGF2eSIsCgkJIlllYXIiOiAxODA3LAoJCSJTcGVjaWZpY0hlYXQiOiAxLjIyOCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiAzLAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAxLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbTmVdIDNzMSIKCX0sCgkiTWFnbmVzaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMiwKCQkiU3ltYm9sIjogIk1nIiwKCQkiQXRvbWljTWFzcyI6IDI0LjMwNSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEyLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMiwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMiwKCQkiUGVyaW9kIjogMywKCQkiR3JvdXAiOiAyLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWxrYWxpbmUgRWFydGggTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjcsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4zMSwKCQkiRmlyc3RJb25pemF0aW9uIjogNy42NDYyLAoJCSJEZW5zaXR5IjogMS43NCwKCQkiTWVsdGluZ1BvaW50IjogOTIzLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAxMzYzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogOCwKCQkiRGlzY292ZXJlciI6ICJCbGFjayIsCgkJIlllYXIiOiAxNzU1LAoJCSJTcGVjaWZpY0hlYXQiOiAxLjAyMywKCQkiTnVtYmVyb2ZTaGVsbHMiOiAzLAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAyLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbTmVdIDNzMiIKCX0sCgkiQWx1bWludW0iOiB7CgkJIkF0b21pY051bWJlciI6IDEzLAoJCSJTeW1ib2wiOiAiQWwiLAoJCSJBdG9taWNNYXNzIjogMjYuOTgyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTQsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDEzLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDEzLAoJCSJQZXJpb2QiOiAzLAoJCSJHcm91cCI6IDEzLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjgsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS42MSwKCQkiRmlyc3RJb25pemF0aW9uIjogNS45ODU4LAoJCSJEZW5zaXR5IjogMi43LAoJCSJNZWx0aW5nUG9pbnQiOiA5MzMuNCwKCQkiQm9pbGluZ1BvaW50IjogMjc5MiwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDgsCgkJIkRpc2NvdmVyZXIiOiAiV3NobGVyIiwKCQkiWWVhciI6IDE4MjcsCgkJIlNwZWNpZmljSGVhdCI6IDAuODk3LAoJCSJOdW1iZXJvZlNoZWxscyI6IDMsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDMsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltOZV0gM3MyIDNwMSIKCX0sCgkiU2lsaWNvbiI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTQsCgkJIlN5bWJvbCI6ICJTaSIsCgkJIkF0b21pY01hc3MiOiAyOC4wODYsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNCwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTQsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTQsCgkJIlBlcmlvZCI6IDMsCgkJIkdyb3VwIjogMTQsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiAieWVzIiwKCQkiVHlwZSI6ICJNZXRhbGxvaWQiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjUsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS45LAoJCSJGaXJzdElvbml6YXRpb24iOiA4LjE1MTcsCgkJIkRlbnNpdHkiOiAyLjMzLAoJCSJNZWx0aW5nUG9pbnQiOiAxNjgzLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAzNTM4LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogOCwKCQkiRGlzY292ZXJlciI6ICJCZXJ6ZWxpdXMiLAoJCSJZZWFyIjogMTgyNCwKCQkiU3BlY2lmaWNIZWF0IjogMC43MDUsCgkJIk51bWJlcm9mU2hlbGxzIjogMywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW05lXSAzczIgM3AyIgoJfSwKCSJQaG9zcGhvcnVzIjogewoJCSJBdG9taWNOdW1iZXIiOiAxNSwKCQkiU3ltYm9sIjogIlAiLAoJCSJBdG9taWNNYXNzIjogMzAuOTc0LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTYsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDE1LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDE1LAoJCSJQZXJpb2QiOiAzLAoJCSJHcm91cCI6IDE1LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTm9ubWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjIsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4xOSwKCQkiRmlyc3RJb25pemF0aW9uIjogMTAuNDg2NywKCQkiRGVuc2l0eSI6IDEuODIsCgkJIk1lbHRpbmdQb2ludCI6IDMxNy4yNSwKCQkiQm9pbGluZ1BvaW50IjogNTUzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogNywKCQkiRGlzY292ZXJlciI6ICJCcmFuQnJhbmQiLAoJCSJZZWFyIjogMTY2OSwKCQkiU3BlY2lmaWNIZWF0IjogMC43NjksCgkJIk51bWJlcm9mU2hlbGxzIjogMywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNSwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW05lXSAzczIgM3AzIgoJfSwKCSJTdWxmdXIiOiB7CgkJIkF0b21pY051bWJlciI6IDE2LAoJCSJTeW1ib2wiOiAiUyIsCgkJIkF0b21pY01hc3MiOiAzMi4wNjUsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNiwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTYsCgkJIlBlcmlvZCI6IDMsCgkJIkdyb3VwIjogMTYsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiAieWVzIiwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJOb25tZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuMSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjU4LAoJCSJGaXJzdElvbml6YXRpb24iOiAxMC4zNiwKCQkiRGVuc2l0eSI6IDIuMDcsCgkJIk1lbHRpbmdQb2ludCI6IDM4OC41MSwKCQkiQm9pbGluZ1BvaW50IjogNzE3LjgsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxMCwKCQkiRGlzY292ZXJlciI6ICJQcmVoaXN0b3JpYyIsCgkJIlllYXIiOiBudWxsLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjcxLAoJCSJOdW1iZXJvZlNoZWxscyI6IDMsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDYsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltOZV0gM3MyIDNwNCIKCX0sCgkiQ2hsb3JpbmUiOiB7CgkJIkF0b21pY051bWJlciI6IDE3LAoJCSJTeW1ib2wiOiAiQ2wiLAoJCSJBdG9taWNNYXNzIjogMzUuNDUzLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDE3LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDE3LAoJCSJQZXJpb2QiOiAzLAoJCSJHcm91cCI6IDE3LAoJCSJQaGFzZSI6ICJnYXMiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkhhbG9nZW4iLAoJCSJBdG9taWNSYWRpdXMiOiAwLjk3LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDMuMTYsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDEyLjk2NzYsCgkJIkRlbnNpdHkiOiAwLjAwMzIxLAoJCSJNZWx0aW5nUG9pbnQiOiAxNzIuMzEsCgkJIkJvaWxpbmdQb2ludCI6IDIzOS4xMSwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDExLAoJCSJEaXNjb3ZlcmVyIjogIlNjaGVlbGUiLAoJCSJZZWFyIjogMTc3NCwKCQkiU3BlY2lmaWNIZWF0IjogMC40NzksCgkJIk51bWJlcm9mU2hlbGxzIjogMywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNywKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW05lXSAzczIgM3A1IgoJfSwKCSJBcmdvbiI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTgsCgkJIlN5bWJvbCI6ICJBciIsCgkJIkF0b21pY01hc3MiOiAzOS45NDgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAyMiwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTgsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTgsCgkJIlBlcmlvZCI6IDMsCgkJIkdyb3VwIjogMTgsCgkJIlBoYXNlIjogImdhcyIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTm9ibGUgR2FzIiwKCQkiQXRvbWljUmFkaXVzIjogMC44OCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiAxNS43NTk2LAoJCSJEZW5zaXR5IjogMC4wMDE3OCwKCQkiTWVsdGluZ1BvaW50IjogODMuOTYsCgkJIkJvaWxpbmdQb2ludCI6IDg3LjMsCgkJIk51bWJlck9mSXNvdG9wZXMiOiA4LAoJCSJEaXNjb3ZlcmVyIjogIlJheWxlaWdoIGFuZCBSYW1zYXkiLAoJCSJZZWFyIjogMTg5NCwKCQkiU3BlY2lmaWNIZWF0IjogMC41MiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiAzLAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA4LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbTmVdIDNzMiAzcDYiCgl9LAoJIlBvdGFzc2l1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTksCgkJIlN5bWJvbCI6ICJLIiwKCQkiQXRvbWljTWFzcyI6IDM5LjA5OCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDIwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxOSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxOSwKCQkiUGVyaW9kIjogNCwKCQkiR3JvdXAiOiAxLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWxrYWxpIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMi44LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDAuODIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDQuMzQwNywKCQkiRGVuc2l0eSI6IDAuODYyLAoJCSJNZWx0aW5nUG9pbnQiOiAzMzYuNSwKCQkiQm9pbGluZ1BvaW50IjogMTAzMiwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDEwLAoJCSJEaXNjb3ZlcmVyIjogIkRhdnkiLAoJCSJZZWFyIjogMTgwNywKCQkiU3BlY2lmaWNIZWF0IjogMC43NTcsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogMSwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSA0czEiCgl9LAoJIkNhbGNpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDIwLAoJCSJTeW1ib2wiOiAiQ2EiLAoJCSJBdG9taWNNYXNzIjogNDAuMDc4LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMjAsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDIwLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDIwLAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDIsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJBbGthbGluZSBFYXJ0aCBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIuMiwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjExMzIsCgkJIkRlbnNpdHkiOiAxLjU0LAoJCSJNZWx0aW5nUG9pbnQiOiAxMTEyLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAxNzU3LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTQsCgkJIkRpc2NvdmVyZXIiOiAiRGF2eSIsCgkJIlllYXIiOiAxODA4LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjY0NywKCQkiTnVtYmVyb2ZTaGVsbHMiOiA0LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAyLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbQXJdIDRzMiIKCX0sCgkiU2NhbmRpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDIxLAoJCSJTeW1ib2wiOiAiU2MiLAoJCSJBdG9taWNNYXNzIjogNDQuOTU2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMjQsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDIxLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDIxLAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDMsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2l0aW9uIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMi4xLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMzYsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNTYxNSwKCQkiRGVuc2l0eSI6IDIuOTksCgkJIk1lbHRpbmdQb2ludCI6IDE4MTIuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDMxMDksCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNSwKCQkiRGlzY292ZXJlciI6ICJOaWxzb24iLAoJCSJZZWFyIjogMTg3OCwKCQkiU3BlY2lmaWNIZWF0IjogMC41NjgsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDEgNHMyIgoJfSwKCSJUaXRhbml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMjIsCgkJIlN5bWJvbCI6ICJUaSIsCgkJIkF0b21pY01hc3MiOiA0Ny44NjcsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAyNiwKCQkiTnVtYmVyb2ZQcm90b25zIjogMjIsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMjIsCgkJIlBlcmlvZCI6IDQsCgkJIkdyb3VwIjogNCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAyLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuNTQsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuODI4MSwKCQkiRGVuc2l0eSI6IDQuNTQsCgkJIk1lbHRpbmdQb2ludCI6IDE5MzMuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM1NjAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiA5LAoJCSJEaXNjb3ZlcmVyIjogIkdyZWdvciIsCgkJIlllYXIiOiAxNzkxLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjUyMywKCQkiTnVtYmVyb2ZTaGVsbHMiOiA0LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbQXJdIDNkMiA0czIiCgl9LAoJIlZhbmFkaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAyMywKCQkiU3ltYm9sIjogIlYiLAoJCSJBdG9taWNNYXNzIjogNTAuOTQyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMjgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDIzLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDIzLAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDUsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2l0aW9uIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMS45LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuNjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNzQ2MiwKCQkiRGVuc2l0eSI6IDYuMTEsCgkJIk1lbHRpbmdQb2ludCI6IDIxNzUuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM2ODAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiA5LAoJCSJEaXNjb3ZlcmVyIjogIiAgIGRlbCBSaW8iLAoJCSJZZWFyIjogMTgwMSwKCQkiU3BlY2lmaWNIZWF0IjogMC40ODksCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDMgNHMyIgoJfSwKCSJDaHJvbWl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMjQsCgkJIlN5bWJvbCI6ICJDciIsCgkJIkF0b21pY01hc3MiOiA1MS45OTYsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAyOCwKCQkiTnVtYmVyb2ZQcm90b25zIjogMjQsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMjQsCgkJIlBlcmlvZCI6IDQsCgkJIkdyb3VwIjogNiwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjksCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS42NiwKCQkiRmlyc3RJb25pemF0aW9uIjogNi43NjY1LAoJCSJEZW5zaXR5IjogNy4xNSwKCQkiTWVsdGluZ1BvaW50IjogMjEzMC4xNSwKCQkiQm9pbGluZ1BvaW50IjogMjk0NCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDksCgkJIkRpc2NvdmVyZXIiOiAiVmF1cXVlbGluIiwKCQkiWWVhciI6IDE3OTcsCgkJIlNwZWNpZmljSGVhdCI6IDAuNDQ5LAoJCSJOdW1iZXJvZlNoZWxscyI6IDQsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltBcl0gM2Q1IDRzMSIKCX0sCgkiTWFuZ2FuZXNlIjogewoJCSJBdG9taWNOdW1iZXIiOiAyNSwKCQkiU3ltYm9sIjogIk1uIiwKCQkiQXRvbWljTWFzcyI6IDU0LjkzOCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDMwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAyNSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAyNSwKCQkiUGVyaW9kIjogNCwKCQkiR3JvdXAiOiA3LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjU1LAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjQzNCwKCQkiRGVuc2l0eSI6IDcuNDQsCgkJIk1lbHRpbmdQb2ludCI6IDE1MTkuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDIzMzQsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxMSwKCQkiRGlzY292ZXJlciI6ICJHYWhuLCBTY2hlZWxlIiwKCQkiWWVhciI6IDE3NzQsCgkJIlNwZWNpZmljSGVhdCI6IDAuNDc5LAoJCSJOdW1iZXJvZlNoZWxscyI6IDQsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltBcl0gM2Q1IDRzMiIKCX0sCgkiSXJvbiI6IHsKCQkiQXRvbWljTnVtYmVyIjogMjYsCgkJIlN5bWJvbCI6ICJGZSIsCgkJIkF0b21pY01hc3MiOiA1NS44NDUsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAzMCwKCQkiTnVtYmVyb2ZQcm90b25zIjogMjYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMjYsCgkJIlBlcmlvZCI6IDQsCgkJIkdyb3VwIjogOCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjcsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS44MywKCQkiRmlyc3RJb25pemF0aW9uIjogNy45MDI0LAoJCSJEZW5zaXR5IjogNy44NywKCQkiTWVsdGluZ1BvaW50IjogMTgwOC4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzEzNCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDEwLAoJCSJEaXNjb3ZlcmVyIjogIlByZWhpc3RvcmljIiwKCQkiWWVhciI6IG51bGwsCgkJIlNwZWNpZmljSGVhdCI6IDAuNDQ5LAoJCSJOdW1iZXJvZlNoZWxscyI6IDQsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltBcl0gM2Q2IDRzMiIKCX0sCgkiQ29iYWx0IjogewoJCSJBdG9taWNOdW1iZXIiOiAyNywKCQkiU3ltYm9sIjogIkNvIiwKCQkiQXRvbWljTWFzcyI6IDU4LjkzMywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDMyLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAyNywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAyNywKCQkiUGVyaW9kIjogNCwKCQkiR3JvdXAiOiA5LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuNywKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjg4LAoJCSJGaXJzdElvbml6YXRpb24iOiA3Ljg4MSwKCQkiRGVuc2l0eSI6IDguODYsCgkJIk1lbHRpbmdQb2ludCI6IDE3NjguMTUsCgkJIkJvaWxpbmdQb2ludCI6IDMyMDAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNCwKCQkiRGlzY292ZXJlciI6ICJCcmFuZHQiLAoJCSJZZWFyIjogMTczNSwKCQkiU3BlY2lmaWNIZWF0IjogMC40MjEsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDcgNHMyIgoJfSwKCSJOaWNrZWwiOiB7CgkJIkF0b21pY051bWJlciI6IDI4LAoJCSJTeW1ib2wiOiAiTmkiLAoJCSJBdG9taWNNYXNzIjogNTguNjkzLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMzEsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDI4LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDI4LAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDEwLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuNiwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjkxLAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjYzOTgsCgkJIkRlbnNpdHkiOiA4LjkxLAoJCSJNZWx0aW5nUG9pbnQiOiAxNzI2LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAzMTg2LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTEsCgkJIkRpc2NvdmVyZXIiOiAiQ3JvbnN0ZWR0IiwKCQkiWWVhciI6IDE3NTEsCgkJIlNwZWNpZmljSGVhdCI6IDAuNDQ0LAoJCSJOdW1iZXJvZlNoZWxscyI6IDQsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltBcl0gM2Q4IDRzMiIKCX0sCgkiQ29wcGVyIjogewoJCSJBdG9taWNOdW1iZXIiOiAyOSwKCQkiU3ltYm9sIjogIkN1IiwKCQkiQXRvbWljTWFzcyI6IDYzLjU0NiwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDM1LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAyOSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAyOSwKCQkiUGVyaW9kIjogNCwKCQkiR3JvdXAiOiAxMSwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjYsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS45LAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjcyNjQsCgkJIkRlbnNpdHkiOiA4Ljk2LAoJCSJNZWx0aW5nUG9pbnQiOiAxMzU3Ljc1LAoJCSJCb2lsaW5nUG9pbnQiOiAyODM1LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTEsCgkJIkRpc2NvdmVyZXIiOiAiUHJlaGlzdG9yaWMiLAoJCSJZZWFyIjogbnVsbCwKCQkiU3BlY2lmaWNIZWF0IjogMC4zODUsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDEwIDRzMSIKCX0sCgkiWmluYyI6IHsKCQkiQXRvbWljTnVtYmVyIjogMzAsCgkJIlN5bWJvbCI6ICJabiIsCgkJIkF0b21pY01hc3MiOiA2NS4zOCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDM1LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAzMCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAzMCwKCQkiUGVyaW9kIjogNCwKCQkiR3JvdXAiOiAxMiwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjUsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS42NSwKCQkiRmlyc3RJb25pemF0aW9uIjogOS4zOTQyLAoJCSJEZW5zaXR5IjogNy4xMywKCQkiTWVsdGluZ1BvaW50IjogNjkyLjg4LAoJCSJCb2lsaW5nUG9pbnQiOiAxMTgwLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTUsCgkJIkRpc2NvdmVyZXIiOiAiUHJlaGlzdG9yaWMiLAoJCSJZZWFyIjogbnVsbCwKCQkiU3BlY2lmaWNIZWF0IjogMC4zODgsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDEwIDRzMiIKCX0sCgkiR2FsbGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMzEsCgkJIlN5bWJvbCI6ICJHYSIsCgkJIkF0b21pY01hc3MiOiA2OS43MjMsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAzOSwKCQkiTnVtYmVyb2ZQcm90b25zIjogMzEsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMzEsCgkJIlBlcmlvZCI6IDQsCgkJIkdyb3VwIjogMTMsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjgxLAoJCSJGaXJzdElvbml6YXRpb24iOiA1Ljk5OTMsCgkJIkRlbnNpdHkiOiA1LjkxLAoJCSJNZWx0aW5nUG9pbnQiOiAzMDIuOTEsCgkJIkJvaWxpbmdQb2ludCI6IDI0NzcsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNCwKCQkiRGlzY292ZXJlciI6ICJkZSBCb2lzYmF1ZHJhbiIsCgkJIlllYXIiOiAxODc1LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjM3MSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA0LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAzLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbQXJdIDNkMTAgNHMyIDRwMSIKCX0sCgkiR2VybWFuaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAzMiwKCQkiU3ltYm9sIjogIkdlIiwKCQkiQXRvbWljTWFzcyI6IDcyLjY0LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNDEsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDMyLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDMyLAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDE0LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogInllcyIsCgkJIlR5cGUiOiAiTWV0YWxsb2lkIiwKCQkiQXRvbWljUmFkaXVzIjogMS41LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMDEsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDcuODk5NCwKCQkiRGVuc2l0eSI6IDUuMzIsCgkJIk1lbHRpbmdQb2ludCI6IDEyMTEuNDUsCgkJIkJvaWxpbmdQb2ludCI6IDMxMDYsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNywKCQkiRGlzY292ZXJlciI6ICJXaW5rbGVyIiwKCQkiWWVhciI6IDE4ODYsCgkJIlNwZWNpZmljSGVhdCI6IDAuMzIsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDEwIDRzMiA0cDIiCgl9LAoJIkFyc2VuaWMiOiB7CgkJIkF0b21pY051bWJlciI6IDMzLAoJCSJTeW1ib2wiOiAiQXMiLAoJCSJBdG9taWNNYXNzIjogNzQuOTIyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNDIsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDMzLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDMzLAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDE1LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogInllcyIsCgkJIlR5cGUiOiAiTWV0YWxsb2lkIiwKCQkiQXRvbWljUmFkaXVzIjogMS4zLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMTgsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDkuNzg4NiwKCQkiRGVuc2l0eSI6IDUuNzgsCgkJIk1lbHRpbmdQb2ludCI6IDEwOTAuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDg4NywKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDE0LAoJCSJEaXNjb3ZlcmVyIjogIkFsYmVydHVzIE1hZ251cyIsCgkJIlllYXIiOiAxMjUwLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjMyOSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA0LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA1LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbQXJdIDNkMTAgNHMyIDRwMyIKCX0sCgkiU2VsZW5pdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDM0LAoJCSJTeW1ib2wiOiAiU2UiLAoJCSJBdG9taWNNYXNzIjogNzguOTYsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA0NSwKCQkiTnVtYmVyb2ZQcm90b25zIjogMzQsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMzQsCgkJIlBlcmlvZCI6IDQsCgkJIkdyb3VwIjogMTYsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiAieWVzIiwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJOb25tZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuMiwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjU1LAoJCSJGaXJzdElvbml6YXRpb24iOiA5Ljc1MjQsCgkJIkRlbnNpdHkiOiA0LjgxLAoJCSJNZWx0aW5nUG9pbnQiOiA0OTQuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDk1OCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDIwLAoJCSJEaXNjb3ZlcmVyIjogIkJlcnplbGl1cyIsCgkJIlllYXIiOiAxODE3LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjMyMSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA0LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA2LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbQXJdIDNkMTAgNHMyIDRwNCIKCX0sCgkiQnJvbWluZSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMzUsCgkJIlN5bWJvbCI6ICJCciIsCgkJIkF0b21pY01hc3MiOiA3OS45MDQsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA0NSwKCQkiTnVtYmVyb2ZQcm90b25zIjogMzUsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMzUsCgkJIlBlcmlvZCI6IDQsCgkJIkdyb3VwIjogMTcsCgkJIlBoYXNlIjogImxpcSIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiSGFsb2dlbiIsCgkJIkF0b21pY1JhZGl1cyI6IDEuMSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjk2LAoJCSJGaXJzdElvbml6YXRpb24iOiAxMS44MTM4LAoJCSJEZW5zaXR5IjogMy4xMiwKCQkiTWVsdGluZ1BvaW50IjogMjY2LjA1LAoJCSJCb2lsaW5nUG9pbnQiOiAzMzIsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxOSwKCQkiRGlzY292ZXJlciI6ICJCYWxhcmQiLAoJCSJZZWFyIjogMTgyNiwKCQkiU3BlY2lmaWNIZWF0IjogMC40NzQsCgkJIk51bWJlcm9mU2hlbGxzIjogNCwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNywKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0FyXSAzZDEwIDRzMiA0cDUiCgl9LAoJIktyeXB0b24iOiB7CgkJIkF0b21pY051bWJlciI6IDM2LAoJCSJTeW1ib2wiOiAiS3IiLAoJCSJBdG9taWNNYXNzIjogODMuNzk4LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNDgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDM2LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDM2LAoJCSJQZXJpb2QiOiA0LAoJCSJHcm91cCI6IDE4LAoJCSJQaGFzZSI6ICJnYXMiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIk5vYmxlIEdhcyIsCgkJIkF0b21pY1JhZGl1cyI6IDEsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogbnVsbCwKCQkiRmlyc3RJb25pemF0aW9uIjogMTMuOTk5NiwKCQkiRGVuc2l0eSI6IDAuMDAzNzMsCgkJIk1lbHRpbmdQb2ludCI6IDExNS45MywKCQkiQm9pbGluZ1BvaW50IjogMTE5LjkzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjMsCgkJIkRpc2NvdmVyZXIiOiAiUmFtc2F5IGFuZCBUcmF2ZXJzIiwKCQkiWWVhciI6IDE4OTgsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjQ4LAoJCSJOdW1iZXJvZlNoZWxscyI6IDQsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDgsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltBcl0gM2QxMCA0czIgNHA2IgoJfSwKCSJSdWJpZGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMzcsCgkJIlN5bWJvbCI6ICJSYiIsCgkJIkF0b21pY01hc3MiOiA4NS40NjgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA0OCwKCQkiTnVtYmVyb2ZQcm90b25zIjogMzcsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMzcsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMSwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFsa2FsaSBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDMsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMC44MiwKCQkiRmlyc3RJb25pemF0aW9uIjogNC4xNzcxLAoJCSJEZW5zaXR5IjogMS41MywKCQkiTWVsdGluZ1BvaW50IjogMzEyLjc5LAoJCSJCb2lsaW5nUG9pbnQiOiA5NjEsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyMCwKCQkiRGlzY292ZXJlciI6ICJCdW5zZW4gYW5kIEtpcmNob2ZmIiwKCQkiWWVhciI6IDE4NjEsCgkJIlNwZWNpZmljSGVhdCI6IDAuMzYzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDEsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNXMxIgoJfSwKCSJTdHJvbnRpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDM4LAoJCSJTeW1ib2wiOiAiU3IiLAoJCSJBdG9taWNNYXNzIjogODcuNjIsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA1MCwKCQkiTnVtYmVyb2ZQcm90b25zIjogMzgsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMzgsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMiwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFsa2FsaW5lIEVhcnRoIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMi41LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDAuOTUsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuNjk0OSwKCQkiRGVuc2l0eSI6IDIuNjQsCgkJIk1lbHRpbmdQb2ludCI6IDEwNDIuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDE2NTUsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxOCwKCQkiRGlzY292ZXJlciI6ICJEYXZ5IiwKCQkiWWVhciI6IDE4MDgsCgkJIlNwZWNpZmljSGVhdCI6IDAuMzAxLAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDIsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNXMyIgoJfSwKCSJZdHRyaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAzOSwKCQkiU3ltYm9sIjogIlkiLAoJCSJBdG9taWNNYXNzIjogODguOTA2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNTAsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDM5LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDM5LAoJCSJQZXJpb2QiOiA1LAoJCSJHcm91cCI6IDMsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2l0aW9uIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMi4zLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMjIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuMjE3MywKCQkiRGVuc2l0eSI6IDQuNDcsCgkJIk1lbHRpbmdQb2ludCI6IDE3OTkuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM2MDksCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyMSwKCQkiRGlzY292ZXJlciI6ICJHYWRvbGluIiwKCQkiWWVhciI6IDE3OTQsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjk4LAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNGQxIDVzMiIKCX0sCgkiWmlyY29uaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA0MCwKCQkiU3ltYm9sIjogIlpyIiwKCQkiQXRvbWljTWFzcyI6IDkxLjIyNCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDUxLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA0MCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA0MCwKCQkiUGVyaW9kIjogNSwKCQkiR3JvdXAiOiA0LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIuMiwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMzLAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjYzMzksCgkJIkRlbnNpdHkiOiA2LjUxLAoJCSJNZWx0aW5nUG9pbnQiOiAyMTI1LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA0NjgyLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjAsCgkJIkRpc2NvdmVyZXIiOiAiS2xhcHJvdGgiLAoJCSJZZWFyIjogMTc4OSwKCQkiU3BlY2lmaWNIZWF0IjogMC4yNzgsCgkJIk51bWJlcm9mU2hlbGxzIjogNSwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0tyXSA0ZDIgNXMyIgoJfSwKCSJOaW9iaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA0MSwKCQkiU3ltYm9sIjogIk5iIiwKCQkiQXRvbWljTWFzcyI6IDkyLjkwNiwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDUyLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA0MSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA0MSwKCQkiUGVyaW9kIjogNSwKCQkiR3JvdXAiOiA1LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIuMSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjYsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNzU4OSwKCQkiRGVuc2l0eSI6IDguNTcsCgkJIk1lbHRpbmdQb2ludCI6IDI3NDEuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDUwMTcsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyNCwKCQkiRGlzY292ZXJlciI6ICJIYXRjaGV0dCIsCgkJIlllYXIiOiAxODAxLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjI2NSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA1LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbS3JdIDRkNCA1czEiCgl9LAoJIk1vbHliZGVudW0iOiB7CgkJIkF0b21pY051bWJlciI6IDQyLAoJCSJTeW1ib2wiOiAiTW8iLAoJCSJBdG9taWNNYXNzIjogOTUuOTYsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA1NCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNDIsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNDIsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogNiwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAyLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMTYsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDcuMDkyNCwKCQkiRGVuc2l0eSI6IDEwLjIsCgkJIk1lbHRpbmdQb2ludCI6IDI4OTAuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDQ5MTIsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyMCwKCQkiRGlzY292ZXJlciI6ICJTY2hlZWxlIiwKCQkiWWVhciI6IDE3NzgsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjUxLAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNGQ1IDVzMSIKCX0sCgkiVGVjaG5ldGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNDMsCgkJIlN5bWJvbCI6ICJUYyIsCgkJIkF0b21pY01hc3MiOiA5OCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDU1LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA0MywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA0MywKCQkiUGVyaW9kIjogNSwKCQkiR3JvdXAiOiA3LAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2l0aW9uIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMiwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjksCgkJIkZpcnN0SW9uaXphdGlvbiI6IDcuMjgsCgkJIkRlbnNpdHkiOiAxMS41LAoJCSJNZWx0aW5nUG9pbnQiOiAyNDczLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA1MTUwLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjMsCgkJIkRpc2NvdmVyZXIiOiAiUGVycmllciBhbmQgU2Vncu+/vSIsCgkJIlllYXIiOiAxOTM3LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNGQ1IDVzMiIKCX0sCgkiUnV0aGVuaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA0NCwKCQkiU3ltYm9sIjogIlJ1IiwKCQkiQXRvbWljTWFzcyI6IDEwMS4wNywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDU3LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA0NCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA0NCwKCQkiUGVyaW9kIjogNSwKCQkiR3JvdXAiOiA4LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDcuMzYwNSwKCQkiRGVuc2l0eSI6IDEyLjQsCgkJIk1lbHRpbmdQb2ludCI6IDI1MjMuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDQ0MjMsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNiwKCQkiRGlzY292ZXJlciI6ICJLbGF1cyIsCgkJIlllYXIiOiAxODQ0LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjIzOCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA1LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbS3JdIDRkNyA1czEiCgl9LAoJIlJob2RpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDQ1LAoJCSJTeW1ib2wiOiAiUmgiLAoJCSJBdG9taWNNYXNzIjogMTAyLjkwNiwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDU4LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA0NSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA0NSwKCQkiUGVyaW9kIjogNSwKCQkiR3JvdXAiOiA5LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjI4LAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjQ1ODksCgkJIkRlbnNpdHkiOiAxMi40LAoJCSJNZWx0aW5nUG9pbnQiOiAyMjM5LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAzOTY4LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjAsCgkJIkRpc2NvdmVyZXIiOiAiV29sbGFzdG9uIiwKCQkiWWVhciI6IDE4MDMsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjQzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNGQ4IDVzMSIKCX0sCgkiUGFsbGFkaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA0NiwKCQkiU3ltYm9sIjogIlBkIiwKCQkiQXRvbWljTWFzcyI6IDEwNi40MiwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDYwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA0NiwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA0NiwKCQkiUGVyaW9kIjogNSwKCQkiR3JvdXAiOiAxMCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjgsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4yLAoJCSJGaXJzdElvbml6YXRpb24iOiA4LjMzNjksCgkJIkRlbnNpdHkiOiAxMiwKCQkiTWVsdGluZ1BvaW50IjogMTgyNS4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzIzNiwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDIxLAoJCSJEaXNjb3ZlcmVyIjogIldvbGxhc3RvbiIsCgkJIlllYXIiOiAxODAzLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjI0NCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA1LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbS3JdIDRkMTAiCgl9LAoJIlNpbHZlciI6IHsKCQkiQXRvbWljTnVtYmVyIjogNDcsCgkJIlN5bWJvbCI6ICJBZyIsCgkJIkF0b21pY01hc3MiOiAxMDcuODY4LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNjEsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDQ3LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDQ3LAoJCSJQZXJpb2QiOiA1LAoJCSJHcm91cCI6IDExLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjkzLAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjU3NjIsCgkJIkRlbnNpdHkiOiAxMC41LAoJCSJNZWx0aW5nUG9pbnQiOiAxMjM0LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAyNDM1LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjcsCgkJIkRpc2NvdmVyZXIiOiAiUHJlaGlzdG9yaWMiLAoJCSJZZWFyIjogbnVsbCwKCQkiU3BlY2lmaWNIZWF0IjogMC4yMzUsCgkJIk51bWJlcm9mU2hlbGxzIjogNSwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0tyXSA0ZDEwIDVzMSIKCX0sCgkiQ2FkbWl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNDgsCgkJIlN5bWJvbCI6ICJDZCIsCgkJIkF0b21pY01hc3MiOiAxMTIuNDExLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNjQsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDQ4LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDQ4LAoJCSJQZXJpb2QiOiA1LAoJCSJHcm91cCI6IDEyLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuNywKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjY5LAoJCSJGaXJzdElvbml6YXRpb24iOiA4Ljk5MzgsCgkJIkRlbnNpdHkiOiA4LjY5LAoJCSJNZWx0aW5nUG9pbnQiOiA1OTQuMzMsCgkJIkJvaWxpbmdQb2ludCI6IDEwNDAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyMiwKCQkiRGlzY292ZXJlciI6ICJTdHJvbWV5ZXIiLAoJCSJZZWFyIjogMTgxNywKCQkiU3BlY2lmaWNIZWF0IjogMC4yMzIsCgkJIk51bWJlcm9mU2hlbGxzIjogNSwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0tyXSA0ZDEwIDVzMiIKCX0sCgkiSW5kaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA0OSwKCQkiU3ltYm9sIjogIkluIiwKCQkiQXRvbWljTWFzcyI6IDExNC44MTgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA2NiwKCQkiTnVtYmVyb2ZQcm90b25zIjogNDksCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNDksCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMTMsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS43OCwKCQkiRmlyc3RJb25pemF0aW9uIjogNS43ODY0LAoJCSJEZW5zaXR5IjogNy4zMSwKCQkiTWVsdGluZ1BvaW50IjogNDI5LjkxLAoJCSJCb2lsaW5nUG9pbnQiOiAyMzQ1LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMzQsCgkJIkRpc2NvdmVyZXIiOiAiUmVpY2ggYW5kIFJpY2h0ZXIiLAoJCSJZZWFyIjogMTg2MywKCQkiU3BlY2lmaWNIZWF0IjogMC4yMzMsCgkJIk51bWJlcm9mU2hlbGxzIjogNSwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogMywKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0tyXSA0ZDEwIDVzMiA1cDEiCgl9LAoJIlRpbiI6IHsKCQkiQXRvbWljTnVtYmVyIjogNTAsCgkJIlN5bWJvbCI6ICJTbiIsCgkJIkF0b21pY01hc3MiOiAxMTguNzEsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA2OSwKCQkiTnVtYmVyb2ZQcm90b25zIjogNTAsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTAsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMTQsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuNywKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjk2LAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjM0MzksCgkJIkRlbnNpdHkiOiA3LjI5LAoJCSJNZWx0aW5nUG9pbnQiOiA1MDUuMjEsCgkJIkJvaWxpbmdQb2ludCI6IDI4NzUsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyOCwKCQkiRGlzY292ZXJlciI6ICJQcmVoaXN0b3JpYyIsCgkJIlllYXIiOiBudWxsLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjIyOCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA1LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA0LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbS3JdIDRkMTAgNXMyIDVwMiIKCX0sCgkiQW50aW1vbnkiOiB7CgkJIkF0b21pY051bWJlciI6IDUxLAoJCSJTeW1ib2wiOiAiU2IiLAoJCSJBdG9taWNNYXNzIjogMTIxLjc2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogNzEsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDUxLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDUxLAoJCSJQZXJpb2QiOiA1LAoJCSJHcm91cCI6IDE1LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogInllcyIsCgkJIlR5cGUiOiAiTWV0YWxsb2lkIiwKCQkiQXRvbWljUmFkaXVzIjogMS41LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMDUsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDguNjA4NCwKCQkiRGVuc2l0eSI6IDYuNjksCgkJIk1lbHRpbmdQb2ludCI6IDkwNC4wNSwKCQkiQm9pbGluZ1BvaW50IjogMTg2MCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDI5LAoJCSJEaXNjb3ZlcmVyIjogIkVhcmx5IGhpc3RvcmljIHRpbWVzIiwKCQkiWWVhciI6IG51bGwsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjA3LAoJCSJOdW1iZXJvZlNoZWxscyI6IDUsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDUsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltLcl0gNGQxMCA1czIgNXAzIgoJfSwKCSJUZWxsdXJpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDUyLAoJCSJTeW1ib2wiOiAiVGUiLAoJCSJBdG9taWNNYXNzIjogMTI3LjYsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA3NiwKCQkiTnVtYmVyb2ZQcm90b25zIjogNTIsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTIsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMTYsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiAieWVzIiwKCQkiVHlwZSI6ICJNZXRhbGxvaWQiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjQsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4xLAoJCSJGaXJzdElvbml6YXRpb24iOiA5LjAwOTYsCgkJIkRlbnNpdHkiOiA2LjIzLAoJCSJNZWx0aW5nUG9pbnQiOiA3MjIuOCwKCQkiQm9pbGluZ1BvaW50IjogMTI2MSwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDI5LAoJCSJEaXNjb3ZlcmVyIjogInZvbiBSZWljaGVuc3RlaW4iLAoJCSJZZWFyIjogMTc4MiwKCQkiU3BlY2lmaWNIZWF0IjogMC4yMDIsCgkJIk51bWJlcm9mU2hlbGxzIjogNSwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNiwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0tyXSA0ZDEwIDVzMiA1cDQiCgl9LAoJIklvZGluZSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNTMsCgkJIlN5bWJvbCI6ICJJIiwKCQkiQXRvbWljTWFzcyI6IDEyNi45MDQsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA3NCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNTMsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTMsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMTcsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiAieWVzIiwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJIYWxvZ2VuIiwKCQkiQXRvbWljUmFkaXVzIjogMS4zLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuNjYsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDEwLjQ1MTMsCgkJIkRlbnNpdHkiOiA0LjkzLAoJCSJNZWx0aW5nUG9pbnQiOiAzODYuNjUsCgkJIkJvaWxpbmdQb2ludCI6IDQ1Ny40LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjQsCgkJIkRpc2NvdmVyZXIiOiAiQ291cnRvaXMiLAoJCSJZZWFyIjogMTgxMSwKCQkiU3BlY2lmaWNIZWF0IjogMC4yMTQsCgkJIk51bWJlcm9mU2hlbGxzIjogNSwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNywKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW0tyXSA0ZDEwIDVzMiA1cDUiCgl9LAoJIlhlbm9uIjogewoJCSJBdG9taWNOdW1iZXIiOiA1NCwKCQkiU3ltYm9sIjogIlhlIiwKCQkiQXRvbWljTWFzcyI6IDEzMS4yOTMsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA3NywKCQkiTnVtYmVyb2ZQcm90b25zIjogNTQsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTQsCgkJIlBlcmlvZCI6IDUsCgkJIkdyb3VwIjogMTgsCgkJIlBoYXNlIjogImdhcyIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTm9ibGUgR2FzIiwKCQkiQXRvbWljUmFkaXVzIjogMS4yLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDEyLjEyOTgsCgkJIkRlbnNpdHkiOiAwLjAwNTg5LAoJCSJNZWx0aW5nUG9pbnQiOiAxNjEuNDUsCgkJIkJvaWxpbmdQb2ludCI6IDE2NS4wMywKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDMxLAoJCSJEaXNjb3ZlcmVyIjogIlJhbXNheSBhbmQgVHJhdmVycyIsCgkJIlllYXIiOiAxODk4LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjE1OCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA1LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA4LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbS3JdIDRkMTAgNXMyIDVwNiIKCX0sCgkiQ2VzaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA1NSwKCQkiU3ltYm9sIjogIkNzIiwKCQkiQXRvbWljTWFzcyI6IDEzMi45MDUsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA3OCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNTUsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTUsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogMSwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFsa2FsaSBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDMuMywKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAwLjc5LAoJCSJGaXJzdElvbml6YXRpb24iOiAzLjg5MzksCgkJIkRlbnNpdHkiOiAxLjg3LAoJCSJNZWx0aW5nUG9pbnQiOiAzMDEuNywKCQkiQm9pbGluZ1BvaW50IjogOTQ0LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjIsCgkJIkRpc2NvdmVyZXIiOiAiQnVuc2VuIGFuZCBLaXJjaG9mZiIsCgkJIlllYXIiOiAxODYwLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjI0MiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAxLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDZzMSIKCX0sCgkiQmFyaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA1NiwKCQkiU3ltYm9sIjogIkJhIiwKCQkiQXRvbWljTWFzcyI6IDEzNy4zMjcsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA4MSwKCQkiTnVtYmVyb2ZQcm90b25zIjogNTYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTYsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogMiwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFsa2FsaW5lIEVhcnRoIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMi44LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDAuODksCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuMjExNywKCQkiRGVuc2l0eSI6IDMuNTksCgkJIk1lbHRpbmdQb2ludCI6IDEwMDIuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDIxNzAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyNSwKCQkiRGlzY292ZXJlciI6ICJEYXZ5IiwKCQkiWWVhciI6IDE4MDgsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjA0LAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDIsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNnMyIgoJfSwKCSJMYW50aGFudW0iOiB7CgkJIkF0b21pY051bWJlciI6IDU3LAoJCSJTeW1ib2wiOiAiTGEiLAoJCSJBdG9taWNNYXNzIjogMTM4LjkwNSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDgyLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA1NywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA1NywKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiAzLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTGFudGhhbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IDIuNywKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjEsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuNTc2OSwKCQkiRGVuc2l0eSI6IDYuMTUsCgkJIk1lbHRpbmdQb2ludCI6IDExOTMuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM3MzcsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxOSwKCQkiRGlzY292ZXJlciI6ICJNb3NhbmRlciIsCgkJIlllYXIiOiAxODM5LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjE5NSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDVkMSA2czIiCgl9LAoJIkNlcml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNTgsCgkJIlN5bWJvbCI6ICJDZSIsCgkJIkF0b21pY01hc3MiOiAxNDAuMTE2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogODIsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDU4LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDU4LAoJCSJQZXJpb2QiOiA2LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJMYW50aGFuaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogMi43LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMTIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuNTM4NywKCQkiRGVuc2l0eSI6IDYuNzcsCgkJIk1lbHRpbmdQb2ludCI6IDEwNzEuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM3MTYsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxOSwKCQkiRGlzY292ZXJlciI6ICJCZXJ6ZWxpdXMiLAoJCSJZZWFyIjogMTgwMywKCQkiU3BlY2lmaWNIZWF0IjogMC4xOTIsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjEgNWQxIDZzMiIKCX0sCgkiUHJhc2VvZHltaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA1OSwKCQkiU3ltYm9sIjogIlByIiwKCQkiQXRvbWljTWFzcyI6IDE0MC45MDgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA4MiwKCQkiTnVtYmVyb2ZQcm90b25zIjogNTksCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNTksCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjcsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4xMywKCQkiRmlyc3RJb25pemF0aW9uIjogNS40NzMsCgkJIkRlbnNpdHkiOiA2Ljc3LAoJCSJNZWx0aW5nUG9pbnQiOiAxMjA0LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAzNzkzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTUsCgkJIkRpc2NvdmVyZXIiOiAidm9uIFdlbHNiYWNoIiwKCQkiWWVhciI6IDE4ODUsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTkzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYzIDZzMiIKCX0sCgkiTmVvZHltaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA2MCwKCQkiU3ltYm9sIjogIk5kIiwKCQkiQXRvbWljTWFzcyI6IDE0NC4yNDIsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA4NCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNjAsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNjAsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjYsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4xNCwKCQkiRmlyc3RJb25pemF0aW9uIjogNS41MjUsCgkJIkRlbnNpdHkiOiA3LjAxLAoJCSJNZWx0aW5nUG9pbnQiOiAxMjg5LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAzMzQ3LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTYsCgkJIkRpc2NvdmVyZXIiOiAidm9uIFdlbHNiYWNoIiwKCQkiWWVhciI6IDE4ODUsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTksCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjQgNnMyIgoJfSwKCSJQcm9tZXRoaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA2MSwKCQkiU3ltYm9sIjogIlBtIiwKCQkiQXRvbWljTWFzcyI6IDE0NSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDg0LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA2MSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA2MSwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiBudWxsLAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJMYW50aGFuaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogMi42LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMTMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuNTgyLAoJCSJEZW5zaXR5IjogNy4yNiwKCQkiTWVsdGluZ1BvaW50IjogMTIwNC4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzI3MywKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDE0LAoJCSJEaXNjb3ZlcmVyIjogIk1hcmluc2t5IGV0IGFsLiIsCgkJIlllYXIiOiAxOTQ1LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGY1IDZzMiIKCX0sCgkiU2FtYXJpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDYyLAoJCSJTeW1ib2wiOiAiU20iLAoJCSJBdG9taWNNYXNzIjogMTUwLjM2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogODgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDYyLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDYyLAoJCSJQZXJpb2QiOiA2LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJMYW50aGFuaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogMi42LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMTcsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuNjQzNywKCQkiRGVuc2l0eSI6IDcuNTIsCgkJIk1lbHRpbmdQb2ludCI6IDEzNDUuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDIwNjcsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNywKCQkiRGlzY292ZXJlciI6ICJCb2lzYmF1ZHJhbiIsCgkJIlllYXIiOiAxODc5LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjE5NywKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmNiA2czIiCgl9LAoJIkV1cm9waXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA2MywKCQkiU3ltYm9sIjogIkV1IiwKCQkiQXRvbWljTWFzcyI6IDE1MS45NjQsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA4OSwKCQkiTnVtYmVyb2ZQcm90b25zIjogNjMsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNjMsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjYsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4yLAoJCSJGaXJzdElvbml6YXRpb24iOiA1LjY3MDQsCgkJIkRlbnNpdHkiOiA1LjI0LAoJCSJNZWx0aW5nUG9pbnQiOiAxMDk1LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAxODAyLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjEsCgkJIkRpc2NvdmVyZXIiOiAiRGVtYXJjYXkiLAoJCSJZZWFyIjogMTkwMSwKCQkiU3BlY2lmaWNIZWF0IjogMC4xODIsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjcgNnMyIgoJfSwKCSJHYWRvbGluaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA2NCwKCQkiU3ltYm9sIjogIkdkIiwKCQkiQXRvbWljTWFzcyI6IDE1Ny4yNSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDkzLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA2NCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA2NCwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiBudWxsLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTGFudGhhbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IDIuNSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuMTUwMSwKCQkiRGVuc2l0eSI6IDcuOSwKCQkiTWVsdGluZ1BvaW50IjogMTU4NS4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzU0NiwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDE3LAoJCSJEaXNjb3ZlcmVyIjogImRlIE1hcmlnbmFjIiwKCQkiWWVhciI6IDE4ODAsCgkJIlNwZWNpZmljSGVhdCI6IDAuMjM2LAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGY3IDVkMSA2czIiCgl9LAoJIlRlcmJpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDY1LAoJCSJTeW1ib2wiOiAiVGIiLAoJCSJBdG9taWNNYXNzIjogMTU4LjkyNSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDk0LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA2NSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA2NSwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiBudWxsLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTGFudGhhbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IDIuNSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjIsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuODYzOCwKCQkiRGVuc2l0eSI6IDguMjMsCgkJIk1lbHRpbmdQb2ludCI6IDE2MzAuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM1MDMsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyNCwKCQkiRGlzY292ZXJlciI6ICJNb3NhbmRlciIsCgkJIlllYXIiOiAxODQzLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjE4MiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmOSA2czIiCgl9LAoJIkR5c3Byb3NpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDY2LAoJCSJTeW1ib2wiOiAiRHkiLAoJCSJBdG9taWNNYXNzIjogMTYyLjUsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA5NywKCQkiTnVtYmVyb2ZQcm90b25zIjogNjYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNjYsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjUsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4yMiwKCQkiRmlyc3RJb25pemF0aW9uIjogNS45Mzg5LAoJCSJEZW5zaXR5IjogOC41NSwKCQkiTWVsdGluZ1BvaW50IjogMTY4MC4xNSwKCQkiQm9pbGluZ1BvaW50IjogMjg0MCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDIxLAoJCSJEaXNjb3ZlcmVyIjogImRlIEJvaXNiYXVkcmFuIiwKCQkiWWVhciI6IDE4ODYsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTcsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjEwIDZzMiIKCX0sCgkiSG9sbWl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNjcsCgkJIlN5bWJvbCI6ICJIbyIsCgkJIkF0b21pY01hc3MiOiAxNjQuOTMsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiA5OCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNjcsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNjcsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjUsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4yMywKCQkiRmlyc3RJb25pemF0aW9uIjogNi4wMjE1LAoJCSJEZW5zaXR5IjogOC44LAoJCSJNZWx0aW5nUG9pbnQiOiAxNzQzLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAyOTkzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjksCgkJIkRpc2NvdmVyZXIiOiAiRGVsYWZvbnRhaW5lIGFuZCBTb3JldCIsCgkJIlllYXIiOiAxODc4LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjE2NSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmMTEgNnMyIgoJfSwKCSJFcmJpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDY4LAoJCSJTeW1ib2wiOiAiRXIiLAoJCSJBdG9taWNNYXNzIjogMTY3LjI1OSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDk5LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA2OCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA2OCwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiBudWxsLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTGFudGhhbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IDIuNSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjI0LAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjEwNzcsCgkJIkRlbnNpdHkiOiA5LjA3LAoJCSJNZWx0aW5nUG9pbnQiOiAxNzk1LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAzNTAzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTYsCgkJIkRpc2NvdmVyZXIiOiAiTW9zYW5kZXIiLAoJCSJZZWFyIjogMTg0MywKCQkiU3BlY2lmaWNIZWF0IjogMC4xNjgsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjEyIDZzMiIKCX0sCgkiVGh1bGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNjksCgkJIlN5bWJvbCI6ICJUbSIsCgkJIkF0b21pY01hc3MiOiAxNjguOTM0LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTAwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA2OSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA2OSwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiBudWxsLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTGFudGhhbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IDIuNCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjI1LAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjE4NDMsCgkJIkRlbnNpdHkiOiA5LjMyLAoJCSJNZWx0aW5nUG9pbnQiOiAxODE4LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAyMjIzLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTgsCgkJIkRpc2NvdmVyZXIiOiAiQ2xldmUiLAoJCSJZZWFyIjogMTg3OSwKCQkiU3BlY2lmaWNIZWF0IjogMC4xNiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmMTMgNnMyIgoJfSwKCSJZdHRlcmJpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDcwLAoJCSJTeW1ib2wiOiAiWWIiLAoJCSJBdG9taWNNYXNzIjogMTczLjA1NCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEwMywKCQkiTnVtYmVyb2ZQcm90b25zIjogNzAsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNzAsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjQsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4xLAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjI1NDIsCgkJIkRlbnNpdHkiOiA2Ljk3LAoJCSJNZWx0aW5nUG9pbnQiOiAxMDk3LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAxNDY5LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTYsCgkJIkRpc2NvdmVyZXIiOiAiTWFyaWduYWMiLAoJCSJZZWFyIjogMTg3OCwKCQkiU3BlY2lmaWNIZWF0IjogMC4xNTUsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjE0IDZzMiIKCX0sCgkiTHV0ZXRpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDcxLAoJCSJTeW1ib2wiOiAiTHUiLAoJCSJBdG9taWNNYXNzIjogMTc0Ljk2NywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEwNCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNzEsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNzEsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkxhbnRoYW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjMsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4yNywKCQkiRmlyc3RJb25pemF0aW9uIjogNS40MjU5LAoJCSJEZW5zaXR5IjogOS44NCwKCQkiTWVsdGluZ1BvaW50IjogMTkzNi4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzY3NSwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDIyLAoJCSJEaXNjb3ZlcmVyIjogIlVyYmFpbi8gdm9uIFdlbHNiYWNoIiwKCQkiWWVhciI6IDE5MDcsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTU0LAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDEgNnMyIgoJfSwKCSJIYWZuaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA3MiwKCQkiU3ltYm9sIjogIkhmIiwKCQkiQXRvbWljTWFzcyI6IDE3OC40OSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEwNiwKCQkiTnVtYmVyb2ZQcm90b25zIjogNzIsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNzIsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogNCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAyLjIsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4zLAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjgyNTEsCgkJIkRlbnNpdHkiOiAxMy4zLAoJCSJNZWx0aW5nUG9pbnQiOiAyNTAwLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA0ODc2LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTcsCgkJIkRpc2NvdmVyZXIiOiAiQ29zdGVyIGFuZCB2b24gSGV2ZXN5IiwKCQkiWWVhciI6IDE5MjMsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTQ0LAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDIgNnMyIgoJfSwKCSJUYW50YWx1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNzMsCgkJIlN5bWJvbCI6ICJUYSIsCgkJIkF0b21pY01hc3MiOiAxODAuOTQ4LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTA4LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA3MywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA3MywKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiA1LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIuMSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjUsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDcuNTQ5NiwKCQkiRGVuc2l0eSI6IDE2LjcsCgkJIk1lbHRpbmdQb2ludCI6IDMyNjkuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDU3MzEsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxOSwKCQkiRGlzY292ZXJlciI6ICJFa2ViZXJnIiwKCQkiWWVhciI6IDE4MDEsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTQsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjE0IDVkMyA2czIiCgl9LAoJIlR1bmdzdGVuIjogewoJCSJBdG9taWNOdW1iZXIiOiA3NCwKCQkiU3ltYm9sIjogIlciLAoJCSJBdG9taWNNYXNzIjogMTgzLjg0LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTEwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA3NCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA3NCwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiA2LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4zNiwKCQkiRmlyc3RJb25pemF0aW9uIjogNy44NjQsCgkJIkRlbnNpdHkiOiAxOS4zLAoJCSJNZWx0aW5nUG9pbnQiOiAzNjgwLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA1ODI4LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjIsCgkJIkRpc2NvdmVyZXIiOiAiSi4gYW5kIEYuIGQnRWxodXlhciIsCgkJIlllYXIiOiAxNzgzLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjEzMiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmMTQgNWQ0IDZzMiIKCX0sCgkiUmhlbml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogNzUsCgkJIlN5bWJvbCI6ICJSZSIsCgkJIkF0b21pY01hc3MiOiAxODYuMjA3LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTExLAoJCSJOdW1iZXJvZlByb3RvbnMiOiA3NSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA3NSwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiA3LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS45LAoJCSJGaXJzdElvbml6YXRpb24iOiA3LjgzMzUsCgkJIkRlbnNpdHkiOiAyMSwKCQkiTWVsdGluZ1BvaW50IjogMzQ1My4xNSwKCQkiQm9pbGluZ1BvaW50IjogNTg2OSwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDIxLAoJCSJEaXNjb3ZlcmVyIjogIk5vZGRhY2ssIEJlcmcsIGFuZCBUYWNrZSIsCgkJIlllYXIiOiAxOTI1LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjEzNywKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmMTQgNWQ1IDZzMiIKCX0sCgkiT3NtaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA3NiwKCQkiU3ltYm9sIjogIk9zIiwKCQkiQXRvbWljTWFzcyI6IDE5MC4yMywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDExNCwKCQkiTnVtYmVyb2ZQcm90b25zIjogNzYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNzYsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogOCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6IG51bGwsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zaXRpb24gTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjksCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4yLAoJCSJGaXJzdElvbml6YXRpb24iOiA4LjQzODIsCgkJIkRlbnNpdHkiOiAyMi42LAoJCSJNZWx0aW5nUG9pbnQiOiAzMzAwLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA1Mjg1LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTksCgkJIkRpc2NvdmVyZXIiOiAiVGVubmFudCIsCgkJIlllYXIiOiAxODAzLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjEzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDYgNnMyIgoJfSwKCSJJcmlkaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA3NywKCQkiU3ltYm9sIjogIklyIiwKCQkiQXRvbWljTWFzcyI6IDE5Mi4yMTcsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxMTUsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDc3LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDc3LAoJCSJQZXJpb2QiOiA2LAoJCSJHcm91cCI6IDksCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2l0aW9uIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMS45LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMiwKCQkiRmlyc3RJb25pemF0aW9uIjogOC45NjcsCgkJIkRlbnNpdHkiOiAyMi42LAoJCSJNZWx0aW5nUG9pbnQiOiAyNzE2LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA0NzAxLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjUsCgkJIkRpc2NvdmVyZXIiOiAiVGVubmFudCIsCgkJIlllYXIiOiAxODA0LAoJCSJTcGVjaWZpY0hlYXQiOiAwLjEzMSwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmMTQgNWQ3IDZzMiIKCX0sCgkiUGxhdGludW0iOiB7CgkJIkF0b21pY051bWJlciI6IDc4LAoJCSJTeW1ib2wiOiAiUHQiLAoJCSJBdG9taWNNYXNzIjogMTk1LjA4NCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDExNywKCQkiTnVtYmVyb2ZQcm90b25zIjogNzgsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogNzgsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogMTAsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2l0aW9uIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMS44LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMjgsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDguOTU4NywKCQkiRGVuc2l0eSI6IDIxLjUsCgkJIk1lbHRpbmdQb2ludCI6IDIwNDUuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDQwOTgsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAzMiwKCQkiRGlzY292ZXJlciI6ICJVbGxvYS9Xb29kIiwKCQkiWWVhciI6IDE3MzUsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTMzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDkgNnMxIgoJfSwKCSJHb2xkIjogewoJCSJBdG9taWNOdW1iZXIiOiA3OSwKCQkiU3ltYm9sIjogIkF1IiwKCQkiQXRvbWljTWFzcyI6IDE5Ni45NjcsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxMTgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDc5LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDc5LAoJCSJQZXJpb2QiOiA2LAoJCSJHcm91cCI6IDExLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjU0LAoJCSJGaXJzdElvbml6YXRpb24iOiA5LjIyNTUsCgkJIkRlbnNpdHkiOiAxOS4zLAoJCSJNZWx0aW5nUG9pbnQiOiAxMzM3LjczLAoJCSJCb2lsaW5nUG9pbnQiOiAzMTI5LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjEsCgkJIkRpc2NvdmVyZXIiOiAiUHJlaGlzdG9yaWMiLAoJCSJZZWFyIjogbnVsbCwKCQkiU3BlY2lmaWNIZWF0IjogMC4xMjksCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjE0IDVkMTAgNnMxIgoJfSwKCSJNZXJjdXJ5IjogewoJCSJBdG9taWNOdW1iZXIiOiA4MCwKCQkiU3ltYm9sIjogIkhnIiwKCQkiQXRvbWljTWFzcyI6IDIwMC41OSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEyMSwKCQkiTnVtYmVyb2ZQcm90b25zIjogODAsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogODAsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogMTIsCgkJIlBoYXNlIjogImxpcSIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNpdGlvbiBNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDEuOCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLAoJCSJGaXJzdElvbml6YXRpb24iOiAxMC40Mzc1LAoJCSJEZW5zaXR5IjogMTMuNSwKCQkiTWVsdGluZ1BvaW50IjogMjM0LjQzLAoJCSJCb2lsaW5nUG9pbnQiOiA2MzAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyNiwKCQkiRGlzY292ZXJlciI6ICJQcmVoaXN0b3JpYyIsCgkJIlllYXIiOiBudWxsLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjE0LAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDEwIDZzMiIKCX0sCgkiVGhhbGxpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDgxLAoJCSJTeW1ib2wiOiAiVGwiLAoJCSJBdG9taWNNYXNzIjogMjA0LjM4MywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEyMywKCQkiTnVtYmVyb2ZQcm90b25zIjogODEsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogODEsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogMTMsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiBudWxsLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJNZXRhbCIsCgkJIkF0b21pY1JhZGl1cyI6IDIuMSwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAyLjA0LAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjEwODIsCgkJIkRlbnNpdHkiOiAxMS45LAoJCSJNZWx0aW5nUG9pbnQiOiA1NzcuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDE3NDYsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyOCwKCQkiRGlzY292ZXJlciI6ICJDcm9va2VzIiwKCQkiWWVhciI6IDE4NjEsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTI5LAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDMsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDEwIDZzMiA2cDEiCgl9LAoJIkxlYWQiOiB7CgkJIkF0b21pY051bWJlciI6IDgyLAoJCSJTeW1ib2wiOiAiUGIiLAoJCSJBdG9taWNNYXNzIjogMjA3LjIsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxMjUsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDgyLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDgyLAoJCSJQZXJpb2QiOiA2LAoJCSJHcm91cCI6IDE0LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjgsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4zMywKCQkiRmlyc3RJb25pemF0aW9uIjogNy40MTY3LAoJCSJEZW5zaXR5IjogMTEuMywKCQkiTWVsdGluZ1BvaW50IjogNjAwLjc1LAoJCSJCb2lsaW5nUG9pbnQiOiAyMDIyLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjksCgkJIkRpc2NvdmVyZXIiOiAiUHJlaGlzdG9yaWMiLAoJCSJZZWFyIjogbnVsbCwKCQkiU3BlY2lmaWNIZWF0IjogMC4xMjksCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjE0IDVkMTAgNnMyIDZwMiIKCX0sCgkiQmlzbXV0aCI6IHsKCQkiQXRvbWljTnVtYmVyIjogODMsCgkJIlN5bWJvbCI6ICJCaSIsCgkJIkF0b21pY01hc3MiOiAyMDguOTgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxMjYsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDgzLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDgzLAoJCSJQZXJpb2QiOiA2LAoJCSJHcm91cCI6IDE1LAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogbnVsbCwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjYsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMi4wMiwKCQkiRmlyc3RJb25pemF0aW9uIjogNy4yODU2LAoJCSJEZW5zaXR5IjogOS44MSwKCQkiTWVsdGluZ1BvaW50IjogNTQ0LjY3LAoJCSJCb2lsaW5nUG9pbnQiOiAxODM3LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTksCgkJIkRpc2NvdmVyZXIiOiAiR2VvZmZyb3kgdGhlIFlvdW5nZXIiLAoJCSJZZWFyIjogMTc1MywKCQkiU3BlY2lmaWNIZWF0IjogMC4xMjIsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNSwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjE0IDVkMTAgNnMyIDZwMyIKCX0sCgkiUG9sb25pdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDg0LAoJCSJTeW1ib2wiOiAiUG8iLAoJCSJBdG9taWNNYXNzIjogMjEwLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTI2LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA4NCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA4NCwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiAxNiwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogbnVsbCwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiAieWVzIiwKCQkiVHlwZSI6ICJNZXRhbGxvaWQiLAoJCSJBdG9taWNSYWRpdXMiOiAxLjUsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMiwKCQkiRmlyc3RJb25pemF0aW9uIjogOC40MTcsCgkJIkRlbnNpdHkiOiA5LjMyLAoJCSJNZWx0aW5nUG9pbnQiOiA1MjcuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDEyMzUsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAzNCwKCQkiRGlzY292ZXJlciI6ICJDdXJpZSIsCgkJIlllYXIiOiAxODk4LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDYsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDYsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltYZV0gNGYxNCA1ZDEwIDZzMiA2cDQiCgl9LAoJIkFzdGF0aW5lIjogewoJCSJBdG9taWNOdW1iZXIiOiA4NSwKCQkiU3ltYm9sIjogIkF0IiwKCQkiQXRvbWljTWFzcyI6IDIxMCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDEyNSwKCQkiTnVtYmVyb2ZQcm90b25zIjogODUsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogODUsCgkJIlBlcmlvZCI6IDYsCgkJIkdyb3VwIjogMTcsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTm9ibGUgR2FzIiwKCQkiQXRvbWljUmFkaXVzIjogMS40LAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDIuMiwKCQkiRmlyc3RJb25pemF0aW9uIjogOS4zLAoJCSJEZW5zaXR5IjogNywKCQkiTWVsdGluZ1BvaW50IjogNTc1LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA2MTAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyMSwKCQkiRGlzY292ZXJlciI6ICJDb3Jzb24gZXQgYWwuIiwKCQkiWWVhciI6IDE5NDAsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNiwKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNywKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1hlXSA0ZjE0IDVkMTAgNnMyIDZwNSIKCX0sCgkiUmFkb24iOiB7CgkJIkF0b21pY051bWJlciI6IDg2LAoJCSJTeW1ib2wiOiAiUm4iLAoJCSJBdG9taWNNYXNzIjogMjIyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTM2LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA4NiwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA4NiwKCQkiUGVyaW9kIjogNiwKCQkiR3JvdXAiOiAxOCwKCQkiUGhhc2UiOiAiZ2FzIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWxrYWxpIE1ldGFsIiwKCQkiQXRvbWljUmFkaXVzIjogMS4zLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDEwLjc0ODUsCgkJIkRlbnNpdHkiOiAwLjAwOTczLAoJCSJNZWx0aW5nUG9pbnQiOiAyMDIuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDIxMS4zLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjAsCgkJIkRpc2NvdmVyZXIiOiAiRG9ybiIsCgkJIlllYXIiOiAxOTAwLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjA5NCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA2LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA4LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbWGVdIDRmMTQgNWQxMCA2czIgNnA2IgoJfSwKCSJGcmFuY2l1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogODcsCgkJIlN5bWJvbCI6ICJGciIsCgkJIkF0b21pY01hc3MiOiAyMjMsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxMzYsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDg3LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDg3LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDEsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWxrYWxpbmUgRWFydGggTWV0YWwiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDAuNywKCQkiRmlyc3RJb25pemF0aW9uIjogNC4wNzI3LAoJCSJEZW5zaXR5IjogMS44NywKCQkiTWVsdGluZ1BvaW50IjogMzAwLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA5NTAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAyMSwKCQkiRGlzY292ZXJlciI6ICJQZXJleSIsCgkJIlllYXIiOiAxOTM5LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDEsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gN3MxIgoJfSwKCSJSYWRpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDg4LAoJCSJTeW1ib2wiOiAiUmEiLAoJCSJBdG9taWNNYXNzIjogMjI2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTM4LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA4OCwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA4OCwKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiAyLAoJCSJQaGFzZSI6ICJzb2xpZCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiAieWVzIiwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAwLjksCgkJIkZpcnN0SW9uaXphdGlvbiI6IDUuMjc4NCwKCQkiRGVuc2l0eSI6IDUuNSwKCQkiTWVsdGluZ1BvaW50IjogOTczLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiAyMDEwLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTUsCgkJIkRpc2NvdmVyZXIiOiAiUGllcnJlIGFuZCBNYXJpZSBDdXJpZSIsCgkJIlllYXIiOiAxODk4LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IDIsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gN3MyIgoJfSwKCSJBY3Rpbml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogODksCgkJIlN5bWJvbCI6ICJBYyIsCgkJIkF0b21pY01hc3MiOiAyMjcsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxMzgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDg5LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDg5LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDMsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMSwKCQkiRmlyc3RJb25pemF0aW9uIjogNS4xNywKCQkiRGVuc2l0eSI6IDEwLjEsCgkJIk1lbHRpbmdQb2ludCI6IDEzMjMuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDM0NzEsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxMSwKCQkiRGlzY292ZXJlciI6ICJEZWJpZXJuZS9HaWVzZWwiLAoJCSJZZWFyIjogMTg5OSwKCQkiU3BlY2lmaWNIZWF0IjogMC4xMiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDZkMSA3czIiCgl9LAoJIlRob3JpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDkwLAoJCSJTeW1ib2wiOiAiVGgiLAoJCSJBdG9taWNNYXNzIjogMjMyLjAzOCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE0MiwKCQkiTnVtYmVyb2ZQcm90b25zIjogOTAsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogOTAsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAic29saWQiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogInllcyIsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJBY3RpbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IG51bGwsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4zLAoJCSJGaXJzdElvbml6YXRpb24iOiA2LjMwNjcsCgkJIkRlbnNpdHkiOiAxMS43LAoJCSJNZWx0aW5nUG9pbnQiOiAyMDI4LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA1MDYxLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTIsCgkJIkRpc2NvdmVyZXIiOiAiQmVyemVsaXVzIiwKCQkiWWVhciI6IDE4MjgsCgkJIlNwZWNpZmljSGVhdCI6IDAuMTEzLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gNmQyIDdzMiIKCX0sCgkiUHJvdGFjdGluaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA5MSwKCQkiU3ltYm9sIjogIlBhIiwKCQkiQXRvbWljTWFzcyI6IDIzMS4wMzYsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNDAsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDkxLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDkxLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuNSwKCQkiRmlyc3RJb25pemF0aW9uIjogNS44OSwKCQkiRGVuc2l0eSI6IDE1LjQsCgkJIk1lbHRpbmdQb2ludCI6IDE4NzMuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDQzMDAsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxNCwKCQkiRGlzY292ZXJlciI6ICJIYWhuIGFuZCBNZWl0bmVyIiwKCQkiWWVhciI6IDE5MTcsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjIgNmQxIDdzMiIKCX0sCgkiVXJhbml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogOTIsCgkJIlN5bWJvbCI6ICJVIiwKCQkiQXRvbWljTWFzcyI6IDIzOC4wMjksCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNDYsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDkyLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDkyLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogInNvbGlkIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6ICJ5ZXMiLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMzgsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuMTk0MSwKCQkiRGVuc2l0eSI6IDE5LAoJCSJNZWx0aW5nUG9pbnQiOiAxNDA1LjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA0NDA0LAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTUsCgkJIkRpc2NvdmVyZXIiOiAiUGVsaWdvdCIsCgkJIlllYXIiOiAxODQxLAoJCSJTcGVjaWZpY0hlYXQiOiAwLjExNiwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMyA2ZDEgN3MyIgoJfSwKCSJOZXB0dW5pdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDkzLAoJCSJTeW1ib2wiOiAiTnAiLAoJCSJBdG9taWNNYXNzIjogMjM3LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTQ0LAoJCSJOdW1iZXJvZlByb3RvbnMiOiA5MywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiA5MywKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiBudWxsLAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJBY3RpbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IG51bGwsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogMS4zNiwKCQkiRmlyc3RJb25pemF0aW9uIjogNi4yNjU3LAoJCSJEZW5zaXR5IjogMjAuNSwKCQkiTWVsdGluZ1BvaW50IjogOTEzLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiA0MjczLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTUzLAoJCSJEaXNjb3ZlcmVyIjogIk1jTWlsbGFuIGFuZCBBYmVsc29uIiwKCQkiWWVhciI6IDE5NDAsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjQgNmQxIDdzMiIKCX0sCgkiUGx1dG9uaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA5NCwKCQkiU3ltYm9sIjogIlB1IiwKCQkiQXRvbWljTWFzcyI6IDI0NCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE1MCwKCQkiTnVtYmVyb2ZQcm90b25zIjogOTQsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogOTQsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMjgsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuMDI2MiwKCQkiRGVuc2l0eSI6IDE5LjgsCgkJIk1lbHRpbmdQb2ludCI6IDkxMy4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzUwMSwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDE2MywKCQkiRGlzY292ZXJlciI6ICJTZWFib3JnIGV0IGFsLiIsCgkJIlllYXIiOiAxOTQwLAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gNWY2IDdzMiIKCX0sCgkiQW1lcmljaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA5NSwKCQkiU3ltYm9sIjogIkFtIiwKCQkiQXRvbWljTWFzcyI6IDI0MywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE0OCwKCQkiTnVtYmVyb2ZQcm90b25zIjogOTUsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogOTUsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMywKCQkiRmlyc3RJb25pemF0aW9uIjogNS45NzM4LAoJCSJEZW5zaXR5IjogMTMuNywKCQkiTWVsdGluZ1BvaW50IjogMTI2Ny4xNSwKCQkiQm9pbGluZ1BvaW50IjogMjg4MCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDEzMywKCQkiRGlzY292ZXJlciI6ICJTZWFib3JnIGV0IGFsLiIsCgkJIlllYXIiOiAxOTQ0LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gNWY3IDdzMiIKCX0sCgkiQ3VyaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiA5NiwKCQkiU3ltYm9sIjogIkNtIiwKCQkiQXRvbWljTWFzcyI6IDI0NywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE1MSwKCQkiTnVtYmVyb2ZQcm90b25zIjogOTYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogOTYsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IDEuMywKCQkiRmlyc3RJb25pemF0aW9uIjogNS45OTE1LAoJCSJEZW5zaXR5IjogMTMuNSwKCQkiTWVsdGluZ1BvaW50IjogMTM0MC4xNSwKCQkiQm9pbGluZ1BvaW50IjogMzM4MywKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDEzMywKCQkiRGlzY292ZXJlciI6ICJTZWFib3JnIGV0IGFsLiIsCgkJIlllYXIiOiAxOTQ0LAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gNWY3IDZkMSA3czIiCgl9LAoJIkJlcmtlbGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogOTcsCgkJIlN5bWJvbCI6ICJCayIsCgkJIkF0b21pY01hc3MiOiAyNDcsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNTAsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDk3LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDk3LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuMTk3OSwKCQkiRGVuc2l0eSI6IDE0LjgsCgkJIk1lbHRpbmdQb2ludCI6IDEyNTkuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDk4MywKCQkiTnVtYmVyT2ZJc290b3BlcyI6IDgzLAoJCSJEaXNjb3ZlcmVyIjogIlNlYWJvcmcgZXQgYWwuIiwKCQkiWWVhciI6IDE5NDksCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjkgN3MyIgoJfSwKCSJDYWxpZm9ybml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogOTgsCgkJIlN5bWJvbCI6ICJDZiIsCgkJIkF0b21pY01hc3MiOiAyNTEsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNTMsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDk4LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDk4LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuMjgxNywKCQkiRGVuc2l0eSI6IDE1LjEsCgkJIk1lbHRpbmdQb2ludCI6IDE5MjUuMTUsCgkJIkJvaWxpbmdQb2ludCI6IDExNzMsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxMjMsCgkJIkRpc2NvdmVyZXIiOiAiU2VhYm9yZyBldCBhbC4iLAoJCSJZZWFyIjogMTk1MCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTAgN3MyIgoJfSwKCSJFaW5zdGVpbml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogOTksCgkJIlN5bWJvbCI6ICJFcyIsCgkJIkF0b21pY01hc3MiOiAyNTIsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNTMsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDk5LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDk5LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNDIsCgkJIkRlbnNpdHkiOiAxMy41LAoJCSJNZWx0aW5nUG9pbnQiOiAxMTMzLjE1LAoJCSJCb2lsaW5nUG9pbnQiOiBudWxsLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMTIzLAoJCSJEaXNjb3ZlcmVyIjogIkdoaW9yc28gZXQgYWwuIiwKCQkiWWVhciI6IDE5NTIsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjExIDdzMiIKCX0sCgkiRmVybWl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTAwLAoJCSJTeW1ib2wiOiAiRm0iLAoJCSJBdG9taWNNYXNzIjogMjU3LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTU3LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMDAsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTAwLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNSwKCQkiRGVuc2l0eSI6IG51bGwsCgkJIk1lbHRpbmdQb2ludCI6IG51bGwsCgkJIkJvaWxpbmdQb2ludCI6IG51bGwsCgkJIk51bWJlck9mSXNvdG9wZXMiOiAxMDMsCgkJIkRpc2NvdmVyZXIiOiAiR2hpb3JzbyBldCBhbC4iLAoJCSJZZWFyIjogMTk1MywKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTIgN3MyIgoJfSwKCSJNZW5kZWxldml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTAxLAoJCSJTeW1ib2wiOiAiTWQiLAoJCSJBdG9taWNNYXNzIjogMjU4LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTU3LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMDEsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTAxLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNTgsCgkJIkRlbnNpdHkiOiBudWxsLAoJCSJNZWx0aW5nUG9pbnQiOiBudWxsLAoJCSJCb2lsaW5nUG9pbnQiOiBudWxsLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMzMsCgkJIkRpc2NvdmVyZXIiOiAiR2hpb3JzbyBldCBhbC4iLAoJCSJZZWFyIjogMTk1NSwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTMgN3MyIgoJfSwKCSJOb2JlbGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTAyLAoJCSJTeW1ib2wiOiAiTm8iLAoJCSJBdG9taWNNYXNzIjogMjU5LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTU3LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMDIsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTAyLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IG51bGwsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIkFjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiAxLjMsCgkJIkZpcnN0SW9uaXphdGlvbiI6IDYuNjUsCgkJIkRlbnNpdHkiOiBudWxsLAoJCSJNZWx0aW5nUG9pbnQiOiBudWxsLAoJCSJCb2lsaW5nUG9pbnQiOiBudWxsLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogNzMsCgkJIkRpc2NvdmVyZXIiOiAiR2hpb3JzbyBldCBhbC4iLAoJCSJZZWFyIjogMTk1OCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgN3MyIgoJfSwKCSJMYXdyZW5jaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMDMsCgkJIlN5bWJvbCI6ICJMciIsCgkJIkF0b21pY01hc3MiOiAyNjIsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNTksCgkJIk51bWJlcm9mUHJvdG9ucyI6IDEwMywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMDMsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogbnVsbCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiQWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IG51bGwsCgkJIkRlbnNpdHkiOiBudWxsLAoJCSJNZWx0aW5nUG9pbnQiOiBudWxsLAoJCSJCb2lsaW5nUG9pbnQiOiBudWxsLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogMjAzLAoJCSJEaXNjb3ZlcmVyIjogIkdoaW9yc28gZXQgYWwuIiwKCQkiWWVhciI6IDE5NjEsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjE0IDdzMiA3cDEiCgl9LAoJIlJ1dGhlcmZvcmRpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDEwNCwKCQkiU3ltYm9sIjogIlJmIiwKCQkiQXRvbWljTWFzcyI6IDI2MSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE1NywKCQkiTnVtYmVyb2ZQcm90b25zIjogMTA0LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDEwNCwKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiA0LAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2FjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogMTguMSwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiAiR2hpb3JzbyBldCBhbC4iLAoJCSJZZWFyIjogMTk2OSwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQyIDdzMiIKCX0sCgkiRHVibml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTA1LAoJCSJTeW1ib2wiOiAiRGIiLAoJCSJBdG9taWNNYXNzIjogMjYyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTU3LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMDUsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTA1LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDUsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zYWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IG51bGwsCgkJIkRlbnNpdHkiOiAzOSwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiAiR2hpb3JzbyBldCBhbC4iLAoJCSJZZWFyIjogMTk3MCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQzIDdzMiIKCX0sCgkiU2VhYm9yZ2l1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTA2LAoJCSJTeW1ib2wiOiAiU2ciLAoJCSJBdG9taWNNYXNzIjogMjY2LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTYwLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMDYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTA2LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDYsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zYWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IG51bGwsCgkJIkRlbnNpdHkiOiAzNSwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiAiR2hpb3JzbyBldCBhbC4iLAoJCSJZZWFyIjogMTk3NCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQ0IDdzMiIKCX0sCgkiQm9ocml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTA3LAoJCSJTeW1ib2wiOiAiQmgiLAoJCSJBdG9taWNNYXNzIjogMjY0LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTU3LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMDcsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTA3LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDcsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogIlRyYW5zYWN0aW5pZGUiLAoJCSJBdG9taWNSYWRpdXMiOiBudWxsLAoJCSJFbGVjdHJvbmVnYXRpdml0eSI6IG51bGwsCgkJIkZpcnN0SW9uaXphdGlvbiI6IG51bGwsCgkJIkRlbnNpdHkiOiAzNywKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiAiQXJtYnJ1c3RlciBhbmQgTe+/vW56ZW5iZXJnIiwKCQkiWWVhciI6IDE5ODEsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjE0IDZkNSA3czIiCgl9LAoJIkhhc3NpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDEwOCwKCQkiU3ltYm9sIjogIkhzIiwKCQkiQXRvbWljTWFzcyI6IDI2NywKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE1OSwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTA4LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDEwOCwKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiA4LAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2FjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogNDEsCgkJIk1lbHRpbmdQb2ludCI6IG51bGwsCgkJIkJvaWxpbmdQb2ludCI6IG51bGwsCgkJIk51bWJlck9mSXNvdG9wZXMiOiBudWxsLAoJCSJEaXNjb3ZlcmVyIjogIkFybWJydXN0ZXIgYW5kIE3vv71uemVuYmVyZyIsCgkJIlllYXIiOiAxOTgzLAoJCSJTcGVjaWZpY0hlYXQiOiBudWxsLAoJCSJOdW1iZXJvZlNoZWxscyI6IDcsCgkJIk51bWJlcm9mVmFsZW5jZSI6IG51bGwsCgkJIkVsZWN0cm9uaWNDb25maWd1cmF0aW9uIjogIltSbl0gNWYxNCA2ZDYgN3MyIgoJfSwKCSJNZWl0bmVyaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMDksCgkJIlN5bWJvbCI6ICJNdCIsCgkJIkF0b21pY01hc3MiOiAyNjgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNTksCgkJIk51bWJlcm9mUHJvdG9ucyI6IDEwOSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMDksCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogOSwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNhY3RpbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IG51bGwsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogbnVsbCwKCQkiRmlyc3RJb25pemF0aW9uIjogbnVsbCwKCQkiRGVuc2l0eSI6IDM1LAoJCSJNZWx0aW5nUG9pbnQiOiBudWxsLAoJCSJCb2lsaW5nUG9pbnQiOiBudWxsLAoJCSJOdW1iZXJPZklzb3RvcGVzIjogbnVsbCwKCQkiRGlzY292ZXJlciI6ICJHU0ksIERhcm1zdGFkdCwgV2VzdCBHZXJtYW55IiwKCQkiWWVhciI6IDE5ODIsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjE0IDZkNyA3czIiCgl9LAoJIkRhcm1zdGFkdGl1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTEwLAoJCSJTeW1ib2wiOiAiRHMgIiwKCQkiQXRvbWljTWFzcyI6IDI3MSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE2MSwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTEwLAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDExMCwKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiAxMCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNhY3RpbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IG51bGwsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogbnVsbCwKCQkiRmlyc3RJb25pemF0aW9uIjogbnVsbCwKCQkiRGVuc2l0eSI6IG51bGwsCgkJIk1lbHRpbmdQb2ludCI6IG51bGwsCgkJIkJvaWxpbmdQb2ludCI6IG51bGwsCgkJIk51bWJlck9mSXNvdG9wZXMiOiBudWxsLAoJCSJEaXNjb3ZlcmVyIjogbnVsbCwKCQkiWWVhciI6IDE5OTQsCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogbnVsbCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjE0IDZkOSA3czEiCgl9LAoJIlJvZW50Z2VuaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMTEsCgkJIlN5bWJvbCI6ICJSZyAiLAoJCSJBdG9taWNNYXNzIjogMjcyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTYxLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMTEsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTExLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDExLAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2FjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMTk5NCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czEiCgl9LAoJIkNvcGVybmljaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMTIsCgkJIlN5bWJvbCI6ICJDbiAiLAoJCSJBdG9taWNNYXNzIjogMjg1LAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTczLAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMTIsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTEyLAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDEyLAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2FjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMTk5NiwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiBudWxsLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czIiCgl9LAoJIk5paG9uaXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMTMsCgkJIlN5bWJvbCI6ICJOaCIsCgkJIkF0b21pY01hc3MiOiAyODQsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNzEsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDExMywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMTMsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogMTMsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogbnVsbCwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMjAwNCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiAzLAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czIgN3AxIgoJfSwKCSJGbGVyb3ZpdW0iOiB7CgkJIkF0b21pY051bWJlciI6IDExNCwKCQkiU3ltYm9sIjogIkZsIiwKCQkiQXRvbWljTWFzcyI6IDI4OSwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE3NSwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTE0LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDExNCwKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiAxNCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6ICJ5ZXMiLAoJCSJOb25tZXRhbCI6IG51bGwsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiVHJhbnNhY3RpbmlkZSIsCgkJIkF0b21pY1JhZGl1cyI6IG51bGwsCgkJIkVsZWN0cm9uZWdhdGl2aXR5IjogbnVsbCwKCQkiRmlyc3RJb25pemF0aW9uIjogbnVsbCwKCQkiRGVuc2l0eSI6IG51bGwsCgkJIk1lbHRpbmdQb2ludCI6IG51bGwsCgkJIkJvaWxpbmdQb2ludCI6IG51bGwsCgkJIk51bWJlck9mSXNvdG9wZXMiOiBudWxsLAoJCSJEaXNjb3ZlcmVyIjogbnVsbCwKCQkiWWVhciI6IDE5OTksCgkJIlNwZWNpZmljSGVhdCI6IG51bGwsCgkJIk51bWJlcm9mU2hlbGxzIjogNywKCQkiTnVtYmVyb2ZWYWxlbmNlIjogNCwKCQkiRWxlY3Ryb25pY0NvbmZpZ3VyYXRpb24iOiAiW1JuXSA1ZjE0IDZkMTAgN3MyIDdwMiIKCX0sCgkiTW9zY292aXVtIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMTUsCgkJIlN5bWJvbCI6ICJNYyIsCgkJIkF0b21pY01hc3MiOiAyODgsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNzMsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDExNSwKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMTUsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogMTUsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiAieWVzIiwKCQkiTm9ubWV0YWwiOiBudWxsLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogbnVsbCwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMjAxMCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA1LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czIgN3AzIgoJfSwKCSJMaXZlcm1vcml1bSI6IHsKCQkiQXRvbWljTnVtYmVyIjogMTE2LAoJCSJTeW1ib2wiOiAiTHYiLAoJCSJBdG9taWNNYXNzIjogMjkyLAoJCSJOdW1iZXJvZk5ldXRyb25zIjogMTc2LAoJCSJOdW1iZXJvZlByb3RvbnMiOiAxMTYsCgkJIk51bWJlcm9mRWxlY3Ryb25zIjogMTE2LAoJCSJQZXJpb2QiOiA3LAoJCSJHcm91cCI6IDE2LAoJCSJQaGFzZSI6ICJhcnRpZmljaWFsIiwKCQkiUmFkaW9hY3RpdmUiOiAieWVzIiwKCQkiTmF0dXJhbCI6IG51bGwsCgkJIk1ldGFsIjogInllcyIsCgkJIk5vbm1ldGFsIjogbnVsbCwKCQkiTWV0YWxsb2lkIjogbnVsbCwKCQkiVHlwZSI6ICJUcmFuc2FjdGluaWRlIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMjAwMCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA2LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czIgN3A0IgoJfSwKCSJUZW5uZXNzaW5lIjogewoJCSJBdG9taWNOdW1iZXIiOiAxMTcsCgkJIlN5bWJvbCI6ICJUcyIsCgkJIkF0b21pY01hc3MiOiAyOTUsCgkJIk51bWJlcm9mTmV1dHJvbnMiOiAxNzgsCgkJIk51bWJlcm9mUHJvdG9ucyI6IDExNywKCQkiTnVtYmVyb2ZFbGVjdHJvbnMiOiAxMTcsCgkJIlBlcmlvZCI6IDcsCgkJIkdyb3VwIjogMTcsCgkJIlBoYXNlIjogImFydGlmaWNpYWwiLAoJCSJSYWRpb2FjdGl2ZSI6ICJ5ZXMiLAoJCSJOYXR1cmFsIjogbnVsbCwKCQkiTWV0YWwiOiBudWxsLAoJCSJOb25tZXRhbCI6ICJ5ZXMiLAoJCSJNZXRhbGxvaWQiOiBudWxsLAoJCSJUeXBlIjogbnVsbCwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMjAxMCwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA3LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czIgN3A1IgoJfSwKCSJPZ2FuZXNzb24iOiB7CgkJIkF0b21pY051bWJlciI6IDExOCwKCQkiU3ltYm9sIjogIk9nIiwKCQkiQXRvbWljTWFzcyI6IDI5NCwKCQkiTnVtYmVyb2ZOZXV0cm9ucyI6IDE3NiwKCQkiTnVtYmVyb2ZQcm90b25zIjogMTE4LAoJCSJOdW1iZXJvZkVsZWN0cm9ucyI6IDExOCwKCQkiUGVyaW9kIjogNywKCQkiR3JvdXAiOiAxOCwKCQkiUGhhc2UiOiAiYXJ0aWZpY2lhbCIsCgkJIlJhZGlvYWN0aXZlIjogInllcyIsCgkJIk5hdHVyYWwiOiBudWxsLAoJCSJNZXRhbCI6IG51bGwsCgkJIk5vbm1ldGFsIjogInllcyIsCgkJIk1ldGFsbG9pZCI6IG51bGwsCgkJIlR5cGUiOiAiTm9ibGUgR2FzIiwKCQkiQXRvbWljUmFkaXVzIjogbnVsbCwKCQkiRWxlY3Ryb25lZ2F0aXZpdHkiOiBudWxsLAoJCSJGaXJzdElvbml6YXRpb24iOiBudWxsLAoJCSJEZW5zaXR5IjogbnVsbCwKCQkiTWVsdGluZ1BvaW50IjogbnVsbCwKCQkiQm9pbGluZ1BvaW50IjogbnVsbCwKCQkiTnVtYmVyT2ZJc290b3BlcyI6IG51bGwsCgkJIkRpc2NvdmVyZXIiOiBudWxsLAoJCSJZZWFyIjogMjAwNiwKCQkiU3BlY2lmaWNIZWF0IjogbnVsbCwKCQkiTnVtYmVyb2ZTaGVsbHMiOiA3LAoJCSJOdW1iZXJvZlZhbGVuY2UiOiA4LAoJCSJFbGVjdHJvbmljQ29uZmlndXJhdGlvbiI6ICJbUm5dIDVmMTQgNmQxMCA3czIgN3A2IgoJfQp9IAo=')


import base64
table = base64.b64decode(b'IF9fX19fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fX19fCnwgIDEgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDIgIHwKfCAgSCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgSGUgfAp8X19fX198X19fX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19fX19fX19fX19fX19fX19fX19fX19fX19fX198X19fX198CnwgIDMgIHwgIDQgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDUgIHwgIDYgIHwgIDcgIHwgIDggIHwgIDkgIHwgIDEwIHwKfCAgTGkgfCAgQmUgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgQiAgfCAgQyAgfCAgTiAgfCAgTyAgfCAgRiAgfCAgTmUgfAp8X19fX198X19fX198ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198CnwgIDExIHwgIDEyIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEzIHwgIDE0IHwgIDE1IHwgIDE2IHwgIDE3IHwgIDE4IHwKfCAgTmEgfCAgTWcgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgQWwgfCAgU2kgfCAgUCAgfCAgUyAgfCAgQ2wgfCAgQXIgfAp8X19fX198X19fX198X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198CnwgIDE5IHwgIDIwIHwgIDIxIHwgIDIyIHwgIDIzIHwgIDI0IHwgIDI1IHwgIDI2IHwgIDI3IHwgIDI4IHwgIDI5IHwgIDMwIHwgIDMxIHwgIDMyIHwgIDMzIHwgIDM0IHwgIDM1IHwgIDM2IHwKfCAgSyAgfCAgQ2EgfCAgU2MgfCAgVGkgfCAgViAgfCAgQ3IgfCAgTW4gfCAgRmUgfCAgQ28gfCAgTmkgfCAgQ3UgfCAgWm4gfCAgR2EgfCAgR2UgfCAgQXMgfCAgU2UgfCAgQnIgfCAgS3IgfAp8X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198CnwgIDM3IHwgIDM4IHwgIDM5IHwgIDQwIHwgIDQxIHwgIDQyIHwgIDQzIHwgIDQ0IHwgIDQ1IHwgIDQ2IHwgIDQ3IHwgIDQ4IHwgIDQ5IHwgIDUwIHwgIDUxIHwgIDUyIHwgIDUzIHwgIDU0IHwKfCAgUmIgfCAgU3IgfCAgWSAgfCAgWnIgfCAgTmIgfCAgTW8gfCAgVGMgfCAgUnUgfCAgUmggfCAgUGQgfCAgQWcgfCAgQ2QgfCAgSW4gfCAgU24gfCAgU2IgfCAgVGUgfCAgSSAgfCAgWGUgfAp8X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198CnwgIDU1IHwgIDU2IHwgIDU3IFwgIDcyIHwgIDczIHwgIDc0IHwgIDc1IHwgIDc2IHwgIDc3IHwgIDc4IHwgIDc5IHwgIDgwIHwgIDgxIHwgIDgyIHwgIDgzIHwgIDg0IHwgIDg1IHwgIDg2IHwKfCAgQ3MgfCAgQmEgfCAgTGEgLyAgSGYgfCAgVGEgfCAgVyAgfCAgUmUgfCAgT3MgfCAgSXIgfCAgUHQgfCAgQXUgfCAgSGcgfCAgVGwgfCAgUGIgfCAgQmkgfCAgUG8gfCAgQXQgfCAgUm4gfAp8X19fX198X19fX198X19fX19cX19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198CnwgIDg3IHwgIDg4IHwgIDg5IC8gMTA0IHwgMTA1IHwgMTA2IHwgMTA3IHwgMTA4IHwgMTA5IHwgMTEwIHwgMTExIHwgMTEyIHwgMTEzIHwgMTE0IHwgMTE1IHwgMTE2IHwgMTE3IHwgMTE4IHwKfCAgRnIgfCAgUmEgfCAgQWMgXCAgUmYgfCAgRGIgfCAgU2cgfCAgQmggfCAgSHMgfCAgTXQgfCAgRHMgfCAgUmcgfCAgQ24gfCAgTmggfCAgRmwgfCAgTWMgfCAgTHYgfCAgVHMgfCAgT2cgfAp8X19fX198X19fX198X19fX18vX19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198CgoJCQkJICBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18gCgkJCQkgIFwgIDU4IHwgIDU5IHwgIDYwIHwgIDYxIHwgIDYyIHwgIDYzIHwgIDY0IHwgIDY1IHwgIDY2IHwgIDY3IHwgIDY4IHwgIDY5IHwgIDcwIHwgIDcxIFwKCQkJCSAgLyAgQ2UgfCAgUHIgfCAgTmQgfCAgUG0gfCAgU20gfCAgRXUgfCAgR2QgfCAgVGIgfCAgRHkgfCAgSG8gfCAgRXIgfCAgVG0gfCAgWWIgfCAgTHUgLwoJCQkJICBcX19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX19cCgkJCQkgIC8gIDkwIHwgIDkxIHwgIDkyIHwgIDkzIHwgIDk0IHwgIDk1IHwgIDk2IHwgIDk3IHwgIDk4IHwgIDk5IHwgMTAwIHwgMTAxIHwgMTAyIHwgMTAzIC8KCQkJCSAgXCAgVGggfCAgUGEgfCAgVSAgfCAgTnAgfCAgUHUgfCAgQW0gfCAgQ20gfCAgQmsgfCAgQ2YgfCAgRXMgfCAgRm0gfCAgTWQgfCAgTm8gfCAgTHIgXAoJCQkJICAvX19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX198X19fX18vCg==')

table=table.decode()


import json
import readline
from pprint import pprint
import copy
import sys
import math
from decimal import Decimal
pt=json.loads(pt)

elements=list(map(str.lower, list(pt.keys())))

symbols=[pt[_]["Symbol"].lower() for _ in list(pt.keys())]

keepnames=["Symbol","Protons","Electrons","Neutrons", "Period", "Group", "Electronic configuration","Atomic mass", "Atomic number", "Atomic radius", "Density (g/cm^3)", "Specific heat (J/K)", "Electronegativity", "Melting point (K)", "Boiling point (K)", "First ionization (eV)"]

keepkeys=["Symbol","NumberofProtons","NumberofElectrons","NumberofNeutrons","Period","Group","ElectronicConfiguration", "AtomicMass","AtomicNumber","AtomicRadius","Density","SpecificHeat","Electronegativity","MeltingPoint","BoilingPoint","FirstIonization"]

def getResult(Element):
	
	if isinstance(Element,str):
		temp_dict={}
		for key in keepkeys:
			temp_dict[keepnames[keepkeys.index(key)]]=pt[Element][key]
			
		result={}
		result['Name']=Element
		result=result | temp_dict
	else:
		result={}
		result['Compound']=''.join([str(_[0])+str(_[1]) for _ in Element])
		result['Molar Mass']=float(sum([Decimal(_[1]*float(getResult(parseElement(_[0]))['Atomic mass'])) for _ in Element]))
	return result
	

def parseElement(Input):
	if Input.lower() in elements:
		return Input.title()
	elif Input.lower() in symbols:
		return elements[symbols.index(Input.lower())].title()
	else:
		raise Exception

def parseCompound(Input):
	LPAR,RPAR = map(Suppress,"()")
	integer = Word(nums)
	
	# add parse action to convert integers to ints, to support doing addition 
	# and multiplication at parse time
	integer.setParseAction(lambda t:int(t[0]))
	
	element = Word(alphas.upper(), alphas.lower())
	# or if you want to be more specific, use this Regex
	# element = Regex(r"A[cglmrstu]|B[aehikr]?|C[adeflmorsu]?|D[bsy]|E[rsu]|F[emr]?|"
	#                 "G[ade]|H[efgos]?|I[nr]?|Kr?|L[airu]|M[dgnot]|N[abdeiop]?|"
	#                 "Os?|P[abdmortu]?|R[abefghnu]|S[bcegimnr]?|T[abcehilm]|"
	#                 "Uu[bhopqst]|U|V|W|Xe|Yb?|Z[nr]")
	
	# forward declare 'formula' so it can be used in definition of 'term'
	formula = Forward()
	
	term = Group((element | Group(LPAR + formula + RPAR)("subgroup")) + 
					Optional(integer, default=1)("mult"))
	
	# define contents of a formula as one or more terms
	formula << OneOrMore(term)
	
	
	# add parse actions for parse-time processing
	
	# parse action to multiply out subgroups
	def multiplyContents(tokens):
		t = tokens[0]
		# if these tokens contain a subgroup, then use multiplier to
		# extend counts of all elements in the subgroup
		if t.subgroup:
			mult = t.mult
			for term in t.subgroup:
				term[1] *= mult
			return t.subgroup
	term.setParseAction(multiplyContents)
	
	# add parse action to sum up multiple references to the same element
	def sumByElement(tokens):
		elementsList = [t[0] for t in tokens]
	
		# construct set to see if there are duplicates
		duplicates = len(elementsList) > len(set(elementsList))
	
		# if there are duplicate element names, sum up by element and
		# return a new nested ParseResults
		if duplicates:
			ctr = defaultdict(int)
			for t in tokens:
				ctr[t[0]] += t[1]
			return ParseResults([ParseResults([k,v]) for k,v in ctr.items()])
	formula.setParseAction(sumByElement)
	return formula.parseString(Input)

def parseInput(Input):
	parseCompound(Input)
	try:
		if Input.islower():
			result=parseElement(Input)
		else:
			result=parseCompound(Input)
	except:
		print("Incorrect Element/Molecule")
		return
	pprint(getResult(result),sort_dicts=False,width=1)
	
def repl():
	while True:
		Input=input('>> ')
		parseInput(Input)

if len(sys.argv)==1:
	try:
	   repl()
	except (EOFError,KeyboardInterrupt):
		print()
		exit()
else:
	if sys.argv[-1]=="--table":
		print(table)
		exit()
	Input=sys.argv[1]
	parseInput(Input)

	